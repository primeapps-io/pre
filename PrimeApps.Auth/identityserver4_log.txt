2018-04-11 16:39:33.282 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-11 16:39:33.344 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-11 16:39:33.350 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-11 16:39:33.352 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-11 16:39:33.355 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-11 16:39:33.357 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-11 16:39:46.638 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-11 16:40:09.156 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-11 16:40:11.403 +03:00 [INF] AuthenticationScheme: Google was challenged.
2018-04-11 16:40:20.214 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-11 16:40:22.292 +03:00 [ERR] Failed executing DbCommand (793ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."Id", "u"."AccessFailedCount", "u"."ConcurrencyStamp", "u"."Email", "u"."EmailConfirmed", "u"."LockoutEnabled", "u"."LockoutEnd", "u"."NormalizedEmail", "u"."NormalizedUserName", "u"."PasswordHash", "u"."PhoneNumber", "u"."PhoneNumberConfirmed", "u"."SecurityStamp", "u"."TwoFactorEnabled", "u"."UserName"
FROM "AspNetUsers" AS "u"
WHERE "u"."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
Npgsql.PostgresException (0x80004005): 42P01: relation "AspNetUsers" does not exist
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
2018-04-11 16:40:23.383 +03:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42P01: relation "AspNetUsers" does not exist
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
Npgsql.PostgresException (0x80004005): 42P01: relation "AspNetUsers" does not exist
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
2018-04-11 16:40:23.767 +03:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
Npgsql.PostgresException (0x80004005): 42P01: relation "AspNetUsers" does not exist
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()
Npgsql.PostgresException (0x80004005): 42P01: relation "AspNetUsers" does not exist
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()
2018-04-11 16:40:57.469 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-11 16:40:57.711 +03:00 [INF] {
  "Name": "User Login Failure",
  "Category": "Authentication",
  "EventType": "Failure",
  "Id": 1001,
  "Username": "alice",
  "Endpoint": "UI",
  "Message": "invalid credentials",
  "ActivityId": "0HLCVM6KIQM0C:00000013",
  "TimeStamp": "2018-04-11T13:40:57Z",
  "ProcessId": 26556,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-11 16:41:49.482 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-11 16:41:49.539 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-11 16:41:49.547 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-11 16:41:49.550 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-11 16:41:49.552 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-11 16:41:49.554 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-11 16:41:53.644 +03:00 [ERR] Failed executing DbCommand (616ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?', @p18='?', @p19='?', @p20='?', @p35='?', @p21='?', @p22='?', @p36='?', @p23='?', @p24='?', @p25='?', @p26='?', @p27='?', @p28='?', @p29='?', @p30='?', @p31='?', @p32='?', @p33='?', @p34='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p3, @p4, @p5)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p6, @p7, @p8)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p9, @p10, @p11)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p12, @p13, @p14)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p15, @p16, @p17)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p18, @p19, @p20)
RETURNING "Id";
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p21, "ConcurrencyStamp" = @p22, "Email" = @p23, "EmailConfirmed" = @p24, "LockoutEnabled" = @p25, "LockoutEnd" = @p26, "NormalizedEmail" = @p27, "NormalizedUserName" = @p28, "PasswordHash" = @p29, "PhoneNumber" = @p30, "PhoneNumberConfirmed" = @p31, "SecurityStamp" = @p32, "TwoFactorEnabled" = @p33, "UserName" = @p34
WHERE "Id" = @p35 AND "ConcurrencyStamp" = @p36;
Npgsql.PostgresException (0x80004005): 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
2018-04-11 16:41:54.610 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
2018-04-11 16:42:42.343 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-11 16:42:42.400 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-11 16:42:42.408 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-11 16:42:42.411 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-11 16:42:42.414 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-11 16:42:42.417 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-11 16:42:49.571 +03:00 [ERR] Failed executing DbCommand (736ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?', @p18='?', @p19='?', @p20='?', @p35='?', @p21='?', @p22='?', @p36='?', @p23='?', @p24='?', @p25='?', @p26='?', @p27='?', @p28='?', @p29='?', @p30='?', @p31='?', @p32='?', @p33='?', @p34='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p3, @p4, @p5)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p6, @p7, @p8)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p9, @p10, @p11)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p12, @p13, @p14)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p15, @p16, @p17)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p18, @p19, @p20)
RETURNING "Id";
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p21, "ConcurrencyStamp" = @p22, "Email" = @p23, "EmailConfirmed" = @p24, "LockoutEnabled" = @p25, "LockoutEnd" = @p26, "NormalizedEmail" = @p27, "NormalizedUserName" = @p28, "PasswordHash" = @p29, "PhoneNumber" = @p30, "PhoneNumberConfirmed" = @p31, "SecurityStamp" = @p32, "TwoFactorEnabled" = @p33, "UserName" = @p34
WHERE "Id" = @p35 AND "ConcurrencyStamp" = @p36;
Npgsql.PostgresException (0x80004005): 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
2018-04-11 16:42:50.623 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
2018-04-11 16:45:36.378 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-11 16:45:36.431 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-11 16:45:36.438 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-11 16:45:36.441 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-11 16:45:36.443 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-11 16:45:36.445 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-11 16:45:40.867 +03:00 [ERR] Failed executing DbCommand (644ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?', @p18='?', @p19='?', @p20='?', @p21='?', @p22='?', @p23='?', @p38='?', @p24='?', @p25='?', @p39='?', @p26='?', @p27='?', @p28='?', @p29='?', @p30='?', @p31='?', @p32='?', @p33='?', @p34='?', @p35='?', @p36='?', @p37='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p3, @p4, @p5)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p6, @p7, @p8)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p9, @p10, @p11)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p12, @p13, @p14)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p15, @p16, @p17)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p18, @p19, @p20)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p21, @p22, @p23)
RETURNING "Id";
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p24, "ConcurrencyStamp" = @p25, "Email" = @p26, "EmailConfirmed" = @p27, "LockoutEnabled" = @p28, "LockoutEnd" = @p29, "NormalizedEmail" = @p30, "NormalizedUserName" = @p31, "PasswordHash" = @p32, "PhoneNumber" = @p33, "PhoneNumberConfirmed" = @p34, "SecurityStamp" = @p35, "TwoFactorEnabled" = @p36, "UserName" = @p37
WHERE "Id" = @p38 AND "ConcurrencyStamp" = @p39;
Npgsql.PostgresException (0x80004005): 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
2018-04-11 16:45:41.869 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
2018-04-11 16:46:03.999 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-11 16:46:04.058 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-11 16:46:04.065 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-11 16:46:04.068 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-11 16:46:04.070 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-11 16:46:04.072 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-11 16:46:07.936 +03:00 [ERR] Failed executing DbCommand (632ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?', @p18='?', @p19='?', @p20='?', @p35='?', @p21='?', @p22='?', @p36='?', @p23='?', @p24='?', @p25='?', @p26='?', @p27='?', @p28='?', @p29='?', @p30='?', @p31='?', @p32='?', @p33='?', @p34='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p3, @p4, @p5)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p6, @p7, @p8)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p9, @p10, @p11)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p12, @p13, @p14)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p15, @p16, @p17)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p18, @p19, @p20)
RETURNING "Id";
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p21, "ConcurrencyStamp" = @p22, "Email" = @p23, "EmailConfirmed" = @p24, "LockoutEnabled" = @p25, "LockoutEnd" = @p26, "NormalizedEmail" = @p27, "NormalizedUserName" = @p28, "PasswordHash" = @p29, "PhoneNumber" = @p30, "PhoneNumberConfirmed" = @p31, "SecurityStamp" = @p32, "TwoFactorEnabled" = @p33, "UserName" = @p34
WHERE "Id" = @p35 AND "ConcurrencyStamp" = @p36;
Npgsql.PostgresException (0x80004005): 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
2018-04-11 16:46:08.921 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
2018-04-11 16:50:59.986 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-11 16:51:00.048 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-11 16:51:00.055 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-11 16:51:00.057 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-11 16:51:00.060 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-11 16:51:00.063 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-11 16:51:04.260 +03:00 [ERR] Failed executing DbCommand (624ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?', @p18='?', @p19='?', @p20='?', @p21='?', @p22='?', @p23='?', @p38='?', @p24='?', @p25='?', @p39='?', @p26='?', @p27='?', @p28='?', @p29='?', @p30='?', @p31='?', @p32='?', @p33='?', @p34='?', @p35='?', @p36='?', @p37='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p3, @p4, @p5)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p6, @p7, @p8)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p9, @p10, @p11)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p12, @p13, @p14)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p15, @p16, @p17)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p18, @p19, @p20)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p21, @p22, @p23)
RETURNING "Id";
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p24, "ConcurrencyStamp" = @p25, "Email" = @p26, "EmailConfirmed" = @p27, "LockoutEnabled" = @p28, "LockoutEnd" = @p29, "NormalizedEmail" = @p30, "NormalizedUserName" = @p31, "PasswordHash" = @p32, "PhoneNumber" = @p33, "PhoneNumberConfirmed" = @p34, "SecurityStamp" = @p35, "TwoFactorEnabled" = @p36, "UserName" = @p37
WHERE "Id" = @p38 AND "ConcurrencyStamp" = @p39;
Npgsql.PostgresException (0x80004005): 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
2018-04-11 16:51:05.241 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
2018-04-11 16:51:27.971 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-11 16:51:28.025 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-11 16:51:28.032 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-11 16:51:28.036 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-11 16:51:28.038 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-11 16:51:28.041 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-11 16:51:35.033 +03:00 [ERR] Failed executing DbCommand (683ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p17='?', @p3='?', @p4='?', @p18='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?', @p16='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p3, "ConcurrencyStamp" = @p4, "Email" = @p5, "EmailConfirmed" = @p6, "LockoutEnabled" = @p7, "LockoutEnd" = @p8, "NormalizedEmail" = @p9, "NormalizedUserName" = @p10, "PasswordHash" = @p11, "PhoneNumber" = @p12, "PhoneNumberConfirmed" = @p13, "SecurityStamp" = @p14, "TwoFactorEnabled" = @p15, "UserName" = @p16
WHERE "Id" = @p17 AND "ConcurrencyStamp" = @p18;
Npgsql.PostgresException (0x80004005): 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
2018-04-11 16:51:36.121 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
2018-04-11 16:51:59.571 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-11 16:51:59.628 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-11 16:51:59.635 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-11 16:51:59.638 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-11 16:51:59.641 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-11 16:51:59.644 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-11 16:53:32.143 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-11 16:53:32.202 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-11 16:53:32.209 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-11 16:53:32.211 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-11 16:53:32.214 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-11 16:53:32.216 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-11 16:54:03.384 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-11 16:54:03.441 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-11 16:54:03.448 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-11 16:54:03.453 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-11 16:54:03.455 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-11 16:54:03.457 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-11 16:56:14.458 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-11 16:56:14.515 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-11 16:56:14.521 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-11 16:56:14.524 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-11 16:56:14.527 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-11 16:56:14.529 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-11 16:56:18.493 +03:00 [ERR] Failed executing DbCommand (617ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?', @p18='?', @p19='?', @p20='?', @p21='?', @p22='?', @p23='?', @p38='?', @p24='?', @p25='?', @p39='?', @p26='?', @p27='?', @p28='?', @p29='?', @p30='?', @p31='?', @p32='?', @p33='?', @p34='?', @p35='?', @p36='?', @p37='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p3, @p4, @p5)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p6, @p7, @p8)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p9, @p10, @p11)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p12, @p13, @p14)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p15, @p16, @p17)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p18, @p19, @p20)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p21, @p22, @p23)
RETURNING "Id";
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p24, "ConcurrencyStamp" = @p25, "Email" = @p26, "EmailConfirmed" = @p27, "LockoutEnabled" = @p28, "LockoutEnd" = @p29, "NormalizedEmail" = @p30, "NormalizedUserName" = @p31, "PasswordHash" = @p32, "PhoneNumber" = @p33, "PhoneNumberConfirmed" = @p34, "SecurityStamp" = @p35, "TwoFactorEnabled" = @p36, "UserName" = @p37
WHERE "Id" = @p38 AND "ConcurrencyStamp" = @p39;
Npgsql.PostgresException (0x80004005): 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
2018-04-11 16:56:19.447 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
2018-04-11 16:56:32.825 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-11 16:56:32.881 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-11 16:56:32.888 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-11 16:56:32.892 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-11 16:56:32.894 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-11 16:56:32.897 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-11 16:59:06.013 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-11 16:59:06.074 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-11 16:59:06.081 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-11 16:59:06.084 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-11 16:59:06.086 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-11 16:59:06.089 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-11 16:59:09.944 +03:00 [ERR] Failed executing DbCommand (624ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?', @p18='?', @p19='?', @p20='?', @p35='?', @p21='?', @p22='?', @p36='?', @p23='?', @p24='?', @p25='?', @p26='?', @p27='?', @p28='?', @p29='?', @p30='?', @p31='?', @p32='?', @p33='?', @p34='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p3, @p4, @p5)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p6, @p7, @p8)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p9, @p10, @p11)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p12, @p13, @p14)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p15, @p16, @p17)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p18, @p19, @p20)
RETURNING "Id";
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p21, "ConcurrencyStamp" = @p22, "Email" = @p23, "EmailConfirmed" = @p24, "LockoutEnabled" = @p25, "LockoutEnd" = @p26, "NormalizedEmail" = @p27, "NormalizedUserName" = @p28, "PasswordHash" = @p29, "PhoneNumber" = @p30, "PhoneNumberConfirmed" = @p31, "SecurityStamp" = @p32, "TwoFactorEnabled" = @p33, "UserName" = @p34
WHERE "Id" = @p35 AND "ConcurrencyStamp" = @p36;
Npgsql.PostgresException (0x80004005): 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
2018-04-11 16:59:10.914 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
2018-04-11 16:59:26.990 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-11 16:59:27.046 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-11 16:59:27.053 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-11 16:59:27.056 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-11 16:59:27.058 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-11 16:59:27.061 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-11 16:59:31.148 +03:00 [ERR] Failed executing DbCommand (646ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?', @p18='?', @p19='?', @p20='?', @p21='?', @p22='?', @p23='?', @p38='?', @p24='?', @p25='?', @p39='?', @p26='?', @p27='?', @p28='?', @p29='?', @p30='?', @p31='?', @p32='?', @p33='?', @p34='?', @p35='?', @p36='?', @p37='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p3, @p4, @p5)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p6, @p7, @p8)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p9, @p10, @p11)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p12, @p13, @p14)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p15, @p16, @p17)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p18, @p19, @p20)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p21, @p22, @p23)
RETURNING "Id";
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p24, "ConcurrencyStamp" = @p25, "Email" = @p26, "EmailConfirmed" = @p27, "LockoutEnabled" = @p28, "LockoutEnd" = @p29, "NormalizedEmail" = @p30, "NormalizedUserName" = @p31, "PasswordHash" = @p32, "PhoneNumber" = @p33, "PhoneNumberConfirmed" = @p34, "SecurityStamp" = @p35, "TwoFactorEnabled" = @p36, "UserName" = @p37
WHERE "Id" = @p38 AND "ConcurrencyStamp" = @p39;
Npgsql.PostgresException (0x80004005): 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
2018-04-11 16:59:32.108 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
2018-04-11 17:00:13.042 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-11 17:00:13.107 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-11 17:00:13.115 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-11 17:00:13.117 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-11 17:00:13.120 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-11 17:00:13.123 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-11 17:00:19.775 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-11 17:00:32.207 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-11 17:00:34.030 +03:00 [DBG] Augmenting SignInContext
2018-04-11 17:00:34.036 +03:00 [DBG] Adding idp claim with value: local
2018-04-11 17:00:34.039 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-11 17:00:34.042 +03:00 [DBG] Adding auth_time claim with value: 1523455234
2018-04-11 17:00:34.063 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-11 17:00:34.263 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLCVMI63FCA8:00000004",
  "TimeStamp": "2018-04-11T14:00:34Z",
  "ProcessId": 11188,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-11 17:00:34.289 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:00:34.296 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:00:37.560 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:00:37.566 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:00:42.020 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:00:42.024 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:04:34.866 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-11 17:04:34.915 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-11 17:04:34.921 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-11 17:04:34.921 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-11 17:04:34.922 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-11 17:04:34.922 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-11 17:04:35.470 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:04:35.488 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:04:40.557 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-11 17:04:40.564 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-11 17:04:40.565 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-11 17:04:40.570 +03:00 [DBG] Start discovery request
2018-04-11 17:04:40.870 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-11 17:04:40.875 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-11 17:04:40.876 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-11 17:04:40.880 +03:00 [DBG] Start key discovery request
2018-04-11 17:04:40.939 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:04:40.941 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:04:40.942 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-11 17:04:40.949 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-11 17:04:40.952 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-11 17:04:40.958 +03:00 [DBG] Start authorize request
2018-04-11 17:04:40.973 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-11 17:04:40.980 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:04:40.994 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:04:40.996 +03:00 [DBG] No PKCE used.
2018-04-11 17:04:41.049 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:04:41.069 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_94Epj8yICeVBPU-6vu1hx6NxBDPEz0fj_H7TPx3ivvWM_6AK6U52TA3jsDLAtMe-Z0VTnhFLNETRDLd2-54BD6N9hs-V6Fm3aURyKsbGytzlINcdM7aCwOj5gL3VrT4PAIzOvTkcHTQAzm749KLXP97wyGXHZlLdsBBaEVooLJ-GjzOR2K9H18eonKcxe_vecoQVRpJMfSLB2llONOsCOnCaU00KsSW1abil3HQfo79_Nrlo7NyJw8H6b4x7Cia2hNZy7Zef8cxb-IegY1EIVuRL5q1b3u-sW08xdvA3lRNElSSdloemVcmRuAaMq-K1tQ",
  "Nonce": "636590522809293659.OGIyZjA3NmEtNGRlYi00YTc0LTg5ZWQtYmZkZGU5Y2ExYWJhOGMxZDNmZTUtMTg4Mi00Njg0LWE1ZDctYzUxYmZjYWRjM2Rl",
  "SessionId": "80ba568b01301210e7ec01e9f57122a2",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636590522809293659.OGIyZjA3NmEtNGRlYi00YTc0LTg5ZWQtYmZkZGU5Y2ExYWJhOGMxZDNmZTUtMTg4Mi00Njg0LWE1ZDctYzUxYmZjYWRjM2Rl",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_94Epj8yICeVBPU-6vu1hx6NxBDPEz0fj_H7TPx3ivvWM_6AK6U52TA3jsDLAtMe-Z0VTnhFLNETRDLd2-54BD6N9hs-V6Fm3aURyKsbGytzlINcdM7aCwOj5gL3VrT4PAIzOvTkcHTQAzm749KLXP97wyGXHZlLdsBBaEVooLJ-GjzOR2K9H18eonKcxe_vecoQVRpJMfSLB2llONOsCOnCaU00KsSW1abil3HQfo79_Nrlo7NyJw8H6b4x7Cia2hNZy7Zef8cxb-IegY1EIVuRL5q1b3u-sW08xdvA3lRNElSSdloemVcmRuAaMq-K1tQ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-11 17:04:42.258 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-11 17:04:42.258 +03:00 [INF] Showing consent: User has not yet consented
2018-04-11 17:04:42.271 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:04:42.273 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:04:42.335 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:04:42.336 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:04:42.337 +03:00 [DBG] No PKCE used.
2018-04-11 17:04:42.340 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:04:56.831 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-11 17:04:56.836 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:04:56.837 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:04:56.877 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:04:56.878 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:04:56.879 +03:00 [DBG] No PKCE used.
2018-04-11 17:04:56.881 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:04:56.906 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:04:56.908 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:04:56.910 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-11 17:04:56.912 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-11 17:04:56.913 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-11 17:04:56.920 +03:00 [DBG] Start authorize callback request
2018-04-11 17:04:56.947 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-11 17:04:56.949 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:04:56.953 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:04:56.954 +03:00 [DBG] No PKCE used.
2018-04-11 17:04:56.954 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:04:56.955 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_94Epj8yICeVBPU-6vu1hx6NxBDPEz0fj_H7TPx3ivvWM_6AK6U52TA3jsDLAtMe-Z0VTnhFLNETRDLd2-54BD6N9hs-V6Fm3aURyKsbGytzlINcdM7aCwOj5gL3VrT4PAIzOvTkcHTQAzm749KLXP97wyGXHZlLdsBBaEVooLJ-GjzOR2K9H18eonKcxe_vecoQVRpJMfSLB2llONOsCOnCaU00KsSW1abil3HQfo79_Nrlo7NyJw8H6b4x7Cia2hNZy7Zef8cxb-IegY1EIVuRL5q1b3u-sW08xdvA3lRNElSSdloemVcmRuAaMq-K1tQ",
  "Nonce": "636590522809293659.OGIyZjA3NmEtNGRlYi00YTc0LTg5ZWQtYmZkZGU5Y2ExYWJhOGMxZDNmZTUtMTg4Mi00Njg0LWE1ZDctYzUxYmZjYWRjM2Rl",
  "SessionId": "80ba568b01301210e7ec01e9f57122a2",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636590522809293659.OGIyZjA3NmEtNGRlYi00YTc0LTg5ZWQtYmZkZGU5Y2ExYWJhOGMxZDNmZTUtMTg4Mi00Njg0LWE1ZDctYzUxYmZjYWRjM2Rl",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_94Epj8yICeVBPU-6vu1hx6NxBDPEz0fj_H7TPx3ivvWM_6AK6U52TA3jsDLAtMe-Z0VTnhFLNETRDLd2-54BD6N9hs-V6Fm3aURyKsbGytzlINcdM7aCwOj5gL3VrT4PAIzOvTkcHTQAzm749KLXP97wyGXHZlLdsBBaEVooLJ-GjzOR2K9H18eonKcxe_vecoQVRpJMfSLB2llONOsCOnCaU00KsSW1abil3HQfo79_Nrlo7NyJw8H6b4x7Cia2hNZy7Zef8cxb-IegY1EIVuRL5q1b3u-sW08xdvA3lRNElSSdloemVcmRuAaMq-K1tQ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-11 17:04:57.063 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-11 17:04:57.073 +03:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2018-04-11 17:04:57.084 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2018-04-11 17:04:57.089 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-11 17:04:57.118 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-11 17:04:57.152 +03:00 [DBG] Creating Implicit Flow response.
2018-04-11 17:04:57.164 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-11 17:04:57.167 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-11 17:04:57.257 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****gtEw"
    },
    {
      "TokenType": "code",
      "TokenValue": "****2421"
    }
  ],
  "ActivityId": "0HLCVMKJVSJER:00000006",
  "TimeStamp": "2018-04-11T14:04:57Z",
  "ProcessId": 2544,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-11 17:04:57.269 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_94Epj8yICeVBPU-6vu1hx6NxBDPEz0fj_H7TPx3ivvWM_6AK6U52TA3jsDLAtMe-Z0VTnhFLNETRDLd2-54BD6N9hs-V6Fm3aURyKsbGytzlINcdM7aCwOj5gL3VrT4PAIzOvTkcHTQAzm749KLXP97wyGXHZlLdsBBaEVooLJ-GjzOR2K9H18eonKcxe_vecoQVRpJMfSLB2llONOsCOnCaU00KsSW1abil3HQfo79_Nrlo7NyJw8H6b4x7Cia2hNZy7Zef8cxb-IegY1EIVuRL5q1b3u-sW08xdvA3lRNElSSdloemVcmRuAaMq-K1tQ",
  "Scope": "openid profile api1 offline_access"
}
2018-04-11 17:04:57.298 +03:00 [DBG] Augmenting SignInContext
2018-04-11 17:04:57.306 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-11 17:04:57.641 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-11 17:04:57.648 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-11 17:04:57.650 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-11 17:04:57.660 +03:00 [DBG] Start token request.
2018-04-11 17:04:57.668 +03:00 [DBG] Start client validation
2018-04-11 17:04:57.677 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-11 17:04:57.681 +03:00 [DBG] Start parsing for secret in post body
2018-04-11 17:04:57.683 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-11 17:04:57.685 +03:00 [DBG] Secret id found: mvc
2018-04-11 17:04:57.701 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-11 17:04:57.704 +03:00 [DBG] Client validation success
2018-04-11 17:04:57.711 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLCVMKJVSJET:00000003",
  "TimeStamp": "2018-04-11T14:04:57Z",
  "ProcessId": 2544,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-11 17:04:57.720 +03:00 [DBG] Start token request validation
2018-04-11 17:04:57.734 +03:00 [DBG] Start validation of authorization code token request
2018-04-11 17:04:57.869 +03:00 [DBG] Validation of authorization code token request success
2018-04-11 17:04:57.877 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "a8a917501689ccfc885a2b669fa91834f97a3913a0c5c058602baf2727dc2421",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "a8a917501689ccfc885a2b669fa91834f97a3913a0c5c058602baf2727dc2421",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-11 17:04:57.903 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-11 17:04:57.905 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-11 17:04:58.210 +03:00 [DBG] Creating refresh token
2018-04-11 17:04:58.210 +03:00 [DBG] Setting an absolute lifetime: 2592000
2018-04-11 17:04:58.230 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-11 17:04:58.233 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-11 17:04:58.239 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****zumg"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****1d6b"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****VxDQ"
    }
  ],
  "ActivityId": "0HLCVMKJVSJET:00000003",
  "TimeStamp": "2018-04-11T14:04:58Z",
  "ProcessId": 2544,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-11 17:04:58.246 +03:00 [DBG] Token request success.
2018-04-11 17:04:58.260 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-11 17:04:58.263 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-11 17:04:58.265 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-11 17:04:58.273 +03:00 [DBG] Start userinfo request
2018-04-11 17:04:58.277 +03:00 [DBG] Bearer token found in header
2018-04-11 17:04:58.433 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-11 17:04:58.442 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1523455498,
    "exp": 1523459098,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1523455234,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2018-04-11 17:04:58.452 +03:00 [DBG] Creating userinfo response
2018-04-11 17:04:58.456 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-11 17:04:58.460 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-11 17:04:58.465 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-11 17:04:58.467 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-11 17:04:58.675 +03:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-04-11 17:04:58.679 +03:00 [DBG] End userinfo request
2018-04-11 17:05:08.403 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-11 17:05:08.406 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-11 17:05:08.406 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-11 17:05:08.407 +03:00 [DBG] Start discovery request
2018-04-11 17:05:08.596 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-11 17:05:08.598 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-11 17:05:08.599 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-11 17:05:08.601 +03:00 [DBG] Start key discovery request
2018-04-11 17:05:29.637 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:05:29.641 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:05:29.644 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-11 17:05:29.646 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-11 17:05:29.648 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-11 17:05:29.659 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-11 17:05:29.668 +03:00 [DBG] Start end session request validation
2018-04-11 17:05:29.675 +03:00 [DBG] Start identity token validation
2018-04-11 17:05:29.677 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-11 17:05:29.776 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-11 17:05:29.780 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1523455498,
    "exp": 1523455798,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636590522809293659.OGIyZjA3NmEtNGRlYi00YTc0LTg5ZWQtYmZkZGU5Y2ExYWJhOGMxZDNmZTUtMTg4Mi00Njg0LWE1ZDctYzUxYmZjYWRjM2Rl",
    "iat": 1523455498,
    "at_hash": "gmzgNfslRF0WpHkGXuKbdQ",
    "sid": "80ba568b01301210e7ec01e9f57122a2",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1523455234,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-11 17:05:29.788 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_96K3h-yWRHZQsrVnTyFnN7NzEjGAbUBf-s1vDzYvQ1cqMlKdefeqsFy_45nH5np5zeqUGwg8llpf_PlCMs2TirIxPBj6eAMaIQQLcJVNzFEJlcfCePnpl_feKSeJa5ZeHKVCn09SFfTSUWhRRy27QhM",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjM0NTU0OTgsImV4cCI6MTUyMzQ1NTc5OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY1OTA1MjI4MDkyOTM2NTkuT0dJeVpqQTNObUV0TkdSbFlpMDBZVGMwTFRnNVpXUXRZbVprWkdVNVkyRXhZV0poT0dNeFpETm1aVFV0TVRnNE1pMDBOamcwTFdFMVpEY3RZelV4WW1aallXUmpNMlJsIiwiaWF0IjoxNTIzNDU1NDk4LCJhdF9oYXNoIjoiZ216Z05mc2xSRjBXcEhrR1h1S2JkUSIsInNpZCI6IjgwYmE1NjhiMDEzMDEyMTBlN2VjMDFlOWY1NzEyMmEyIiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTIzNDU1MjM0LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.MTPASb9ZlCqUjQW6DOd6p1hhWBUA4gpLAQV3zTi0fUfd590qyzd4OQIyexC_NiX15_6JPPAEpzs7nNdmBno2kCVY2SWxLhGXIBfLNyFi1y011DO__A3XbPMHy_IfVdWL9PzouSlLgxZApsSpm7uxKMmzF6h2ofUg5AF7v4FCZMKU_YVDbUY-_-2Ua5AbpmoOHbrzGuuoVzoVyApFQcxGjBhy64sH7lcK09JH1GRrGIWFbcQPO683ZSJTHT3g0xoJK5lUAMZwoFcjAC72MJK6GQhjQirlEAyTNkbG_zpmBD-V5t_mggpFIaS8llR4PX9r0NjLoCGfKaVQWBn8s3zumg",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_96K3h-yWRHZQsrVnTyFnN7NzEjGAbUBf-s1vDzYvQ1cqMlKdefeqsFy_45nH5np5zeqUGwg8llpf_PlCMs2TirIxPBj6eAMaIQQLcJVNzFEJlcfCePnpl_feKSeJa5ZeHKVCn09SFfTSUWhRRy27QhM",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-11 17:05:29.797 +03:00 [DBG] Success validating end session request from mvc
2018-04-11 17:05:29.818 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:05:29.820 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:05:29.864 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-11 17:05:29.866 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-11 17:05:29.868 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-11 17:05:29.876 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLCVMKJVSJER:00000008",
  "TimeStamp": "2018-04-11T14:05:29Z",
  "ProcessId": 2544,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-11 17:05:30.137 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-11 17:05:30.143 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-11 17:05:30.144 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-11 17:05:30.151 +03:00 [DBG] Processing signout callback request
2018-04-11 17:05:30.163 +03:00 [DBG] No client front-channel logout URLs
2018-04-11 17:05:30.164 +03:00 [DBG] No client back-channel logout URLs
2018-04-11 17:05:30.165 +03:00 [INF] Successful signout callback.
2018-04-11 17:05:30.166 +03:00 [DBG] No client front-channel iframe urls
2018-04-11 17:05:30.167 +03:00 [DBG] No client back-channel iframe urls
2018-04-11 17:05:35.816 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-11 17:05:52.215 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-11 17:05:52.219 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-11 17:05:52.220 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-11 17:05:52.222 +03:00 [DBG] Start authorize request
2018-04-11 17:05:52.224 +03:00 [DBG] No user present in authorize request
2018-04-11 17:05:52.226 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:05:52.231 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:05:52.232 +03:00 [DBG] No PKCE used.
2018-04-11 17:05:52.233 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:05:52.234 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_97oIJFhYbZhcH_OX7rlUIQmUpLBfnylDnQziuL5hDGoUMagsncLHuU2Go6kEKND-FojYgf95yFLuiYNbG8ZFZ5ggFrpPL7bD15tIXjbY2MiUuf5UPSEKaKvgBvZks-ulBv63os7d0Lq-iGniuqwxLtLd-qxz-b4EIek0kGPhAKYwZVgTN48CfkS9K4qm_vjR8ylg7qtbdco90ZidylWJtSt5BD-9wD-FXDyQikMkPY4ENWjOSz_ZQygnfPAgqI5EW2WpujRwLCCvFhpzidOHsmXV73AEnSnH8_Zt010CbO2xOj724B2WecId80LkdA6ATk",
  "Nonce": "636590523522094561.NWFkNTkxYmEtZmYzOS00YjlmLTk1MWUtOWQ1OTMwYjI2ZjY3ZDc4YWQyNmMtNDM2Zi00MzYwLTg0MmYtYThkZWViODQwYTI4",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636590523522094561.NWFkNTkxYmEtZmYzOS00YjlmLTk1MWUtOWQ1OTMwYjI2ZjY3ZDc4YWQyNmMtNDM2Zi00MzYwLTg0MmYtYThkZWViODQwYTI4",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_97oIJFhYbZhcH_OX7rlUIQmUpLBfnylDnQziuL5hDGoUMagsncLHuU2Go6kEKND-FojYgf95yFLuiYNbG8ZFZ5ggFrpPL7bD15tIXjbY2MiUuf5UPSEKaKvgBvZks-ulBv63os7d0Lq-iGniuqwxLtLd-qxz-b4EIek0kGPhAKYwZVgTN48CfkS9K4qm_vjR8ylg7qtbdco90ZidylWJtSt5BD-9wD-FXDyQikMkPY4ENWjOSz_ZQygnfPAgqI5EW2WpujRwLCCvFhpzidOHsmXV73AEnSnH8_Zt010CbO2xOj724B2WecId80LkdA6ATk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-11 17:05:52.243 +03:00 [INF] Showing login: User is not authenticated
2018-04-11 17:05:52.252 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:05:52.253 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:05:52.254 +03:00 [DBG] No PKCE used.
2018-04-11 17:05:52.254 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:06:04.408 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-11 17:06:04.424 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:06:04.425 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:06:04.426 +03:00 [DBG] No PKCE used.
2018-04-11 17:06:04.428 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:06:04.437 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-11 17:06:04.440 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-11 17:06:04.443 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-11 17:06:04.444 +03:00 [DBG] Start authorize callback request
2018-04-11 17:06:04.445 +03:00 [DBG] No user present in authorize request
2018-04-11 17:06:04.445 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:06:04.446 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:06:04.446 +03:00 [DBG] No PKCE used.
2018-04-11 17:06:04.447 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:06:04.448 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_97oIJFhYbZhcH_OX7rlUIQmUpLBfnylDnQziuL5hDGoUMagsncLHuU2Go6kEKND-FojYgf95yFLuiYNbG8ZFZ5ggFrpPL7bD15tIXjbY2MiUuf5UPSEKaKvgBvZks-ulBv63os7d0Lq-iGniuqwxLtLd-qxz-b4EIek0kGPhAKYwZVgTN48CfkS9K4qm_vjR8ylg7qtbdco90ZidylWJtSt5BD-9wD-FXDyQikMkPY4ENWjOSz_ZQygnfPAgqI5EW2WpujRwLCCvFhpzidOHsmXV73AEnSnH8_Zt010CbO2xOj724B2WecId80LkdA6ATk",
  "Nonce": "636590523522094561.NWFkNTkxYmEtZmYzOS00YjlmLTk1MWUtOWQ1OTMwYjI2ZjY3ZDc4YWQyNmMtNDM2Zi00MzYwLTg0MmYtYThkZWViODQwYTI4",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636590523522094561.NWFkNTkxYmEtZmYzOS00YjlmLTk1MWUtOWQ1OTMwYjI2ZjY3ZDc4YWQyNmMtNDM2Zi00MzYwLTg0MmYtYThkZWViODQwYTI4",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_97oIJFhYbZhcH_OX7rlUIQmUpLBfnylDnQziuL5hDGoUMagsncLHuU2Go6kEKND-FojYgf95yFLuiYNbG8ZFZ5ggFrpPL7bD15tIXjbY2MiUuf5UPSEKaKvgBvZks-ulBv63os7d0Lq-iGniuqwxLtLd-qxz-b4EIek0kGPhAKYwZVgTN48CfkS9K4qm_vjR8ylg7qtbdco90ZidylWJtSt5BD-9wD-FXDyQikMkPY4ENWjOSz_ZQygnfPAgqI5EW2WpujRwLCCvFhpzidOHsmXV73AEnSnH8_Zt010CbO2xOj724B2WecId80LkdA6ATk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-11 17:06:04.460 +03:00 [INF] Error: User denied consent
2018-04-11 17:06:04.465 +03:00 [INF] {
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_97oIJFhYbZhcH_OX7rlUIQmUpLBfnylDnQziuL5hDGoUMagsncLHuU2Go6kEKND-FojYgf95yFLuiYNbG8ZFZ5ggFrpPL7bD15tIXjbY2MiUuf5UPSEKaKvgBvZks-ulBv63os7d0Lq-iGniuqwxLtLd-qxz-b4EIek0kGPhAKYwZVgTN48CfkS9K4qm_vjR8ylg7qtbdco90ZidylWJtSt5BD-9wD-FXDyQikMkPY4ENWjOSz_ZQygnfPAgqI5EW2WpujRwLCCvFhpzidOHsmXV73AEnSnH8_Zt010CbO2xOj724B2WecId80LkdA6ATk",
  "Nonce": "636590523522094561.NWFkNTkxYmEtZmYzOS00YjlmLTk1MWUtOWQ1OTMwYjI2ZjY3ZDc4YWQyNmMtNDM2Zi00MzYwLTg0MmYtYThkZWViODQwYTI4",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636590523522094561.NWFkNTkxYmEtZmYzOS00YjlmLTk1MWUtOWQ1OTMwYjI2ZjY3ZDc4YWQyNmMtNDM2Zi00MzYwLTg0MmYtYThkZWViODQwYTI4",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_97oIJFhYbZhcH_OX7rlUIQmUpLBfnylDnQziuL5hDGoUMagsncLHuU2Go6kEKND-FojYgf95yFLuiYNbG8ZFZ5ggFrpPL7bD15tIXjbY2MiUuf5UPSEKaKvgBvZks-ulBv63os7d0Lq-iGniuqwxLtLd-qxz-b4EIek0kGPhAKYwZVgTN48CfkS9K4qm_vjR8ylg7qtbdco90ZidylWJtSt5BD-9wD-FXDyQikMkPY4ENWjOSz_ZQygnfPAgqI5EW2WpujRwLCCvFhpzidOHsmXV73AEnSnH8_Zt010CbO2xOj724B2WecId80LkdA6ATk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-11 17:06:04.485 +03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Error": "access_denied",
  "ActivityId": "0HLCVMKJVSJER:0000000F",
  "TimeStamp": "2018-04-11T14:06:04Z",
  "ProcessId": 2544,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-11 17:06:10.597 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-11 17:06:10.599 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-11 17:06:10.601 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-11 17:06:10.603 +03:00 [DBG] Start authorize request
2018-04-11 17:06:10.604 +03:00 [DBG] No user present in authorize request
2018-04-11 17:06:10.604 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:06:10.605 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:06:10.612 +03:00 [DBG] No PKCE used.
2018-04-11 17:06:10.613 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:06:10.616 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_96M59KLJAr__7PkKcD5tCVCmi0teKOXFMTd0hgxy09FjMmbSXa6ukrxk9pisfUsodiZ3Srs5L8zvW-UhEkZXA21pJPLIa0v2xYdsg-Y7-DUXuJzsrMBnw9WtRA2GznAXDX7NL5ck_R0LUJ8CgxtY1qRwFHiwR-gXIyp9RlSSEZh9QeIunhuGlQEjBiOSbmdh0knacNSZnGhhMz7rXrBWETy9bYXFibUkFC8WajL11UT-qWQ1exFwHY2FHtNT2VQcK44KJOXROVH0wghaRdoUDsm13ahG3KbEWQNW5lAWnU4z8JOUlKzSa4JWwc4riRZD_Y",
  "Nonce": "636590523705891528.ZDUwY2UxM2YtZTVlNi00MGJlLWEwN2MtYTYyNjc0YWQwZTE5ZmY5OGNmY2QtYmJjOC00YzVkLWIyMDUtYTllOTExYWFmYTBk",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636590523705891528.ZDUwY2UxM2YtZTVlNi00MGJlLWEwN2MtYTYyNjc0YWQwZTE5ZmY5OGNmY2QtYmJjOC00YzVkLWIyMDUtYTllOTExYWFmYTBk",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_96M59KLJAr__7PkKcD5tCVCmi0teKOXFMTd0hgxy09FjMmbSXa6ukrxk9pisfUsodiZ3Srs5L8zvW-UhEkZXA21pJPLIa0v2xYdsg-Y7-DUXuJzsrMBnw9WtRA2GznAXDX7NL5ck_R0LUJ8CgxtY1qRwFHiwR-gXIyp9RlSSEZh9QeIunhuGlQEjBiOSbmdh0knacNSZnGhhMz7rXrBWETy9bYXFibUkFC8WajL11UT-qWQ1exFwHY2FHtNT2VQcK44KJOXROVH0wghaRdoUDsm13ahG3KbEWQNW5lAWnU4z8JOUlKzSa4JWwc4riRZD_Y",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-11 17:06:10.620 +03:00 [INF] Showing login: User is not authenticated
2018-04-11 17:06:10.625 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:06:10.626 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:06:10.627 +03:00 [DBG] No PKCE used.
2018-04-11 17:06:10.628 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:06:14.010 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-11 17:06:14.012 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-11 17:06:14.013 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-11 17:06:14.015 +03:00 [DBG] Start authorize request
2018-04-11 17:06:14.016 +03:00 [DBG] No user present in authorize request
2018-04-11 17:06:14.019 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:06:14.023 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:06:14.023 +03:00 [DBG] No PKCE used.
2018-04-11 17:06:14.024 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:06:14.025 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_95ZdOwVVrN_9xr_I4jN1nsvS6JJiaP8oTrJfW17K9S0ZkpGwyP_S1kfgxdEpeLMTSBem9XE-TTlpcyLr-NRVMGI2Da8snvBIadT_ztueaX2t39Zt_9Uq2l6PVWihWTALQJzk6rwaUIKrqsXHDY_vgw79kXNjRszoO8ghycsTuHsnXXcfYkvZewY4i_pH6G70hMiJIYkBOwekcPKfcePY6EVKlo2stZIaaSuFm0vdknU1YG1i7ws_VxxaG9EoeVyozl3C_HJHNxmDCZtZB_T7uoeu0cplFDbMNRz2o0S5jrhIydhk95-52OVIzahOiiq-Ik",
  "Nonce": "636590523740030726.YjA5ZDgyZmYtOTAxNC00YTdmLTk3MDUtODNmODBlZTJhMzZiNzVlY2ZjZWItZWY0Yy00MWVhLWI2MjAtZmEwYzFhMjNiNGE0",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636590523740030726.YjA5ZDgyZmYtOTAxNC00YTdmLTk3MDUtODNmODBlZTJhMzZiNzVlY2ZjZWItZWY0Yy00MWVhLWI2MjAtZmEwYzFhMjNiNGE0",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_95ZdOwVVrN_9xr_I4jN1nsvS6JJiaP8oTrJfW17K9S0ZkpGwyP_S1kfgxdEpeLMTSBem9XE-TTlpcyLr-NRVMGI2Da8snvBIadT_ztueaX2t39Zt_9Uq2l6PVWihWTALQJzk6rwaUIKrqsXHDY_vgw79kXNjRszoO8ghycsTuHsnXXcfYkvZewY4i_pH6G70hMiJIYkBOwekcPKfcePY6EVKlo2stZIaaSuFm0vdknU1YG1i7ws_VxxaG9EoeVyozl3C_HJHNxmDCZtZB_T7uoeu0cplFDbMNRz2o0S5jrhIydhk95-52OVIzahOiiq-Ik",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-11 17:06:14.037 +03:00 [INF] Showing login: User is not authenticated
2018-04-11 17:06:14.043 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:06:14.047 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:06:14.049 +03:00 [DBG] No PKCE used.
2018-04-11 17:06:14.050 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:37:49.426 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-11 17:37:50.185 +03:00 [DBG] Augmenting SignInContext
2018-04-11 17:37:50.185 +03:00 [DBG] Adding idp claim with value: local
2018-04-11 17:37:50.187 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-11 17:37:50.192 +03:00 [DBG] Adding auth_time claim with value: 1523457470
2018-04-11 17:37:50.193 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-11 17:37:50.299 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLCVMKJVSJF5:00000001",
  "TimeStamp": "2018-04-11T14:37:50Z",
  "ProcessId": 2544,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-11 17:37:50.311 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:37:50.313 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:37:50.314 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-11 17:37:50.315 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-11 17:37:50.316 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-11 17:37:50.317 +03:00 [DBG] Start authorize callback request
2018-04-11 17:37:50.317 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-11 17:37:50.318 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:37:50.319 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:37:50.319 +03:00 [DBG] No PKCE used.
2018-04-11 17:37:50.320 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:37:50.321 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_95ZdOwVVrN_9xr_I4jN1nsvS6JJiaP8oTrJfW17K9S0ZkpGwyP_S1kfgxdEpeLMTSBem9XE-TTlpcyLr-NRVMGI2Da8snvBIadT_ztueaX2t39Zt_9Uq2l6PVWihWTALQJzk6rwaUIKrqsXHDY_vgw79kXNjRszoO8ghycsTuHsnXXcfYkvZewY4i_pH6G70hMiJIYkBOwekcPKfcePY6EVKlo2stZIaaSuFm0vdknU1YG1i7ws_VxxaG9EoeVyozl3C_HJHNxmDCZtZB_T7uoeu0cplFDbMNRz2o0S5jrhIydhk95-52OVIzahOiiq-Ik",
  "Nonce": "636590523740030726.YjA5ZDgyZmYtOTAxNC00YTdmLTk3MDUtODNmODBlZTJhMzZiNzVlY2ZjZWItZWY0Yy00MWVhLWI2MjAtZmEwYzFhMjNiNGE0",
  "SessionId": "ec557790f4e280cafc55dbacb32ab650",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636590523740030726.YjA5ZDgyZmYtOTAxNC00YTdmLTk3MDUtODNmODBlZTJhMzZiNzVlY2ZjZWItZWY0Yy00MWVhLWI2MjAtZmEwYzFhMjNiNGE0",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_95ZdOwVVrN_9xr_I4jN1nsvS6JJiaP8oTrJfW17K9S0ZkpGwyP_S1kfgxdEpeLMTSBem9XE-TTlpcyLr-NRVMGI2Da8snvBIadT_ztueaX2t39Zt_9Uq2l6PVWihWTALQJzk6rwaUIKrqsXHDY_vgw79kXNjRszoO8ghycsTuHsnXXcfYkvZewY4i_pH6G70hMiJIYkBOwekcPKfcePY6EVKlo2stZIaaSuFm0vdknU1YG1i7ws_VxxaG9EoeVyozl3C_HJHNxmDCZtZB_T7uoeu0cplFDbMNRz2o0S5jrhIydhk95-52OVIzahOiiq-Ik",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-11 17:37:50.447 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-11 17:37:50.448 +03:00 [INF] Showing consent: User has not yet consented
2018-04-11 17:37:50.456 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:37:50.457 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:37:50.460 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:37:50.460 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:37:50.461 +03:00 [DBG] No PKCE used.
2018-04-11 17:37:50.462 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:37:53.541 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-11 17:37:53.546 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:37:53.550 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:37:53.553 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:37:53.553 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:37:53.556 +03:00 [DBG] No PKCE used.
2018-04-11 17:37:53.557 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:37:53.566 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:37:53.567 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:37:53.568 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-11 17:37:53.569 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-11 17:37:53.571 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-11 17:37:53.572 +03:00 [DBG] Start authorize callback request
2018-04-11 17:37:53.574 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-11 17:37:53.578 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:37:53.579 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:37:53.580 +03:00 [DBG] No PKCE used.
2018-04-11 17:37:53.581 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:37:53.582 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_95ZdOwVVrN_9xr_I4jN1nsvS6JJiaP8oTrJfW17K9S0ZkpGwyP_S1kfgxdEpeLMTSBem9XE-TTlpcyLr-NRVMGI2Da8snvBIadT_ztueaX2t39Zt_9Uq2l6PVWihWTALQJzk6rwaUIKrqsXHDY_vgw79kXNjRszoO8ghycsTuHsnXXcfYkvZewY4i_pH6G70hMiJIYkBOwekcPKfcePY6EVKlo2stZIaaSuFm0vdknU1YG1i7ws_VxxaG9EoeVyozl3C_HJHNxmDCZtZB_T7uoeu0cplFDbMNRz2o0S5jrhIydhk95-52OVIzahOiiq-Ik",
  "Nonce": "636590523740030726.YjA5ZDgyZmYtOTAxNC00YTdmLTk3MDUtODNmODBlZTJhMzZiNzVlY2ZjZWItZWY0Yy00MWVhLWI2MjAtZmEwYzFhMjNiNGE0",
  "SessionId": "ec557790f4e280cafc55dbacb32ab650",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636590523740030726.YjA5ZDgyZmYtOTAxNC00YTdmLTk3MDUtODNmODBlZTJhMzZiNzVlY2ZjZWItZWY0Yy00MWVhLWI2MjAtZmEwYzFhMjNiNGE0",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_95ZdOwVVrN_9xr_I4jN1nsvS6JJiaP8oTrJfW17K9S0ZkpGwyP_S1kfgxdEpeLMTSBem9XE-TTlpcyLr-NRVMGI2Da8snvBIadT_ztueaX2t39Zt_9Uq2l6PVWihWTALQJzk6rwaUIKrqsXHDY_vgw79kXNjRszoO8ghycsTuHsnXXcfYkvZewY4i_pH6G70hMiJIYkBOwekcPKfcePY6EVKlo2stZIaaSuFm0vdknU1YG1i7ws_VxxaG9EoeVyozl3C_HJHNxmDCZtZB_T7uoeu0cplFDbMNRz2o0S5jrhIydhk95-52OVIzahOiiq-Ik",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-11 17:37:53.686 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-11 17:37:53.686 +03:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2018-04-11 17:37:53.689 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2018-04-11 17:37:53.692 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-11 17:37:53.698 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-11 17:37:53.710 +03:00 [DBG] Creating Implicit Flow response.
2018-04-11 17:37:53.711 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-11 17:37:53.714 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-11 17:37:53.719 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****T09Q"
    },
    {
      "TokenType": "code",
      "TokenValue": "****f667"
    }
  ],
  "ActivityId": "0HLCVMKJVSJF5:00000005",
  "TimeStamp": "2018-04-11T14:37:53Z",
  "ProcessId": 2544,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-11 17:37:53.722 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_95ZdOwVVrN_9xr_I4jN1nsvS6JJiaP8oTrJfW17K9S0ZkpGwyP_S1kfgxdEpeLMTSBem9XE-TTlpcyLr-NRVMGI2Da8snvBIadT_ztueaX2t39Zt_9Uq2l6PVWihWTALQJzk6rwaUIKrqsXHDY_vgw79kXNjRszoO8ghycsTuHsnXXcfYkvZewY4i_pH6G70hMiJIYkBOwekcPKfcePY6EVKlo2stZIaaSuFm0vdknU1YG1i7ws_VxxaG9EoeVyozl3C_HJHNxmDCZtZB_T7uoeu0cplFDbMNRz2o0S5jrhIydhk95-52OVIzahOiiq-Ik",
  "Scope": "openid profile api1 offline_access"
}
2018-04-11 17:37:53.724 +03:00 [DBG] Augmenting SignInContext
2018-04-11 17:37:53.724 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-11 17:37:57.915 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:37:57.919 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:37:59.490 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:37:59.493 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:38:01.780 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:38:01.786 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:38:11.964 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:38:11.966 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:38:11.968 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-11 17:38:11.970 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-11 17:38:11.972 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-11 17:38:11.974 +03:00 [DBG] Start authorize request
2018-04-11 17:38:11.975 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-11 17:38:11.979 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:38:11.980 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:38:11.981 +03:00 [DBG] No PKCE used.
2018-04-11 17:38:11.982 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:38:11.984 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_94zbrmVGHbcKTwSX4boUinNR3Rb64tzp3b8GucJxncCznH6OihGxVjVStidD7-9Nl8_APmOUQPwzphPL_P_J4tJuoRdAWQSlqQ0t8gZOMUO-SIFGLFCmIMyOpiNkVDmybHNSyBV7B29AtQOMlB4xBB8qLbUNR2po7IGpnaSXy-sUcgMlcEJgGGzAWstG4cG2_RRgmzBnBEatf0ga52HklwoUuiyaEH-5J_q6CMeQLOCe7IfpnAAcwF4-kswxBqkks1u5zj07JX-Tp5pzSP1TIECUpupDdi2tqA6lYqDsEYTaRn4t0Bh1liYr178qa6PV3Q",
  "Nonce": "636590542919559208.YzIwNjJhZDMtZmM0Ni00NDM5LWE0ODQtYWUwNjIyMGIyOTgzYzJiZTM2NWItMDAwOS00NTc3LWI1ZTctZDc0YTY5YTBjMDk4",
  "SessionId": "ec557790f4e280cafc55dbacb32ab650",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636590542919559208.YzIwNjJhZDMtZmM0Ni00NDM5LWE0ODQtYWUwNjIyMGIyOTgzYzJiZTM2NWItMDAwOS00NTc3LWI1ZTctZDc0YTY5YTBjMDk4",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_94zbrmVGHbcKTwSX4boUinNR3Rb64tzp3b8GucJxncCznH6OihGxVjVStidD7-9Nl8_APmOUQPwzphPL_P_J4tJuoRdAWQSlqQ0t8gZOMUO-SIFGLFCmIMyOpiNkVDmybHNSyBV7B29AtQOMlB4xBB8qLbUNR2po7IGpnaSXy-sUcgMlcEJgGGzAWstG4cG2_RRgmzBnBEatf0ga52HklwoUuiyaEH-5J_q6CMeQLOCe7IfpnAAcwF4-kswxBqkks1u5zj07JX-Tp5pzSP1TIECUpupDdi2tqA6lYqDsEYTaRn4t0Bh1liYr178qa6PV3Q",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-11 17:38:12.097 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-11 17:38:12.099 +03:00 [INF] Showing consent: User has not yet consented
2018-04-11 17:38:12.105 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:38:12.106 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:38:12.108 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:38:12.109 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:38:12.112 +03:00 [DBG] No PKCE used.
2018-04-11 17:38:12.113 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:38:13.840 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-11 17:38:13.846 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:38:13.847 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:38:13.849 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:38:13.850 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:38:13.850 +03:00 [DBG] No PKCE used.
2018-04-11 17:38:13.851 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:38:13.865 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:38:13.869 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-11 17:38:13.870 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-11 17:38:13.873 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-11 17:38:13.879 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-11 17:38:13.880 +03:00 [DBG] Start authorize callback request
2018-04-11 17:38:13.881 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-11 17:38:13.882 +03:00 [DBG] Start authorize request protocol validation
2018-04-11 17:38:13.882 +03:00 [DBG] Checking for PKCE parameters
2018-04-11 17:38:13.883 +03:00 [DBG] No PKCE used.
2018-04-11 17:38:13.883 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-11 17:38:13.884 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_94zbrmVGHbcKTwSX4boUinNR3Rb64tzp3b8GucJxncCznH6OihGxVjVStidD7-9Nl8_APmOUQPwzphPL_P_J4tJuoRdAWQSlqQ0t8gZOMUO-SIFGLFCmIMyOpiNkVDmybHNSyBV7B29AtQOMlB4xBB8qLbUNR2po7IGpnaSXy-sUcgMlcEJgGGzAWstG4cG2_RRgmzBnBEatf0ga52HklwoUuiyaEH-5J_q6CMeQLOCe7IfpnAAcwF4-kswxBqkks1u5zj07JX-Tp5pzSP1TIECUpupDdi2tqA6lYqDsEYTaRn4t0Bh1liYr178qa6PV3Q",
  "Nonce": "636590542919559208.YzIwNjJhZDMtZmM0Ni00NDM5LWE0ODQtYWUwNjIyMGIyOTgzYzJiZTM2NWItMDAwOS00NTc3LWI1ZTctZDc0YTY5YTBjMDk4",
  "SessionId": "ec557790f4e280cafc55dbacb32ab650",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636590542919559208.YzIwNjJhZDMtZmM0Ni00NDM5LWE0ODQtYWUwNjIyMGIyOTgzYzJiZTM2NWItMDAwOS00NTc3LWI1ZTctZDc0YTY5YTBjMDk4",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_94zbrmVGHbcKTwSX4boUinNR3Rb64tzp3b8GucJxncCznH6OihGxVjVStidD7-9Nl8_APmOUQPwzphPL_P_J4tJuoRdAWQSlqQ0t8gZOMUO-SIFGLFCmIMyOpiNkVDmybHNSyBV7B29AtQOMlB4xBB8qLbUNR2po7IGpnaSXy-sUcgMlcEJgGGzAWstG4cG2_RRgmzBnBEatf0ga52HklwoUuiyaEH-5J_q6CMeQLOCe7IfpnAAcwF4-kswxBqkks1u5zj07JX-Tp5pzSP1TIECUpupDdi2tqA6lYqDsEYTaRn4t0Bh1liYr178qa6PV3Q",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-11 17:38:14.437 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-11 17:38:14.437 +03:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2018-04-11 17:38:14.440 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2018-04-11 17:38:14.443 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-11 17:38:14.448 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-11 17:38:14.461 +03:00 [DBG] Creating Implicit Flow response.
2018-04-11 17:38:14.461 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-11 17:38:14.463 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-11 17:38:14.468 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****B29A"
    },
    {
      "TokenType": "code",
      "TokenValue": "****0ca2"
    }
  ],
  "ActivityId": "0HLCVMKJVSJF5:0000000C",
  "TimeStamp": "2018-04-11T14:38:14Z",
  "ProcessId": 2544,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-11 17:38:14.474 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_94zbrmVGHbcKTwSX4boUinNR3Rb64tzp3b8GucJxncCznH6OihGxVjVStidD7-9Nl8_APmOUQPwzphPL_P_J4tJuoRdAWQSlqQ0t8gZOMUO-SIFGLFCmIMyOpiNkVDmybHNSyBV7B29AtQOMlB4xBB8qLbUNR2po7IGpnaSXy-sUcgMlcEJgGGzAWstG4cG2_RRgmzBnBEatf0ga52HklwoUuiyaEH-5J_q6CMeQLOCe7IfpnAAcwF4-kswxBqkks1u5zj07JX-Tp5pzSP1TIECUpupDdi2tqA6lYqDsEYTaRn4t0Bh1liYr178qa6PV3Q",
  "Scope": "openid profile api1 offline_access"
}
2018-04-11 17:38:14.654 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-11 17:38:14.657 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-11 17:38:14.658 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-11 17:38:14.660 +03:00 [DBG] Start token request.
2018-04-11 17:38:14.660 +03:00 [DBG] Start client validation
2018-04-11 17:38:14.661 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-11 17:38:14.662 +03:00 [DBG] Start parsing for secret in post body
2018-04-11 17:38:14.662 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-11 17:38:14.663 +03:00 [DBG] Secret id found: mvc
2018-04-11 17:38:14.664 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-11 17:38:14.664 +03:00 [DBG] Client validation success
2018-04-11 17:38:14.669 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLCVMKJVSJF9:00000001",
  "TimeStamp": "2018-04-11T14:38:14Z",
  "ProcessId": 2544,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-11 17:38:14.671 +03:00 [DBG] Start token request validation
2018-04-11 17:38:14.676 +03:00 [DBG] Start validation of authorization code token request
2018-04-11 17:38:14.809 +03:00 [DBG] Validation of authorization code token request success
2018-04-11 17:38:14.810 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "22dece386c3dedaf4bc98c0f189df6bb5fd142d188f3ddcf74786305002b0ca2",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "22dece386c3dedaf4bc98c0f189df6bb5fd142d188f3ddcf74786305002b0ca2",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-11 17:38:14.814 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-11 17:38:14.815 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-11 17:38:15.019 +03:00 [DBG] Creating refresh token
2018-04-11 17:38:15.020 +03:00 [DBG] Setting an absolute lifetime: 2592000
2018-04-11 17:38:15.033 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-11 17:38:15.035 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-11 17:38:15.039 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****H2dw"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****9138"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****Mjtw"
    }
  ],
  "ActivityId": "0HLCVMKJVSJF9:00000001",
  "TimeStamp": "2018-04-11T14:38:15Z",
  "ProcessId": 2544,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-11 17:38:15.045 +03:00 [DBG] Token request success.
2018-04-11 17:38:15.050 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-11 17:38:15.051 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-11 17:38:15.052 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-11 17:38:15.056 +03:00 [DBG] Start userinfo request
2018-04-11 17:38:15.057 +03:00 [DBG] Bearer token found in header
2018-04-11 17:38:15.157 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-11 17:38:15.159 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1523457495,
    "exp": 1523461095,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1523457470,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2018-04-11 17:38:15.162 +03:00 [DBG] Creating userinfo response
2018-04-11 17:38:15.162 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-11 17:38:15.163 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-11 17:38:15.164 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-11 17:38:15.166 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-11 17:38:15.368 +03:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-04-11 17:38:15.370 +03:00 [DBG] End userinfo request
2018-04-11 17:39:50.577 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-11 17:39:50.578 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-11 17:39:50.579 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-11 17:39:50.581 +03:00 [DBG] Start discovery request
2018-04-11 17:39:50.725 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-11 17:39:50.727 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-11 17:39:50.728 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-11 17:39:50.729 +03:00 [DBG] Start key discovery request
2018-04-11 17:39:51.081 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-11 17:39:51.083 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-11 17:39:51.084 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-11 17:39:51.085 +03:00 [DBG] Start token request.
2018-04-11 17:39:51.086 +03:00 [DBG] Start client validation
2018-04-11 17:39:51.086 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-11 17:39:51.087 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-11 17:39:51.088 +03:00 [DBG] Secret id found: ro.client
2018-04-11 17:39:51.089 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-11 17:39:51.091 +03:00 [DBG] Client validation success
2018-04-11 17:39:51.095 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ro.client",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLCVMKJVSJFB:00000001",
  "TimeStamp": "2018-04-11T14:39:51Z",
  "ProcessId": 2544,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-11 17:39:51.097 +03:00 [DBG] Start token request validation
2018-04-11 17:39:51.109 +03:00 [DBG] Start resource owner password token request validation
2018-04-11 17:39:51.228 +03:00 [INF] Credentials validated for username: alice
2018-04-11 17:39:51.230 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "Token",
  "ActivityId": "0HLCVMKJVSJFB:00000001",
  "TimeStamp": "2018-04-11T14:39:51Z",
  "ProcessId": 2544,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-11 17:39:51.238 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Endpoint": "Token",
  "ActivityId": "0HLCVMKJVSJFB:00000001",
  "TimeStamp": "2018-04-11T14:39:51Z",
  "ProcessId": 2544,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-11 17:39:51.244 +03:00 [DBG] Resource owner password token request validation success.
2018-04-11 17:39:51.244 +03:00 [INF] Token request validation success
{
  "ClientId": "ro.client",
  "GrantType": "password",
  "Scopes": "api1",
  "UserName": "alice",
  "Raw": {
    "grant_type": "password",
    "username": "alice",
    "password": "***REDACTED***",
    "scope": "api1"
  }
}
2018-04-11 17:39:51.250 +03:00 [DBG] Getting claims for access token for client: ro.client
2018-04-11 17:39:51.250 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-11 17:39:51.453 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ro.client",
  "Endpoint": "Token",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "api1",
  "GrantType": "password",
  "Tokens": [
    {
      "TokenType": "access_token",
      "TokenValue": "****Qv3A"
    }
  ],
  "ActivityId": "0HLCVMKJVSJFB:00000001",
  "TimeStamp": "2018-04-11T14:39:51Z",
  "ProcessId": 2544,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-11 17:39:51.456 +03:00 [DBG] Token request success.
2018-04-12 13:40:40.707 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-12 13:40:40.770 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-12 13:40:40.776 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-12 13:40:40.776 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-12 13:40:40.776 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-12 13:40:40.777 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-12 13:40:43.023 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 13:40:43.043 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 13:41:25.549 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-12 13:41:25.561 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-12 13:41:25.562 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-12 13:41:25.570 +03:00 [DBG] Start token request.
2018-04-12 13:41:25.576 +03:00 [DBG] Start client validation
2018-04-12 13:41:25.584 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-12 13:41:25.584 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-12 13:41:25.585 +03:00 [DBG] Secret id found: ro.client
2018-04-12 13:41:25.598 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-12 13:41:25.598 +03:00 [DBG] Client validation success
2018-04-12 13:41:25.673 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ro.client",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD0C7B779AS:00000001",
  "TimeStamp": "2018-04-12T10:41:25Z",
  "ProcessId": 24396,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:41:25.688 +03:00 [DBG] Start token request validation
2018-04-12 13:41:25.700 +03:00 [DBG] Start resource owner password token request validation
2018-04-12 13:41:25.837 +03:00 [INF] Credentials validated for username: alice
2018-04-12 13:41:25.845 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "Token",
  "ActivityId": "0HLD0C7B779AS:00000001",
  "TimeStamp": "2018-04-12T10:41:25Z",
  "ProcessId": 24396,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:41:25.852 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Endpoint": "Token",
  "ActivityId": "0HLD0C7B779AS:00000001",
  "TimeStamp": "2018-04-12T10:41:25Z",
  "ProcessId": 24396,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:41:25.855 +03:00 [DBG] Resource owner password token request validation success.
2018-04-12 13:41:25.880 +03:00 [INF] Token request validation success
{
  "ClientId": "ro.client",
  "GrantType": "password",
  "Scopes": "api1",
  "UserName": "alice",
  "Raw": {
    "grant_type": "password",
    "username": "alice",
    "password": "***REDACTED***",
    "scope": "api1"
  }
}
2018-04-12 13:41:25.906 +03:00 [DBG] Getting claims for access token for client: ro.client
2018-04-12 13:41:25.907 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 13:41:26.132 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ro.client",
  "Endpoint": "Token",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "api1",
  "GrantType": "password",
  "Tokens": [
    {
      "TokenType": "access_token",
      "TokenValue": "****nI1w"
    }
  ],
  "ActivityId": "0HLD0C7B779AS:00000001",
  "TimeStamp": "2018-04-12T10:41:26Z",
  "ProcessId": 24396,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:41:26.137 +03:00 [DBG] Token request success.
2018-04-12 13:41:45.516 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 13:41:45.518 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 13:41:50.932 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 13:41:50.937 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 13:42:25.751 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 13:42:25.753 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 13:42:29.851 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-12 13:42:29.858 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-12 13:42:29.859 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-12 13:42:29.860 +03:00 [DBG] Start token request.
2018-04-12 13:42:29.861 +03:00 [DBG] Start client validation
2018-04-12 13:42:29.861 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-12 13:42:29.862 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-12 13:42:29.862 +03:00 [DBG] Secret id found: ro.client
2018-04-12 13:42:29.863 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-12 13:42:29.864 +03:00 [DBG] Client validation success
2018-04-12 13:42:29.864 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ro.client",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD0C7B779AS:00000002",
  "TimeStamp": "2018-04-12T10:42:29Z",
  "ProcessId": 24396,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:42:29.866 +03:00 [DBG] Start token request validation
2018-04-12 13:42:29.867 +03:00 [DBG] Start resource owner password token request validation
2018-04-12 13:42:29.946 +03:00 [INF] Credentials validated for username: alice
2018-04-12 13:42:29.947 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "Token",
  "ActivityId": "0HLD0C7B779AS:00000002",
  "TimeStamp": "2018-04-12T10:42:29Z",
  "ProcessId": 24396,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:42:29.951 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Endpoint": "Token",
  "ActivityId": "0HLD0C7B779AS:00000002",
  "TimeStamp": "2018-04-12T10:42:29Z",
  "ProcessId": 24396,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:42:29.954 +03:00 [DBG] Resource owner password token request validation success.
2018-04-12 13:42:29.954 +03:00 [INF] Token request validation success
{
  "ClientId": "ro.client",
  "GrantType": "password",
  "Scopes": "api1",
  "UserName": "alice",
  "Raw": {
    "grant_type": "password",
    "username": "alice",
    "password": "***REDACTED***",
    "scope": "api1"
  }
}
2018-04-12 13:42:29.955 +03:00 [DBG] Getting claims for access token for client: ro.client
2018-04-12 13:42:29.955 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 13:42:30.097 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ro.client",
  "Endpoint": "Token",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "api1",
  "GrantType": "password",
  "Tokens": [
    {
      "TokenType": "access_token",
      "TokenValue": "****MurQ"
    }
  ],
  "ActivityId": "0HLD0C7B779AS:00000002",
  "TimeStamp": "2018-04-12T10:42:30Z",
  "ProcessId": 24396,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:42:30.100 +03:00 [DBG] Token request success.
2018-04-12 13:42:46.518 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 13:42:46.538 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 13:42:50.673 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-12 13:42:50.674 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-12 13:42:50.675 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-12 13:42:50.676 +03:00 [DBG] Start token request.
2018-04-12 13:42:50.677 +03:00 [DBG] Start client validation
2018-04-12 13:42:50.677 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-12 13:42:50.678 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-12 13:42:50.679 +03:00 [DBG] Secret id found: ro.client
2018-04-12 13:42:50.679 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-12 13:42:50.680 +03:00 [DBG] Client validation success
2018-04-12 13:42:50.680 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ro.client",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD0C7B779AS:00000003",
  "TimeStamp": "2018-04-12T10:42:50Z",
  "ProcessId": 24396,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:42:50.682 +03:00 [DBG] Start token request validation
2018-04-12 13:42:50.682 +03:00 [DBG] Start resource owner password token request validation
2018-04-12 13:42:50.889 +03:00 [INF] Credentials validated for username: alice
2018-04-12 13:42:50.890 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "Token",
  "ActivityId": "0HLD0C7B779AS:00000003",
  "TimeStamp": "2018-04-12T10:42:50Z",
  "ProcessId": 24396,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:42:50.892 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Endpoint": "Token",
  "ActivityId": "0HLD0C7B779AS:00000003",
  "TimeStamp": "2018-04-12T10:42:50Z",
  "ProcessId": 24396,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:42:50.893 +03:00 [DBG] Resource owner password token request validation success.
2018-04-12 13:42:50.893 +03:00 [INF] Token request validation success
{
  "ClientId": "ro.client",
  "GrantType": "password",
  "Scopes": "api1",
  "UserName": "alice",
  "Raw": {
    "grant_type": "password",
    "username": "alice",
    "password": "***REDACTED***",
    "scope": "api1"
  }
}
2018-04-12 13:42:50.894 +03:00 [DBG] Getting claims for access token for client: ro.client
2018-04-12 13:42:50.894 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 13:42:51.031 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ro.client",
  "Endpoint": "Token",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "api1",
  "GrantType": "password",
  "Tokens": [
    {
      "TokenType": "access_token",
      "TokenValue": "****HTBQ"
    }
  ],
  "ActivityId": "0HLD0C7B779AS:00000003",
  "TimeStamp": "2018-04-12T10:42:51Z",
  "ProcessId": 24396,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:42:51.033 +03:00 [DBG] Token request success.
2018-04-12 13:43:03.574 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-12 13:43:03.577 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-12 13:43:03.580 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-12 13:43:03.581 +03:00 [DBG] Start token request.
2018-04-12 13:43:03.581 +03:00 [DBG] Start client validation
2018-04-12 13:43:03.582 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-12 13:43:03.582 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-12 13:43:03.583 +03:00 [DBG] Secret id found: ro.client
2018-04-12 13:43:03.583 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-12 13:43:03.584 +03:00 [DBG] Client validation success
2018-04-12 13:43:03.584 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ro.client",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD0C7B779AS:00000004",
  "TimeStamp": "2018-04-12T10:43:03Z",
  "ProcessId": 24396,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:43:03.586 +03:00 [DBG] Start token request validation
2018-04-12 13:43:03.586 +03:00 [DBG] Start resource owner password token request validation
2018-04-12 13:43:03.587 +03:00 [ERR] offline_access is not allowed for this client: ro.client
2018-04-12 13:43:03.589 +03:00 [ERR] {
  "ClientId": "ro.client",
  "GrantType": "password",
  "Raw": {
    "grant_type": "password",
    "username": "alice",
    "password": "***REDACTED***",
    "scope": "api1 offline_access"
  }
}
2018-04-12 13:43:03.599 +03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "ro.client",
  "Endpoint": "Token",
  "GrantType": "password",
  "Error": "invalid_scope",
  "ActivityId": "0HLD0C7B779AS:00000004",
  "TimeStamp": "2018-04-12T10:43:03Z",
  "ProcessId": 24396,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:44:28.617 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-12 13:44:28.665 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-12 13:44:28.670 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-12 13:44:28.670 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-12 13:44:28.670 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-12 13:44:28.670 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-12 13:44:29.207 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 13:44:29.224 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 13:44:33.735 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-12 13:44:33.746 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-12 13:44:33.752 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-12 13:44:33.761 +03:00 [DBG] Start token request.
2018-04-12 13:44:33.769 +03:00 [DBG] Start client validation
2018-04-12 13:44:33.776 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-12 13:44:33.776 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-12 13:44:33.777 +03:00 [DBG] Secret id found: ro.client
2018-04-12 13:44:33.792 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-12 13:44:33.793 +03:00 [DBG] Client validation success
2018-04-12 13:44:33.867 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ro.client",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD0C9F1JTKQ:00000001",
  "TimeStamp": "2018-04-12T10:44:33Z",
  "ProcessId": 15600,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:44:33.889 +03:00 [DBG] Start token request validation
2018-04-12 13:44:33.903 +03:00 [DBG] Start resource owner password token request validation
2018-04-12 13:44:33.911 +03:00 [ERR] offline_access is not allowed for this client: ro.client
2018-04-12 13:44:33.938 +03:00 [ERR] {
  "ClientId": "ro.client",
  "GrantType": "password",
  "Raw": {
    "grant_type": "password",
    "username": "alice",
    "password": "***REDACTED***",
    "scope": "api1 offline_access"
  }
}
2018-04-12 13:44:33.948 +03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "ro.client",
  "Endpoint": "Token",
  "GrantType": "password",
  "Error": "invalid_scope",
  "ActivityId": "0HLD0C9F1JTKQ:00000001",
  "TimeStamp": "2018-04-12T10:44:33Z",
  "ProcessId": 15600,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:44:38.291 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-12 13:44:38.294 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-12 13:44:38.297 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-12 13:44:38.300 +03:00 [DBG] Start token request.
2018-04-12 13:44:38.301 +03:00 [DBG] Start client validation
2018-04-12 13:44:38.304 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-12 13:44:38.305 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-12 13:44:38.307 +03:00 [DBG] Secret id found: ro.client
2018-04-12 13:44:38.307 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-12 13:44:38.308 +03:00 [DBG] Client validation success
2018-04-12 13:44:38.309 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ro.client",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD0C9F1JTKQ:00000002",
  "TimeStamp": "2018-04-12T10:44:38Z",
  "ProcessId": 15600,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:44:38.311 +03:00 [DBG] Start token request validation
2018-04-12 13:44:38.311 +03:00 [DBG] Start resource owner password token request validation
2018-04-12 13:44:39.464 +03:00 [INF] Credentials validated for username: alice
2018-04-12 13:44:39.473 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "Token",
  "ActivityId": "0HLD0C9F1JTKQ:00000002",
  "TimeStamp": "2018-04-12T10:44:39Z",
  "ProcessId": 15600,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:44:39.485 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Endpoint": "Token",
  "ActivityId": "0HLD0C9F1JTKQ:00000002",
  "TimeStamp": "2018-04-12T10:44:39Z",
  "ProcessId": 15600,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:44:39.487 +03:00 [DBG] Resource owner password token request validation success.
2018-04-12 13:44:39.489 +03:00 [INF] Token request validation success
{
  "ClientId": "ro.client",
  "GrantType": "password",
  "Scopes": "api1",
  "UserName": "alice",
  "Raw": {
    "grant_type": "password",
    "username": "alice",
    "password": "***REDACTED***",
    "scope": "api1"
  }
}
2018-04-12 13:44:39.514 +03:00 [DBG] Getting claims for access token for client: ro.client
2018-04-12 13:44:39.516 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 13:44:39.839 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ro.client",
  "Endpoint": "Token",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "api1",
  "GrantType": "password",
  "Tokens": [
    {
      "TokenType": "access_token",
      "TokenValue": "****TbHA"
    }
  ],
  "ActivityId": "0HLD0C9F1JTKQ:00000002",
  "TimeStamp": "2018-04-12T10:44:39Z",
  "ProcessId": 15600,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:44:39.843 +03:00 [DBG] Token request success.
2018-04-12 13:45:22.635 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-12 13:45:22.707 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-12 13:45:22.713 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-12 13:45:22.714 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-12 13:45:22.714 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-12 13:45:22.714 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-12 13:45:23.692 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 13:45:23.729 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 13:45:30.653 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-12 13:45:30.665 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-12 13:45:30.667 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-12 13:45:30.676 +03:00 [DBG] Start token request.
2018-04-12 13:45:30.683 +03:00 [DBG] Start client validation
2018-04-12 13:45:30.688 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-12 13:45:30.689 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-12 13:45:30.691 +03:00 [DBG] Secret id found: ro.client
2018-04-12 13:45:30.706 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-12 13:45:30.706 +03:00 [DBG] Client validation success
2018-04-12 13:45:30.781 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ro.client",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD0C9V6QM9P:00000001",
  "TimeStamp": "2018-04-12T10:45:30Z",
  "ProcessId": 20640,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:45:30.799 +03:00 [DBG] Start token request validation
2018-04-12 13:45:30.811 +03:00 [DBG] Start resource owner password token request validation
2018-04-12 13:45:31.890 +03:00 [INF] Credentials validated for username: alice
2018-04-12 13:45:31.898 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "Token",
  "ActivityId": "0HLD0C9V6QM9P:00000001",
  "TimeStamp": "2018-04-12T10:45:31Z",
  "ProcessId": 20640,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:45:31.910 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Endpoint": "Token",
  "ActivityId": "0HLD0C9V6QM9P:00000001",
  "TimeStamp": "2018-04-12T10:45:31Z",
  "ProcessId": 20640,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:45:31.912 +03:00 [DBG] Resource owner password token request validation success.
2018-04-12 13:45:31.939 +03:00 [INF] Token request validation success
{
  "ClientId": "ro.client",
  "GrantType": "password",
  "Scopes": "api1",
  "UserName": "alice",
  "Raw": {
    "grant_type": "password",
    "username": "alice",
    "password": "***REDACTED***",
    "scope": "api1"
  }
}
2018-04-12 13:45:31.965 +03:00 [DBG] Getting claims for access token for client: ro.client
2018-04-12 13:45:31.982 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 13:45:32.299 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ro.client",
  "Endpoint": "Token",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "api1",
  "GrantType": "password",
  "Tokens": [
    {
      "TokenType": "access_token",
      "TokenValue": "****0nZw"
    }
  ],
  "ActivityId": "0HLD0C9V6QM9P:00000001",
  "TimeStamp": "2018-04-12T10:45:32Z",
  "ProcessId": 20640,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:45:32.304 +03:00 [DBG] Token request success.
2018-04-12 13:45:40.312 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-12 13:45:40.314 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-12 13:45:40.315 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-12 13:45:40.316 +03:00 [DBG] Start token request.
2018-04-12 13:45:40.317 +03:00 [DBG] Start client validation
2018-04-12 13:45:40.318 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-12 13:45:40.319 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-12 13:45:40.319 +03:00 [DBG] Secret id found: ro.client
2018-04-12 13:45:40.321 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-12 13:45:40.321 +03:00 [DBG] Client validation success
2018-04-12 13:45:40.322 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ro.client",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD0C9V6QM9P:00000002",
  "TimeStamp": "2018-04-12T10:45:40Z",
  "ProcessId": 20640,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:45:40.331 +03:00 [DBG] Start token request validation
2018-04-12 13:45:40.332 +03:00 [DBG] Start resource owner password token request validation
2018-04-12 13:45:40.333 +03:00 [ERR] Requested scope not allowed: offline_acces
2018-04-12 13:45:40.334 +03:00 [ERR] {
  "ClientId": "ro.client",
  "GrantType": "password",
  "Raw": {
    "grant_type": "password",
    "username": "alice",
    "password": "***REDACTED***",
    "scope": "api1 offline_acces"
  }
}
2018-04-12 13:45:40.348 +03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "ro.client",
  "Endpoint": "Token",
  "GrantType": "password",
  "Error": "invalid_scope",
  "ActivityId": "0HLD0C9V6QM9P:00000002",
  "TimeStamp": "2018-04-12T10:45:40Z",
  "ProcessId": 20640,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:46:40.400 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-12 13:46:40.448 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-12 13:46:40.452 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-12 13:46:40.452 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-12 13:46:40.452 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-12 13:46:40.453 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-12 13:46:40.951 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 13:46:40.969 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 13:46:48.719 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-12 13:46:48.732 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-12 13:46:48.733 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-12 13:46:48.742 +03:00 [DBG] Start token request.
2018-04-12 13:46:48.750 +03:00 [DBG] Start client validation
2018-04-12 13:46:48.755 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-12 13:46:48.756 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-12 13:46:48.757 +03:00 [DBG] Secret id found: ro.client
2018-04-12 13:46:48.770 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-12 13:46:48.770 +03:00 [DBG] Client validation success
2018-04-12 13:46:48.848 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ro.client",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD0CAMA9ARP:00000001",
  "TimeStamp": "2018-04-12T10:46:48Z",
  "ProcessId": 9944,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:46:48.866 +03:00 [DBG] Start token request validation
2018-04-12 13:46:48.878 +03:00 [DBG] Start resource owner password token request validation
2018-04-12 13:46:48.907 +03:00 [ERR] Requested scope not allowed: offline_acces
2018-04-12 13:46:48.932 +03:00 [ERR] {
  "ClientId": "ro.client",
  "GrantType": "password",
  "Raw": {
    "grant_type": "password",
    "username": "alice",
    "password": "***REDACTED***",
    "scope": "api1 offline_acces"
  }
}
2018-04-12 13:46:48.941 +03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "ro.client",
  "Endpoint": "Token",
  "GrantType": "password",
  "Error": "invalid_scope",
  "ActivityId": "0HLD0CAMA9ARP:00000001",
  "TimeStamp": "2018-04-12T10:46:48Z",
  "ProcessId": 9944,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:46:52.247 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-12 13:46:52.250 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-12 13:46:52.256 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-12 13:46:52.260 +03:00 [DBG] Start token request.
2018-04-12 13:46:52.262 +03:00 [DBG] Start client validation
2018-04-12 13:46:52.263 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-12 13:46:52.263 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-12 13:46:52.264 +03:00 [DBG] Secret id found: ro.client
2018-04-12 13:46:52.264 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-12 13:46:52.265 +03:00 [DBG] Client validation success
2018-04-12 13:46:52.265 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ro.client",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD0CAMA9ARP:00000002",
  "TimeStamp": "2018-04-12T10:46:52Z",
  "ProcessId": 9944,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:46:52.268 +03:00 [DBG] Start token request validation
2018-04-12 13:46:52.272 +03:00 [DBG] Start resource owner password token request validation
2018-04-12 13:46:53.345 +03:00 [INF] Credentials validated for username: alice
2018-04-12 13:46:53.355 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "Token",
  "ActivityId": "0HLD0CAMA9ARP:00000002",
  "TimeStamp": "2018-04-12T10:46:53Z",
  "ProcessId": 9944,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:46:53.367 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Endpoint": "Token",
  "ActivityId": "0HLD0CAMA9ARP:00000002",
  "TimeStamp": "2018-04-12T10:46:53Z",
  "ProcessId": 9944,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:46:53.369 +03:00 [DBG] Resource owner password token request validation success.
2018-04-12 13:46:53.372 +03:00 [INF] Token request validation success
{
  "ClientId": "ro.client",
  "GrantType": "password",
  "Scopes": "api1",
  "UserName": "alice",
  "Raw": {
    "grant_type": "password",
    "username": "alice",
    "password": "***REDACTED***",
    "scope": "api1"
  }
}
2018-04-12 13:46:53.402 +03:00 [DBG] Getting claims for access token for client: ro.client
2018-04-12 13:46:53.404 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 13:46:53.723 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ro.client",
  "Endpoint": "Token",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "api1",
  "GrantType": "password",
  "Tokens": [
    {
      "TokenType": "access_token",
      "TokenValue": "****3P-A"
    }
  ],
  "ActivityId": "0HLD0CAMA9ARP:00000002",
  "TimeStamp": "2018-04-12T10:46:53Z",
  "ProcessId": 9944,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:46:53.727 +03:00 [DBG] Token request success.
2018-04-12 13:48:25.663 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-12 13:48:25.724 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-12 13:48:25.730 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-12 13:48:25.730 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-12 13:48:25.731 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-12 13:48:25.732 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-12 13:48:26.555 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 13:48:26.583 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 13:48:32.861 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-12 13:48:32.872 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-12 13:48:32.874 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-12 13:48:32.883 +03:00 [DBG] Start token request.
2018-04-12 13:48:32.889 +03:00 [DBG] Start client validation
2018-04-12 13:48:32.895 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-12 13:48:32.895 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-12 13:48:32.896 +03:00 [DBG] Secret id found: ro.client
2018-04-12 13:48:32.909 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-12 13:48:32.910 +03:00 [DBG] Client validation success
2018-04-12 13:48:32.985 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ro.client",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD0CBLOKL75:00000001",
  "TimeStamp": "2018-04-12T10:48:32Z",
  "ProcessId": 21764,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:48:33.003 +03:00 [DBG] Start token request validation
2018-04-12 13:48:33.017 +03:00 [DBG] Start resource owner password token request validation
2018-04-12 13:48:34.066 +03:00 [INF] Credentials validated for username: alice
2018-04-12 13:48:34.074 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "Token",
  "ActivityId": "0HLD0CBLOKL75:00000001",
  "TimeStamp": "2018-04-12T10:48:34Z",
  "ProcessId": 21764,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:48:34.084 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Endpoint": "Token",
  "ActivityId": "0HLD0CBLOKL75:00000001",
  "TimeStamp": "2018-04-12T10:48:34Z",
  "ProcessId": 21764,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:48:34.086 +03:00 [DBG] Resource owner password token request validation success.
2018-04-12 13:48:34.113 +03:00 [INF] Token request validation success
{
  "ClientId": "ro.client",
  "GrantType": "password",
  "Scopes": "api1",
  "UserName": "alice",
  "Raw": {
    "grant_type": "password",
    "username": "alice",
    "password": "***REDACTED***",
    "scope": "api1"
  }
}
2018-04-12 13:48:34.138 +03:00 [DBG] Getting claims for access token for client: ro.client
2018-04-12 13:48:34.139 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 13:48:34.468 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ro.client",
  "Endpoint": "Token",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "api1",
  "GrantType": "password",
  "Tokens": [
    {
      "TokenType": "access_token",
      "TokenValue": "****lKfQ"
    }
  ],
  "ActivityId": "0HLD0CBLOKL75:00000001",
  "TimeStamp": "2018-04-12T10:48:34Z",
  "ProcessId": 21764,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:48:34.474 +03:00 [DBG] Token request success.
2018-04-12 13:48:41.235 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-12 13:48:41.239 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-12 13:48:41.240 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-12 13:48:41.242 +03:00 [DBG] Start token request.
2018-04-12 13:48:41.242 +03:00 [DBG] Start client validation
2018-04-12 13:48:41.243 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-12 13:48:41.244 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-12 13:48:41.246 +03:00 [DBG] Secret id found: ro.client
2018-04-12 13:48:41.247 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-12 13:48:41.247 +03:00 [DBG] Client validation success
2018-04-12 13:48:41.252 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ro.client",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD0CBLOKL75:00000002",
  "TimeStamp": "2018-04-12T10:48:41Z",
  "ProcessId": 21764,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:48:41.257 +03:00 [DBG] Start token request validation
2018-04-12 13:48:41.257 +03:00 [DBG] Start resource owner password token request validation
2018-04-12 13:48:41.340 +03:00 [INF] Credentials validated for username: alice
2018-04-12 13:48:41.342 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "Token",
  "ActivityId": "0HLD0CBLOKL75:00000002",
  "TimeStamp": "2018-04-12T10:48:41Z",
  "ProcessId": 21764,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:48:41.345 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Endpoint": "Token",
  "ActivityId": "0HLD0CBLOKL75:00000002",
  "TimeStamp": "2018-04-12T10:48:41Z",
  "ProcessId": 21764,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:48:41.347 +03:00 [DBG] Resource owner password token request validation success.
2018-04-12 13:48:41.349 +03:00 [INF] Token request validation success
{
  "ClientId": "ro.client",
  "GrantType": "password",
  "Scopes": "api1 offline_access",
  "UserName": "alice",
  "Raw": {
    "grant_type": "password",
    "username": "alice",
    "password": "***REDACTED***",
    "scope": "api1 offline_access"
  }
}
2018-04-12 13:48:41.375 +03:00 [DBG] Getting claims for access token for client: ro.client
2018-04-12 13:48:41.376 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 13:48:41.519 +03:00 [DBG] Creating refresh token
2018-04-12 13:48:41.519 +03:00 [DBG] Setting an absolute lifetime: 2592000
2018-04-12 13:48:41.547 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ro.client",
  "Endpoint": "Token",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "api1 offline_access",
  "GrantType": "password",
  "Tokens": [
    {
      "TokenType": "refresh_token",
      "TokenValue": "****1ee3"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****-z_A"
    }
  ],
  "ActivityId": "0HLD0CBLOKL75:00000002",
  "TimeStamp": "2018-04-12T10:48:41Z",
  "ProcessId": 21764,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 13:48:41.550 +03:00 [DBG] Token request success.
2018-04-12 17:44:47.637 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-12 17:44:47.690 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-12 17:44:47.694 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-12 17:44:47.695 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-12 17:44:47.697 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-12 17:44:47.698 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-12 17:44:50.261 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:44:50.282 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:49:51.731 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-12 17:49:51.740 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-12 17:49:51.742 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-12 17:49:51.749 +03:00 [DBG] Start discovery request
2018-04-12 17:49:54.605 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-12 17:49:54.608 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-12 17:49:54.609 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-12 17:49:54.613 +03:00 [DBG] Start key discovery request
2018-04-12 17:49:56.142 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:49:56.144 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:49:56.144 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-12 17:49:56.149 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-12 17:49:56.150 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-12 17:49:56.167 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 17:49:56.176 +03:00 [DBG] Start end session request validation
2018-04-12 17:49:56.184 +03:00 [DBG] Start identity token validation
2018-04-12 17:49:56.223 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-12 17:50:15.546 +03:00 [ERR] Failed executing DbCommand (213ms) [Parameters=[@__get_Item_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."Id", "e"."AccessFailedCount", "e"."ConcurrencyStamp", "e"."Email", "e"."EmailConfirmed", "e"."LockoutEnabled", "e"."LockoutEnd", "e"."NormalizedEmail", "e"."NormalizedUserName", "e"."PasswordHash", "e"."PhoneNumber", "e"."PhoneNumberConfirmed", "e"."SecurityStamp", "e"."TwoFactorEnabled", "e"."UserName"
FROM "AspNetUsers" AS "e"
WHERE "e"."Id" = @__get_Item_0
LIMIT 1
Npgsql.NpgsqlException (0x80004005): Exception while reading from stream ---> System.IO.IOException: Unable to transfer data on the transport connection: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond
   --- End of inner exception stack trace ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadPrependedMessages>d__157.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
2018-04-12 17:50:15.649 +03:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure. ---> Npgsql.NpgsqlException: Exception while reading from stream ---> System.IO.IOException: Unable to transfer data on the transport connection: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond
   --- End of inner exception stack trace ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
   --- End of inner exception stack trace ---
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadPrependedMessages>d__157.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure. ---> Npgsql.NpgsqlException: Exception while reading from stream ---> System.IO.IOException: Unable to transfer data on the transport connection: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond
   --- End of inner exception stack trace ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
   --- End of inner exception stack trace ---
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadPrependedMessages>d__157.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
2018-04-12 17:50:15.776 +03:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure. ---> Npgsql.NpgsqlException: Exception while reading from stream ---> System.IO.IOException: Unable to transfer data on the transport connection: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond
   --- End of inner exception stack trace ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
   --- End of inner exception stack trace ---
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadPrependedMessages>d__157.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure. ---> Npgsql.NpgsqlException: Exception while reading from stream ---> System.IO.IOException: Unable to transfer data on the transport connection: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond
   --- End of inner exception stack trace ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
   --- End of inner exception stack trace ---
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadPrependedMessages>d__157.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()
2018-04-12 17:50:15.987 +03:00 [INF] {
  "Name": "Unhandled Exception",
  "Category": "Error",
  "EventType": "Error",
  "Id": 3000,
  "Details": "System.InvalidOperationException: An exception has been raised that is likely due to a transient failure. ---> Npgsql.NpgsqlException: Exception while reading from stream ---> System.IO.IOException: Unable to transfer data on the transport connection: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond\r\n   --- End of inner exception stack trace ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()\r\n   --- End of inner exception stack trace ---\r\n   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()\r\n   at Npgsql.NpgsqlConnector.<ReadPrependedMessages>d__157.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()\r\n   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()\r\n   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()\r\n   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()\r\n   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()\r\n   --- End of inner exception stack trace ---\r\n   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()\r\n   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()\r\n   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()\r\n   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.AspNetIdentity.ProfileService`1.<IsActiveAsync>d__4.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Validation.TokenValidator.<ValidateIdentityTokenAsync>d__12.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Validation\\TokenValidator.cs:line 121\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Validation.EndSessionRequestValidator.<ValidateAsync>d__9.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Validation\\EndSessionRequestValidator.cs:line 74\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Endpoints.EndSessionEndpoint.<ProcessAsync>d__4.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Endpoints\\EndSessionEndpoint.cs:line 56\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Hosting\\IdentityServerMiddleware.cs:line 54",
  "Message": "An exception has been raised that is likely due to a transient failure.",
  "ActivityId": "0HLD0GFO8GQ6A:00000001",
  "TimeStamp": "2018-04-12T14:50:15Z",
  "ProcessId": 2404,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 17:50:16.034 +03:00 [FTL] Unhandled exception: System.InvalidOperationException: An exception has been raised that is likely due to a transient failure. ---> Npgsql.NpgsqlException: Exception while reading from stream ---> System.IO.IOException: Unable to transfer data on the transport connection: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond
   --- End of inner exception stack trace ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
   --- End of inner exception stack trace ---
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadPrependedMessages>d__157.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.AspNetIdentity.ProfileService`1.<IsActiveAsync>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Validation.TokenValidator.<ValidateIdentityTokenAsync>d__12.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Validation\TokenValidator.cs:line 121
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Validation.EndSessionRequestValidator.<ValidateAsync>d__9.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Validation\EndSessionRequestValidator.cs:line 74
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Endpoints.EndSessionEndpoint.<ProcessAsync>d__4.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Endpoints\EndSessionEndpoint.cs:line 56
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 54
2018-04-12 17:50:17.566 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:50:17.569 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:50:42.359 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-12 17:50:42.361 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-12 17:50:42.362 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-12 17:50:42.363 +03:00 [DBG] Start discovery request
2018-04-12 17:50:42.556 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-12 17:50:42.557 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-12 17:50:42.558 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-12 17:50:42.559 +03:00 [DBG] Start key discovery request
2018-04-12 17:50:42.590 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:50:42.592 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:50:42.593 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-12 17:50:42.598 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-12 17:50:42.599 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-12 17:50:42.606 +03:00 [DBG] Start authorize request
2018-04-12 17:50:42.612 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 17:50:42.618 +03:00 [DBG] Start authorize request protocol validation
2018-04-12 17:50:42.630 +03:00 [DBG] Checking for PKCE parameters
2018-04-12 17:50:42.632 +03:00 [DBG] No PKCE used.
2018-04-12 17:50:42.681 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-12 17:50:42.696 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_95esmL8ziM05ZDt9AC6MDbE3LU8ZisRMViWyPuG2z2Jh6eeE6pSxCFV2B9ppm4JYrTdKyR1n3WlD_olNO3HHNv_GbcZVJUlJVEGkNgzkQN6YwGdOS8jAHiNZoz6-0Yip1ytQIgOuR7VfvMwszisdpendu8K2vB_F5EQ_kKAXjbP5G7--5lsDbhuStN_fHgqfkAmDOh6IbbNP7TuvqmaeYo9RyGBSFRXdRiI7_dhBVZNNIPGIkzbDC6-ONWCbCTSgnzMiUr3SSEJTeUE1tUs3FVu7PXBxgbDkFKcJE79PjSWQjDh_5Z_PrTGU9wd4Ji2pjc",
  "Nonce": "636591414425812400.NTkxYzUwYmUtMWQ0Ny00ZGY4LTllZDMtOGFlMmY2YTE5ZWVjMDdlMjI2MjktZmI3Yy00MjFkLThiNTEtYzg1ZjEzODRhOTA3",
  "SessionId": "ec557790f4e280cafc55dbacb32ab650",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636591414425812400.NTkxYzUwYmUtMWQ0Ny00ZGY4LTllZDMtOGFlMmY2YTE5ZWVjMDdlMjI2MjktZmI3Yy00MjFkLThiNTEtYzg1ZjEzODRhOTA3",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_95esmL8ziM05ZDt9AC6MDbE3LU8ZisRMViWyPuG2z2Jh6eeE6pSxCFV2B9ppm4JYrTdKyR1n3WlD_olNO3HHNv_GbcZVJUlJVEGkNgzkQN6YwGdOS8jAHiNZoz6-0Yip1ytQIgOuR7VfvMwszisdpendu8K2vB_F5EQ_kKAXjbP5G7--5lsDbhuStN_fHgqfkAmDOh6IbbNP7TuvqmaeYo9RyGBSFRXdRiI7_dhBVZNNIPGIkzbDC6-ONWCbCTSgnzMiUr3SSEJTeUE1tUs3FVu7PXBxgbDkFKcJE79PjSWQjDh_5Z_PrTGU9wd4Ji2pjc",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-12 17:50:42.820 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-12 17:50:42.820 +03:00 [INF] Showing consent: User has not yet consented
2018-04-12 17:50:42.832 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:50:42.833 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:50:42.902 +03:00 [DBG] Start authorize request protocol validation
2018-04-12 17:50:42.903 +03:00 [DBG] Checking for PKCE parameters
2018-04-12 17:50:42.905 +03:00 [DBG] No PKCE used.
2018-04-12 17:50:42.907 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-12 17:50:59.061 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-12 17:50:59.063 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:50:59.065 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:50:59.101 +03:00 [DBG] Start authorize request protocol validation
2018-04-12 17:50:59.103 +03:00 [DBG] Checking for PKCE parameters
2018-04-12 17:50:59.105 +03:00 [DBG] No PKCE used.
2018-04-12 17:50:59.107 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-12 17:50:59.129 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:50:59.131 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:50:59.133 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-12 17:50:59.135 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-12 17:50:59.137 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-12 17:50:59.143 +03:00 [DBG] Start authorize callback request
2018-04-12 17:50:59.163 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 17:50:59.164 +03:00 [DBG] Start authorize request protocol validation
2018-04-12 17:50:59.165 +03:00 [DBG] Checking for PKCE parameters
2018-04-12 17:50:59.166 +03:00 [DBG] No PKCE used.
2018-04-12 17:50:59.167 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-12 17:50:59.168 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_95esmL8ziM05ZDt9AC6MDbE3LU8ZisRMViWyPuG2z2Jh6eeE6pSxCFV2B9ppm4JYrTdKyR1n3WlD_olNO3HHNv_GbcZVJUlJVEGkNgzkQN6YwGdOS8jAHiNZoz6-0Yip1ytQIgOuR7VfvMwszisdpendu8K2vB_F5EQ_kKAXjbP5G7--5lsDbhuStN_fHgqfkAmDOh6IbbNP7TuvqmaeYo9RyGBSFRXdRiI7_dhBVZNNIPGIkzbDC6-ONWCbCTSgnzMiUr3SSEJTeUE1tUs3FVu7PXBxgbDkFKcJE79PjSWQjDh_5Z_PrTGU9wd4Ji2pjc",
  "Nonce": "636591414425812400.NTkxYzUwYmUtMWQ0Ny00ZGY4LTllZDMtOGFlMmY2YTE5ZWVjMDdlMjI2MjktZmI3Yy00MjFkLThiNTEtYzg1ZjEzODRhOTA3",
  "SessionId": "ec557790f4e280cafc55dbacb32ab650",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636591414425812400.NTkxYzUwYmUtMWQ0Ny00ZGY4LTllZDMtOGFlMmY2YTE5ZWVjMDdlMjI2MjktZmI3Yy00MjFkLThiNTEtYzg1ZjEzODRhOTA3",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_95esmL8ziM05ZDt9AC6MDbE3LU8ZisRMViWyPuG2z2Jh6eeE6pSxCFV2B9ppm4JYrTdKyR1n3WlD_olNO3HHNv_GbcZVJUlJVEGkNgzkQN6YwGdOS8jAHiNZoz6-0Yip1ytQIgOuR7VfvMwszisdpendu8K2vB_F5EQ_kKAXjbP5G7--5lsDbhuStN_fHgqfkAmDOh6IbbNP7TuvqmaeYo9RyGBSFRXdRiI7_dhBVZNNIPGIkzbDC6-ONWCbCTSgnzMiUr3SSEJTeUE1tUs3FVu7PXBxgbDkFKcJE79PjSWQjDh_5Z_PrTGU9wd4Ji2pjc",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-12 17:50:59.274 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-12 17:50:59.285 +03:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2018-04-12 17:50:59.296 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2018-04-12 17:50:59.300 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 17:50:59.318 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-12 17:50:59.348 +03:00 [DBG] Creating Implicit Flow response.
2018-04-12 17:50:59.358 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-12 17:50:59.363 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-12 17:50:59.406 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****yCRQ"
    },
    {
      "TokenType": "code",
      "TokenValue": "****88f4"
    }
  ],
  "ActivityId": "0HLD0GFO8GQ6A:00000007",
  "TimeStamp": "2018-04-12T14:50:59Z",
  "ProcessId": 2404,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 17:50:59.416 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_95esmL8ziM05ZDt9AC6MDbE3LU8ZisRMViWyPuG2z2Jh6eeE6pSxCFV2B9ppm4JYrTdKyR1n3WlD_olNO3HHNv_GbcZVJUlJVEGkNgzkQN6YwGdOS8jAHiNZoz6-0Yip1ytQIgOuR7VfvMwszisdpendu8K2vB_F5EQ_kKAXjbP5G7--5lsDbhuStN_fHgqfkAmDOh6IbbNP7TuvqmaeYo9RyGBSFRXdRiI7_dhBVZNNIPGIkzbDC6-ONWCbCTSgnzMiUr3SSEJTeUE1tUs3FVu7PXBxgbDkFKcJE79PjSWQjDh_5Z_PrTGU9wd4Ji2pjc",
  "Scope": "openid profile api1 offline_access"
}
2018-04-12 17:50:59.776 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-12 17:50:59.781 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-12 17:50:59.786 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-12 17:50:59.799 +03:00 [DBG] Start token request.
2018-04-12 17:50:59.807 +03:00 [DBG] Start client validation
2018-04-12 17:50:59.813 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-12 17:50:59.817 +03:00 [DBG] Start parsing for secret in post body
2018-04-12 17:50:59.818 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-12 17:50:59.818 +03:00 [DBG] Secret id found: mvc
2018-04-12 17:50:59.830 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-12 17:50:59.831 +03:00 [DBG] Client validation success
2018-04-12 17:50:59.836 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD0GFO8GQ6E:00000003",
  "TimeStamp": "2018-04-12T14:50:59Z",
  "ProcessId": 2404,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 17:50:59.845 +03:00 [DBG] Start token request validation
2018-04-12 17:50:59.856 +03:00 [DBG] Start validation of authorization code token request
2018-04-12 17:50:59.998 +03:00 [DBG] Validation of authorization code token request success
2018-04-12 17:51:00.008 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "fbb03e8f1920f695f988e9096aee36cd75b27ded1950783af08603c985e688f4",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "fbb03e8f1920f695f988e9096aee36cd75b27ded1950783af08603c985e688f4",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-12 17:51:00.037 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-12 17:51:00.039 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 17:51:00.250 +03:00 [DBG] Creating refresh token
2018-04-12 17:51:00.251 +03:00 [DBG] Setting an absolute lifetime: 2592000
2018-04-12 17:51:00.271 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-12 17:51:00.272 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-12 17:51:00.279 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****lzlg"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****117c"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****s4TA"
    }
  ],
  "ActivityId": "0HLD0GFO8GQ6E:00000003",
  "TimeStamp": "2018-04-12T14:51:00Z",
  "ProcessId": 2404,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 17:51:00.284 +03:00 [DBG] Token request success.
2018-04-12 17:51:00.296 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-12 17:51:00.299 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-12 17:51:00.300 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-12 17:51:00.309 +03:00 [DBG] Start userinfo request
2018-04-12 17:51:00.315 +03:00 [DBG] Bearer token found in header
2018-04-12 17:51:00.433 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-12 17:51:00.440 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1523544660,
    "exp": 1523548260,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1523457470,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2018-04-12 17:51:00.451 +03:00 [DBG] Creating userinfo response
2018-04-12 17:51:00.456 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-12 17:51:00.460 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-12 17:51:00.465 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-12 17:51:00.466 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-12 17:51:00.662 +03:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-04-12 17:51:00.663 +03:00 [DBG] End userinfo request
2018-04-12 17:52:41.006 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-12 17:52:41.008 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-12 17:52:41.009 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-12 17:52:41.010 +03:00 [DBG] Start token request.
2018-04-12 17:52:41.010 +03:00 [DBG] Start client validation
2018-04-12 17:52:41.011 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-12 17:52:41.011 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-12 17:52:41.012 +03:00 [DBG] Secret id found: ro.client
2018-04-12 17:52:41.012 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-12 17:52:41.013 +03:00 [DBG] Client validation success
2018-04-12 17:52:41.013 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "ro.client",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD0GFO8GQ6K:00000001",
  "TimeStamp": "2018-04-12T14:52:41Z",
  "ProcessId": 2404,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 17:52:41.016 +03:00 [DBG] Start token request validation
2018-04-12 17:52:41.027 +03:00 [DBG] Start resource owner password token request validation
2018-04-12 17:52:41.176 +03:00 [INF] Credentials validated for username: alice
2018-04-12 17:52:41.186 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "Token",
  "ActivityId": "0HLD0GFO8GQ6K:00000001",
  "TimeStamp": "2018-04-12T14:52:41Z",
  "ProcessId": 2404,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 17:52:41.191 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Endpoint": "Token",
  "ActivityId": "0HLD0GFO8GQ6K:00000001",
  "TimeStamp": "2018-04-12T14:52:41Z",
  "ProcessId": 2404,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 17:52:41.193 +03:00 [DBG] Resource owner password token request validation success.
2018-04-12 17:52:41.193 +03:00 [INF] Token request validation success
{
  "ClientId": "ro.client",
  "GrantType": "password",
  "Scopes": "api1 offline_access",
  "UserName": "alice",
  "Raw": {
    "grant_type": "password",
    "username": "alice",
    "password": "***REDACTED***"
  }
}
2018-04-12 17:52:41.198 +03:00 [DBG] Getting claims for access token for client: ro.client
2018-04-12 17:52:41.199 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 17:52:41.404 +03:00 [DBG] Creating refresh token
2018-04-12 17:52:41.404 +03:00 [DBG] Setting an absolute lifetime: 2592000
2018-04-12 17:52:41.417 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "ro.client",
  "Endpoint": "Token",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "api1 offline_access",
  "GrantType": "password",
  "Tokens": [
    {
      "TokenType": "refresh_token",
      "TokenValue": "****33e7"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****CeBg"
    }
  ],
  "ActivityId": "0HLD0GFO8GQ6K:00000001",
  "TimeStamp": "2018-04-12T14:52:41Z",
  "ProcessId": 2404,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 17:52:41.420 +03:00 [DBG] Token request success.
2018-04-12 17:58:56.129 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:58:56.130 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:58:56.132 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-12 17:58:56.133 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-12 17:58:56.134 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-12 17:58:56.135 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 17:58:56.136 +03:00 [DBG] Start end session request validation
2018-04-12 17:58:56.137 +03:00 [DBG] Start identity token validation
2018-04-12 17:58:56.137 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-12 17:58:56.561 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-12 17:58:56.564 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1523544660,
    "exp": 1523544960,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636591414425812400.NTkxYzUwYmUtMWQ0Ny00ZGY4LTllZDMtOGFlMmY2YTE5ZWVjMDdlMjI2MjktZmI3Yy00MjFkLThiNTEtYzg1ZjEzODRhOTA3",
    "iat": 1523544660,
    "at_hash": "2fSoJTAUmawVcUiTfLEs_w",
    "sid": "ec557790f4e280cafc55dbacb32ab650",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1523457470,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-12 17:58:56.572 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_94UPNtTXPYNJv9K9ShrkeWnnkIa8EOzxbZWlgBUeKLRSvFfxlldQYL8nKP_41_qhY0yvPkzNHrmxTog8gk9sMZiHeZgc286FLZtEqN1hZ4C0x3y2gebn4oyr3GtTeRLE0Yc_fIkRxZk7bR7ovb4BaWH",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjM1NDQ2NjAsImV4cCI6MTUyMzU0NDk2MCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY1OTE0MTQ0MjU4MTI0MDAuTlRreFl6VXdZbVV0TVdRME55MDBaR1k0TFRsbFpETXRPR0ZsTW1ZMllURTVaV1ZqTURkbE1qSTJNamt0Wm1JM1l5MDBNakZrTFRoaU5URXRZemcxWmpFek9EUmhPVEEzIiwiaWF0IjoxNTIzNTQ0NjYwLCJhdF9oYXNoIjoiMmZTb0pUQVVtYXdWY1VpVGZMRXNfdyIsInNpZCI6ImVjNTU3NzkwZjRlMjgwY2FmYzU1ZGJhY2IzMmFiNjUwIiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTIzNDU3NDcwLCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.E50kmDeKpvIEeRdiiiRGhdqozZ1g-0NWcu0qlD-Q_h7iOfXm5qwavHQb_gcMx1v2NGhDHUATozY1-aqcKa7dDMoHwd5S1FRkFcg_EtdaTx0UrLMyzJ71dc97-HO2Q2oUuQOyGnpdje_Rb2aRrDFmIGUpX0nEICdTz2fbxQM71emqv_xxlL_ujOHTErsWZ3Z5fs-h62_Z8mqAkL8KHhHLDr1PQNZiCmVwOn2Hbxla3TaTT8nDNMNnDwtdxD6bmOExfiMdFgIRFHuLR8EFCIHp3npARXrYHcglmV7jvwTz-NrTXV-9unefYIRl7r8ZKflrAVHC7vkJ9UE_Z8_Te5lzlg",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_94UPNtTXPYNJv9K9ShrkeWnnkIa8EOzxbZWlgBUeKLRSvFfxlldQYL8nKP_41_qhY0yvPkzNHrmxTog8gk9sMZiHeZgc286FLZtEqN1hZ4C0x3y2gebn4oyr3GtTeRLE0Yc_fIkRxZk7bR7ovb4BaWH",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-12 17:58:56.578 +03:00 [DBG] Success validating end session request from mvc
2018-04-12 17:58:56.598 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:58:56.598 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:58:56.641 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-12 17:58:56.642 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-12 17:58:56.644 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-12 17:58:56.652 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD0GFO8GQ6M:00000002",
  "TimeStamp": "2018-04-12T14:58:56Z",
  "ProcessId": 2404,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 17:58:57.265 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-12 17:58:57.269 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-12 17:58:57.270 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-12 17:58:57.277 +03:00 [DBG] Processing signout callback request
2018-04-12 17:58:57.292 +03:00 [DBG] No client front-channel logout URLs
2018-04-12 17:58:57.292 +03:00 [DBG] No client back-channel logout URLs
2018-04-12 17:58:57.294 +03:00 [INF] Successful signout callback.
2018-04-12 17:58:57.294 +03:00 [DBG] No client front-channel iframe urls
2018-04-12 17:58:57.295 +03:00 [DBG] No client back-channel iframe urls
2018-04-12 17:59:15.977 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-12 17:59:15.979 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-12 17:59:15.980 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-12 17:59:15.981 +03:00 [DBG] Start authorize request
2018-04-12 17:59:15.982 +03:00 [DBG] No user present in authorize request
2018-04-12 17:59:15.984 +03:00 [DBG] Start authorize request protocol validation
2018-04-12 17:59:15.986 +03:00 [DBG] Checking for PKCE parameters
2018-04-12 17:59:15.988 +03:00 [DBG] No PKCE used.
2018-04-12 17:59:15.989 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-12 17:59:15.990 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_94_rC40jE5rrr7Ot0AgWuK9G2avQljSLiX0-vJNgziNxJJeyXUPxw2nmvotdnrVS8SmiZCgSDNFR48atxRUrJi6JO6tFEh3IGNCCpRs_1_a4PfjFXcQc-PqxH6t65GD9ieXGSkhyLNAM4isareUQNUa_3ZuagLqXBZd2eDrtpaK-TtpZTc7E6HUTPIkr9YDJjchdrwr_ju0YFwd_1kx8yY50yakatn0CcJeC8ZBCSAe3cflLiVCVXT5xiSHxQcIYQ3OW8t5t8btGGVziQ1N9Nj0qUr4P-ptYjxJ93EAyfPbKI8nZemPKMpYi3t3tJBH_wA",
  "Nonce": "636591419559707398.YmYwYzcxZGYtMmExZS00ZmY3LWJlOWMtM2Q5MDA0ZGU1YWVmNDVhMWNmMGEtOTBiNi00YzI0LThiNjMtYWM0NWFjNTFjMDdl",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636591419559707398.YmYwYzcxZGYtMmExZS00ZmY3LWJlOWMtM2Q5MDA0ZGU1YWVmNDVhMWNmMGEtOTBiNi00YzI0LThiNjMtYWM0NWFjNTFjMDdl",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_94_rC40jE5rrr7Ot0AgWuK9G2avQljSLiX0-vJNgziNxJJeyXUPxw2nmvotdnrVS8SmiZCgSDNFR48atxRUrJi6JO6tFEh3IGNCCpRs_1_a4PfjFXcQc-PqxH6t65GD9ieXGSkhyLNAM4isareUQNUa_3ZuagLqXBZd2eDrtpaK-TtpZTc7E6HUTPIkr9YDJjchdrwr_ju0YFwd_1kx8yY50yakatn0CcJeC8ZBCSAe3cflLiVCVXT5xiSHxQcIYQ3OW8t5t8btGGVziQ1N9Nj0qUr4P-ptYjxJ93EAyfPbKI8nZemPKMpYi3t3tJBH_wA",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-12 17:59:15.994 +03:00 [INF] Showing login: User is not authenticated
2018-04-12 17:59:16.018 +03:00 [DBG] Start authorize request protocol validation
2018-04-12 17:59:16.019 +03:00 [DBG] Checking for PKCE parameters
2018-04-12 17:59:16.020 +03:00 [DBG] No PKCE used.
2018-04-12 17:59:16.021 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-12 17:59:25.835 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-12 17:59:25.837 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-12 17:59:25.838 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-12 17:59:25.839 +03:00 [DBG] Start authorize request
2018-04-12 17:59:25.840 +03:00 [DBG] No user present in authorize request
2018-04-12 17:59:25.840 +03:00 [DBG] Start authorize request protocol validation
2018-04-12 17:59:25.841 +03:00 [DBG] Checking for PKCE parameters
2018-04-12 17:59:25.842 +03:00 [DBG] No PKCE used.
2018-04-12 17:59:25.843 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-12 17:59:25.844 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_97Va6GfgfR47JxY6TOSgePh84Ptb-5sxyiTqxAyg2KJuF9Z_R4v_FrSs0fIzE6YE33VTSV4fiBDMIIm8xMwj01y8Di6CgF2FZBxjOc4R-EptKnhgVqZgygizDpGutLF8tFGkXgzqnPTaNJeAf_G264NS1l3Kww-yCPgQlgvBRMtJgGMcrTunOVUUlHgwwuG6lrNq6OFsxw-9sv1H2BmjoZ8wGPLujuH3bkTBWXEYT8lst5-52m96lfMjjyCNca1UxdMWmLxGC9FXWoTzrC-UP7t4dZchc3YbN40VvntkPtxNFXqRRTO8pVrelwwy4WggQM",
  "Nonce": "636591419658282671.ODRlNzAzOTAtMTEwMi00YTM0LThhMTQtMjA4MDY0MmQ2NzZiMDY1NjRlMjYtZjI0ZC00M2E0LTk5ZjAtN2QzN2UzOWYzOGU4",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636591419658282671.ODRlNzAzOTAtMTEwMi00YTM0LThhMTQtMjA4MDY0MmQ2NzZiMDY1NjRlMjYtZjI0ZC00M2E0LTk5ZjAtN2QzN2UzOWYzOGU4",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_97Va6GfgfR47JxY6TOSgePh84Ptb-5sxyiTqxAyg2KJuF9Z_R4v_FrSs0fIzE6YE33VTSV4fiBDMIIm8xMwj01y8Di6CgF2FZBxjOc4R-EptKnhgVqZgygizDpGutLF8tFGkXgzqnPTaNJeAf_G264NS1l3Kww-yCPgQlgvBRMtJgGMcrTunOVUUlHgwwuG6lrNq6OFsxw-9sv1H2BmjoZ8wGPLujuH3bkTBWXEYT8lst5-52m96lfMjjyCNca1UxdMWmLxGC9FXWoTzrC-UP7t4dZchc3YbN40VvntkPtxNFXqRRTO8pVrelwwy4WggQM",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-12 17:59:25.853 +03:00 [INF] Showing login: User is not authenticated
2018-04-12 17:59:25.858 +03:00 [DBG] Start authorize request protocol validation
2018-04-12 17:59:25.858 +03:00 [DBG] Checking for PKCE parameters
2018-04-12 17:59:25.859 +03:00 [DBG] No PKCE used.
2018-04-12 17:59:25.860 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-12 17:59:39.269 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-12 17:59:39.612 +03:00 [DBG] Augmenting SignInContext
2018-04-12 17:59:39.615 +03:00 [DBG] Adding idp claim with value: local
2018-04-12 17:59:39.616 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-12 17:59:39.617 +03:00 [DBG] Adding auth_time claim with value: 1523545179
2018-04-12 17:59:39.623 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-12 17:59:39.717 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD0GFO8GQ6O:0000000B",
  "TimeStamp": "2018-04-12T14:59:39Z",
  "ProcessId": 2404,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 17:59:39.729 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:59:39.730 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:59:39.731 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-12 17:59:39.732 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-12 17:59:39.733 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-12 17:59:39.734 +03:00 [DBG] Start authorize callback request
2018-04-12 17:59:39.734 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 17:59:39.735 +03:00 [DBG] Start authorize request protocol validation
2018-04-12 17:59:39.735 +03:00 [DBG] Checking for PKCE parameters
2018-04-12 17:59:39.735 +03:00 [DBG] No PKCE used.
2018-04-12 17:59:39.736 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-12 17:59:39.737 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_97Va6GfgfR47JxY6TOSgePh84Ptb-5sxyiTqxAyg2KJuF9Z_R4v_FrSs0fIzE6YE33VTSV4fiBDMIIm8xMwj01y8Di6CgF2FZBxjOc4R-EptKnhgVqZgygizDpGutLF8tFGkXgzqnPTaNJeAf_G264NS1l3Kww-yCPgQlgvBRMtJgGMcrTunOVUUlHgwwuG6lrNq6OFsxw-9sv1H2BmjoZ8wGPLujuH3bkTBWXEYT8lst5-52m96lfMjjyCNca1UxdMWmLxGC9FXWoTzrC-UP7t4dZchc3YbN40VvntkPtxNFXqRRTO8pVrelwwy4WggQM",
  "Nonce": "636591419658282671.ODRlNzAzOTAtMTEwMi00YTM0LThhMTQtMjA4MDY0MmQ2NzZiMDY1NjRlMjYtZjI0ZC00M2E0LTk5ZjAtN2QzN2UzOWYzOGU4",
  "SessionId": "08c5cee53e4718d328dea32bba69c016",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636591419658282671.ODRlNzAzOTAtMTEwMi00YTM0LThhMTQtMjA4MDY0MmQ2NzZiMDY1NjRlMjYtZjI0ZC00M2E0LTk5ZjAtN2QzN2UzOWYzOGU4",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_97Va6GfgfR47JxY6TOSgePh84Ptb-5sxyiTqxAyg2KJuF9Z_R4v_FrSs0fIzE6YE33VTSV4fiBDMIIm8xMwj01y8Di6CgF2FZBxjOc4R-EptKnhgVqZgygizDpGutLF8tFGkXgzqnPTaNJeAf_G264NS1l3Kww-yCPgQlgvBRMtJgGMcrTunOVUUlHgwwuG6lrNq6OFsxw-9sv1H2BmjoZ8wGPLujuH3bkTBWXEYT8lst5-52m96lfMjjyCNca1UxdMWmLxGC9FXWoTzrC-UP7t4dZchc3YbN40VvntkPtxNFXqRRTO8pVrelwwy4WggQM",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-12 17:59:39.833 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-12 17:59:39.834 +03:00 [INF] Showing consent: User has not yet consented
2018-04-12 17:59:39.840 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:59:39.841 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:59:39.845 +03:00 [DBG] Start authorize request protocol validation
2018-04-12 17:59:39.846 +03:00 [DBG] Checking for PKCE parameters
2018-04-12 17:59:39.847 +03:00 [DBG] No PKCE used.
2018-04-12 17:59:39.847 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-12 17:59:50.632 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-12 17:59:50.637 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:59:50.638 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:59:50.640 +03:00 [DBG] Start authorize request protocol validation
2018-04-12 17:59:50.640 +03:00 [DBG] Checking for PKCE parameters
2018-04-12 17:59:50.640 +03:00 [DBG] No PKCE used.
2018-04-12 17:59:50.641 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-12 17:59:50.649 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:59:50.650 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 17:59:50.653 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-12 17:59:50.656 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-12 17:59:50.658 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-12 17:59:50.659 +03:00 [DBG] Start authorize callback request
2018-04-12 17:59:50.660 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 17:59:50.661 +03:00 [DBG] Start authorize request protocol validation
2018-04-12 17:59:50.661 +03:00 [DBG] Checking for PKCE parameters
2018-04-12 17:59:50.662 +03:00 [DBG] No PKCE used.
2018-04-12 17:59:50.662 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-12 17:59:50.663 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_97Va6GfgfR47JxY6TOSgePh84Ptb-5sxyiTqxAyg2KJuF9Z_R4v_FrSs0fIzE6YE33VTSV4fiBDMIIm8xMwj01y8Di6CgF2FZBxjOc4R-EptKnhgVqZgygizDpGutLF8tFGkXgzqnPTaNJeAf_G264NS1l3Kww-yCPgQlgvBRMtJgGMcrTunOVUUlHgwwuG6lrNq6OFsxw-9sv1H2BmjoZ8wGPLujuH3bkTBWXEYT8lst5-52m96lfMjjyCNca1UxdMWmLxGC9FXWoTzrC-UP7t4dZchc3YbN40VvntkPtxNFXqRRTO8pVrelwwy4WggQM",
  "Nonce": "636591419658282671.ODRlNzAzOTAtMTEwMi00YTM0LThhMTQtMjA4MDY0MmQ2NzZiMDY1NjRlMjYtZjI0ZC00M2E0LTk5ZjAtN2QzN2UzOWYzOGU4",
  "SessionId": "08c5cee53e4718d328dea32bba69c016",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636591419658282671.ODRlNzAzOTAtMTEwMi00YTM0LThhMTQtMjA4MDY0MmQ2NzZiMDY1NjRlMjYtZjI0ZC00M2E0LTk5ZjAtN2QzN2UzOWYzOGU4",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_97Va6GfgfR47JxY6TOSgePh84Ptb-5sxyiTqxAyg2KJuF9Z_R4v_FrSs0fIzE6YE33VTSV4fiBDMIIm8xMwj01y8Di6CgF2FZBxjOc4R-EptKnhgVqZgygizDpGutLF8tFGkXgzqnPTaNJeAf_G264NS1l3Kww-yCPgQlgvBRMtJgGMcrTunOVUUlHgwwuG6lrNq6OFsxw-9sv1H2BmjoZ8wGPLujuH3bkTBWXEYT8lst5-52m96lfMjjyCNca1UxdMWmLxGC9FXWoTzrC-UP7t4dZchc3YbN40VvntkPtxNFXqRRTO8pVrelwwy4WggQM",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-12 17:59:50.767 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-12 17:59:50.768 +03:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2018-04-12 17:59:50.770 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2018-04-12 17:59:50.772 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 17:59:50.778 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-12 17:59:50.790 +03:00 [DBG] Creating Implicit Flow response.
2018-04-12 17:59:50.790 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-12 17:59:50.792 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-12 17:59:50.797 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****eRFw"
    },
    {
      "TokenType": "code",
      "TokenValue": "****e8a1"
    }
  ],
  "ActivityId": "0HLD0GFO8GQ6O:00000010",
  "TimeStamp": "2018-04-12T14:59:50Z",
  "ProcessId": 2404,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 17:59:50.801 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_97Va6GfgfR47JxY6TOSgePh84Ptb-5sxyiTqxAyg2KJuF9Z_R4v_FrSs0fIzE6YE33VTSV4fiBDMIIm8xMwj01y8Di6CgF2FZBxjOc4R-EptKnhgVqZgygizDpGutLF8tFGkXgzqnPTaNJeAf_G264NS1l3Kww-yCPgQlgvBRMtJgGMcrTunOVUUlHgwwuG6lrNq6OFsxw-9sv1H2BmjoZ8wGPLujuH3bkTBWXEYT8lst5-52m96lfMjjyCNca1UxdMWmLxGC9FXWoTzrC-UP7t4dZchc3YbN40VvntkPtxNFXqRRTO8pVrelwwy4WggQM",
  "Scope": "openid profile api1 offline_access"
}
2018-04-12 17:59:50.808 +03:00 [DBG] Augmenting SignInContext
2018-04-12 17:59:50.809 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-12 17:59:51.075 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-12 17:59:51.077 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-12 17:59:51.078 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-12 17:59:51.079 +03:00 [DBG] Start token request.
2018-04-12 17:59:51.079 +03:00 [DBG] Start client validation
2018-04-12 17:59:51.080 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-12 17:59:51.081 +03:00 [DBG] Start parsing for secret in post body
2018-04-12 17:59:51.081 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-12 17:59:51.082 +03:00 [DBG] Secret id found: mvc
2018-04-12 17:59:51.083 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-12 17:59:51.083 +03:00 [DBG] Client validation success
2018-04-12 17:59:51.084 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD0GFO8GQ6P:00000001",
  "TimeStamp": "2018-04-12T14:59:51Z",
  "ProcessId": 2404,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 17:59:51.086 +03:00 [DBG] Start token request validation
2018-04-12 17:59:51.086 +03:00 [DBG] Start validation of authorization code token request
2018-04-12 17:59:51.199 +03:00 [DBG] Validation of authorization code token request success
2018-04-12 17:59:51.200 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "57f4dff41bbdb2675c643d2606b54df02e7e63ea10d962cdf6593872b61de8a1",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "57f4dff41bbdb2675c643d2606b54df02e7e63ea10d962cdf6593872b61de8a1",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-12 17:59:51.203 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-12 17:59:51.204 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-12 17:59:51.397 +03:00 [DBG] Creating refresh token
2018-04-12 17:59:51.398 +03:00 [DBG] Setting an absolute lifetime: 2592000
2018-04-12 17:59:51.410 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-12 17:59:51.412 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-12 17:59:51.418 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****hCCw"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****11c1"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****gaTg"
    }
  ],
  "ActivityId": "0HLD0GFO8GQ6P:00000001",
  "TimeStamp": "2018-04-12T14:59:51Z",
  "ProcessId": 2404,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 17:59:51.421 +03:00 [DBG] Token request success.
2018-04-12 17:59:51.424 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-12 17:59:51.425 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-12 17:59:51.426 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-12 17:59:51.427 +03:00 [DBG] Start userinfo request
2018-04-12 17:59:51.428 +03:00 [DBG] Bearer token found in header
2018-04-12 17:59:51.529 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-12 17:59:51.531 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1523545191,
    "exp": 1523548791,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1523545179,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2018-04-12 17:59:51.535 +03:00 [DBG] Creating userinfo response
2018-04-12 17:59:51.535 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-12 17:59:51.536 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-12 17:59:51.538 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-12 17:59:51.539 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-12 17:59:51.748 +03:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-04-12 17:59:51.748 +03:00 [DBG] End userinfo request
2018-04-12 18:11:00.193 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 18:11:00.196 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 18:11:02.913 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 18:11:02.916 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 18:11:04.166 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-12 18:11:04.169 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 18:11:04.170 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-12 18:11:04.182 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-12 18:11:04.183 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-12 18:11:04.185 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-12 18:11:04.186 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD0GFO8GQ6Q:00000003",
  "TimeStamp": "2018-04-12T15:11:04Z",
  "ProcessId": 2404,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-12 18:11:04.315 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-12 18:11:04.316 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-12 18:11:04.318 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-12 18:11:04.319 +03:00 [DBG] Processing signout callback request
2018-04-12 18:11:04.322 +03:00 [DBG] No client front-channel logout URLs
2018-04-12 18:11:04.322 +03:00 [DBG] No client back-channel logout URLs
2018-04-12 18:11:04.324 +03:00 [INF] Successful signout callback.
2018-04-12 18:11:04.325 +03:00 [DBG] No client front-channel iframe urls
2018-04-12 18:11:04.325 +03:00 [DBG] No client back-channel iframe urls
2018-04-12 18:11:06.978 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 09:56:57.073 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 09:56:57.131 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 09:56:57.135 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 09:56:57.135 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 09:56:57.136 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 09:56:57.136 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 09:57:05.884 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 09:58:08.164 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 09:58:09.729 +03:00 [DBG] Augmenting SignInContext
2018-04-19 09:58:09.731 +03:00 [DBG] Adding idp claim with value: local
2018-04-19 09:58:09.732 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-19 09:58:09.733 +03:00 [DBG] Adding auth_time claim with value: 1524121089
2018-04-19 09:58:09.745 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 09:58:09.908 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD5OAV2A8C7:00000008",
  "TimeStamp": "2018-04-19T06:58:09Z",
  "ProcessId": 32512,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 09:58:09.924 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 09:58:09.930 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 09:58:18.436 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 09:58:18.438 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 09:58:19.989 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 09:58:19.994 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 09:59:29.758 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-19 09:59:29.763 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-19 09:59:29.765 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-19 09:59:29.769 +03:00 [DBG] Start discovery request
2018-04-19 09:59:29.902 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-19 09:59:29.904 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-19 09:59:29.905 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-19 09:59:29.909 +03:00 [DBG] Start key discovery request
2018-04-19 09:59:29.944 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 09:59:29.945 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 09:59:29.948 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-19 09:59:29.956 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-19 09:59:29.957 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-19 09:59:29.967 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 09:59:29.975 +03:00 [DBG] Start end session request validation
2018-04-19 09:59:29.982 +03:00 [DBG] Start identity token validation
2018-04-19 09:59:30.023 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-19 09:59:30.161 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 09:59:30.168 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1523545191,
    "exp": 1523545491,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636591419658282671.ODRlNzAzOTAtMTEwMi00YTM0LThhMTQtMjA4MDY0MmQ2NzZiMDY1NjRlMjYtZjI0ZC00M2E0LTk5ZjAtN2QzN2UzOWYzOGU4",
    "iat": 1523545191,
    "at_hash": "cmosfQG8X14vGBpOYsZEtg",
    "sid": "08c5cee53e4718d328dea32bba69c016",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1523545179,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-19 09:59:30.184 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_95upWZAhvE2vRP_sSKS2KlM1DoxIQBo6qJC2zaGS4ldESeo2NJ8TfzAPOjiagfToebjhvwmhKkomm67badpWLrCZaM4PXOw3a1UeuF0MtlMiXMPpvrDUN881zG2-HgMxnTFKzzpswYlXdMTxbXc-5SH",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjM1NDUxOTEsImV4cCI6MTUyMzU0NTQ5MSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY1OTE0MTk2NTgyODI2NzEuT0RSbE56QXpPVEF0TVRFd01pMDBZVE0wTFRoaE1UUXRNakE0TURZME1tUTJOelppTURZMU5qUmxNall0WmpJMFpDMDBNMkUwTFRrNVpqQXROMlF6TjJVek9XWXpPR1U0IiwiaWF0IjoxNTIzNTQ1MTkxLCJhdF9oYXNoIjoiY21vc2ZRRzhYMTR2R0JwT1lzWkV0ZyIsInNpZCI6IjA4YzVjZWU1M2U0NzE4ZDMyOGRlYTMyYmJhNjljMDE2Iiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTIzNTQ1MTc5LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.W2vgsuW_hlp932eiXHiNvhIQ90hhwhusiIOfAthQPcUmNFoZ7koKGZRAsz03F2fRh4Kcryudbma011OgaeSHibH1dL7AjrytwYUcXAVynqivOWz8lzPR4EJakcf3RUG7lzNyrwhwETu8J1pPft03t8lT1TEfpETYCKXjo247ilptk6rke2bwQSDkGIZBjKxzb2Y_8VziPKZAEphyomV9sqItU7GXw7xbdmQo4xiJyyU4QglVNRAdVOkCsz7JB0E40uZCHx-PJqgAjY92NwA0DP9TM8_WkXvbr890Y2K-WUKBRTxxurSrnjyuNINuipp59KHg3K3EQBzjZoFl9fhCCw",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_95upWZAhvE2vRP_sSKS2KlM1DoxIQBo6qJC2zaGS4ldESeo2NJ8TfzAPOjiagfToebjhvwmhKkomm67badpWLrCZaM4PXOw3a1UeuF0MtlMiXMPpvrDUN881zG2-HgMxnTFKzzpswYlXdMTxbXc-5SH",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 09:59:30.190 +03:00 [DBG] Success validating end session request from mvc
2018-04-19 09:59:30.212 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 09:59:30.212 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 09:59:30.265 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-19 09:59:30.267 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 09:59:30.269 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-19 09:59:30.279 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD5OAV2A8C7:0000000D",
  "TimeStamp": "2018-04-19T06:59:30Z",
  "ProcessId": 32512,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 09:59:50.136 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-19 09:59:50.144 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-19 09:59:50.149 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-19 09:59:50.157 +03:00 [DBG] Start authorize request
2018-04-19 09:59:50.164 +03:00 [DBG] No user present in authorize request
2018-04-19 09:59:50.169 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 09:59:50.183 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 09:59:50.185 +03:00 [DBG] No PKCE used.
2018-04-19 09:59:50.232 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 09:59:50.246 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_95Y4wooHyd8FW5wo_AURfkkbFOu01WuObuhvSbgsiU1c0_ceC78LVKNR_xPYpK6Q7PcF6JFBEtHikF9c-hHOiVv5BZr9rb_qsmFI26R-WgKgKW3E7jHZS1vJsVPfsJQCg4DL1XGsb93szXERnNG4BV3qwV2BXYgy-zpbvU1devMZQ0UqPLL-gfBHV7uBv_rf_xT-Y_ln-t3hC9QlQr3nKgzDZuD5MDA9-no4K7c3pEJOBwz8PMZWItE9KbrPqh0TIfmqJ0smF4x1NB-0Fgvt8vCJJ87uoaxSJkb-FaYAoC9Ddub7-T6ZZGcoRgyZWuDKLw",
  "Nonce": "636597179900794189.YmVkNWY4MDAtNjViMS00MGY0LTk2ZmEtODI3YzdhMTAwNjVhZTk5NjkyNzUtMTQzMC00ZTBkLTllOTgtZDcxYjk3Mzg3YjY2",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636597179900794189.YmVkNWY4MDAtNjViMS00MGY0LTk2ZmEtODI3YzdhMTAwNjVhZTk5NjkyNzUtMTQzMC00ZTBkLTllOTgtZDcxYjk3Mzg3YjY2",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_95Y4wooHyd8FW5wo_AURfkkbFOu01WuObuhvSbgsiU1c0_ceC78LVKNR_xPYpK6Q7PcF6JFBEtHikF9c-hHOiVv5BZr9rb_qsmFI26R-WgKgKW3E7jHZS1vJsVPfsJQCg4DL1XGsb93szXERnNG4BV3qwV2BXYgy-zpbvU1devMZQ0UqPLL-gfBHV7uBv_rf_xT-Y_ln-t3hC9QlQr3nKgzDZuD5MDA9-no4K7c3pEJOBwz8PMZWItE9KbrPqh0TIfmqJ0smF4x1NB-0Fgvt8vCJJ87uoaxSJkb-FaYAoC9Ddub7-T6ZZGcoRgyZWuDKLw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 09:59:50.261 +03:00 [INF] Showing login: User is not authenticated
2018-04-19 09:59:50.294 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 09:59:50.294 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 09:59:50.295 +03:00 [DBG] No PKCE used.
2018-04-19 09:59:50.296 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 09:59:59.637 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 09:59:59.856 +03:00 [DBG] Augmenting SignInContext
2018-04-19 09:59:59.856 +03:00 [DBG] Adding idp claim with value: local
2018-04-19 09:59:59.856 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-19 09:59:59.857 +03:00 [DBG] Adding auth_time claim with value: 1524121199
2018-04-19 09:59:59.858 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 09:59:59.926 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD5OAV2A8C7:00000013",
  "TimeStamp": "2018-04-19T06:59:59Z",
  "ProcessId": 32512,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 09:59:59.934 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 09:59:59.935 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 09:59:59.936 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-19 09:59:59.938 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-19 09:59:59.939 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-19 09:59:59.945 +03:00 [DBG] Start authorize callback request
2018-04-19 09:59:59.949 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 09:59:59.951 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 09:59:59.952 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 09:59:59.953 +03:00 [DBG] No PKCE used.
2018-04-19 09:59:59.954 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 09:59:59.955 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_95Y4wooHyd8FW5wo_AURfkkbFOu01WuObuhvSbgsiU1c0_ceC78LVKNR_xPYpK6Q7PcF6JFBEtHikF9c-hHOiVv5BZr9rb_qsmFI26R-WgKgKW3E7jHZS1vJsVPfsJQCg4DL1XGsb93szXERnNG4BV3qwV2BXYgy-zpbvU1devMZQ0UqPLL-gfBHV7uBv_rf_xT-Y_ln-t3hC9QlQr3nKgzDZuD5MDA9-no4K7c3pEJOBwz8PMZWItE9KbrPqh0TIfmqJ0smF4x1NB-0Fgvt8vCJJ87uoaxSJkb-FaYAoC9Ddub7-T6ZZGcoRgyZWuDKLw",
  "Nonce": "636597179900794189.YmVkNWY4MDAtNjViMS00MGY0LTk2ZmEtODI3YzdhMTAwNjVhZTk5NjkyNzUtMTQzMC00ZTBkLTllOTgtZDcxYjk3Mzg3YjY2",
  "SessionId": "880eb4400755ee962932ac6e0582f9aa",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636597179900794189.YmVkNWY4MDAtNjViMS00MGY0LTk2ZmEtODI3YzdhMTAwNjVhZTk5NjkyNzUtMTQzMC00ZTBkLTllOTgtZDcxYjk3Mzg3YjY2",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_95Y4wooHyd8FW5wo_AURfkkbFOu01WuObuhvSbgsiU1c0_ceC78LVKNR_xPYpK6Q7PcF6JFBEtHikF9c-hHOiVv5BZr9rb_qsmFI26R-WgKgKW3E7jHZS1vJsVPfsJQCg4DL1XGsb93szXERnNG4BV3qwV2BXYgy-zpbvU1devMZQ0UqPLL-gfBHV7uBv_rf_xT-Y_ln-t3hC9QlQr3nKgzDZuD5MDA9-no4K7c3pEJOBwz8PMZWItE9KbrPqh0TIfmqJ0smF4x1NB-0Fgvt8vCJJ87uoaxSJkb-FaYAoC9Ddub7-T6ZZGcoRgyZWuDKLw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 10:00:00.039 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-19 10:00:00.040 +03:00 [INF] Showing consent: User has not yet consented
2018-04-19 10:00:00.046 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:00:00.048 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:00:00.056 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:00:00.060 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:00:00.061 +03:00 [DBG] No PKCE used.
2018-04-19 10:00:00.062 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:00:09.012 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 10:00:09.016 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:00:09.017 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:00:09.039 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:00:09.040 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:00:09.041 +03:00 [DBG] No PKCE used.
2018-04-19 10:00:09.041 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:00:09.063 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:00:09.064 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:00:09.065 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-19 10:00:09.066 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-19 10:00:09.067 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-19 10:00:09.067 +03:00 [DBG] Start authorize callback request
2018-04-19 10:00:09.070 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:00:09.073 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:00:09.076 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:00:09.076 +03:00 [DBG] No PKCE used.
2018-04-19 10:00:09.077 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:00:09.078 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_95Y4wooHyd8FW5wo_AURfkkbFOu01WuObuhvSbgsiU1c0_ceC78LVKNR_xPYpK6Q7PcF6JFBEtHikF9c-hHOiVv5BZr9rb_qsmFI26R-WgKgKW3E7jHZS1vJsVPfsJQCg4DL1XGsb93szXERnNG4BV3qwV2BXYgy-zpbvU1devMZQ0UqPLL-gfBHV7uBv_rf_xT-Y_ln-t3hC9QlQr3nKgzDZuD5MDA9-no4K7c3pEJOBwz8PMZWItE9KbrPqh0TIfmqJ0smF4x1NB-0Fgvt8vCJJ87uoaxSJkb-FaYAoC9Ddub7-T6ZZGcoRgyZWuDKLw",
  "Nonce": "636597179900794189.YmVkNWY4MDAtNjViMS00MGY0LTk2ZmEtODI3YzdhMTAwNjVhZTk5NjkyNzUtMTQzMC00ZTBkLTllOTgtZDcxYjk3Mzg3YjY2",
  "SessionId": "880eb4400755ee962932ac6e0582f9aa",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636597179900794189.YmVkNWY4MDAtNjViMS00MGY0LTk2ZmEtODI3YzdhMTAwNjVhZTk5NjkyNzUtMTQzMC00ZTBkLTllOTgtZDcxYjk3Mzg3YjY2",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_95Y4wooHyd8FW5wo_AURfkkbFOu01WuObuhvSbgsiU1c0_ceC78LVKNR_xPYpK6Q7PcF6JFBEtHikF9c-hHOiVv5BZr9rb_qsmFI26R-WgKgKW3E7jHZS1vJsVPfsJQCg4DL1XGsb93szXERnNG4BV3qwV2BXYgy-zpbvU1devMZQ0UqPLL-gfBHV7uBv_rf_xT-Y_ln-t3hC9QlQr3nKgzDZuD5MDA9-no4K7c3pEJOBwz8PMZWItE9KbrPqh0TIfmqJ0smF4x1NB-0Fgvt8vCJJ87uoaxSJkb-FaYAoC9Ddub7-T6ZZGcoRgyZWuDKLw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 10:00:09.151 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-19 10:00:09.162 +03:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2018-04-19 10:00:09.174 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2018-04-19 10:00:09.179 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:00:09.198 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-19 10:00:09.227 +03:00 [DBG] Creating Implicit Flow response.
2018-04-19 10:00:09.241 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-19 10:00:09.244 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 10:00:09.294 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****xn6g"
    },
    {
      "TokenType": "code",
      "TokenValue": "****f732"
    }
  ],
  "ActivityId": "0HLD5OAV2A8C7:00000018",
  "TimeStamp": "2018-04-19T07:00:09Z",
  "ProcessId": 32512,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:00:09.303 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_95Y4wooHyd8FW5wo_AURfkkbFOu01WuObuhvSbgsiU1c0_ceC78LVKNR_xPYpK6Q7PcF6JFBEtHikF9c-hHOiVv5BZr9rb_qsmFI26R-WgKgKW3E7jHZS1vJsVPfsJQCg4DL1XGsb93szXERnNG4BV3qwV2BXYgy-zpbvU1devMZQ0UqPLL-gfBHV7uBv_rf_xT-Y_ln-t3hC9QlQr3nKgzDZuD5MDA9-no4K7c3pEJOBwz8PMZWItE9KbrPqh0TIfmqJ0smF4x1NB-0Fgvt8vCJJ87uoaxSJkb-FaYAoC9Ddub7-T6ZZGcoRgyZWuDKLw",
  "Scope": "openid profile api1 offline_access"
}
2018-04-19 10:00:09.319 +03:00 [DBG] Augmenting SignInContext
2018-04-19 10:00:09.320 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 10:00:09.545 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-19 10:00:09.549 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-19 10:00:09.553 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-19 10:00:09.565 +03:00 [DBG] Start token request.
2018-04-19 10:00:09.572 +03:00 [DBG] Start client validation
2018-04-19 10:00:09.581 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-19 10:00:09.589 +03:00 [DBG] Start parsing for secret in post body
2018-04-19 10:00:09.590 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-19 10:00:09.591 +03:00 [DBG] Secret id found: mvc
2018-04-19 10:00:09.605 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-19 10:00:09.606 +03:00 [DBG] Client validation success
2018-04-19 10:00:09.613 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD5OAV2A8C8:00000003",
  "TimeStamp": "2018-04-19T07:00:09Z",
  "ProcessId": 32512,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:00:09.627 +03:00 [DBG] Start token request validation
2018-04-19 10:00:09.643 +03:00 [DBG] Start validation of authorization code token request
2018-04-19 10:00:09.750 +03:00 [DBG] Validation of authorization code token request success
2018-04-19 10:00:09.758 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "e5798b15fffa4a7c1ecbdfbb55114f30600e347d6c0bc769915f6dd0f331f732",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "e5798b15fffa4a7c1ecbdfbb55114f30600e347d6c0bc769915f6dd0f331f732",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-19 10:00:09.786 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-19 10:00:09.788 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:00:09.936 +03:00 [DBG] Creating refresh token
2018-04-19 10:00:09.937 +03:00 [DBG] Setting an absolute lifetime: 2592000
2018-04-19 10:00:09.958 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-19 10:00:09.963 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 10:00:09.967 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****WhrA"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****15ab"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****5Sog"
    }
  ],
  "ActivityId": "0HLD5OAV2A8C8:00000003",
  "TimeStamp": "2018-04-19T07:00:09Z",
  "ProcessId": 32512,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:00:09.975 +03:00 [DBG] Token request success.
2018-04-19 10:00:10.026 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-19 10:00:10.030 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-19 10:00:10.030 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-19 10:00:10.039 +03:00 [DBG] Start userinfo request
2018-04-19 10:00:10.042 +03:00 [DBG] Bearer token found in header
2018-04-19 10:00:10.127 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 10:00:10.130 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524121209,
    "exp": 1524124809,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524121199,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2018-04-19 10:00:10.140 +03:00 [DBG] Creating userinfo response
2018-04-19 10:00:10.144 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-19 10:00:10.150 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-19 10:00:10.155 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-19 10:00:10.156 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-19 10:00:10.292 +03:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-04-19 10:00:10.293 +03:00 [DBG] End userinfo request
2018-04-19 10:00:16.244 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:00:16.248 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:00:16.249 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-19 10:00:16.250 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-19 10:00:16.251 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-19 10:00:16.254 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:00:16.258 +03:00 [DBG] Start end session request validation
2018-04-19 10:00:16.260 +03:00 [DBG] Start identity token validation
2018-04-19 10:00:16.261 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-19 10:00:16.345 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 10:00:16.347 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524121209,
    "exp": 1524121509,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636597179900794189.YmVkNWY4MDAtNjViMS00MGY0LTk2ZmEtODI3YzdhMTAwNjVhZTk5NjkyNzUtMTQzMC00ZTBkLTllOTgtZDcxYjk3Mzg3YjY2",
    "iat": 1524121209,
    "at_hash": "yGUHxbnwaAcWFZwkkfLDIw",
    "sid": "880eb4400755ee962932ac6e0582f9aa",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524121199,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-19 10:00:16.353 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_94QMamE_wVEtZKTndMzgnaojFZWoZLSyiYCC5jQ9bj33VL-kBk48hxPAd8Om8wAsnUJIxxksj9Swg-zXlAyUqUQGlBS55h27icLdMH5QBpJsyxyz9bGmDdsHFrwDeaRwOaZO36ubu_iBAOvFBUG6n05",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQxMjEyMDksImV4cCI6MTUyNDEyMTUwOSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY1OTcxNzk5MDA3OTQxODkuWW1Wa05XWTRNREF0TmpWaU1TMDBNR1kwTFRrMlptRXRPREkzWXpkaE1UQXdOalZoWlRrNU5qa3lOelV0TVRRek1DMDBaVEJrTFRsbE9UZ3RaRGN4WWprM016ZzNZalkyIiwiaWF0IjoxNTI0MTIxMjA5LCJhdF9oYXNoIjoieUdVSHhibndhQWNXRlp3a2tmTERJdyIsInNpZCI6Ijg4MGViNDQwMDc1NWVlOTYyOTMyYWM2ZTA1ODJmOWFhIiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0MTIxMTk5LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.p0RlzWlSpG7i8y2oonsBd93FxVfiPP4kOqgJWzjuZ-fVAQ1Ltvu0WQENPJdVYDqUtjQpif41gldJI7BWBvdGsrVZznnQEaz69g-88YQq8HBSWPPhGH3XPi3H3PHmmy5Jx29qLxpXyaIRPwjhN_AbHBKdXDEa0KM0zwKXqMmahdXGDAmP0Y8KOqFjaswMwdyWDUIo2SHMQzGhUJkrmMD1aBKdxpOrCGYwhLITZb92K5u9LGYwoWp21el-jmUyRImEzJQ2MVpZ0n471h7k5h7CPgvf7coxKs6y0mfnicyg9pL04N9XJg47plzLXE7qbI-l8sXvyPo5gv1x9Fxkq-WhrA",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_94QMamE_wVEtZKTndMzgnaojFZWoZLSyiYCC5jQ9bj33VL-kBk48hxPAd8Om8wAsnUJIxxksj9Swg-zXlAyUqUQGlBS55h27icLdMH5QBpJsyxyz9bGmDdsHFrwDeaRwOaZO36ubu_iBAOvFBUG6n05",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 10:00:16.357 +03:00 [DBG] Success validating end session request from mvc
2018-04-19 10:00:16.363 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:00:16.364 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:00:16.371 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-19 10:00:16.372 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 10:00:16.373 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-19 10:00:16.375 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD5OAV2A8C7:0000001A",
  "TimeStamp": "2018-04-19T07:00:16Z",
  "ProcessId": 32512,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:00:16.575 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-19 10:00:16.581 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-19 10:00:16.583 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-19 10:00:16.597 +03:00 [DBG] Processing signout callback request
2018-04-19 10:00:16.609 +03:00 [DBG] No client front-channel logout URLs
2018-04-19 10:00:16.610 +03:00 [DBG] No client back-channel logout URLs
2018-04-19 10:00:16.611 +03:00 [INF] Successful signout callback.
2018-04-19 10:00:16.611 +03:00 [DBG] No client front-channel iframe urls
2018-04-19 10:00:16.612 +03:00 [DBG] No client back-channel iframe urls
2018-04-19 10:00:25.098 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-19 10:00:25.100 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-19 10:00:25.101 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-19 10:00:25.103 +03:00 [DBG] Start authorize request
2018-04-19 10:00:25.103 +03:00 [DBG] No user present in authorize request
2018-04-19 10:00:25.104 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:00:25.104 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:00:25.105 +03:00 [DBG] No PKCE used.
2018-04-19 10:00:25.106 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:00:25.107 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_94Bea0-jIexdk-7-v_YLX_UHvQEcYH5Y9A-G7EiqhlPW7MPWN1nfionGx4ibf2-Xad3vVjxNO64_H1M9WVWSDEh7ssmtFFSWoKSJJ1nWxrEQ0YuNlW2uD1R5HzPzkFRQz3uP5LQqsWoy-dXOH_fvic4ikhusoiGIwXFOkd8DarzR9d27l4yAxLeEyq66sa6ttLlavVd2p01VOQ71S1a_KvTkmPf3RFxpvCSKkNHQLsiqmJAlAG7_55-kcmPpf7XD_oicSPLgru3G2MbD7M0ik8DR9-1_2efVEYZWWyECWOz0ZPqqS0sYMzg-9E03IQIOqs",
  "Nonce": "636597180250734534.NmY0YzkxMmMtNzE0ZC00MmI0LTkyNjQtNmIxMzNkOWY2MTIxY2QxNjljYjUtY2ViZS00NTllLTk4ZDEtZTdlYjNkMGMzNjhk",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636597180250734534.NmY0YzkxMmMtNzE0ZC00MmI0LTkyNjQtNmIxMzNkOWY2MTIxY2QxNjljYjUtY2ViZS00NTllLTk4ZDEtZTdlYjNkMGMzNjhk",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_94Bea0-jIexdk-7-v_YLX_UHvQEcYH5Y9A-G7EiqhlPW7MPWN1nfionGx4ibf2-Xad3vVjxNO64_H1M9WVWSDEh7ssmtFFSWoKSJJ1nWxrEQ0YuNlW2uD1R5HzPzkFRQz3uP5LQqsWoy-dXOH_fvic4ikhusoiGIwXFOkd8DarzR9d27l4yAxLeEyq66sa6ttLlavVd2p01VOQ71S1a_KvTkmPf3RFxpvCSKkNHQLsiqmJAlAG7_55-kcmPpf7XD_oicSPLgru3G2MbD7M0ik8DR9-1_2efVEYZWWyECWOz0ZPqqS0sYMzg-9E03IQIOqs",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 10:00:25.116 +03:00 [INF] Showing login: User is not authenticated
2018-04-19 10:00:25.122 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:00:25.123 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:00:25.124 +03:00 [DBG] No PKCE used.
2018-04-19 10:00:25.124 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:00:28.199 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 10:00:28.412 +03:00 [DBG] Augmenting SignInContext
2018-04-19 10:00:28.415 +03:00 [DBG] Adding idp claim with value: local
2018-04-19 10:00:28.417 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-19 10:00:28.418 +03:00 [DBG] Adding auth_time claim with value: 1524121228
2018-04-19 10:00:28.418 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 10:00:28.486 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD5OAV2A8C7:0000001F",
  "TimeStamp": "2018-04-19T07:00:28Z",
  "ProcessId": 32512,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:00:28.495 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:00:28.499 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:00:28.500 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-19 10:00:28.500 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-19 10:00:28.501 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-19 10:00:28.502 +03:00 [DBG] Start authorize callback request
2018-04-19 10:00:28.502 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:00:28.504 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:00:28.505 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:00:28.506 +03:00 [DBG] No PKCE used.
2018-04-19 10:00:28.506 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:00:28.507 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_94Bea0-jIexdk-7-v_YLX_UHvQEcYH5Y9A-G7EiqhlPW7MPWN1nfionGx4ibf2-Xad3vVjxNO64_H1M9WVWSDEh7ssmtFFSWoKSJJ1nWxrEQ0YuNlW2uD1R5HzPzkFRQz3uP5LQqsWoy-dXOH_fvic4ikhusoiGIwXFOkd8DarzR9d27l4yAxLeEyq66sa6ttLlavVd2p01VOQ71S1a_KvTkmPf3RFxpvCSKkNHQLsiqmJAlAG7_55-kcmPpf7XD_oicSPLgru3G2MbD7M0ik8DR9-1_2efVEYZWWyECWOz0ZPqqS0sYMzg-9E03IQIOqs",
  "Nonce": "636597180250734534.NmY0YzkxMmMtNzE0ZC00MmI0LTkyNjQtNmIxMzNkOWY2MTIxY2QxNjljYjUtY2ViZS00NTllLTk4ZDEtZTdlYjNkMGMzNjhk",
  "SessionId": "ac9ecdd0a2e2e25f45cdac0f596ecb42",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636597180250734534.NmY0YzkxMmMtNzE0ZC00MmI0LTkyNjQtNmIxMzNkOWY2MTIxY2QxNjljYjUtY2ViZS00NTllLTk4ZDEtZTdlYjNkMGMzNjhk",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_94Bea0-jIexdk-7-v_YLX_UHvQEcYH5Y9A-G7EiqhlPW7MPWN1nfionGx4ibf2-Xad3vVjxNO64_H1M9WVWSDEh7ssmtFFSWoKSJJ1nWxrEQ0YuNlW2uD1R5HzPzkFRQz3uP5LQqsWoy-dXOH_fvic4ikhusoiGIwXFOkd8DarzR9d27l4yAxLeEyq66sa6ttLlavVd2p01VOQ71S1a_KvTkmPf3RFxpvCSKkNHQLsiqmJAlAG7_55-kcmPpf7XD_oicSPLgru3G2MbD7M0ik8DR9-1_2efVEYZWWyECWOz0ZPqqS0sYMzg-9E03IQIOqs",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 10:00:28.577 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-19 10:00:28.578 +03:00 [INF] Showing consent: User has not yet consented
2018-04-19 10:00:28.583 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:00:28.585 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:00:28.586 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:00:28.587 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:00:28.589 +03:00 [DBG] No PKCE used.
2018-04-19 10:00:28.591 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:02:47.451 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 10:02:47.501 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 10:02:47.505 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 10:02:47.506 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 10:02:47.506 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 10:02:47.506 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 10:02:47.981 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:02:48.001 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:05.926 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:05.928 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:05.940 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-19 10:03:05.949 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-19 10:03:05.951 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-19 10:03:05.961 +03:00 [DBG] Start authorize request
2018-04-19 10:03:05.974 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:03:05.980 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:03:05.996 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:03:05.999 +03:00 [DBG] No PKCE used.
2018-04-19 10:03:06.045 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:03:06.128 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_97qgTO4XHC9DOIVVlKfET6rXgCEsxGvXxbGrrJnNTeQa5mQaSFCk9i8dDG0YZt2TFNWrYLsKb0-_A31BHmini1Ud4mE10EBRiIrusqR2hC6432NkrHHmqXK2-L9bjxbNUjtdOz7ea5axZfNCNXGel8HA5bIsHRIADJIiHAPVE0_ZIt4LRvkqzyOLbsoVRS9eY3Tn9vNNZGZQIqQSTxgw7t5pePMCV7dIofFiDwUFMLQLqfX1fykEgHN4AyNGsz1PeeVW6NUHv4ARtokzeXDY8JkVwAg2zLswOXYSzq2Yvr0ikVmcjou2bPLSdloFv9kpRk",
  "Nonce": "636597181859174470.YzM2M2NkMDYtM2Q1My00NTM0LTkzOWUtOTU1OTRjOWJkMDkyYjYwODIwMmMtMmY3Ny00ZDU1LWJmMTMtMTE0MTQ2NWIyM2Q5",
  "SessionId": "ac9ecdd0a2e2e25f45cdac0f596ecb42",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636597181859174470.YzM2M2NkMDYtM2Q1My00NTM0LTkzOWUtOTU1OTRjOWJkMDkyYjYwODIwMmMtMmY3Ny00ZDU1LWJmMTMtMTE0MTQ2NWIyM2Q5",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_97qgTO4XHC9DOIVVlKfET6rXgCEsxGvXxbGrrJnNTeQa5mQaSFCk9i8dDG0YZt2TFNWrYLsKb0-_A31BHmini1Ud4mE10EBRiIrusqR2hC6432NkrHHmqXK2-L9bjxbNUjtdOz7ea5axZfNCNXGel8HA5bIsHRIADJIiHAPVE0_ZIt4LRvkqzyOLbsoVRS9eY3Tn9vNNZGZQIqQSTxgw7t5pePMCV7dIofFiDwUFMLQLqfX1fykEgHN4AyNGsz1PeeVW6NUHv4ARtokzeXDY8JkVwAg2zLswOXYSzq2Yvr0ikVmcjou2bPLSdloFv9kpRk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 10:03:07.320 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-19 10:03:07.320 +03:00 [INF] Showing consent: User has not yet consented
2018-04-19 10:03:07.337 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:07.338 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:07.411 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:03:07.412 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:03:07.415 +03:00 [DBG] No PKCE used.
2018-04-19 10:03:07.417 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:03:10.059 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 10:03:10.063 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:10.065 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:10.113 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:03:10.114 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:03:10.114 +03:00 [DBG] No PKCE used.
2018-04-19 10:03:10.117 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:03:10.149 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:10.151 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:10.152 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-19 10:03:10.155 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-19 10:03:10.156 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-19 10:03:10.163 +03:00 [DBG] Start authorize callback request
2018-04-19 10:03:10.192 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:03:10.193 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:03:10.195 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:03:10.199 +03:00 [DBG] No PKCE used.
2018-04-19 10:03:10.201 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:03:10.204 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_97qgTO4XHC9DOIVVlKfET6rXgCEsxGvXxbGrrJnNTeQa5mQaSFCk9i8dDG0YZt2TFNWrYLsKb0-_A31BHmini1Ud4mE10EBRiIrusqR2hC6432NkrHHmqXK2-L9bjxbNUjtdOz7ea5axZfNCNXGel8HA5bIsHRIADJIiHAPVE0_ZIt4LRvkqzyOLbsoVRS9eY3Tn9vNNZGZQIqQSTxgw7t5pePMCV7dIofFiDwUFMLQLqfX1fykEgHN4AyNGsz1PeeVW6NUHv4ARtokzeXDY8JkVwAg2zLswOXYSzq2Yvr0ikVmcjou2bPLSdloFv9kpRk",
  "Nonce": "636597181859174470.YzM2M2NkMDYtM2Q1My00NTM0LTkzOWUtOTU1OTRjOWJkMDkyYjYwODIwMmMtMmY3Ny00ZDU1LWJmMTMtMTE0MTQ2NWIyM2Q5",
  "SessionId": "ac9ecdd0a2e2e25f45cdac0f596ecb42",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636597181859174470.YzM2M2NkMDYtM2Q1My00NTM0LTkzOWUtOTU1OTRjOWJkMDkyYjYwODIwMmMtMmY3Ny00ZDU1LWJmMTMtMTE0MTQ2NWIyM2Q5",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_97qgTO4XHC9DOIVVlKfET6rXgCEsxGvXxbGrrJnNTeQa5mQaSFCk9i8dDG0YZt2TFNWrYLsKb0-_A31BHmini1Ud4mE10EBRiIrusqR2hC6432NkrHHmqXK2-L9bjxbNUjtdOz7ea5axZfNCNXGel8HA5bIsHRIADJIiHAPVE0_ZIt4LRvkqzyOLbsoVRS9eY3Tn9vNNZGZQIqQSTxgw7t5pePMCV7dIofFiDwUFMLQLqfX1fykEgHN4AyNGsz1PeeVW6NUHv4ARtokzeXDY8JkVwAg2zLswOXYSzq2Yvr0ikVmcjou2bPLSdloFv9kpRk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 10:03:10.284 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-19 10:03:10.298 +03:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2018-04-19 10:03:10.313 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2018-04-19 10:03:10.319 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:03:10.345 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-19 10:03:10.382 +03:00 [DBG] Creating Implicit Flow response.
2018-04-19 10:03:10.393 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-19 10:03:10.400 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 10:03:10.499 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****5fuA"
    },
    {
      "TokenType": "code",
      "TokenValue": "****4eb8"
    }
  ],
  "ActivityId": "0HLD5OE7DJNFJ:00000005",
  "TimeStamp": "2018-04-19T07:03:10Z",
  "ProcessId": 29636,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:03:10.509 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_97qgTO4XHC9DOIVVlKfET6rXgCEsxGvXxbGrrJnNTeQa5mQaSFCk9i8dDG0YZt2TFNWrYLsKb0-_A31BHmini1Ud4mE10EBRiIrusqR2hC6432NkrHHmqXK2-L9bjxbNUjtdOz7ea5axZfNCNXGel8HA5bIsHRIADJIiHAPVE0_ZIt4LRvkqzyOLbsoVRS9eY3Tn9vNNZGZQIqQSTxgw7t5pePMCV7dIofFiDwUFMLQLqfX1fykEgHN4AyNGsz1PeeVW6NUHv4ARtokzeXDY8JkVwAg2zLswOXYSzq2Yvr0ikVmcjou2bPLSdloFv9kpRk",
  "Scope": "openid profile api1 offline_access"
}
2018-04-19 10:03:10.545 +03:00 [DBG] Augmenting SignInContext
2018-04-19 10:03:10.554 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 10:03:10.711 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-19 10:03:10.718 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-19 10:03:10.720 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-19 10:03:10.734 +03:00 [DBG] Start token request.
2018-04-19 10:03:10.740 +03:00 [DBG] Start client validation
2018-04-19 10:03:10.748 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-19 10:03:10.752 +03:00 [DBG] Start parsing for secret in post body
2018-04-19 10:03:10.755 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-19 10:03:10.761 +03:00 [DBG] Secret id found: mvc
2018-04-19 10:03:10.774 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-19 10:03:10.775 +03:00 [DBG] Client validation success
2018-04-19 10:03:10.783 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD5OE7DJNFK:00000001",
  "TimeStamp": "2018-04-19T07:03:10Z",
  "ProcessId": 29636,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:03:10.795 +03:00 [DBG] Start token request validation
2018-04-19 10:03:10.809 +03:00 [DBG] Start validation of authorization code token request
2018-04-19 10:03:10.925 +03:00 [DBG] Validation of authorization code token request success
2018-04-19 10:03:10.935 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "6b36e5542699c1541cba09d627203aab60a357bea7e660f07faeaf3219274eb8",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "6b36e5542699c1541cba09d627203aab60a357bea7e660f07faeaf3219274eb8",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-19 10:03:10.963 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-19 10:03:10.964 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:03:11.216 +03:00 [DBG] Creating refresh token
2018-04-19 10:03:11.217 +03:00 [DBG] Setting an absolute lifetime: 2592000
2018-04-19 10:03:11.237 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-19 10:03:11.240 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 10:03:11.245 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****-RWw"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****355c"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****5FMg"
    }
  ],
  "ActivityId": "0HLD5OE7DJNFK:00000001",
  "TimeStamp": "2018-04-19T07:03:11Z",
  "ProcessId": 29636,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:03:11.249 +03:00 [DBG] Token request success.
2018-04-19 10:03:11.264 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-19 10:03:11.268 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-19 10:03:11.271 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-19 10:03:11.280 +03:00 [DBG] Start userinfo request
2018-04-19 10:03:11.284 +03:00 [DBG] Bearer token found in header
2018-04-19 10:03:11.440 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 10:03:11.450 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524121391,
    "exp": 1524124991,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524121228,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2018-04-19 10:03:11.461 +03:00 [DBG] Creating userinfo response
2018-04-19 10:03:11.470 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-19 10:03:11.475 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-19 10:03:11.481 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-19 10:03:11.482 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-19 10:03:11.649 +03:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-04-19 10:03:11.654 +03:00 [DBG] End userinfo request
2018-04-19 10:03:24.409 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-19 10:03:24.411 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-19 10:03:24.413 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-19 10:03:24.414 +03:00 [DBG] Start token request.
2018-04-19 10:03:24.415 +03:00 [DBG] Start client validation
2018-04-19 10:03:24.419 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-19 10:03:24.422 +03:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-04-19 10:03:24.422 +03:00 [DBG] Secret id found: mvc
2018-04-19 10:03:24.423 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-19 10:03:24.424 +03:00 [DBG] Client validation success
2018-04-19 10:03:24.424 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD5OE7DJNFL:00000001",
  "TimeStamp": "2018-04-19T07:03:24Z",
  "ProcessId": 29636,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:03:24.426 +03:00 [DBG] Start token request validation
2018-04-19 10:03:24.433 +03:00 [DBG] Start client credentials token request validation
2018-04-19 10:03:24.440 +03:00 [DBG] mvc credentials token request validation success
2018-04-19 10:03:24.440 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "client_credentials",
  "Scopes": "api1",
  "Raw": {
    "grant_type": "client_credentials",
    "scope": "api1"
  }
}
2018-04-19 10:03:24.446 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-19 10:03:24.451 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "api1",
  "GrantType": "client_credentials",
  "Tokens": [
    {
      "TokenType": "access_token",
      "TokenValue": "****gX6Q"
    }
  ],
  "ActivityId": "0HLD5OE7DJNFL:00000001",
  "TimeStamp": "2018-04-19T07:03:24Z",
  "ProcessId": 29636,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:03:24.453 +03:00 [DBG] Token request success.
2018-04-19 10:03:30.486 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:30.493 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:30.494 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-19 10:03:30.498 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-19 10:03:30.500 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-19 10:03:30.509 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:03:30.517 +03:00 [DBG] Start end session request validation
2018-04-19 10:03:30.525 +03:00 [DBG] Start identity token validation
2018-04-19 10:03:30.528 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-19 10:03:30.670 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 10:03:30.673 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524121391,
    "exp": 1524121691,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636597181859174470.YzM2M2NkMDYtM2Q1My00NTM0LTkzOWUtOTU1OTRjOWJkMDkyYjYwODIwMmMtMmY3Ny00ZDU1LWJmMTMtMTE0MTQ2NWIyM2Q5",
    "iat": 1524121391,
    "at_hash": "SF08ZIq_fpLqg-pgeG_MEg",
    "sid": "ac9ecdd0a2e2e25f45cdac0f596ecb42",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524121228,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-19 10:03:30.687 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_97TNro8Pifnu9xSoSewluw5zzHhRS9hkx2xaivtCRPKVDqlXbukVDQ0H2iQ-qARvK0EdFBsY__LkdwXqbdf0NQCw_xVCetOQAX_uV0djBQeWHzdx8H9Mb7rhMq7EeQBAR1UEUQxC8PKpvI9peETVpu1",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQxMjEzOTEsImV4cCI6MTUyNDEyMTY5MSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY1OTcxODE4NTkxNzQ0NzAuWXpNMk0yTmtNRFl0TTJRMU15MDBOVE0wTFRrek9XVXRPVFUxT1RSak9XSmtNRGt5WWpZd09ESXdNbU10TW1ZM055MDBaRFUxTFdKbU1UTXRNVEUwTVRRMk5XSXlNMlE1IiwiaWF0IjoxNTI0MTIxMzkxLCJhdF9oYXNoIjoiU0YwOFpJcV9mcExxZy1wZ2VHX01FZyIsInNpZCI6ImFjOWVjZGQwYTJlMmUyNWY0NWNkYWMwZjU5NmVjYjQyIiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0MTIxMjI4LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.QKz4ZnkaXiFXxSo-vmqoYvb1aYf41tSlOwDyZ-8eHRKAt7CvMC0Bj9PV-JQaS9UsyUVbYyrGGkUTL2Adra7b2IXlU30OdtBFtEURMiogoAD9I4e0gBK_w_wxUDgqf9dQ_F-qkY-eXJzcpbYUl0lbK2idkJkjfIcBHy1b0u5BxkBvJue_e5GJIBnvWDnGPvZoxqbMqOJ9Ko8iN9RKb8EOp7ACx59ib9GPyXLYDqbavrGU-aW_vgXG3Wl-kKVrB0oc6_M4DxuyyC7h-Jca1w6kHwWf1hhVmv3u-DRNERAS6DoCMMzujnGe3X_y_tFtOkJEZFYWzQfEHtm0YIaeSP-RWw",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_97TNro8Pifnu9xSoSewluw5zzHhRS9hkx2xaivtCRPKVDqlXbukVDQ0H2iQ-qARvK0EdFBsY__LkdwXqbdf0NQCw_xVCetOQAX_uV0djBQeWHzdx8H9Mb7rhMq7EeQBAR1UEUQxC8PKpvI9peETVpu1",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 10:03:30.695 +03:00 [DBG] Success validating end session request from mvc
2018-04-19 10:03:30.718 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:30.720 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:30.764 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-19 10:03:30.767 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 10:03:30.769 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-19 10:03:30.778 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD5OE7DJNFJ:00000007",
  "TimeStamp": "2018-04-19T07:03:30Z",
  "ProcessId": 29636,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:03:31.040 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-19 10:03:31.045 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-19 10:03:31.047 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-19 10:03:31.057 +03:00 [DBG] Processing signout callback request
2018-04-19 10:03:31.070 +03:00 [DBG] No client front-channel logout URLs
2018-04-19 10:03:31.072 +03:00 [DBG] No client back-channel logout URLs
2018-04-19 10:03:31.077 +03:00 [INF] Successful signout callback.
2018-04-19 10:03:31.080 +03:00 [DBG] No client front-channel iframe urls
2018-04-19 10:03:31.082 +03:00 [DBG] No client back-channel iframe urls
2018-04-19 10:03:35.722 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-19 10:03:35.725 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-19 10:03:35.731 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-19 10:03:35.737 +03:00 [DBG] Start authorize request
2018-04-19 10:03:35.739 +03:00 [DBG] No user present in authorize request
2018-04-19 10:03:35.743 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:03:35.745 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:03:35.746 +03:00 [DBG] No PKCE used.
2018-04-19 10:03:35.748 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:03:35.751 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_97krIoZKYPAkDEHxDARWT4WIYNAnppf2KnNfjfZo7zA0n3jS_GFVb5Nd0SH5m5kS8mgxC7SdoXkjZCV2p5f3IBguFUT4z47Fj499QUcapQpbP7qSVJ5XxGcYRnMVjlRTNbo8-fh4xSJDJHleNeDsd3gfZVYXapHrB5LxwQXu1SkBeWoqfc58iFYuHvKAPpvpRFwl-2bOp0NFNCyUDB4Kk63m5_QJazOwwnVrIYt3wopoMPnPyWgoQD2HlK1OZRaSAPcj5cRDyY1qQVfSFGPC2FReLyjgyRO2_-iebEEKxKdXfTaH_y4wXbnbau0Ot9dpuc",
  "Nonce": "636597182157137863.MjhjMDFhZGMtYjczYS00YjcyLThiOTItOWQyZTZjMmJlMzhhZDI3MzNhY2EtOWY0Yi00NDJlLWE1NzgtOTMyMDYzY2MwNGY4",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636597182157137863.MjhjMDFhZGMtYjczYS00YjcyLThiOTItOWQyZTZjMmJlMzhhZDI3MzNhY2EtOWY0Yi00NDJlLWE1NzgtOTMyMDYzY2MwNGY4",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_97krIoZKYPAkDEHxDARWT4WIYNAnppf2KnNfjfZo7zA0n3jS_GFVb5Nd0SH5m5kS8mgxC7SdoXkjZCV2p5f3IBguFUT4z47Fj499QUcapQpbP7qSVJ5XxGcYRnMVjlRTNbo8-fh4xSJDJHleNeDsd3gfZVYXapHrB5LxwQXu1SkBeWoqfc58iFYuHvKAPpvpRFwl-2bOp0NFNCyUDB4Kk63m5_QJazOwwnVrIYt3wopoMPnPyWgoQD2HlK1OZRaSAPcj5cRDyY1qQVfSFGPC2FReLyjgyRO2_-iebEEKxKdXfTaH_y4wXbnbau0Ot9dpuc",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 10:03:35.765 +03:00 [INF] Showing login: User is not authenticated
2018-04-19 10:03:35.787 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:03:35.788 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:03:35.790 +03:00 [DBG] No PKCE used.
2018-04-19 10:03:35.791 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:03:41.584 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 10:03:41.848 +03:00 [DBG] Augmenting SignInContext
2018-04-19 10:03:41.849 +03:00 [DBG] Adding idp claim with value: local
2018-04-19 10:03:41.851 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-19 10:03:41.853 +03:00 [DBG] Adding auth_time claim with value: 1524121421
2018-04-19 10:03:41.856 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 10:03:41.942 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD5OE7DJNFJ:0000000B",
  "TimeStamp": "2018-04-19T07:03:41Z",
  "ProcessId": 29636,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:03:41.954 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:41.958 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:41.962 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-19 10:03:41.964 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-19 10:03:41.966 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-19 10:03:41.969 +03:00 [DBG] Start authorize callback request
2018-04-19 10:03:41.970 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:03:41.971 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:03:41.971 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:03:41.972 +03:00 [DBG] No PKCE used.
2018-04-19 10:03:41.973 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:03:41.974 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_97krIoZKYPAkDEHxDARWT4WIYNAnppf2KnNfjfZo7zA0n3jS_GFVb5Nd0SH5m5kS8mgxC7SdoXkjZCV2p5f3IBguFUT4z47Fj499QUcapQpbP7qSVJ5XxGcYRnMVjlRTNbo8-fh4xSJDJHleNeDsd3gfZVYXapHrB5LxwQXu1SkBeWoqfc58iFYuHvKAPpvpRFwl-2bOp0NFNCyUDB4Kk63m5_QJazOwwnVrIYt3wopoMPnPyWgoQD2HlK1OZRaSAPcj5cRDyY1qQVfSFGPC2FReLyjgyRO2_-iebEEKxKdXfTaH_y4wXbnbau0Ot9dpuc",
  "Nonce": "636597182157137863.MjhjMDFhZGMtYjczYS00YjcyLThiOTItOWQyZTZjMmJlMzhhZDI3MzNhY2EtOWY0Yi00NDJlLWE1NzgtOTMyMDYzY2MwNGY4",
  "SessionId": "b3ae3bc4cad1255cb72d9db5c46bf476",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636597182157137863.MjhjMDFhZGMtYjczYS00YjcyLThiOTItOWQyZTZjMmJlMzhhZDI3MzNhY2EtOWY0Yi00NDJlLWE1NzgtOTMyMDYzY2MwNGY4",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_97krIoZKYPAkDEHxDARWT4WIYNAnppf2KnNfjfZo7zA0n3jS_GFVb5Nd0SH5m5kS8mgxC7SdoXkjZCV2p5f3IBguFUT4z47Fj499QUcapQpbP7qSVJ5XxGcYRnMVjlRTNbo8-fh4xSJDJHleNeDsd3gfZVYXapHrB5LxwQXu1SkBeWoqfc58iFYuHvKAPpvpRFwl-2bOp0NFNCyUDB4Kk63m5_QJazOwwnVrIYt3wopoMPnPyWgoQD2HlK1OZRaSAPcj5cRDyY1qQVfSFGPC2FReLyjgyRO2_-iebEEKxKdXfTaH_y4wXbnbau0Ot9dpuc",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 10:03:42.055 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-19 10:03:42.055 +03:00 [INF] Showing consent: User has not yet consented
2018-04-19 10:03:42.063 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:42.065 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:42.068 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:03:42.069 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:03:42.069 +03:00 [DBG] No PKCE used.
2018-04-19 10:03:42.070 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:03:46.404 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 10:03:46.409 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:46.411 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:46.416 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:03:46.419 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:03:46.420 +03:00 [DBG] No PKCE used.
2018-04-19 10:03:46.421 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:03:46.430 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:46.431 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:46.433 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-19 10:03:46.436 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-19 10:03:46.437 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-19 10:03:46.441 +03:00 [DBG] Start authorize callback request
2018-04-19 10:03:46.441 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:03:46.442 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:03:46.443 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:03:46.443 +03:00 [DBG] No PKCE used.
2018-04-19 10:03:46.444 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:03:46.445 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_97krIoZKYPAkDEHxDARWT4WIYNAnppf2KnNfjfZo7zA0n3jS_GFVb5Nd0SH5m5kS8mgxC7SdoXkjZCV2p5f3IBguFUT4z47Fj499QUcapQpbP7qSVJ5XxGcYRnMVjlRTNbo8-fh4xSJDJHleNeDsd3gfZVYXapHrB5LxwQXu1SkBeWoqfc58iFYuHvKAPpvpRFwl-2bOp0NFNCyUDB4Kk63m5_QJazOwwnVrIYt3wopoMPnPyWgoQD2HlK1OZRaSAPcj5cRDyY1qQVfSFGPC2FReLyjgyRO2_-iebEEKxKdXfTaH_y4wXbnbau0Ot9dpuc",
  "Nonce": "636597182157137863.MjhjMDFhZGMtYjczYS00YjcyLThiOTItOWQyZTZjMmJlMzhhZDI3MzNhY2EtOWY0Yi00NDJlLWE1NzgtOTMyMDYzY2MwNGY4",
  "SessionId": "b3ae3bc4cad1255cb72d9db5c46bf476",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636597182157137863.MjhjMDFhZGMtYjczYS00YjcyLThiOTItOWQyZTZjMmJlMzhhZDI3MzNhY2EtOWY0Yi00NDJlLWE1NzgtOTMyMDYzY2MwNGY4",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_97krIoZKYPAkDEHxDARWT4WIYNAnppf2KnNfjfZo7zA0n3jS_GFVb5Nd0SH5m5kS8mgxC7SdoXkjZCV2p5f3IBguFUT4z47Fj499QUcapQpbP7qSVJ5XxGcYRnMVjlRTNbo8-fh4xSJDJHleNeDsd3gfZVYXapHrB5LxwQXu1SkBeWoqfc58iFYuHvKAPpvpRFwl-2bOp0NFNCyUDB4Kk63m5_QJazOwwnVrIYt3wopoMPnPyWgoQD2HlK1OZRaSAPcj5cRDyY1qQVfSFGPC2FReLyjgyRO2_-iebEEKxKdXfTaH_y4wXbnbau0Ot9dpuc",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 10:03:46.523 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-19 10:03:46.523 +03:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2018-04-19 10:03:46.526 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2018-04-19 10:03:46.528 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:03:46.533 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-19 10:03:46.546 +03:00 [DBG] Creating Implicit Flow response.
2018-04-19 10:03:46.546 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-19 10:03:46.548 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 10:03:46.553 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****4Vlw"
    },
    {
      "TokenType": "code",
      "TokenValue": "****77d0"
    }
  ],
  "ActivityId": "0HLD5OE7DJNFJ:0000000F",
  "TimeStamp": "2018-04-19T07:03:46Z",
  "ProcessId": 29636,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:03:46.557 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_97krIoZKYPAkDEHxDARWT4WIYNAnppf2KnNfjfZo7zA0n3jS_GFVb5Nd0SH5m5kS8mgxC7SdoXkjZCV2p5f3IBguFUT4z47Fj499QUcapQpbP7qSVJ5XxGcYRnMVjlRTNbo8-fh4xSJDJHleNeDsd3gfZVYXapHrB5LxwQXu1SkBeWoqfc58iFYuHvKAPpvpRFwl-2bOp0NFNCyUDB4Kk63m5_QJazOwwnVrIYt3wopoMPnPyWgoQD2HlK1OZRaSAPcj5cRDyY1qQVfSFGPC2FReLyjgyRO2_-iebEEKxKdXfTaH_y4wXbnbau0Ot9dpuc",
  "Scope": "openid profile api1 offline_access"
}
2018-04-19 10:03:46.559 +03:00 [DBG] Augmenting SignInContext
2018-04-19 10:03:46.560 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 10:03:47.025 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-19 10:03:47.027 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-19 10:03:47.028 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-19 10:03:47.029 +03:00 [DBG] Start token request.
2018-04-19 10:03:47.029 +03:00 [DBG] Start client validation
2018-04-19 10:03:47.030 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-19 10:03:47.031 +03:00 [DBG] Start parsing for secret in post body
2018-04-19 10:03:47.031 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-19 10:03:47.032 +03:00 [DBG] Secret id found: mvc
2018-04-19 10:03:47.032 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-19 10:03:47.033 +03:00 [DBG] Client validation success
2018-04-19 10:03:47.034 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD5OE7DJNFK:00000003",
  "TimeStamp": "2018-04-19T07:03:47Z",
  "ProcessId": 29636,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:03:47.041 +03:00 [DBG] Start token request validation
2018-04-19 10:03:47.042 +03:00 [DBG] Start validation of authorization code token request
2018-04-19 10:03:47.127 +03:00 [DBG] Validation of authorization code token request success
2018-04-19 10:03:47.127 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "58fafdf79f5ae8ec91074b7224914b28bdfbef57330db5ee8b360e305f4e77d0",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "58fafdf79f5ae8ec91074b7224914b28bdfbef57330db5ee8b360e305f4e77d0",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-19 10:03:47.132 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-19 10:03:47.133 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:03:47.281 +03:00 [DBG] Creating refresh token
2018-04-19 10:03:47.281 +03:00 [DBG] Setting an absolute lifetime: 2592000
2018-04-19 10:03:47.294 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-19 10:03:47.295 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 10:03:47.300 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****4GPw"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****2169"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****QPwg"
    }
  ],
  "ActivityId": "0HLD5OE7DJNFK:00000003",
  "TimeStamp": "2018-04-19T07:03:47Z",
  "ProcessId": 29636,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:03:47.305 +03:00 [DBG] Token request success.
2018-04-19 10:03:47.308 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-19 10:03:47.310 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-19 10:03:47.311 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-19 10:03:47.312 +03:00 [DBG] Start userinfo request
2018-04-19 10:03:47.316 +03:00 [DBG] Bearer token found in header
2018-04-19 10:03:47.393 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 10:03:47.395 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524121427,
    "exp": 1524125027,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524121421,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2018-04-19 10:03:47.398 +03:00 [DBG] Creating userinfo response
2018-04-19 10:03:47.399 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-19 10:03:47.404 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-19 10:03:47.412 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-19 10:03:47.412 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-19 10:03:47.590 +03:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-04-19 10:03:47.593 +03:00 [DBG] End userinfo request
2018-04-19 10:03:51.766 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:51.769 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:51.774 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-19 10:03:51.775 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-19 10:03:51.776 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-19 10:03:51.777 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:03:51.781 +03:00 [DBG] Start end session request validation
2018-04-19 10:03:51.781 +03:00 [DBG] Start identity token validation
2018-04-19 10:03:51.782 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-19 10:03:51.855 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 10:03:51.857 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524121427,
    "exp": 1524121727,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636597182157137863.MjhjMDFhZGMtYjczYS00YjcyLThiOTItOWQyZTZjMmJlMzhhZDI3MzNhY2EtOWY0Yi00NDJlLWE1NzgtOTMyMDYzY2MwNGY4",
    "iat": 1524121427,
    "at_hash": "jqeL6SgReRhjph20RaGx8A",
    "sid": "b3ae3bc4cad1255cb72d9db5c46bf476",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524121421,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-19 10:03:51.860 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_96dn_8DY8nRZdBb019b9qzURGnZlQqGjbvDcfE9Jlwkkc0udcP9y4yNRyUs3AfcnuZrbSAYeqOqJCEl8B5FiDB3_6eeVZ3kIUrN3n2Sm3I1tQVUSI9SV8cggUwuTBrD4OLc3vX_45wk1qJp0-0HYsdL",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQxMjE0MjcsImV4cCI6MTUyNDEyMTcyNywiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY1OTcxODIxNTcxMzc4NjMuTWpoak1ERmhaR010WWpjellTMDBZamN5TFRoaU9USXRPV1F5WlRaak1tSmxNemhoWkRJM016TmhZMkV0T1dZMFlpMDBOREpsTFdFMU56Z3RPVE15TURZelkyTXdOR1k0IiwiaWF0IjoxNTI0MTIxNDI3LCJhdF9oYXNoIjoianFlTDZTZ1JlUmhqcGgyMFJhR3g4QSIsInNpZCI6ImIzYWUzYmM0Y2FkMTI1NWNiNzJkOWRiNWM0NmJmNDc2Iiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0MTIxNDIxLCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.dvbptPnOm2VI9iyJR1co8lA05Knf0csIfsvNYecZyO4vReDKwquZB3xi5v_SwwZnzcxdQsQPlJ2ZQzPpzV0E8ftZkVlmE6o2UQJN18gvc45S92DSpgpiPCM8bfoJspT3s9zHt_79Tzw6Te9zVft1H1QP4gdIxBR40dkGCPsGzMCp7qrPjHKfJS82Wy3nL2Va0MWtNLlnQd6KzsYUABUO8GPyDWG1ofjlQb0BCkM10-kjd5ExRpVnL173zIuf3s2bTEvqkQJYB9ZXtD0s2We1150wCjdEjiQ0eSgLWl9uSA2P68ZJ8lR_C6tJWb4elhaW8Yr6yNjB7NaPnhRoyI4GPw",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_96dn_8DY8nRZdBb019b9qzURGnZlQqGjbvDcfE9Jlwkkc0udcP9y4yNRyUs3AfcnuZrbSAYeqOqJCEl8B5FiDB3_6eeVZ3kIUrN3n2Sm3I1tQVUSI9SV8cggUwuTBrD4OLc3vX_45wk1qJp0-0HYsdL",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 10:03:51.865 +03:00 [DBG] Success validating end session request from mvc
2018-04-19 10:03:51.870 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:51.872 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:03:51.874 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-19 10:03:51.875 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 10:03:51.876 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-19 10:03:51.877 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD5OE7DJNFJ:00000011",
  "TimeStamp": "2018-04-19T07:03:51Z",
  "ProcessId": 29636,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:03:52.037 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-19 10:03:52.042 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-19 10:03:52.043 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-19 10:03:52.044 +03:00 [DBG] Processing signout callback request
2018-04-19 10:03:52.046 +03:00 [DBG] No client front-channel logout URLs
2018-04-19 10:03:52.046 +03:00 [DBG] No client back-channel logout URLs
2018-04-19 10:03:52.047 +03:00 [INF] Successful signout callback.
2018-04-19 10:03:52.047 +03:00 [DBG] No client front-channel iframe urls
2018-04-19 10:03:52.048 +03:00 [DBG] No client back-channel iframe urls
2018-04-19 10:04:00.440 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-19 10:04:00.447 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-19 10:04:00.449 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-19 10:04:00.451 +03:00 [DBG] Start authorize request
2018-04-19 10:04:00.452 +03:00 [DBG] No user present in authorize request
2018-04-19 10:04:00.454 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:04:00.455 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:04:00.455 +03:00 [DBG] No PKCE used.
2018-04-19 10:04:00.460 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:04:00.461 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_96MygwljDW5XAq3hhnGSPNgdU02fp-0cGqc_WOhOWU5rOTszYQiuXO4oeVgnbDrd38QDz2pOjCYezR4MP3DaBTqrNuyf-kAAjhXEiUApld-zNYTQg6O4jkX4qaWzGHOv9AfIpCofhD3WdZPCZdWoXJkgu8Ekf6XiXochXHul88l4HiZryMAGxgZahzJHyhDPvO8__BCjwYJlEnKp_U7R3u2tFXJTLlYKU_zX6BDdvmTf5wPkPM9IR4FLKaSkJuoeaSmVM64Uuw-tQTTyVPC-_3dlwM1OBwcgHWSt9N1ZypExsn6zT6v5Yri96Qy9F928GY",
  "Nonce": "636597182404343136.NGY4YmFjNjUtNTNmMS00M2M2LWI4MmMtYzVlZDg2YTk4OGJlMzk1ZmUzM2EtYWY3Ny00NGUzLTgwOTUtZDkzYzNiZDIyNzM2",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636597182404343136.NGY4YmFjNjUtNTNmMS00M2M2LWI4MmMtYzVlZDg2YTk4OGJlMzk1ZmUzM2EtYWY3Ny00NGUzLTgwOTUtZDkzYzNiZDIyNzM2",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_96MygwljDW5XAq3hhnGSPNgdU02fp-0cGqc_WOhOWU5rOTszYQiuXO4oeVgnbDrd38QDz2pOjCYezR4MP3DaBTqrNuyf-kAAjhXEiUApld-zNYTQg6O4jkX4qaWzGHOv9AfIpCofhD3WdZPCZdWoXJkgu8Ekf6XiXochXHul88l4HiZryMAGxgZahzJHyhDPvO8__BCjwYJlEnKp_U7R3u2tFXJTLlYKU_zX6BDdvmTf5wPkPM9IR4FLKaSkJuoeaSmVM64Uuw-tQTTyVPC-_3dlwM1OBwcgHWSt9N1ZypExsn6zT6v5Yri96Qy9F928GY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 10:04:00.485 +03:00 [INF] Showing login: User is not authenticated
2018-04-19 10:04:00.492 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:04:00.496 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:04:00.502 +03:00 [DBG] No PKCE used.
2018-04-19 10:04:00.503 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:04:04.512 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 10:04:04.727 +03:00 [DBG] Augmenting SignInContext
2018-04-19 10:04:04.730 +03:00 [DBG] Adding idp claim with value: local
2018-04-19 10:04:04.735 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-19 10:04:04.735 +03:00 [DBG] Adding auth_time claim with value: 1524121444
2018-04-19 10:04:04.736 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 10:04:04.807 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD5OE7DJNFP:00000009",
  "TimeStamp": "2018-04-19T07:04:04Z",
  "ProcessId": 29636,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:04:04.815 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:04:04.817 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:04:04.823 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-19 10:04:04.824 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-19 10:04:04.825 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-19 10:04:04.825 +03:00 [DBG] Start authorize callback request
2018-04-19 10:04:04.826 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:04:04.827 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:04:04.828 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:04:04.828 +03:00 [DBG] No PKCE used.
2018-04-19 10:04:04.829 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:04:04.830 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_96MygwljDW5XAq3hhnGSPNgdU02fp-0cGqc_WOhOWU5rOTszYQiuXO4oeVgnbDrd38QDz2pOjCYezR4MP3DaBTqrNuyf-kAAjhXEiUApld-zNYTQg6O4jkX4qaWzGHOv9AfIpCofhD3WdZPCZdWoXJkgu8Ekf6XiXochXHul88l4HiZryMAGxgZahzJHyhDPvO8__BCjwYJlEnKp_U7R3u2tFXJTLlYKU_zX6BDdvmTf5wPkPM9IR4FLKaSkJuoeaSmVM64Uuw-tQTTyVPC-_3dlwM1OBwcgHWSt9N1ZypExsn6zT6v5Yri96Qy9F928GY",
  "Nonce": "636597182404343136.NGY4YmFjNjUtNTNmMS00M2M2LWI4MmMtYzVlZDg2YTk4OGJlMzk1ZmUzM2EtYWY3Ny00NGUzLTgwOTUtZDkzYzNiZDIyNzM2",
  "SessionId": "0fd7bb1e73e25606bdf24c46b98dedc9",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636597182404343136.NGY4YmFjNjUtNTNmMS00M2M2LWI4MmMtYzVlZDg2YTk4OGJlMzk1ZmUzM2EtYWY3Ny00NGUzLTgwOTUtZDkzYzNiZDIyNzM2",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_96MygwljDW5XAq3hhnGSPNgdU02fp-0cGqc_WOhOWU5rOTszYQiuXO4oeVgnbDrd38QDz2pOjCYezR4MP3DaBTqrNuyf-kAAjhXEiUApld-zNYTQg6O4jkX4qaWzGHOv9AfIpCofhD3WdZPCZdWoXJkgu8Ekf6XiXochXHul88l4HiZryMAGxgZahzJHyhDPvO8__BCjwYJlEnKp_U7R3u2tFXJTLlYKU_zX6BDdvmTf5wPkPM9IR4FLKaSkJuoeaSmVM64Uuw-tQTTyVPC-_3dlwM1OBwcgHWSt9N1ZypExsn6zT6v5Yri96Qy9F928GY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 10:04:04.915 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-19 10:04:04.916 +03:00 [INF] Showing consent: User has not yet consented
2018-04-19 10:04:04.921 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:04:04.924 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:04:04.926 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:04:04.927 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:04:04.927 +03:00 [DBG] No PKCE used.
2018-04-19 10:04:04.928 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:04:09.323 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 10:04:09.326 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:04:09.328 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:04:09.331 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:04:09.332 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:04:09.333 +03:00 [DBG] No PKCE used.
2018-04-19 10:04:09.334 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:04:09.345 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:04:09.346 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 10:04:09.349 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-19 10:04:09.353 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-19 10:04:09.356 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-19 10:04:09.357 +03:00 [DBG] Start authorize callback request
2018-04-19 10:04:09.358 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:04:09.360 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 10:04:09.361 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 10:04:09.361 +03:00 [DBG] No PKCE used.
2018-04-19 10:04:09.362 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 10:04:09.363 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_96MygwljDW5XAq3hhnGSPNgdU02fp-0cGqc_WOhOWU5rOTszYQiuXO4oeVgnbDrd38QDz2pOjCYezR4MP3DaBTqrNuyf-kAAjhXEiUApld-zNYTQg6O4jkX4qaWzGHOv9AfIpCofhD3WdZPCZdWoXJkgu8Ekf6XiXochXHul88l4HiZryMAGxgZahzJHyhDPvO8__BCjwYJlEnKp_U7R3u2tFXJTLlYKU_zX6BDdvmTf5wPkPM9IR4FLKaSkJuoeaSmVM64Uuw-tQTTyVPC-_3dlwM1OBwcgHWSt9N1ZypExsn6zT6v5Yri96Qy9F928GY",
  "Nonce": "636597182404343136.NGY4YmFjNjUtNTNmMS00M2M2LWI4MmMtYzVlZDg2YTk4OGJlMzk1ZmUzM2EtYWY3Ny00NGUzLTgwOTUtZDkzYzNiZDIyNzM2",
  "SessionId": "0fd7bb1e73e25606bdf24c46b98dedc9",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636597182404343136.NGY4YmFjNjUtNTNmMS00M2M2LWI4MmMtYzVlZDg2YTk4OGJlMzk1ZmUzM2EtYWY3Ny00NGUzLTgwOTUtZDkzYzNiZDIyNzM2",
    "state": "CfDJ8D_j949MDKJJst_tAEpQ_96MygwljDW5XAq3hhnGSPNgdU02fp-0cGqc_WOhOWU5rOTszYQiuXO4oeVgnbDrd38QDz2pOjCYezR4MP3DaBTqrNuyf-kAAjhXEiUApld-zNYTQg6O4jkX4qaWzGHOv9AfIpCofhD3WdZPCZdWoXJkgu8Ekf6XiXochXHul88l4HiZryMAGxgZahzJHyhDPvO8__BCjwYJlEnKp_U7R3u2tFXJTLlYKU_zX6BDdvmTf5wPkPM9IR4FLKaSkJuoeaSmVM64Uuw-tQTTyVPC-_3dlwM1OBwcgHWSt9N1ZypExsn6zT6v5Yri96Qy9F928GY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 10:04:09.463 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-04-19 10:04:09.464 +03:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2018-04-19 10:04:09.466 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2018-04-19 10:04:09.468 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:04:09.475 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-19 10:04:09.491 +03:00 [DBG] Creating Implicit Flow response.
2018-04-19 10:04:09.492 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-19 10:04:09.494 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 10:04:09.503 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****SmUQ"
    },
    {
      "TokenType": "code",
      "TokenValue": "****b87c"
    }
  ],
  "ActivityId": "0HLD5OE7DJNFP:0000000E",
  "TimeStamp": "2018-04-19T07:04:09Z",
  "ProcessId": 29636,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:04:09.509 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8D_j949MDKJJst_tAEpQ_96MygwljDW5XAq3hhnGSPNgdU02fp-0cGqc_WOhOWU5rOTszYQiuXO4oeVgnbDrd38QDz2pOjCYezR4MP3DaBTqrNuyf-kAAjhXEiUApld-zNYTQg6O4jkX4qaWzGHOv9AfIpCofhD3WdZPCZdWoXJkgu8Ekf6XiXochXHul88l4HiZryMAGxgZahzJHyhDPvO8__BCjwYJlEnKp_U7R3u2tFXJTLlYKU_zX6BDdvmTf5wPkPM9IR4FLKaSkJuoeaSmVM64Uuw-tQTTyVPC-_3dlwM1OBwcgHWSt9N1ZypExsn6zT6v5Yri96Qy9F928GY",
  "Scope": "openid profile api1 offline_access"
}
2018-04-19 10:04:09.512 +03:00 [DBG] Augmenting SignInContext
2018-04-19 10:04:09.513 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 10:04:09.664 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-19 10:04:09.666 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-19 10:04:09.668 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-19 10:04:09.670 +03:00 [DBG] Start token request.
2018-04-19 10:04:09.671 +03:00 [DBG] Start client validation
2018-04-19 10:04:09.672 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-19 10:04:09.673 +03:00 [DBG] Start parsing for secret in post body
2018-04-19 10:04:09.674 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-19 10:04:09.677 +03:00 [DBG] Secret id found: mvc
2018-04-19 10:04:09.678 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-19 10:04:09.678 +03:00 [DBG] Client validation success
2018-04-19 10:04:09.679 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD5OE7DJNFK:00000005",
  "TimeStamp": "2018-04-19T07:04:09Z",
  "ProcessId": 29636,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:04:09.684 +03:00 [DBG] Start token request validation
2018-04-19 10:04:09.685 +03:00 [DBG] Start validation of authorization code token request
2018-04-19 10:04:09.772 +03:00 [DBG] Validation of authorization code token request success
2018-04-19 10:04:09.772 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "3f7d0c0d3d121b6d5a25c0222138d8e4dff3509cd28edda0d400e1422f27b87c",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "3f7d0c0d3d121b6d5a25c0222138d8e4dff3509cd28edda0d400e1422f27b87c",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-19 10:04:09.778 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-19 10:04:09.779 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 10:04:09.919 +03:00 [DBG] Creating refresh token
2018-04-19 10:04:09.920 +03:00 [DBG] Setting an absolute lifetime: 2592000
2018-04-19 10:04:09.932 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-19 10:04:09.934 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 10:04:09.943 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****QozQ"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****ea13"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****cnMQ"
    }
  ],
  "ActivityId": "0HLD5OE7DJNFK:00000005",
  "TimeStamp": "2018-04-19T07:04:09Z",
  "ProcessId": 29636,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 10:04:09.946 +03:00 [DBG] Token request success.
2018-04-19 10:04:09.949 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-19 10:04:09.952 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-19 10:04:09.954 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-19 10:04:09.955 +03:00 [DBG] Start userinfo request
2018-04-19 10:04:09.956 +03:00 [DBG] Bearer token found in header
2018-04-19 10:04:10.034 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 10:04:10.041 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524121449,
    "exp": 1524125049,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524121444,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2018-04-19 10:04:10.043 +03:00 [DBG] Creating userinfo response
2018-04-19 10:04:10.043 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-19 10:04:10.045 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-19 10:04:10.046 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-19 10:04:10.047 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-04-19 10:04:10.190 +03:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-04-19 10:04:10.192 +03:00 [DBG] End userinfo request
2018-04-19 13:33:06.108 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 13:33:06.157 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 13:33:06.160 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 13:33:06.161 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 13:33:06.161 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 13:33:06.161 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 13:33:06.732 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.ArgumentException: Options.ClientId must be provided
Parameter name: ClientId
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectOptions.Validate()
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.<InitializeAsync>d__42.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationHandlerProvider.<GetHandlerAsync>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOut.FederatedSignoutAuthenticationHandlerProvider.<GetHandlerAsync>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\FederatedSignOut\FederatedSignoutAuthenticationHandlerProvider.cs:line 33
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-19 13:34:37.240 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 13:34:37.303 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 13:34:37.310 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 13:34:37.315 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 13:34:37.317 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 13:34:37.320 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 13:34:40.584 +03:00 [WRN] Heartbeat took longer than ""00:00:01"" at ""2018-04-19T10:34:40.5678675+00:00"".
2018-04-19 13:34:41.955 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.ArgumentException: Options.ClientId must be provided
Parameter name: ClientId
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectOptions.Validate()
   at Microsoft.AspNetCore.Authentication.AuthenticationHandler`1.<InitializeAsync>d__42.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationHandlerProvider.<GetHandlerAsync>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOut.FederatedSignoutAuthenticationHandlerProvider.<GetHandlerAsync>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\FederatedSignOut\FederatedSignoutAuthenticationHandlerProvider.cs:line 33
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-19 13:37:40.061 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 13:37:40.133 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 13:37:40.140 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 13:37:40.143 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 13:37:40.146 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 13:37:40.149 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 13:37:59.117 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:37:59.139 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:38:15.102 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:38:15.124 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:38:17.447 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 13:38:17.455 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:38:17.460 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:38:17.535 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-19 13:38:17.543 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 13:38:17.547 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-19 13:38:18.184 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD5S69PN9H7:00000003",
  "TimeStamp": "2018-04-19T10:38:18Z",
  "ProcessId": 9524,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 13:38:19.314 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-19 13:38:19.328 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-19 13:38:19.332 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-19 13:38:19.345 +03:00 [DBG] Processing signout callback request
2018-04-19 13:38:19.388 +03:00 [DBG] No client front-channel logout URLs
2018-04-19 13:38:19.392 +03:00 [DBG] No client back-channel logout URLs
2018-04-19 13:38:19.395 +03:00 [INF] Successful signout callback.
2018-04-19 13:38:19.399 +03:00 [DBG] No client front-channel iframe urls
2018-04-19 13:38:19.402 +03:00 [DBG] No client back-channel iframe urls
2018-04-19 13:38:23.201 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 13:38:40.784 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 13:46:16.954 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 13:46:17.002 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 13:46:17.006 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 13:46:17.008 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 13:46:17.009 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 13:46:17.010 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 13:46:36.574 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-19 13:46:36.645 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-19 13:46:36.646 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-19 13:46:36.657 +03:00 [DBG] Start discovery request
2018-04-19 13:46:36.948 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-19 13:46:36.951 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-19 13:46:36.952 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-19 13:46:36.957 +03:00 [DBG] Start key discovery request
2018-04-19 13:46:37.018 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-19 13:46:37.025 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-19 13:46:37.027 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-19 13:46:37.037 +03:00 [DBG] Processing signout request for anonymous
2018-04-19 13:46:37.046 +03:00 [DBG] Start end session request validation
2018-04-19 13:46:37.053 +03:00 [DBG] Start identity token validation
2018-04-19 13:46:37.087 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-19 13:46:38.158 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 13:46:38.168 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524121449,
    "exp": 1524121749,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636597182404343136.NGY4YmFjNjUtNTNmMS00M2M2LWI4MmMtYzVlZDg2YTk4OGJlMzk1ZmUzM2EtYWY3Ny00NGUzLTgwOTUtZDkzYzNiZDIyNzM2",
    "iat": 1524121449,
    "at_hash": "FCRMpaioEaU2V8I9UXuAGg",
    "sid": "0fd7bb1e73e25606bdf24c46b98dedc9",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524121444,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-19 13:46:38.179 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "unknown",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hyJo4M0sSn2XC19WDnoGjza79lGSutgoxzwN2yKP1lsHDBJBv_qUFMrwe15Ar7fIuPqe3IBv8Jgp_KenF95FkjTFnK7oQHLQrsIYUeJfn0yqRdND5g-3hhfLdSde4YHu86deGsnggV1cicRPvfoHjOy",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQxMjE0NDksImV4cCI6MTUyNDEyMTc0OSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY1OTcxODI0MDQzNDMxMzYuTkdZNFltRmpOalV0TlRObU1TMDBNMk0yTFdJNE1tTXRZelZsWkRnMllUazRPR0psTXprMVptVXpNMkV0WVdZM055MDBOR1V6TFRnd09UVXRaRGt6WXpOaVpESXlOek0yIiwiaWF0IjoxNTI0MTIxNDQ5LCJhdF9oYXNoIjoiRkNSTXBhaW9FYVUyVjhJOVVYdUFHZyIsInNpZCI6IjBmZDdiYjFlNzNlMjU2MDZiZGYyNGM0NmI5OGRlZGM5Iiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0MTIxNDQ0LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.CwKChCyTqCk185OwG_6uOHKXQYC5WlyoNcLUbtu3mPDvMCy9mHdc0M4M7sD6xtgWZR1TRxWZEideQncm75KqJMCAIaMGww9Rmq_U9fd17LgYCStsR5KLb9SuNrIKzrVxwBsTa_1GVslSslC0QewkX-Mig8MGj5LoAwmAC2RAQdCHbWMBk4PK-aBvYeBvhCuyGAzBAe53nHnbSjVPRhStgUyCtzM3QDlKoUX4jfGChCeSJcUkw5XqS2o21IrrA_yj33zPrtcX2O8UqRiLCDlxtEPyPUEZTHZAvlL9a1O-3WkpxUsjNIwSh0W5bnBnbhBTUaWRnr9ozoG1Dyl10oQozQ",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hyJo4M0sSn2XC19WDnoGjza79lGSutgoxzwN2yKP1lsHDBJBv_qUFMrwe15Ar7fIuPqe3IBv8Jgp_KenF95FkjTFnK7oQHLQrsIYUeJfn0yqRdND5g-3hhfLdSde4YHu86deGsnggV1cicRPvfoHjOy",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 13:46:38.188 +03:00 [DBG] Success validating end session request from mvc
2018-04-19 13:46:42.073 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-19 13:46:42.082 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-19 13:46:42.084 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-19 13:46:42.092 +03:00 [DBG] Start authorize request
2018-04-19 13:46:42.105 +03:00 [DBG] No user present in authorize request
2018-04-19 13:46:42.114 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 13:46:42.127 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 13:46:42.129 +03:00 [DBG] No PKCE used.
2018-04-19 13:46:42.167 +03:00 [ERR] offline_access is not allowed for this client: mvc
2018-04-19 13:46:42.171 +03:00 [ERR] Request validation failed
2018-04-19 13:46:42.185 +03:00 [INF] {
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hwqLswOSZ5Dyg_6kneTBAmSnmZhbjXC7kg7yLunRkct9dKt2L3gDbPoRnESlbzTHXcMm8iaMxzsjEShYCN56AIvbXHob_73eWWlulUtfFoDRdL9x8aVImlHs-70nB5KtaPklbDQo9wcQa6ztH384uGwt5rKRQBseOl2ccv54Oc0qr6yEi8xbPEpU2gh-lDJAwZGNTfuYzdZwIm486PmPBgvGSEUUPj1D-ofHjvYJMZcKEhRRliuB2sMf8Tfl2jUJUxxWEviaScYLD3vfhTSIVPwPsBl7ZVkWbJfDFgazmpRN-HrH_JnHh-neTmyNoUorwo",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636597316020648478.NDVkM2M4ZTctODM0MS00ZTE0LTg0OGUtNTViNDg3ODU2Njk2MzFjZTU5Y2UtYzZjMy00Yjg1LWE1NDEtZGJkZTkwMThhNWY2",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwqLswOSZ5Dyg_6kneTBAmSnmZhbjXC7kg7yLunRkct9dKt2L3gDbPoRnESlbzTHXcMm8iaMxzsjEShYCN56AIvbXHob_73eWWlulUtfFoDRdL9x8aVImlHs-70nB5KtaPklbDQo9wcQa6ztH384uGwt5rKRQBseOl2ccv54Oc0qr6yEi8xbPEpU2gh-lDJAwZGNTfuYzdZwIm486PmPBgvGSEUUPj1D-ofHjvYJMZcKEhRRliuB2sMf8Tfl2jUJUxxWEviaScYLD3vfhTSIVPwPsBl7ZVkWbJfDFgazmpRN-HrH_JnHh-neTmyNoUorwo",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 13:46:42.233 +03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid scope",
  "ActivityId": "0HLD5SB3OU6NG:00000004",
  "TimeStamp": "2018-04-19T10:46:42Z",
  "ProcessId": 25348,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 13:47:23.619 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-19 13:47:23.622 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-19 13:47:23.623 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-19 13:47:23.624 +03:00 [DBG] Start discovery request
2018-04-19 13:47:23.881 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-19 13:47:23.883 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-19 13:47:23.884 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-19 13:47:23.886 +03:00 [DBG] Start key discovery request
2018-04-19 13:47:23.947 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-19 13:47:23.950 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-19 13:47:23.951 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-19 13:47:23.953 +03:00 [DBG] Start authorize request
2018-04-19 13:47:23.954 +03:00 [DBG] No user present in authorize request
2018-04-19 13:47:23.954 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 13:47:23.956 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 13:47:23.960 +03:00 [DBG] No PKCE used.
2018-04-19 13:47:23.978 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 13:47:23.980 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hy6BEfkDUWzWJUrwmVODozYBOGZzicfO6bsjXs16oR6f46vmMp8NySbI-tXAjawSAmWopBwlCoZyfPyoQSYxFa5CyZ8aP-Q9s368GAyyY1fhRYEyJo4yOGXXSFMkWv3Fci59y562z9vA5bKnDlrpCdWDCD46MfmfgqaTxpsMj40Y0P07V3H3dDnH1dJLWR0AjOQqiFHePkehO6I_Ym9LCpoUB7rIMmzYzqCCLd_bWBQoyJzPcKnHZVd64wwtMvX2EmCrqWR4hSZcU7Sbm6aNe4aC-sbTw7G96a1IWUzVxlYplDrn5-QhfE9Dv5aYWuImes",
  "Nonce": "636597316439236519.ODkzMTliMDYtZmI3YS00MDIwLTkwMGMtMjJmZjdjYjYyMmVlMzVhYzJlZDAtNTQ3YS00YWQzLWJjZWEtNmMzN2M5YTVmYjM5",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636597316439236519.ODkzMTliMDYtZmI3YS00MDIwLTkwMGMtMjJmZjdjYjYyMmVlMzVhYzJlZDAtNTQ3YS00YWQzLWJjZWEtNmMzN2M5YTVmYjM5",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hy6BEfkDUWzWJUrwmVODozYBOGZzicfO6bsjXs16oR6f46vmMp8NySbI-tXAjawSAmWopBwlCoZyfPyoQSYxFa5CyZ8aP-Q9s368GAyyY1fhRYEyJo4yOGXXSFMkWv3Fci59y562z9vA5bKnDlrpCdWDCD46MfmfgqaTxpsMj40Y0P07V3H3dDnH1dJLWR0AjOQqiFHePkehO6I_Ym9LCpoUB7rIMmzYzqCCLd_bWBQoyJzPcKnHZVd64wwtMvX2EmCrqWR4hSZcU7Sbm6aNe4aC-sbTw7G96a1IWUzVxlYplDrn5-QhfE9Dv5aYWuImes",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 13:47:23.999 +03:00 [INF] Showing login: User is not authenticated
2018-04-19 13:47:24.036 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 13:47:24.037 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 13:47:24.038 +03:00 [DBG] No PKCE used.
2018-04-19 13:47:24.039 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 13:47:33.838 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 13:47:34.262 +03:00 [DBG] Augmenting SignInContext
2018-04-19 13:47:34.265 +03:00 [DBG] Adding idp claim with value: local
2018-04-19 13:47:34.266 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-19 13:47:34.267 +03:00 [DBG] Adding auth_time claim with value: 1524134854
2018-04-19 13:47:34.281 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 13:47:34.366 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD5SB3OU6NG:00000008",
  "TimeStamp": "2018-04-19T10:47:34Z",
  "ProcessId": 25348,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 13:47:34.382 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:47:34.384 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:47:34.385 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-19 13:47:34.388 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-19 13:47:34.390 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-19 13:47:34.399 +03:00 [DBG] Start authorize callback request
2018-04-19 13:47:34.405 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 13:47:34.407 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 13:47:34.408 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 13:47:34.410 +03:00 [DBG] No PKCE used.
2018-04-19 13:47:34.412 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 13:47:34.413 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hy6BEfkDUWzWJUrwmVODozYBOGZzicfO6bsjXs16oR6f46vmMp8NySbI-tXAjawSAmWopBwlCoZyfPyoQSYxFa5CyZ8aP-Q9s368GAyyY1fhRYEyJo4yOGXXSFMkWv3Fci59y562z9vA5bKnDlrpCdWDCD46MfmfgqaTxpsMj40Y0P07V3H3dDnH1dJLWR0AjOQqiFHePkehO6I_Ym9LCpoUB7rIMmzYzqCCLd_bWBQoyJzPcKnHZVd64wwtMvX2EmCrqWR4hSZcU7Sbm6aNe4aC-sbTw7G96a1IWUzVxlYplDrn5-QhfE9Dv5aYWuImes",
  "Nonce": "636597316439236519.ODkzMTliMDYtZmI3YS00MDIwLTkwMGMtMjJmZjdjYjYyMmVlMzVhYzJlZDAtNTQ3YS00YWQzLWJjZWEtNmMzN2M5YTVmYjM5",
  "SessionId": "d27de65dd05932f07564c9d5d1a0e831",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636597316439236519.ODkzMTliMDYtZmI3YS00MDIwLTkwMGMtMjJmZjdjYjYyMmVlMzVhYzJlZDAtNTQ3YS00YWQzLWJjZWEtNmMzN2M5YTVmYjM5",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hy6BEfkDUWzWJUrwmVODozYBOGZzicfO6bsjXs16oR6f46vmMp8NySbI-tXAjawSAmWopBwlCoZyfPyoQSYxFa5CyZ8aP-Q9s368GAyyY1fhRYEyJo4yOGXXSFMkWv3Fci59y562z9vA5bKnDlrpCdWDCD46MfmfgqaTxpsMj40Y0P07V3H3dDnH1dJLWR0AjOQqiFHePkehO6I_Ym9LCpoUB7rIMmzYzqCCLd_bWBQoyJzPcKnHZVd64wwtMvX2EmCrqWR4hSZcU7Sbm6aNe4aC-sbTw7G96a1IWUzVxlYplDrn5-QhfE9Dv5aYWuImes",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 13:47:34.500 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-19 13:47:34.503 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-19 13:47:34.507 +03:00 [INF] Showing consent: User has not yet consented
2018-04-19 13:47:34.514 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:47:34.515 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:47:34.535 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 13:47:34.536 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 13:47:34.537 +03:00 [DBG] No PKCE used.
2018-04-19 13:47:34.541 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 13:47:36.616 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 13:47:36.620 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:47:36.621 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:47:36.656 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 13:47:36.656 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 13:47:36.658 +03:00 [DBG] No PKCE used.
2018-04-19 13:47:36.660 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 13:47:36.689 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:47:36.691 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:47:36.693 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-19 13:47:36.696 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-19 13:47:36.699 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-19 13:47:36.703 +03:00 [DBG] Start authorize callback request
2018-04-19 13:47:36.708 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 13:47:36.709 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 13:47:36.711 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 13:47:36.712 +03:00 [DBG] No PKCE used.
2018-04-19 13:47:36.713 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 13:47:36.715 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hy6BEfkDUWzWJUrwmVODozYBOGZzicfO6bsjXs16oR6f46vmMp8NySbI-tXAjawSAmWopBwlCoZyfPyoQSYxFa5CyZ8aP-Q9s368GAyyY1fhRYEyJo4yOGXXSFMkWv3Fci59y562z9vA5bKnDlrpCdWDCD46MfmfgqaTxpsMj40Y0P07V3H3dDnH1dJLWR0AjOQqiFHePkehO6I_Ym9LCpoUB7rIMmzYzqCCLd_bWBQoyJzPcKnHZVd64wwtMvX2EmCrqWR4hSZcU7Sbm6aNe4aC-sbTw7G96a1IWUzVxlYplDrn5-QhfE9Dv5aYWuImes",
  "Nonce": "636597316439236519.ODkzMTliMDYtZmI3YS00MDIwLTkwMGMtMjJmZjdjYjYyMmVlMzVhYzJlZDAtNTQ3YS00YWQzLWJjZWEtNmMzN2M5YTVmYjM5",
  "SessionId": "d27de65dd05932f07564c9d5d1a0e831",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636597316439236519.ODkzMTliMDYtZmI3YS00MDIwLTkwMGMtMjJmZjdjYjYyMmVlMzVhYzJlZDAtNTQ3YS00YWQzLWJjZWEtNmMzN2M5YTVmYjM5",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hy6BEfkDUWzWJUrwmVODozYBOGZzicfO6bsjXs16oR6f46vmMp8NySbI-tXAjawSAmWopBwlCoZyfPyoQSYxFa5CyZ8aP-Q9s368GAyyY1fhRYEyJo4yOGXXSFMkWv3Fci59y562z9vA5bKnDlrpCdWDCD46MfmfgqaTxpsMj40Y0P07V3H3dDnH1dJLWR0AjOQqiFHePkehO6I_Ym9LCpoUB7rIMmzYzqCCLd_bWBQoyJzPcKnHZVd64wwtMvX2EmCrqWR4hSZcU7Sbm6aNe4aC-sbTw7G96a1IWUzVxlYplDrn5-QhfE9Dv5aYWuImes",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 13:47:36.798 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-19 13:47:36.800 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-19 13:47:36.814 +03:00 [INF] User consented to scopes: ["openid","profile","api1"]
2018-04-19 13:47:36.830 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1"]
2018-04-19 13:47:36.835 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 13:47:36.854 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-19 13:47:36.883 +03:00 [DBG] Creating Implicit Flow response.
2018-04-19 13:47:36.898 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-19 13:47:36.902 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 13:47:36.947 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****hEfg"
    },
    {
      "TokenType": "code",
      "TokenValue": "****04b6"
    }
  ],
  "ActivityId": "0HLD5SB3OU6NG:0000000D",
  "TimeStamp": "2018-04-19T10:47:36Z",
  "ProcessId": 25348,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 13:47:36.955 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hy6BEfkDUWzWJUrwmVODozYBOGZzicfO6bsjXs16oR6f46vmMp8NySbI-tXAjawSAmWopBwlCoZyfPyoQSYxFa5CyZ8aP-Q9s368GAyyY1fhRYEyJo4yOGXXSFMkWv3Fci59y562z9vA5bKnDlrpCdWDCD46MfmfgqaTxpsMj40Y0P07V3H3dDnH1dJLWR0AjOQqiFHePkehO6I_Ym9LCpoUB7rIMmzYzqCCLd_bWBQoyJzPcKnHZVd64wwtMvX2EmCrqWR4hSZcU7Sbm6aNe4aC-sbTw7G96a1IWUzVxlYplDrn5-QhfE9Dv5aYWuImes",
  "Scope": "openid profile api1"
}
2018-04-19 13:47:36.981 +03:00 [DBG] Augmenting SignInContext
2018-04-19 13:47:36.982 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 13:47:37.408 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-19 13:47:37.414 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-19 13:47:37.415 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-19 13:47:37.427 +03:00 [DBG] Start token request.
2018-04-19 13:47:37.437 +03:00 [DBG] Start client validation
2018-04-19 13:47:37.444 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-19 13:47:37.451 +03:00 [DBG] Start parsing for secret in post body
2018-04-19 13:47:37.452 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-19 13:47:37.452 +03:00 [DBG] Secret id found: mvc
2018-04-19 13:47:37.468 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-19 13:47:37.469 +03:00 [DBG] Client validation success
2018-04-19 13:47:37.479 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD5SB3OU6NK:00000003",
  "TimeStamp": "2018-04-19T10:47:37Z",
  "ProcessId": 25348,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 13:47:37.488 +03:00 [DBG] Start token request validation
2018-04-19 13:47:37.501 +03:00 [DBG] Start validation of authorization code token request
2018-04-19 13:47:37.597 +03:00 [DBG] Validation of authorization code token request success
2018-04-19 13:47:37.606 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "fa47a5417eafe8c0b8eedfc0579efb8ea1f615df82b8a405d6e8e10b752c04b6",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "fa47a5417eafe8c0b8eedfc0579efb8ea1f615df82b8a405d6e8e10b752c04b6",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-19 13:47:37.634 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-19 13:47:37.638 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 13:47:37.792 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-19 13:47:37.795 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 13:47:37.801 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****7UGA"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****-plg"
    }
  ],
  "ActivityId": "0HLD5SB3OU6NK:00000003",
  "TimeStamp": "2018-04-19T10:47:37Z",
  "ProcessId": 25348,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 13:47:37.810 +03:00 [DBG] Token request success.
2018-04-19 13:47:37.829 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-19 13:47:37.834 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-19 13:47:37.835 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-19 13:47:37.843 +03:00 [DBG] Start userinfo request
2018-04-19 13:47:37.847 +03:00 [DBG] Bearer token found in header
2018-04-19 13:47:37.931 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 13:47:37.933 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524134857,
    "exp": 1524138457,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524134854,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-04-19 13:47:37.944 +03:00 [DBG] Creating userinfo response
2018-04-19 13:47:37.949 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-19 13:47:37.952 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-19 13:47:37.957 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-19 13:47:37.958 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-19 13:47:38.094 +03:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-04-19 13:47:38.095 +03:00 [DBG] End userinfo request
2018-04-19 13:47:45.504 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:47:45.510 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:47:45.513 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-19 13:47:45.514 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-19 13:47:45.517 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-19 13:47:45.519 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 13:47:45.523 +03:00 [DBG] Start end session request validation
2018-04-19 13:47:45.524 +03:00 [DBG] Start identity token validation
2018-04-19 13:47:45.525 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-19 13:47:45.605 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 13:47:45.609 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524134857,
    "exp": 1524135157,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636597316439236519.ODkzMTliMDYtZmI3YS00MDIwLTkwMGMtMjJmZjdjYjYyMmVlMzVhYzJlZDAtNTQ3YS00YWQzLWJjZWEtNmMzN2M5YTVmYjM5",
    "iat": 1524134857,
    "at_hash": "xQ8Jf0J9hM0tCFqcxAi3YQ",
    "sid": "d27de65dd05932f07564c9d5d1a0e831",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524134854,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-19 13:47:45.623 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxr2HVFqV6rhtavdYEBIFHFa4nJkSA-DPYvSeFPvnbqpBPF8sQZEv15y94G1n7GN84t4hwDqWkhI7A8nPPs7_32AcS4wDWAnAXfNWZciHXQQ1oeD69q_bVR6Go4K8nP8nHvAXuETeiktVYya-gzxoBT",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQxMzQ4NTcsImV4cCI6MTUyNDEzNTE1NywiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY1OTczMTY0MzkyMzY1MTkuT0Rrek1UbGlNRFl0Wm1JM1lTMDBNREl3TFRrd01HTXRNakptWmpkallqWXlNbVZsTXpWaFl6SmxaREF0TlRRM1lTMDBZV1F6TFdKalpXRXRObU16TjJNNVlUVm1Zak01IiwiaWF0IjoxNTI0MTM0ODU3LCJhdF9oYXNoIjoieFE4SmYwSjloTTB0Q0ZxY3hBaTNZUSIsInNpZCI6ImQyN2RlNjVkZDA1OTMyZjA3NTY0YzlkNWQxYTBlODMxIiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0MTM0ODU0LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.MSNES9TosKJ49qbFBhRKkhiKODj8-mSo30MH58HaPtJfLzr_KUwyJbQ1wB2GlZEn6q_YguTmKXSvaCShScihgJf7c-0T35tHR4K26x5rMs_yxDtBXEjTP1E8Slz7hEOfGniCMsZQwjdRO5JGmPuLMy_w17AqaD_XBaUdq3RW-yEtBYF5DpTWkMKyQq3I9Cv2wdGlqQ0IRnntCAmOCQuW4PRcKOLveH-nXPGvfumsgKlphfdhZf2cpF47u9ziNJysIVrzlJoiQtMDFJyvYCbdsXNufX8nL-lYSWCNd4fqqyj0i0W-S7aDxyB642f4Lxi0bOf3NDZPN26bX3atce7UGA",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hxr2HVFqV6rhtavdYEBIFHFa4nJkSA-DPYvSeFPvnbqpBPF8sQZEv15y94G1n7GN84t4hwDqWkhI7A8nPPs7_32AcS4wDWAnAXfNWZciHXQQ1oeD69q_bVR6Go4K8nP8nHvAXuETeiktVYya-gzxoBT",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 13:47:45.641 +03:00 [DBG] Success validating end session request from mvc
2018-04-19 13:47:45.648 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:47:45.650 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:47:45.669 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-19 13:47:45.672 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 13:47:45.674 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-19 13:47:45.684 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD5SB3OU6NG:0000000F",
  "TimeStamp": "2018-04-19T10:47:45Z",
  "ProcessId": 25348,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 13:47:45.833 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-19 13:47:45.837 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-19 13:47:45.839 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-19 13:47:45.847 +03:00 [DBG] Processing signout callback request
2018-04-19 13:47:45.863 +03:00 [DBG] No client front-channel logout URLs
2018-04-19 13:47:45.863 +03:00 [DBG] No client back-channel logout URLs
2018-04-19 13:47:45.865 +03:00 [INF] Successful signout callback.
2018-04-19 13:47:45.865 +03:00 [DBG] No client front-channel iframe urls
2018-04-19 13:47:45.867 +03:00 [DBG] No client back-channel iframe urls
2018-04-19 13:47:52.963 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-19 13:47:52.965 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-19 13:47:52.968 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-19 13:47:52.971 +03:00 [DBG] Start authorize request
2018-04-19 13:47:52.975 +03:00 [DBG] No user present in authorize request
2018-04-19 13:47:52.978 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 13:47:52.978 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 13:47:52.979 +03:00 [DBG] No PKCE used.
2018-04-19 13:47:52.980 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 13:47:52.981 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxRcQC7WAKLGWO6qgESTnpa1Dov4mbnuQX8UQr1dVKFGwBBck3fgYp6DrXAkQT-kws0dVZoIbsMY8PIu4T8CF5XnI_gm6Th9RenoXNCdi3-gDYP0lSZn7-YJKyIZ9fRa1aXYvU3I2LsYdb9wYYjQHQncNOF0JbbHtG8e6FAe-kiOos0dsa0AwdBVogFr7851R7HkHDSssFS4Pp8WSZJYmqocNFpl8Gh3VgH6qiRdvyJq-UvqBbek-UdK_f68Y7QvQ66IOhs23Np5DxhY8ADfWWs9kauKQdYEogMxoBkUV9TBTk4cfuRo4LH1IFA0jrfajY",
  "Nonce": "636597316729424110.YmIyY2QzMGEtY2YyZC00YmQ1LWIyNDItYzI4NWI1ZjAyNGMzYmFkYWI0ZWMtNDFmNC00N2Q5LTk0YjUtZDAwMmQyMjYyNGE1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636597316729424110.YmIyY2QzMGEtY2YyZC00YmQ1LWIyNDItYzI4NWI1ZjAyNGMzYmFkYWI0ZWMtNDFmNC00N2Q5LTk0YjUtZDAwMmQyMjYyNGE1",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hxRcQC7WAKLGWO6qgESTnpa1Dov4mbnuQX8UQr1dVKFGwBBck3fgYp6DrXAkQT-kws0dVZoIbsMY8PIu4T8CF5XnI_gm6Th9RenoXNCdi3-gDYP0lSZn7-YJKyIZ9fRa1aXYvU3I2LsYdb9wYYjQHQncNOF0JbbHtG8e6FAe-kiOos0dsa0AwdBVogFr7851R7HkHDSssFS4Pp8WSZJYmqocNFpl8Gh3VgH6qiRdvyJq-UvqBbek-UdK_f68Y7QvQ66IOhs23Np5DxhY8ADfWWs9kauKQdYEogMxoBkUV9TBTk4cfuRo4LH1IFA0jrfajY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 13:47:52.986 +03:00 [INF] Showing login: User is not authenticated
2018-04-19 13:47:52.994 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 13:47:52.995 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 13:47:52.995 +03:00 [DBG] No PKCE used.
2018-04-19 13:47:52.996 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 13:47:58.916 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 13:47:59.135 +03:00 [DBG] Augmenting SignInContext
2018-04-19 13:47:59.136 +03:00 [DBG] Adding idp claim with value: local
2018-04-19 13:47:59.137 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-19 13:47:59.138 +03:00 [DBG] Adding auth_time claim with value: 1524134879
2018-04-19 13:47:59.141 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 13:47:59.216 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD5SB3OU6NG:00000013",
  "TimeStamp": "2018-04-19T10:47:59Z",
  "ProcessId": 25348,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 13:47:59.225 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:47:59.226 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:47:59.231 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-19 13:47:59.232 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-19 13:47:59.233 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-19 13:47:59.234 +03:00 [DBG] Start authorize callback request
2018-04-19 13:47:59.235 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 13:47:59.236 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 13:47:59.237 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 13:47:59.237 +03:00 [DBG] No PKCE used.
2018-04-19 13:47:59.238 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 13:47:59.244 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxRcQC7WAKLGWO6qgESTnpa1Dov4mbnuQX8UQr1dVKFGwBBck3fgYp6DrXAkQT-kws0dVZoIbsMY8PIu4T8CF5XnI_gm6Th9RenoXNCdi3-gDYP0lSZn7-YJKyIZ9fRa1aXYvU3I2LsYdb9wYYjQHQncNOF0JbbHtG8e6FAe-kiOos0dsa0AwdBVogFr7851R7HkHDSssFS4Pp8WSZJYmqocNFpl8Gh3VgH6qiRdvyJq-UvqBbek-UdK_f68Y7QvQ66IOhs23Np5DxhY8ADfWWs9kauKQdYEogMxoBkUV9TBTk4cfuRo4LH1IFA0jrfajY",
  "Nonce": "636597316729424110.YmIyY2QzMGEtY2YyZC00YmQ1LWIyNDItYzI4NWI1ZjAyNGMzYmFkYWI0ZWMtNDFmNC00N2Q5LTk0YjUtZDAwMmQyMjYyNGE1",
  "SessionId": "3b93fdacdccb5043464355a1dea2663c",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636597316729424110.YmIyY2QzMGEtY2YyZC00YmQ1LWIyNDItYzI4NWI1ZjAyNGMzYmFkYWI0ZWMtNDFmNC00N2Q5LTk0YjUtZDAwMmQyMjYyNGE1",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hxRcQC7WAKLGWO6qgESTnpa1Dov4mbnuQX8UQr1dVKFGwBBck3fgYp6DrXAkQT-kws0dVZoIbsMY8PIu4T8CF5XnI_gm6Th9RenoXNCdi3-gDYP0lSZn7-YJKyIZ9fRa1aXYvU3I2LsYdb9wYYjQHQncNOF0JbbHtG8e6FAe-kiOos0dsa0AwdBVogFr7851R7HkHDSssFS4Pp8WSZJYmqocNFpl8Gh3VgH6qiRdvyJq-UvqBbek-UdK_f68Y7QvQ66IOhs23Np5DxhY8ADfWWs9kauKQdYEogMxoBkUV9TBTk4cfuRo4LH1IFA0jrfajY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 13:47:59.324 +03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-04-19 13:47:59.327 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-19 13:47:59.337 +03:00 [DBG] Creating Implicit Flow response.
2018-04-19 13:47:59.338 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-19 13:47:59.342 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 13:47:59.346 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****wZzA"
    },
    {
      "TokenType": "code",
      "TokenValue": "****b1eb"
    }
  ],
  "ActivityId": "0HLD5SB3OU6NG:00000014",
  "TimeStamp": "2018-04-19T10:47:59Z",
  "ProcessId": 25348,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 13:47:59.350 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxRcQC7WAKLGWO6qgESTnpa1Dov4mbnuQX8UQr1dVKFGwBBck3fgYp6DrXAkQT-kws0dVZoIbsMY8PIu4T8CF5XnI_gm6Th9RenoXNCdi3-gDYP0lSZn7-YJKyIZ9fRa1aXYvU3I2LsYdb9wYYjQHQncNOF0JbbHtG8e6FAe-kiOos0dsa0AwdBVogFr7851R7HkHDSssFS4Pp8WSZJYmqocNFpl8Gh3VgH6qiRdvyJq-UvqBbek-UdK_f68Y7QvQ66IOhs23Np5DxhY8ADfWWs9kauKQdYEogMxoBkUV9TBTk4cfuRo4LH1IFA0jrfajY",
  "Scope": "openid profile api1"
}
2018-04-19 13:47:59.352 +03:00 [DBG] Augmenting SignInContext
2018-04-19 13:47:59.356 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 13:47:59.597 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-19 13:47:59.599 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-19 13:47:59.601 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-19 13:47:59.602 +03:00 [DBG] Start token request.
2018-04-19 13:47:59.603 +03:00 [DBG] Start client validation
2018-04-19 13:47:59.605 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-19 13:47:59.608 +03:00 [DBG] Start parsing for secret in post body
2018-04-19 13:47:59.612 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-19 13:47:59.612 +03:00 [DBG] Secret id found: mvc
2018-04-19 13:47:59.615 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-19 13:47:59.618 +03:00 [DBG] Client validation success
2018-04-19 13:47:59.619 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD5SB3OU6NK:00000005",
  "TimeStamp": "2018-04-19T10:47:59Z",
  "ProcessId": 25348,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 13:47:59.621 +03:00 [DBG] Start token request validation
2018-04-19 13:47:59.621 +03:00 [DBG] Start validation of authorization code token request
2018-04-19 13:47:59.713 +03:00 [DBG] Validation of authorization code token request success
2018-04-19 13:47:59.713 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "e7fdd1116050e387de3874da007fcf20e0ff4e5b52cdc1669f865a159d69b1eb",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "e7fdd1116050e387de3874da007fcf20e0ff4e5b52cdc1669f865a159d69b1eb",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-19 13:47:59.717 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-19 13:47:59.717 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 13:47:59.903 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-19 13:47:59.905 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 13:47:59.912 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****-wug"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****FZFA"
    }
  ],
  "ActivityId": "0HLD5SB3OU6NK:00000005",
  "TimeStamp": "2018-04-19T10:47:59Z",
  "ProcessId": 25348,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 13:47:59.916 +03:00 [DBG] Token request success.
2018-04-19 13:47:59.922 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-19 13:47:59.923 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-19 13:47:59.924 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-19 13:47:59.927 +03:00 [DBG] Start userinfo request
2018-04-19 13:47:59.927 +03:00 [DBG] Bearer token found in header
2018-04-19 13:48:00.045 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 13:48:00.046 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524134879,
    "exp": 1524138479,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524134879,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-04-19 13:48:00.049 +03:00 [DBG] Creating userinfo response
2018-04-19 13:48:00.049 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-19 13:48:00.050 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-19 13:48:00.051 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-19 13:48:00.053 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-19 13:48:00.347 +03:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-04-19 13:48:00.349 +03:00 [DBG] End userinfo request
2018-04-19 13:52:57.298 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 13:52:57.300 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:07:17.395 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:07:17.397 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:07:17.401 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-19 14:07:17.405 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-19 14:07:17.407 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-19 14:07:17.409 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 14:07:17.411 +03:00 [DBG] Start end session request validation
2018-04-19 14:07:17.411 +03:00 [DBG] Start identity token validation
2018-04-19 14:07:17.412 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-19 14:07:17.713 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 14:07:17.715 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524134879,
    "exp": 1524135179,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636597316729424110.YmIyY2QzMGEtY2YyZC00YmQ1LWIyNDItYzI4NWI1ZjAyNGMzYmFkYWI0ZWMtNDFmNC00N2Q5LTk0YjUtZDAwMmQyMjYyNGE1",
    "iat": 1524134879,
    "at_hash": "Gh1ZxsYRiHUf6QQCULyY_w",
    "sid": "3b93fdacdccb5043464355a1dea2663c",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524134879,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-19 14:07:17.719 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxVqxZkIY0yg8Ib9zn6awvlF_BrjeXvccPzqnQB8YlWBZAeK9eoXvWcZrj5gn8PYvfIyGxiHraRCXLV7pay4c40oqE19YJ7K8IzbH44uQyD32nbiku-CGtqQd4xsvhScNHQ1I9_tFdFVLwmOJ4P5TDj",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQxMzQ4NzksImV4cCI6MTUyNDEzNTE3OSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY1OTczMTY3Mjk0MjQxMTAuWW1JeVkyUXpNR0V0WTJZeVpDMDBZbVExTFdJeU5ESXRZekk0TldJMVpqQXlOR016WW1Ga1lXSTBaV010TkRGbU5DMDBOMlE1TFRrMFlqVXRaREF3TW1ReU1qWXlOR0UxIiwiaWF0IjoxNTI0MTM0ODc5LCJhdF9oYXNoIjoiR2gxWnhzWVJpSFVmNlFRQ1VMeVlfdyIsInNpZCI6IjNiOTNmZGFjZGNjYjUwNDM0NjQzNTVhMWRlYTI2NjNjIiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0MTM0ODc5LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.Eso-Yd_JSOVjsit7AF7IdBARm2rt9RrsHfBx6lEkNFTaiYdVwRxkYY00wLvJRc5WjFSdyNl8pbssON22oZz_0hy5GKd7kI9feDRIF-GbpaEmaEBupYk_61poiiBJ1le4t7AQ8EoQRNIRu9-fS0bFW4NQNzfiXp6foLik0N73x29_4kWqybKl2udSQO9-wNLGj-QLcp034ZxdEk8b0DK7Bi3sxLEs76GBWTRWRuR6YbTNnfAh6vnOyGJ5MsOMqk6A2OLmMlcC7xr19QqVhDmB7LOFyOQY2K5skIo0VIc_97MzeJ9DVofxoCz6gr7rDDgdvoSigWGPylFYpzO-1d-wug",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hxVqxZkIY0yg8Ib9zn6awvlF_BrjeXvccPzqnQB8YlWBZAeK9eoXvWcZrj5gn8PYvfIyGxiHraRCXLV7pay4c40oqE19YJ7K8IzbH44uQyD32nbiku-CGtqQd4xsvhScNHQ1I9_tFdFVLwmOJ4P5TDj",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 14:07:17.731 +03:00 [DBG] Success validating end session request from mvc
2018-04-19 14:07:17.737 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:07:17.739 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:07:17.742 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-19 14:07:17.743 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 14:07:17.744 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-19 14:07:17.746 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD5SB3OU6NQ:00000002",
  "TimeStamp": "2018-04-19T11:07:17Z",
  "ProcessId": 25348,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:07:18.123 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-19 14:07:18.126 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-19 14:07:18.128 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-19 14:07:18.130 +03:00 [DBG] Processing signout callback request
2018-04-19 14:07:18.135 +03:00 [DBG] No client front-channel logout URLs
2018-04-19 14:07:18.138 +03:00 [DBG] No client back-channel logout URLs
2018-04-19 14:07:18.139 +03:00 [INF] Successful signout callback.
2018-04-19 14:07:18.140 +03:00 [DBG] No client front-channel iframe urls
2018-04-19 14:07:18.141 +03:00 [DBG] No client back-channel iframe urls
2018-04-19 14:07:26.723 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 14:07:36.346 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:07:36.592 +03:00 [DBG] Augmenting SignInContext
2018-04-19 14:07:36.593 +03:00 [DBG] Adding idp claim with value: local
2018-04-19 14:07:36.595 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-19 14:07:36.595 +03:00 [DBG] Adding auth_time claim with value: 1524136056
2018-04-19 14:07:36.596 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 14:07:36.671 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD5SB3OU6NQ:00000008",
  "TimeStamp": "2018-04-19T11:07:36Z",
  "ProcessId": 25348,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:07:36.680 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:07:36.682 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:07:42.309 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:07:42.313 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:07:46.109 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:07:46.112 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:07:54.061 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:07:54.064 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:07:54.072 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-19 14:07:54.073 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-19 14:07:54.075 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-19 14:07:54.076 +03:00 [DBG] Start authorize request
2018-04-19 14:07:54.077 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 14:07:54.079 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 14:07:54.079 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 14:07:54.080 +03:00 [DBG] No PKCE used.
2018-04-19 14:07:54.081 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 14:07:54.082 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzqQo0PaZMSmydpFgj9Kd17lDJo-DoRxlwTnWBuylH57hSqmzG1MfxBb1D07nvZ-dopd-jGOoaEU05EpEuFjQMhCIc3amdEq1V3mnGB5PhYIRcSG-ylKGX3b_nZCXRGtAi2zvaGNP0lfKLcvtzkk9Wuqt45gjq06zznesl5FZAPp8o7R-3y7TdJLZK_AYgGLG0u00qucX27cXQgbR9DaVKVMTep0iAet0kdVIwGQB0GOXPni2TMRD8A32JEg8T1E57c0BwxGKj15pCQsyOLp4yJeWiNyj0QU-Gywttmz3NzR4KjPN1hFMvr_TnIbMMiLaA",
  "Nonce": "636597328740236215.ZjBlOWZiNWUtM2NiZC00Njc3LWIyZWEtOTRmNWIxOTYxNjA0OGYwMWFiM2QtOTk1YS00MmJhLThjOWEtM2ZiMzkyMWY5YmRm",
  "SessionId": "3a39b407bb64a31867099fb349e17fc6",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636597328740236215.ZjBlOWZiNWUtM2NiZC00Njc3LWIyZWEtOTRmNWIxOTYxNjA0OGYwMWFiM2QtOTk1YS00MmJhLThjOWEtM2ZiMzkyMWY5YmRm",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hzqQo0PaZMSmydpFgj9Kd17lDJo-DoRxlwTnWBuylH57hSqmzG1MfxBb1D07nvZ-dopd-jGOoaEU05EpEuFjQMhCIc3amdEq1V3mnGB5PhYIRcSG-ylKGX3b_nZCXRGtAi2zvaGNP0lfKLcvtzkk9Wuqt45gjq06zznesl5FZAPp8o7R-3y7TdJLZK_AYgGLG0u00qucX27cXQgbR9DaVKVMTep0iAet0kdVIwGQB0GOXPni2TMRD8A32JEg8T1E57c0BwxGKj15pCQsyOLp4yJeWiNyj0QU-Gywttmz3NzR4KjPN1hFMvr_TnIbMMiLaA",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 14:07:54.167 +03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-04-19 14:07:54.168 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-19 14:07:54.181 +03:00 [DBG] Creating Implicit Flow response.
2018-04-19 14:07:54.183 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-19 14:07:54.186 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 14:07:54.191 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****C7yQ"
    },
    {
      "TokenType": "code",
      "TokenValue": "****66b0"
    }
  ],
  "ActivityId": "0HLD5SB3OU6NS:00000008",
  "TimeStamp": "2018-04-19T11:07:54Z",
  "ProcessId": 25348,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:07:54.196 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzqQo0PaZMSmydpFgj9Kd17lDJo-DoRxlwTnWBuylH57hSqmzG1MfxBb1D07nvZ-dopd-jGOoaEU05EpEuFjQMhCIc3amdEq1V3mnGB5PhYIRcSG-ylKGX3b_nZCXRGtAi2zvaGNP0lfKLcvtzkk9Wuqt45gjq06zznesl5FZAPp8o7R-3y7TdJLZK_AYgGLG0u00qucX27cXQgbR9DaVKVMTep0iAet0kdVIwGQB0GOXPni2TMRD8A32JEg8T1E57c0BwxGKj15pCQsyOLp4yJeWiNyj0QU-Gywttmz3NzR4KjPN1hFMvr_TnIbMMiLaA",
  "Scope": "openid profile api1"
}
2018-04-19 14:07:54.203 +03:00 [DBG] Augmenting SignInContext
2018-04-19 14:07:54.204 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 14:07:54.369 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-19 14:07:54.372 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-19 14:07:54.373 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-19 14:07:54.375 +03:00 [DBG] Start token request.
2018-04-19 14:07:54.376 +03:00 [DBG] Start client validation
2018-04-19 14:07:54.377 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-19 14:07:54.378 +03:00 [DBG] Start parsing for secret in post body
2018-04-19 14:07:54.378 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-19 14:07:54.379 +03:00 [DBG] Secret id found: mvc
2018-04-19 14:07:54.380 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-19 14:07:54.383 +03:00 [DBG] Client validation success
2018-04-19 14:07:54.387 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD5SB3OU6NT:00000001",
  "TimeStamp": "2018-04-19T11:07:54Z",
  "ProcessId": 25348,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:07:54.391 +03:00 [DBG] Start token request validation
2018-04-19 14:07:54.391 +03:00 [DBG] Start validation of authorization code token request
2018-04-19 14:07:54.474 +03:00 [DBG] Validation of authorization code token request success
2018-04-19 14:07:54.483 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "b91b263d9ff5a114ea935a5698a7c1667f6c10898df9f288fbfe502ab68b66b0",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "b91b263d9ff5a114ea935a5698a7c1667f6c10898df9f288fbfe502ab68b66b0",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-19 14:07:54.495 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-19 14:07:54.501 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 14:07:54.646 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-19 14:07:54.648 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 14:07:54.654 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****eH_w"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****U3yg"
    }
  ],
  "ActivityId": "0HLD5SB3OU6NT:00000001",
  "TimeStamp": "2018-04-19T11:07:54Z",
  "ProcessId": 25348,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:07:54.661 +03:00 [DBG] Token request success.
2018-04-19 14:07:54.679 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-19 14:07:54.682 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-19 14:07:54.684 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-19 14:07:54.685 +03:00 [DBG] Start userinfo request
2018-04-19 14:07:54.686 +03:00 [DBG] Bearer token found in header
2018-04-19 14:07:54.756 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 14:07:54.759 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524136074,
    "exp": 1524139674,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524136056,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-04-19 14:07:54.766 +03:00 [DBG] Creating userinfo response
2018-04-19 14:07:54.766 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-19 14:07:54.767 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-19 14:07:54.770 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-19 14:07:54.772 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-19 14:07:54.905 +03:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-04-19 14:07:54.907 +03:00 [DBG] End userinfo request
2018-04-19 14:08:47.843 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:08:47.848 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:08:49.463 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:08:49.467 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:08:49.469 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:08:49.480 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-19 14:08:49.481 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 14:08:49.483 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-19 14:08:49.484 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD5SB3OU6NS:0000000A",
  "TimeStamp": "2018-04-19T11:08:49Z",
  "ProcessId": 25348,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:08:49.638 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-19 14:08:49.641 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-19 14:08:49.645 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-19 14:08:49.651 +03:00 [DBG] Processing signout callback request
2018-04-19 14:08:49.653 +03:00 [DBG] No client front-channel logout URLs
2018-04-19 14:08:49.653 +03:00 [DBG] No client back-channel logout URLs
2018-04-19 14:08:49.654 +03:00 [INF] Successful signout callback.
2018-04-19 14:08:49.655 +03:00 [DBG] No client front-channel iframe urls
2018-04-19 14:08:49.657 +03:00 [DBG] No client back-channel iframe urls
2018-04-19 14:08:52.173 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 14:08:54.038 +03:00 [INF] AuthenticationScheme: Google was challenged.
2018-04-19 14:08:57.876 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-19 14:08:57.895 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-19 14:08:58.533 +03:00 [ERR] Failed executing DbCommand (75ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p20='?', @p6='?', @p7='?', @p21='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?', @p18='?', @p19='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p3, @p4, @p5)
RETURNING "Id";
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p6, "ConcurrencyStamp" = @p7, "Email" = @p8, "EmailConfirmed" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "PasswordHash" = @p14, "PhoneNumber" = @p15, "PhoneNumberConfirmed" = @p16, "SecurityStamp" = @p17, "TwoFactorEnabled" = @p18, "UserName" = @p19
WHERE "Id" = @p20 AND "ConcurrencyStamp" = @p21;
Npgsql.PostgresException (0x80004005): 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
2018-04-19 14:08:58.710 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
2018-04-19 14:09:06.342 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 14:14:57.810 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 14:14:59.270 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 14:15:00.035 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:15:00.077 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-19 14:15:00.097 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-19 14:15:00.877 +03:00 [ERR] Failed executing DbCommand (95ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p17='?', @p3='?', @p4='?', @p18='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?', @p16='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p3, "ConcurrencyStamp" = @p4, "Email" = @p5, "EmailConfirmed" = @p6, "LockoutEnabled" = @p7, "LockoutEnd" = @p8, "NormalizedEmail" = @p9, "NormalizedUserName" = @p10, "PasswordHash" = @p11, "PhoneNumber" = @p12, "PhoneNumberConfirmed" = @p13, "SecurityStamp" = @p14, "TwoFactorEnabled" = @p15, "UserName" = @p16
WHERE "Id" = @p17 AND "ConcurrencyStamp" = @p18;
Npgsql.PostgresException (0x80004005): 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
2018-04-19 14:15:01.035 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
2018-04-19 14:15:34.669 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 14:15:36.410 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 14:15:36.912 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:15:36.918 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-19 14:15:36.933 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-19 14:15:37.417 +03:00 [ERR] Failed executing DbCommand (84ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p17='?', @p3='?', @p4='?', @p18='?', @p5='?', @p6='?', @p7='?', @p8='?', @p9='?', @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?', @p16='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p3, "ConcurrencyStamp" = @p4, "Email" = @p5, "EmailConfirmed" = @p6, "LockoutEnabled" = @p7, "LockoutEnd" = @p8, "NormalizedEmail" = @p9, "NormalizedUserName" = @p10, "PasswordHash" = @p11, "PhoneNumber" = @p12, "PhoneNumberConfirmed" = @p13, "SecurityStamp" = @p14, "TwoFactorEnabled" = @p15, "UserName" = @p16
WHERE "Id" = @p17 AND "ConcurrencyStamp" = @p18;
Npgsql.PostgresException (0x80004005): 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
2018-04-19 14:15:37.545 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> Npgsql.PostgresException: 23502: null value in column "Id" violates not-null constraint
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.<ExecuteAsync>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.<ExecuteAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__61.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<SaveChangesAsync>d__59.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.DbContext.<SaveChangesAsync>d__48.MoveNext()
2018-04-19 14:16:39.375 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 14:16:39.435 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 14:16:39.441 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 14:16:39.441 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 14:16:39.441 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 14:16:39.441 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 14:22:01.570 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 14:22:01.617 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 14:22:01.620 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 14:22:01.620 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 14:22:01.620 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 14:22:01.620 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 14:22:21.577 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 14:22:21.622 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 14:22:21.625 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 14:22:21.625 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 14:22:21.625 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 14:22:21.625 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 14:23:00.107 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 14:23:00.169 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 14:23:00.173 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 14:23:00.173 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 14:23:00.173 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 14:23:00.173 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 14:24:59.086 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 14:24:59.142 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 14:24:59.148 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 14:24:59.148 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 14:24:59.149 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 14:24:59.149 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 14:25:04.631 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 14:25:09.387 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 14:25:10.216 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:25:10.370 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-19 14:25:10.389 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-19 14:25:12.781 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "aad",
  "ProviderUserId": "M3DibDFlo2l47ahrFpL9-n5mvF6FHOt39YSKDDWGiR8",
  "SubjectId": "e6ed8551-bae3-4983-8c3b-f9a476e4f74d",
  "DisplayName": "Bahadır Civelek",
  "Endpoint": "UI",
  "ActivityId": "0HLD5T0NQ9IF5:00000006",
  "TimeStamp": "2018-04-19T11:25:12Z",
  "ProcessId": 30208,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:25:12.801 +03:00 [DBG] Augmenting SignInContext
2018-04-19 14:25:12.805 +03:00 [DBG] Adding amr claim with value: external
2018-04-19 14:25:12.818 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 14:25:12.826 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 14:25:12.838 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:25:12.841 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:25:20.293 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:25:20.298 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:25:22.440 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:25:22.442 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:25:37.064 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:25:37.067 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:25:38.840 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:25:38.843 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:25:38.846 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:25:38.884 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-19 14:25:38.886 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 14:25:38.887 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-19 14:25:38.898 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "e6ed8551-bae3-4983-8c3b-f9a476e4f74d",
  "DisplayName": "Bahadır Civelek",
  "ActivityId": "0HLD5T0NQ9IF5:0000000B",
  "TimeStamp": "2018-04-19T11:25:38Z",
  "ProcessId": 30208,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:25:38.906 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:25:38.909 +03:00 [INF] AuthenticationScheme: aad signed out.
2018-04-19 14:27:02.189 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 14:27:58.180 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:27:58.184 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-19 14:27:58.193 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-19 14:27:59.213 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "aad",
  "ProviderUserId": "W9w3bFWsvQaZSMY40X_1A2EPi4gE9NxeA76G30M1NTA",
  "SubjectId": "077ae44f-5d54-418e-b731-24d58df76500",
  "DisplayName": "Çağlar Sert",
  "Endpoint": "UI",
  "ActivityId": "0HLD5T0NQ9IF5:00000011",
  "TimeStamp": "2018-04-19T11:27:59Z",
  "ProcessId": 30208,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:27:59.218 +03:00 [DBG] Augmenting SignInContext
2018-04-19 14:27:59.218 +03:00 [DBG] Adding amr claim with value: external
2018-04-19 14:27:59.218 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 14:27:59.219 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 14:27:59.226 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:27:59.226 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:28:15.187 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:28:15.190 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:28:16.430 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:28:16.435 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:28:16.436 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:28:16.438 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-19 14:28:16.440 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 14:28:16.441 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-19 14:28:16.445 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "077ae44f-5d54-418e-b731-24d58df76500",
  "DisplayName": "Çağlar Sert",
  "ActivityId": "0HLD5T0NQ9IF5:00000014",
  "TimeStamp": "2018-04-19T11:28:16Z",
  "ProcessId": 30208,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:28:16.447 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:28:16.448 +03:00 [INF] AuthenticationScheme: aad signed out.
2018-04-19 14:28:40.945 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 14:28:41.002 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 14:28:41.009 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 14:28:41.012 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 14:28:41.015 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 14:28:41.017 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 14:28:58.675 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 14:29:11.749 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 14:29:22.033 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:29:23.506 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-19 14:29:23.536 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-19 14:29:26.801 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "aad",
  "ProviderUserId": "W9w3bFWsvQaZSMY40X_1A2EPi4gE9NxeA76G30M1NTA",
  "SubjectId": "077ae44f-5d54-418e-b731-24d58df76500",
  "DisplayName": "Çağlar Sert",
  "Endpoint": "UI",
  "ActivityId": "0HLD5T2PVOHMP:00000006",
  "TimeStamp": "2018-04-19T11:29:26Z",
  "ProcessId": 10328,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:29:26.821 +03:00 [DBG] Augmenting SignInContext
2018-04-19 14:29:26.827 +03:00 [DBG] Adding amr claim with value: external
2018-04-19 14:29:26.840 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 14:29:26.851 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 14:29:26.880 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:29:26.889 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:30:45.057 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 14:30:45.127 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 14:30:45.136 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 14:30:45.138 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 14:30:45.141 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 14:30:45.143 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 14:30:47.135 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:30:47.159 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:31:03.661 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-19 14:31:03.676 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-19 14:31:03.681 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-19 14:31:03.694 +03:00 [DBG] Start discovery request
2018-04-19 14:31:04.044 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-19 14:31:04.052 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-19 14:31:04.056 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-19 14:31:04.066 +03:00 [DBG] Start key discovery request
2018-04-19 14:31:04.163 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:31:04.169 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:31:04.173 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-19 14:31:04.186 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-19 14:31:04.190 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-19 14:31:04.211 +03:00 [DBG] Processing signout request for 077ae44f-5d54-418e-b731-24d58df76500
2018-04-19 14:31:04.224 +03:00 [DBG] Start end session request validation
2018-04-19 14:31:04.237 +03:00 [DBG] Start identity token validation
2018-04-19 14:31:04.281 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-19 14:31:07.557 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 14:31:07.572 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524136074,
    "exp": 1524136374,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636597328740236215.ZjBlOWZiNWUtM2NiZC00Njc3LWIyZWEtOTRmNWIxOTYxNjA0OGYwMWFiM2QtOTk1YS00MmJhLThjOWEtM2ZiMzkyMWY5YmRm",
    "iat": 1524136074,
    "at_hash": "c-WqVIyi2879XYY3ubwhMg",
    "sid": "3a39b407bb64a31867099fb349e17fc6",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524136056,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-19 14:31:07.594 +03:00 [INF] End session request validation failure: Current user does not match identity token
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "unknown",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQxMzYwNzQsImV4cCI6MTUyNDEzNjM3NCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY1OTczMjg3NDAyMzYyMTUuWmpCbE9XWmlOV1V0TTJOaVpDMDBOamMzTFdJeVpXRXRPVFJtTldJeE9UWXhOakEwT0dZd01XRmlNMlF0T1RrMVlTMDBNbUpoTFRoak9XRXRNMlppTXpreU1XWTVZbVJtIiwiaWF0IjoxNTI0MTM2MDc0LCJhdF9oYXNoIjoiYy1XcVZJeWkyODc5WFlZM3Vid2hNZyIsInNpZCI6IjNhMzliNDA3YmI2NGEzMTg2NzA5OWZiMzQ5ZTE3ZmM2Iiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0MTM2MDU2LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.StUQ_G1LXZRAtK8yxKx48hAVHodth8i8EmgO2XDi20_nDPGk8P-PpM0R0awK7zWTTdQEuNzKAHhsu9jrxnbKHbyQopCgp5bmUsXiSIF4rcEdRsZVqegcTJ_KcZWiAIK7X6ov39jN1I_QZZkQnjWN2FiaPyFpXeNuzvNMn9rfZI21ueqSO_X0gR81iQyFuF2qUcvMCRd1DujH1rXHA1QHcS8JJcscvUGnDkT3BjlhQt50TJ2jiyZEn9gtnN5oun-MMsBlZjlLA2Gpf2PmURXXQ7OhaIuJjChA_5ZyzxmjyJFoYHXwYxLW3ErlOIPU_xGNPMENeofeLP3S5RrYUxeH_w",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hyqoRVldJprmW3-TyfXOa8dYvQD6O3UIQm3d8Sbqtc7L9JMv24d0V7_s758OnKwY1ZWTJjMn-awCgbZVXGZem6Yaq6e6coN4tl8pIG8Psb02AKzsSl-ogaH4H5kuLBWKnA0pBwuzxj-vOXTaJkHnx_l",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 14:31:07.606 +03:00 [ERR] Error processing end session request Invalid request
2018-04-19 14:31:07.624 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:31:07.628 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:31:10.017 +03:00 [DBG] CORS request made for path: /account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:31:10.026 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:31:10.032 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:31:10.117 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-19 14:31:10.124 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 14:31:10.128 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-19 14:31:10.189 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "077ae44f-5d54-418e-b731-24d58df76500",
  "DisplayName": "Çağlar Sert",
  "ActivityId": "0HLD5T3UVF2AB:00000004",
  "TimeStamp": "2018-04-19T11:31:10Z",
  "ProcessId": 12824,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:31:10.858 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:31:10.866 +03:00 [INF] AuthenticationScheme: aad signed out.
2018-04-19 14:31:21.392 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-19 14:31:21.404 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-19 14:31:21.409 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-19 14:31:21.420 +03:00 [DBG] Start authorize request
2018-04-19 14:31:21.432 +03:00 [DBG] No user present in authorize request
2018-04-19 14:31:21.444 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 14:31:21.462 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 14:31:21.466 +03:00 [DBG] No PKCE used.
2018-04-19 14:31:21.526 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 14:31:21.546 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hyhAmCrKIuvuRHoCYswfSboGksHCRabiAs5IxjAopq9twt2TuABsha44iF3JUoTsemKYqxphKx4AmrR4EI0bDf-NKiMzH9IGqv-WVZKtd0AcfqbU1m_WWfMuB1nh7CyXQmyfIc__qqEn5zs7-NOCVtEdcfK4R3FmRyzcmIwvjaDNlGqlJi7_QoJeFZaIGGGbdMnpd_gmysza3RFhvRXVjFZVFGdwyv55GFBemRz-VKT99CT2XdGQsBKRU3UOOhAWLfdRlRbLQObFcsvMUdbVldVBs9Q6aKfFFUvjK5EYYeWGw1tSkhSrJrw__fGrlyQWI4",
  "Nonce": "636597342813805808.NjNmYTA4YjUtZWVhOS00N2NiLWJiNDctYWRhNTg4ODhiMTM4ZDY0NTVjMmUtNmY3OC00MzFhLWI3NTMtOTcyYWNjY2I2OTA2",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636597342813805808.NjNmYTA4YjUtZWVhOS00N2NiLWJiNDctYWRhNTg4ODhiMTM4ZDY0NTVjMmUtNmY3OC00MzFhLWI3NTMtOTcyYWNjY2I2OTA2",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hyhAmCrKIuvuRHoCYswfSboGksHCRabiAs5IxjAopq9twt2TuABsha44iF3JUoTsemKYqxphKx4AmrR4EI0bDf-NKiMzH9IGqv-WVZKtd0AcfqbU1m_WWfMuB1nh7CyXQmyfIc__qqEn5zs7-NOCVtEdcfK4R3FmRyzcmIwvjaDNlGqlJi7_QoJeFZaIGGGbdMnpd_gmysza3RFhvRXVjFZVFGdwyv55GFBemRz-VKT99CT2XdGQsBKRU3UOOhAWLfdRlRbLQObFcsvMUdbVldVBs9Q6aKfFFUvjK5EYYeWGw1tSkhSrJrw__fGrlyQWI4",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 14:31:21.584 +03:00 [INF] Showing login: User is not authenticated
2018-04-19 14:31:21.624 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 14:31:21.627 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 14:31:21.630 +03:00 [DBG] No PKCE used.
2018-04-19 14:31:21.633 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 14:31:37.102 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 14:31:48.767 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:31:48.935 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-19 14:31:48.964 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-19 14:31:49.461 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "aad",
  "ProviderUserId": "W9w3bFWsvQaZSMY40X_1A2EPi4gE9NxeA76G30M1NTA",
  "SubjectId": "077ae44f-5d54-418e-b731-24d58df76500",
  "DisplayName": "Çağlar Sert",
  "Endpoint": "UI",
  "ActivityId": "0HLD5T3UVF2AB:0000000C",
  "TimeStamp": "2018-04-19T11:31:49Z",
  "ProcessId": 12824,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:31:49.481 +03:00 [DBG] Augmenting SignInContext
2018-04-19 14:31:49.489 +03:00 [DBG] Adding amr claim with value: external
2018-04-19 14:31:49.499 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 14:31:49.504 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 14:31:49.525 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:31:49.529 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:31:49.532 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-19 14:31:49.537 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-19 14:31:49.541 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-19 14:31:49.550 +03:00 [DBG] Start authorize callback request
2018-04-19 14:31:49.561 +03:00 [DBG] User in authorize request: 077ae44f-5d54-418e-b731-24d58df76500
2018-04-19 14:31:49.566 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 14:31:49.571 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 14:31:49.574 +03:00 [DBG] No PKCE used.
2018-04-19 14:31:49.577 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 14:31:49.581 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "077ae44f-5d54-418e-b731-24d58df76500",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hyhAmCrKIuvuRHoCYswfSboGksHCRabiAs5IxjAopq9twt2TuABsha44iF3JUoTsemKYqxphKx4AmrR4EI0bDf-NKiMzH9IGqv-WVZKtd0AcfqbU1m_WWfMuB1nh7CyXQmyfIc__qqEn5zs7-NOCVtEdcfK4R3FmRyzcmIwvjaDNlGqlJi7_QoJeFZaIGGGbdMnpd_gmysza3RFhvRXVjFZVFGdwyv55GFBemRz-VKT99CT2XdGQsBKRU3UOOhAWLfdRlRbLQObFcsvMUdbVldVBs9Q6aKfFFUvjK5EYYeWGw1tSkhSrJrw__fGrlyQWI4",
  "Nonce": "636597342813805808.NjNmYTA4YjUtZWVhOS00N2NiLWJiNDctYWRhNTg4ODhiMTM4ZDY0NTVjMmUtNmY3OC00MzFhLWI3NTMtOTcyYWNjY2I2OTA2",
  "SessionId": "d1e7e23b0322c083bb66badb9cc6a7d7",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636597342813805808.NjNmYTA4YjUtZWVhOS00N2NiLWJiNDctYWRhNTg4ODhiMTM4ZDY0NTVjMmUtNmY3OC00MzFhLWI3NTMtOTcyYWNjY2I2OTA2",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hyhAmCrKIuvuRHoCYswfSboGksHCRabiAs5IxjAopq9twt2TuABsha44iF3JUoTsemKYqxphKx4AmrR4EI0bDf-NKiMzH9IGqv-WVZKtd0AcfqbU1m_WWfMuB1nh7CyXQmyfIc__qqEn5zs7-NOCVtEdcfK4R3FmRyzcmIwvjaDNlGqlJi7_QoJeFZaIGGGbdMnpd_gmysza3RFhvRXVjFZVFGdwyv55GFBemRz-VKT99CT2XdGQsBKRU3UOOhAWLfdRlRbLQObFcsvMUdbVldVBs9Q6aKfFFUvjK5EYYeWGw1tSkhSrJrw__fGrlyQWI4",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 14:31:49.684 +03:00 [DBG] user_consent grant with value: mvc|077ae44f-5d54-418e-b731-24d58df76500 not found in store.
2018-04-19 14:31:49.692 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-19 14:31:49.695 +03:00 [INF] Showing consent: User has not yet consented
2018-04-19 14:31:49.711 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:31:49.715 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:31:49.745 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 14:31:49.749 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 14:31:49.752 +03:00 [DBG] No PKCE used.
2018-04-19 14:31:49.756 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 14:32:03.612 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:32:03.622 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:32:03.626 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:32:03.662 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 14:32:03.666 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 14:32:03.671 +03:00 [DBG] No PKCE used.
2018-04-19 14:32:03.674 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 14:32:03.710 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:32:03.714 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:32:03.718 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-19 14:32:03.722 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-19 14:32:03.726 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-19 14:32:03.730 +03:00 [DBG] Start authorize callback request
2018-04-19 14:32:03.755 +03:00 [DBG] User in authorize request: 077ae44f-5d54-418e-b731-24d58df76500
2018-04-19 14:32:03.762 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 14:32:03.765 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 14:32:03.769 +03:00 [DBG] No PKCE used.
2018-04-19 14:32:03.775 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 14:32:03.780 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "077ae44f-5d54-418e-b731-24d58df76500",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hyhAmCrKIuvuRHoCYswfSboGksHCRabiAs5IxjAopq9twt2TuABsha44iF3JUoTsemKYqxphKx4AmrR4EI0bDf-NKiMzH9IGqv-WVZKtd0AcfqbU1m_WWfMuB1nh7CyXQmyfIc__qqEn5zs7-NOCVtEdcfK4R3FmRyzcmIwvjaDNlGqlJi7_QoJeFZaIGGGbdMnpd_gmysza3RFhvRXVjFZVFGdwyv55GFBemRz-VKT99CT2XdGQsBKRU3UOOhAWLfdRlRbLQObFcsvMUdbVldVBs9Q6aKfFFUvjK5EYYeWGw1tSkhSrJrw__fGrlyQWI4",
  "Nonce": "636597342813805808.NjNmYTA4YjUtZWVhOS00N2NiLWJiNDctYWRhNTg4ODhiMTM4ZDY0NTVjMmUtNmY3OC00MzFhLWI3NTMtOTcyYWNjY2I2OTA2",
  "SessionId": "d1e7e23b0322c083bb66badb9cc6a7d7",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636597342813805808.NjNmYTA4YjUtZWVhOS00N2NiLWJiNDctYWRhNTg4ODhiMTM4ZDY0NTVjMmUtNmY3OC00MzFhLWI3NTMtOTcyYWNjY2I2OTA2",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hyhAmCrKIuvuRHoCYswfSboGksHCRabiAs5IxjAopq9twt2TuABsha44iF3JUoTsemKYqxphKx4AmrR4EI0bDf-NKiMzH9IGqv-WVZKtd0AcfqbU1m_WWfMuB1nh7CyXQmyfIc__qqEn5zs7-NOCVtEdcfK4R3FmRyzcmIwvjaDNlGqlJi7_QoJeFZaIGGGbdMnpd_gmysza3RFhvRXVjFZVFGdwyv55GFBemRz-VKT99CT2XdGQsBKRU3UOOhAWLfdRlRbLQObFcsvMUdbVldVBs9Q6aKfFFUvjK5EYYeWGw1tSkhSrJrw__fGrlyQWI4",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 14:32:03.870 +03:00 [DBG] user_consent grant with value: mvc|077ae44f-5d54-418e-b731-24d58df76500 not found in store.
2018-04-19 14:32:03.873 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-19 14:32:03.887 +03:00 [INF] User consented to scopes: ["openid","profile","api1"]
2018-04-19 14:32:03.907 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1"]
2018-04-19 14:32:03.914 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 077ae44f-5d54-418e-b731-24d58df76500
2018-04-19 14:32:03.938 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-19 14:32:03.974 +03:00 [DBG] Creating Implicit Flow response.
2018-04-19 14:32:03.990 +03:00 [DBG] Getting claims for identity token for subject: 077ae44f-5d54-418e-b731-24d58df76500 and client: mvc
2018-04-19 14:32:03.997 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 14:32:04.054 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "077ae44f-5d54-418e-b731-24d58df76500",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****gCZQ"
    },
    {
      "TokenType": "code",
      "TokenValue": "****d0f0"
    }
  ],
  "ActivityId": "0HLD5T3UVF2AB:00000011",
  "TimeStamp": "2018-04-19T11:32:04Z",
  "ProcessId": 12824,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:32:04.066 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "077ae44f-5d54-418e-b731-24d58df76500",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hyhAmCrKIuvuRHoCYswfSboGksHCRabiAs5IxjAopq9twt2TuABsha44iF3JUoTsemKYqxphKx4AmrR4EI0bDf-NKiMzH9IGqv-WVZKtd0AcfqbU1m_WWfMuB1nh7CyXQmyfIc__qqEn5zs7-NOCVtEdcfK4R3FmRyzcmIwvjaDNlGqlJi7_QoJeFZaIGGGbdMnpd_gmysza3RFhvRXVjFZVFGdwyv55GFBemRz-VKT99CT2XdGQsBKRU3UOOhAWLfdRlRbLQObFcsvMUdbVldVBs9Q6aKfFFUvjK5EYYeWGw1tSkhSrJrw__fGrlyQWI4",
  "Scope": "openid profile api1"
}
2018-04-19 14:32:04.087 +03:00 [DBG] Augmenting SignInContext
2018-04-19 14:32:04.092 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 14:32:04.434 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-19 14:32:04.444 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-19 14:32:04.450 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-19 14:32:04.464 +03:00 [DBG] Start token request.
2018-04-19 14:32:04.475 +03:00 [DBG] Start client validation
2018-04-19 14:32:04.485 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-19 14:32:04.493 +03:00 [DBG] Start parsing for secret in post body
2018-04-19 14:32:04.498 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-19 14:32:04.503 +03:00 [DBG] Secret id found: mvc
2018-04-19 14:32:04.519 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-19 14:32:04.523 +03:00 [DBG] Client validation success
2018-04-19 14:32:04.532 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD5T3UVF2AK:00000001",
  "TimeStamp": "2018-04-19T11:32:04Z",
  "ProcessId": 12824,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:32:04.547 +03:00 [DBG] Start token request validation
2018-04-19 14:32:04.564 +03:00 [DBG] Start validation of authorization code token request
2018-04-19 14:32:04.672 +03:00 [DBG] Validation of authorization code token request success
2018-04-19 14:32:04.681 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "69814ba89a24d2132ae44feddae2edc29bf80e90ac8e2842193013ef8065d0f0",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "69814ba89a24d2132ae44feddae2edc29bf80e90ac8e2842193013ef8065d0f0",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-19 14:32:04.717 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-19 14:32:04.723 +03:00 [DBG] Getting claims for access token for subject: 077ae44f-5d54-418e-b731-24d58df76500
2018-04-19 14:32:04.883 +03:00 [DBG] Getting claims for identity token for subject: 077ae44f-5d54-418e-b731-24d58df76500 and client: mvc
2018-04-19 14:32:04.888 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 14:32:04.896 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****sJTA"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****WsrA"
    }
  ],
  "ActivityId": "0HLD5T3UVF2AK:00000001",
  "TimeStamp": "2018-04-19T11:32:04Z",
  "ProcessId": 12824,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:32:04.904 +03:00 [DBG] Token request success.
2018-04-19 14:32:04.928 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-19 14:32:04.934 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-19 14:32:04.937 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-19 14:32:04.948 +03:00 [DBG] Start userinfo request
2018-04-19 14:32:04.958 +03:00 [DBG] Bearer token found in header
2018-04-19 14:32:05.065 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 14:32:05.070 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524137524,
    "exp": 1524141124,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "077ae44f-5d54-418e-b731-24d58df76500",
    "auth_time": 1524137509,
    "idp": "aad",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "external"
  }
}
2018-04-19 14:32:05.081 +03:00 [DBG] Creating userinfo response
2018-04-19 14:32:05.092 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-19 14:32:05.102 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-19 14:32:05.109 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-19 14:32:05.114 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-19 14:32:05.259 +03:00 [INF] Profile service returned to the following claim types: sub name preferred_username
2018-04-19 14:32:05.264 +03:00 [DBG] End userinfo request
2018-04-19 14:32:22.691 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:32:22.700 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:32:24.273 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:32:24.281 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:38:06.752 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 14:38:06.811 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 14:38:06.818 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 14:38:06.821 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 14:38:06.824 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 14:38:06.826 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 14:38:09.011 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:38:09.034 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:38:17.967 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:38:17.975 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:38:20.278 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:38:20.283 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:38:20.286 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:38:20.383 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-19 14:38:20.389 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 14:38:20.393 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-19 14:38:20.465 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "077ae44f-5d54-418e-b731-24d58df76500",
  "DisplayName": "Çağlar Sert",
  "ActivityId": "0HLD5T82LCGRT:00000003",
  "TimeStamp": "2018-04-19T11:38:20Z",
  "ProcessId": 27284,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:38:21.357 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:38:21.364 +03:00 [INF] AuthenticationScheme: aad signed out.
2018-04-19 14:38:24.446 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-19 14:38:24.461 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-19 14:38:24.466 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-19 14:38:24.474 +03:00 [DBG] Processing signout callback request
2018-04-19 14:38:24.496 +03:00 [DBG] No client front-channel logout URLs
2018-04-19 14:38:24.500 +03:00 [DBG] No client back-channel logout URLs
2018-04-19 14:38:24.503 +03:00 [INF] Successful signout callback.
2018-04-19 14:38:24.506 +03:00 [DBG] No client front-channel iframe urls
2018-04-19 14:38:24.509 +03:00 [DBG] No client back-channel iframe urls
2018-04-19 14:38:32.666 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 14:38:45.314 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 14:38:55.829 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:38:56.056 +03:00 [ERR] Exception occurred while processing message.
Microsoft.IdentityModel.Tokens.SecurityTokenInvalidIssuerException: IDX10205: Issuer validation failed. Issuer: 'https://sts.windows.net/dd7a82b0-2195-409f-b09f-e0e8226753ad/'. Did not match: validationParameters.ValidIssuer: 'null' or validationParameters.ValidIssuers: 'https://sts.windows.net/{tenantid}/'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateIssuer(String issuer, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateIssuer(String issuer, JwtSecurityToken securityToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateTokenPayload(JwtSecurityToken jwt, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken)
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler.ValidateToken(String idToken, AuthenticationProperties properties, TokenValidationParameters validationParameters, JwtSecurityToken& jwt)
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler.<HandleRemoteAuthenticateAsync>d__21.MoveNext()
2018-04-19 14:38:56.107 +03:00 [INF] Error from RemoteAuthentication: IDX10205: Issuer validation failed. Issuer: 'https://sts.windows.net/dd7a82b0-2195-409f-b09f-e0e8226753ad/'. Did not match: validationParameters.ValidIssuer: 'null' or validationParameters.ValidIssuers: 'https://sts.windows.net/{tenantid}/'..
2018-04-19 14:38:56.417 +03:00 [ERR] An unhandled exception has occurred while executing the request
Microsoft.IdentityModel.Tokens.SecurityTokenInvalidIssuerException: IDX10205: Issuer validation failed. Issuer: 'https://sts.windows.net/dd7a82b0-2195-409f-b09f-e0e8226753ad/'. Did not match: validationParameters.ValidIssuer: 'null' or validationParameters.ValidIssuers: 'https://sts.windows.net/{tenantid}/'.
   at Microsoft.AspNetCore.Authentication.RemoteAuthenticationHandler`1.<HandleRequestAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOut.AuthenticationRequestHandlerWrapper.<HandleRequestAsync>d__6.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\FederatedSignOut\AuthenticationRequestHandlerWrapper.cs:line 38
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-19 14:40:21.966 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 14:40:22.036 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 14:40:22.044 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 14:40:22.047 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 14:40:22.050 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 14:40:22.052 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 14:40:32.392 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 14:40:33.904 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 14:40:44.826 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 14:40:45.321 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:41:18.822 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-19 14:41:23.286 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-19 14:42:47.952 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "aad",
  "ProviderUserId": "W9w3bFWsvQaZSMY40X_1A2EPi4gE9NxeA76G30M1NTA",
  "SubjectId": "077ae44f-5d54-418e-b731-24d58df76500",
  "DisplayName": "Çağlar Sert",
  "Endpoint": "UI",
  "ActivityId": "0HLD5T9AV2N0R:00000005",
  "TimeStamp": "2018-04-19T11:42:47Z",
  "ProcessId": 33092,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:42:48.111 +03:00 [DBG] Augmenting SignInContext
2018-04-19 14:42:48.119 +03:00 [DBG] Adding amr claim with value: external
2018-04-19 14:42:48.133 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 14:42:48.498 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 14:42:52.521 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:42:52.527 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:43:49.836 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:43:49.843 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:43:52.387 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:43:52.394 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:43:52.398 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:43:52.452 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-19 14:43:52.457 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 14:43:52.463 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-19 14:43:52.476 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "077ae44f-5d54-418e-b731-24d58df76500",
  "DisplayName": "Çağlar Sert",
  "ActivityId": "0HLD5T9AV2N0R:00000008",
  "TimeStamp": "2018-04-19T11:43:52Z",
  "ProcessId": 33092,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:43:52.493 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:43:52.499 +03:00 [INF] AuthenticationScheme: aad signed out.
2018-04-19 14:44:01.831 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 14:44:03.359 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 14:44:35.695 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:44:35.702 +03:00 [ERR] Message contains error: 'access_denied', error_description: 'AADSTS65004: The resource owner or authorization server denied the request.
Trace ID: a878fa77-a1d1-41f4-b92a-b5dcfce84f00
Correlation ID: 19f893c4-d39d-4bb1-b7ad-e5ddf9ffcf16
Timestamp: 2018-04-19 11:44:34Z', error_uri: 'error_uri is null'.
2018-04-19 14:44:35.710 +03:00 [INF] Error from RemoteAuthentication: Message contains error: 'access_denied', error_description: 'AADSTS65004: The resource owner or authorization server denied the request.
Trace ID: a878fa77-a1d1-41f4-b92a-b5dcfce84f00
Correlation ID: 19f893c4-d39d-4bb1-b7ad-e5ddf9ffcf16
Timestamp: 2018-04-19 11:44:34Z', error_uri: 'error_uri is null'..
2018-04-19 14:44:36.066 +03:00 [ERR] An unhandled exception has occurred while executing the request
Microsoft.IdentityModel.Protocols.OpenIdConnect.OpenIdConnectProtocolException: Message contains error: 'access_denied', error_description: 'AADSTS65004: The resource owner or authorization server denied the request.
Trace ID: a878fa77-a1d1-41f4-b92a-b5dcfce84f00
Correlation ID: 19f893c4-d39d-4bb1-b7ad-e5ddf9ffcf16
Timestamp: 2018-04-19 11:44:34Z', error_uri: 'error_uri is null'.
   at Microsoft.AspNetCore.Authentication.RemoteAuthenticationHandler`1.<HandleRequestAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOut.AuthenticationRequestHandlerWrapper.<HandleRequestAsync>d__6.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\FederatedSignOut\AuthenticationRequestHandlerWrapper.cs:line 38
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-19 14:44:41.926 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 14:46:28.345 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-19 14:46:28.360 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-19 14:46:28.365 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-19 14:46:28.383 +03:00 [DBG] Processing signout request for anonymous
2018-04-19 14:46:28.394 +03:00 [DBG] Start end session request validation
2018-04-19 14:46:28.407 +03:00 [DBG] Start identity token validation
2018-04-19 14:46:28.418 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-19 14:46:45.701 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-19 14:46:45.706 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-19 14:46:45.737 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-19 14:46:45.754 +03:00 [DBG] Processing signout request for anonymous
2018-04-19 14:46:45.758 +03:00 [DBG] Start end session request validation
2018-04-19 14:46:45.771 +03:00 [INF] End session request validation success
{
  "SubjectId": "unknown",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hyeb2V0v-vnmSao3m8aw7ZuVhwakw0EPyN4Q5vx4M97nSGSyBs1hKxqth4ZwyDcqVXGb62UQOcPwUkpdNW5yOk2FD1rWta7wsFFuE5y9X8jHenBhmqTCGlWlOhEBs5ELUU3qcs3E5tXZnEETTTMBcHW",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 14:46:45.777 +03:00 [DBG] Success validating end session request from null
2018-04-19 14:46:48.477 +03:00 [ERR] Failed executing DbCommand (958ms) [Parameters=[@__get_Item_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT "e"."Id", "e"."AccessFailedCount", "e"."ConcurrencyStamp", "e"."Email", "e"."EmailConfirmed", "e"."LockoutEnabled", "e"."LockoutEnd", "e"."NormalizedEmail", "e"."NormalizedUserName", "e"."PasswordHash", "e"."PhoneNumber", "e"."PhoneNumberConfirmed", "e"."SecurityStamp", "e"."TwoFactorEnabled", "e"."UserName"
FROM "AspNetUsers" AS "e"
WHERE "e"."Id" = @__get_Item_0
LIMIT 1
Npgsql.NpgsqlException (0x80004005): Exception while reading from stream ---> System.IO.IOException: Unable to transfer data on the transport connection: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond
   --- End of inner exception stack trace ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadPrependedMessages>d__157.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
2018-04-19 14:46:49.890 +03:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure. ---> Npgsql.NpgsqlException: Exception while reading from stream ---> System.IO.IOException: Unable to transfer data on the transport connection: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond
   --- End of inner exception stack trace ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
   --- End of inner exception stack trace ---
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadPrependedMessages>d__157.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure. ---> Npgsql.NpgsqlException: Exception while reading from stream ---> System.IO.IOException: Unable to transfer data on the transport connection: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond
   --- End of inner exception stack trace ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
   --- End of inner exception stack trace ---
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadPrependedMessages>d__157.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
2018-04-19 14:46:50.299 +03:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure. ---> Npgsql.NpgsqlException: Exception while reading from stream ---> System.IO.IOException: Unable to transfer data on the transport connection: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond
   --- End of inner exception stack trace ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
   --- End of inner exception stack trace ---
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadPrependedMessages>d__157.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure. ---> Npgsql.NpgsqlException: Exception while reading from stream ---> System.IO.IOException: Unable to transfer data on the transport connection: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond
   --- End of inner exception stack trace ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
   --- End of inner exception stack trace ---
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadPrependedMessages>d__157.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()
2018-04-19 14:46:51.325 +03:00 [INF] {
  "Name": "Unhandled Exception",
  "Category": "Error",
  "EventType": "Error",
  "Id": 3000,
  "Details": "System.InvalidOperationException: An exception has been raised that is likely due to a transient failure. ---> Npgsql.NpgsqlException: Exception while reading from stream ---> System.IO.IOException: Unable to transfer data on the transport connection: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond\r\n   --- End of inner exception stack trace ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()\r\n   --- End of inner exception stack trace ---\r\n   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()\r\n   at Npgsql.NpgsqlConnector.<ReadPrependedMessages>d__157.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()\r\n   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()\r\n   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()\r\n   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()\r\n   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()\r\n   --- End of inner exception stack trace ---\r\n   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()\r\n   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()\r\n   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()\r\n   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.AspNetIdentity.ProfileService`1.<IsActiveAsync>d__4.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Validation.TokenValidator.<ValidateIdentityTokenAsync>d__12.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Validation\\TokenValidator.cs:line 121\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Validation.EndSessionRequestValidator.<ValidateAsync>d__9.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Validation\\EndSessionRequestValidator.cs:line 74\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Endpoints.EndSessionEndpoint.<ProcessAsync>d__4.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Endpoints\\EndSessionEndpoint.cs:line 56\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Hosting\\IdentityServerMiddleware.cs:line 54",
  "Message": "An exception has been raised that is likely due to a transient failure.",
  "ActivityId": "0HLD5T9AV2N0R:00000013",
  "TimeStamp": "2018-04-19T11:46:51Z",
  "ProcessId": 33092,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:46:51.390 +03:00 [FTL] Unhandled exception: System.InvalidOperationException: An exception has been raised that is likely due to a transient failure. ---> Npgsql.NpgsqlException: Exception while reading from stream ---> System.IO.IOException: Unable to transfer data on the transport connection: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond
   --- End of inner exception stack trace ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
   --- End of inner exception stack trace ---
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadPrependedMessages>d__157.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.AspNetIdentity.ProfileService`1.<IsActiveAsync>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Validation.TokenValidator.<ValidateIdentityTokenAsync>d__12.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Validation\TokenValidator.cs:line 121
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Validation.EndSessionRequestValidator.<ValidateAsync>d__9.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Validation\EndSessionRequestValidator.cs:line 74
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Endpoints.EndSessionEndpoint.<ProcessAsync>d__4.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Endpoints\EndSessionEndpoint.cs:line 56
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 54
2018-04-19 14:46:53.481 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure. ---> Npgsql.NpgsqlException: Exception while reading from stream ---> System.IO.IOException: Unable to transfer data on the transport connection: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond
   --- End of inner exception stack trace ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
   --- End of inner exception stack trace ---
   at Npgsql.ReadBuffer.<Ensure>d__27.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadPrependedMessages>d__157.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlDataReader.<<NextResultAsync>b__31_0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlCommand.<>c__DisplayClass90_0.<<ExecuteDbDataReaderAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.<ExecuteAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.AspNetIdentity.ProfileService`1.<IsActiveAsync>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Validation.TokenValidator.<ValidateIdentityTokenAsync>d__12.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Validation\TokenValidator.cs:line 121
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Validation.EndSessionRequestValidator.<ValidateAsync>d__9.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Validation\EndSessionRequestValidator.cs:line 74
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Endpoints.EndSessionEndpoint.<ProcessAsync>d__4.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Endpoints\EndSessionEndpoint.cs:line 56
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 54
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-19 14:46:55.607 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-19 14:46:55.616 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-19 14:46:55.620 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-19 14:46:55.632 +03:00 [DBG] Start authorize request
2018-04-19 14:46:55.644 +03:00 [DBG] No user present in authorize request
2018-04-19 14:46:55.657 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 14:46:55.673 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 14:46:55.678 +03:00 [DBG] No PKCE used.
2018-04-19 14:46:55.740 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 14:46:55.765 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hx21CJk8gZciznR14DyBJLG-8EjDyO6hJSbhiqT-satfIHUqGoyrE52Nrgf8f50jcPWKlQIaiDo2AkdiZ_jV8AakZM0_IozCBxZ0xexdZWP5ZyuWCa0z7vu5FinpMiAprZi8uGF9zpDidt8UPafOdJZwUBK7PCtlcxkxylhsYD5ban2HqUJ-0tVGnXjimMQWJd309UMP6HArK5k-RwsQZFJZ6l7iaNNspl5mqvF_Pp1Ujmel6ximtaspmlfJQCgz31wiIi6mVheKMcU9sHuOVjLKiIC-q_6IjktJYzocZ3V3jmWfECr1wCyoOo80P8XWYk",
  "Nonce": "636597352155947921.OTcwMzNkNDItMGUyZi00NzA1LWJhZjktZDlkZTUwODJkNGZkNGNkMWI0MmYtZGJiMy00MzI4LTkzZTAtZmQwYzliMjNjMDU4",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636597352155947921.OTcwMzNkNDItMGUyZi00NzA1LWJhZjktZDlkZTUwODJkNGZkNGNkMWI0MmYtZGJiMy00MzI4LTkzZTAtZmQwYzliMjNjMDU4",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hx21CJk8gZciznR14DyBJLG-8EjDyO6hJSbhiqT-satfIHUqGoyrE52Nrgf8f50jcPWKlQIaiDo2AkdiZ_jV8AakZM0_IozCBxZ0xexdZWP5ZyuWCa0z7vu5FinpMiAprZi8uGF9zpDidt8UPafOdJZwUBK7PCtlcxkxylhsYD5ban2HqUJ-0tVGnXjimMQWJd309UMP6HArK5k-RwsQZFJZ6l7iaNNspl5mqvF_Pp1Ujmel6ximtaspmlfJQCgz31wiIi6mVheKMcU9sHuOVjLKiIC-q_6IjktJYzocZ3V3jmWfECr1wCyoOo80P8XWYk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 14:46:55.795 +03:00 [INF] Showing login: User is not authenticated
2018-04-19 14:46:55.825 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 14:46:55.829 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 14:46:55.833 +03:00 [DBG] No PKCE used.
2018-04-19 14:46:55.836 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 14:47:07.738 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:47:09.240 +03:00 [DBG] Augmenting SignInContext
2018-04-19 14:47:09.243 +03:00 [DBG] Adding idp claim with value: local
2018-04-19 14:47:09.245 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-19 14:47:09.249 +03:00 [DBG] Adding auth_time claim with value: 1524138429
2018-04-19 14:47:09.252 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 14:47:09.363 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD5T9AV2N12:00000007",
  "TimeStamp": "2018-04-19T11:47:09Z",
  "ProcessId": 33092,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:47:09.384 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:47:09.388 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:47:09.391 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-19 14:47:09.396 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-19 14:47:09.399 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-19 14:47:09.411 +03:00 [DBG] Start authorize callback request
2018-04-19 14:47:09.423 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 14:47:09.428 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 14:47:09.433 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 14:47:09.436 +03:00 [DBG] No PKCE used.
2018-04-19 14:47:09.439 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 14:47:09.443 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hx21CJk8gZciznR14DyBJLG-8EjDyO6hJSbhiqT-satfIHUqGoyrE52Nrgf8f50jcPWKlQIaiDo2AkdiZ_jV8AakZM0_IozCBxZ0xexdZWP5ZyuWCa0z7vu5FinpMiAprZi8uGF9zpDidt8UPafOdJZwUBK7PCtlcxkxylhsYD5ban2HqUJ-0tVGnXjimMQWJd309UMP6HArK5k-RwsQZFJZ6l7iaNNspl5mqvF_Pp1Ujmel6ximtaspmlfJQCgz31wiIi6mVheKMcU9sHuOVjLKiIC-q_6IjktJYzocZ3V3jmWfECr1wCyoOo80P8XWYk",
  "Nonce": "636597352155947921.OTcwMzNkNDItMGUyZi00NzA1LWJhZjktZDlkZTUwODJkNGZkNGNkMWI0MmYtZGJiMy00MzI4LTkzZTAtZmQwYzliMjNjMDU4",
  "SessionId": "5155274cb1ebc09032acf246137ed884",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636597352155947921.OTcwMzNkNDItMGUyZi00NzA1LWJhZjktZDlkZTUwODJkNGZkNGNkMWI0MmYtZGJiMy00MzI4LTkzZTAtZmQwYzliMjNjMDU4",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hx21CJk8gZciznR14DyBJLG-8EjDyO6hJSbhiqT-satfIHUqGoyrE52Nrgf8f50jcPWKlQIaiDo2AkdiZ_jV8AakZM0_IozCBxZ0xexdZWP5ZyuWCa0z7vu5FinpMiAprZi8uGF9zpDidt8UPafOdJZwUBK7PCtlcxkxylhsYD5ban2HqUJ-0tVGnXjimMQWJd309UMP6HArK5k-RwsQZFJZ6l7iaNNspl5mqvF_Pp1Ujmel6ximtaspmlfJQCgz31wiIi6mVheKMcU9sHuOVjLKiIC-q_6IjktJYzocZ3V3jmWfECr1wCyoOo80P8XWYk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 14:47:09.558 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-19 14:47:09.564 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-19 14:47:09.568 +03:00 [INF] Showing consent: User has not yet consented
2018-04-19 14:47:09.585 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:47:09.591 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:47:09.613 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 14:47:09.616 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 14:47:09.620 +03:00 [DBG] No PKCE used.
2018-04-19 14:47:09.624 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 14:47:17.377 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:47:17.385 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:47:17.390 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:47:17.425 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 14:47:17.431 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 14:47:17.436 +03:00 [DBG] No PKCE used.
2018-04-19 14:47:17.439 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 14:47:17.485 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:47:17.491 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:47:17.497 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-19 14:47:17.503 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-19 14:47:17.512 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-19 14:47:17.518 +03:00 [DBG] Start authorize callback request
2018-04-19 14:47:17.547 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 14:47:17.552 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 14:47:17.555 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 14:47:17.559 +03:00 [DBG] No PKCE used.
2018-04-19 14:47:17.563 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 14:47:17.568 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hx21CJk8gZciznR14DyBJLG-8EjDyO6hJSbhiqT-satfIHUqGoyrE52Nrgf8f50jcPWKlQIaiDo2AkdiZ_jV8AakZM0_IozCBxZ0xexdZWP5ZyuWCa0z7vu5FinpMiAprZi8uGF9zpDidt8UPafOdJZwUBK7PCtlcxkxylhsYD5ban2HqUJ-0tVGnXjimMQWJd309UMP6HArK5k-RwsQZFJZ6l7iaNNspl5mqvF_Pp1Ujmel6ximtaspmlfJQCgz31wiIi6mVheKMcU9sHuOVjLKiIC-q_6IjktJYzocZ3V3jmWfECr1wCyoOo80P8XWYk",
  "Nonce": "636597352155947921.OTcwMzNkNDItMGUyZi00NzA1LWJhZjktZDlkZTUwODJkNGZkNGNkMWI0MmYtZGJiMy00MzI4LTkzZTAtZmQwYzliMjNjMDU4",
  "SessionId": "5155274cb1ebc09032acf246137ed884",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636597352155947921.OTcwMzNkNDItMGUyZi00NzA1LWJhZjktZDlkZTUwODJkNGZkNGNkMWI0MmYtZGJiMy00MzI4LTkzZTAtZmQwYzliMjNjMDU4",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hx21CJk8gZciznR14DyBJLG-8EjDyO6hJSbhiqT-satfIHUqGoyrE52Nrgf8f50jcPWKlQIaiDo2AkdiZ_jV8AakZM0_IozCBxZ0xexdZWP5ZyuWCa0z7vu5FinpMiAprZi8uGF9zpDidt8UPafOdJZwUBK7PCtlcxkxylhsYD5ban2HqUJ-0tVGnXjimMQWJd309UMP6HArK5k-RwsQZFJZ6l7iaNNspl5mqvF_Pp1Ujmel6ximtaspmlfJQCgz31wiIi6mVheKMcU9sHuOVjLKiIC-q_6IjktJYzocZ3V3jmWfECr1wCyoOo80P8XWYk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 14:47:17.657 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-19 14:47:17.664 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-19 14:47:17.681 +03:00 [INF] User consented to scopes: ["openid","profile","api1"]
2018-04-19 14:47:17.693 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1"]
2018-04-19 14:47:17.701 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 14:47:17.725 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-19 14:47:17.767 +03:00 [DBG] Creating Implicit Flow response.
2018-04-19 14:47:17.783 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-19 14:47:17.793 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 14:47:17.852 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****l26A"
    },
    {
      "TokenType": "code",
      "TokenValue": "****aa9a"
    }
  ],
  "ActivityId": "0HLD5T9AV2N12:0000000B",
  "TimeStamp": "2018-04-19T11:47:17Z",
  "ProcessId": 33092,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:47:17.864 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hx21CJk8gZciznR14DyBJLG-8EjDyO6hJSbhiqT-satfIHUqGoyrE52Nrgf8f50jcPWKlQIaiDo2AkdiZ_jV8AakZM0_IozCBxZ0xexdZWP5ZyuWCa0z7vu5FinpMiAprZi8uGF9zpDidt8UPafOdJZwUBK7PCtlcxkxylhsYD5ban2HqUJ-0tVGnXjimMQWJd309UMP6HArK5k-RwsQZFJZ6l7iaNNspl5mqvF_Pp1Ujmel6ximtaspmlfJQCgz31wiIi6mVheKMcU9sHuOVjLKiIC-q_6IjktJYzocZ3V3jmWfECr1wCyoOo80P8XWYk",
  "Scope": "openid profile api1"
}
2018-04-19 14:47:17.888 +03:00 [DBG] Augmenting SignInContext
2018-04-19 14:47:17.892 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 14:47:18.080 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-19 14:47:18.094 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-19 14:47:18.099 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-19 14:47:18.114 +03:00 [DBG] Start token request.
2018-04-19 14:47:18.125 +03:00 [DBG] Start client validation
2018-04-19 14:47:18.135 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-19 14:47:18.145 +03:00 [DBG] Start parsing for secret in post body
2018-04-19 14:47:18.152 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-19 14:47:18.155 +03:00 [DBG] Secret id found: mvc
2018-04-19 14:47:18.172 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-19 14:47:18.175 +03:00 [DBG] Client validation success
2018-04-19 14:47:18.188 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD5T9AV2N18:00000001",
  "TimeStamp": "2018-04-19T11:47:18Z",
  "ProcessId": 33092,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:47:18.203 +03:00 [DBG] Start token request validation
2018-04-19 14:47:18.221 +03:00 [DBG] Start validation of authorization code token request
2018-04-19 14:47:18.338 +03:00 [DBG] Validation of authorization code token request success
2018-04-19 14:47:18.349 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "51e89906eca0eade5767c6e4a8589843508dfed6e24e669e12d20ae45c15aa9a",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "51e89906eca0eade5767c6e4a8589843508dfed6e24e669e12d20ae45c15aa9a",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-19 14:47:18.384 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-19 14:47:18.390 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 14:47:18.588 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-19 14:47:18.596 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 14:47:18.604 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****diIA"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****gh9g"
    }
  ],
  "ActivityId": "0HLD5T9AV2N18:00000001",
  "TimeStamp": "2018-04-19T11:47:18Z",
  "ProcessId": 33092,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:47:18.619 +03:00 [DBG] Token request success.
2018-04-19 14:47:18.649 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-19 14:47:18.656 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-19 14:47:18.660 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-19 14:47:18.675 +03:00 [DBG] Start userinfo request
2018-04-19 14:47:18.685 +03:00 [DBG] Bearer token found in header
2018-04-19 14:47:18.785 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 14:47:18.798 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524138438,
    "exp": 1524142038,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524138429,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-04-19 14:47:18.819 +03:00 [DBG] Creating userinfo response
2018-04-19 14:47:18.828 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-19 14:47:18.837 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-19 14:47:18.844 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-19 14:47:18.850 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-19 14:47:18.998 +03:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-04-19 14:47:19.004 +03:00 [DBG] End userinfo request
2018-04-19 14:47:33.590 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:47:33.598 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:47:42.093 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:47:42.098 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:47:42.109 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-19 14:47:42.113 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-19 14:47:42.121 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-19 14:47:42.127 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-19 14:47:42.132 +03:00 [DBG] Start end session request validation
2018-04-19 14:47:42.137 +03:00 [DBG] Start identity token validation
2018-04-19 14:47:42.142 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-19 14:47:42.229 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 14:47:42.238 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524138438,
    "exp": 1524138738,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636597352155947921.OTcwMzNkNDItMGUyZi00NzA1LWJhZjktZDlkZTUwODJkNGZkNGNkMWI0MmYtZGJiMy00MzI4LTkzZTAtZmQwYzliMjNjMDU4",
    "iat": 1524138438,
    "at_hash": "SxNCH1GoltN4u6FgnyIhZw",
    "sid": "5155274cb1ebc09032acf246137ed884",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524138429,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-19 14:47:42.248 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hykXZ-d2FPY7lqmWqC5h-rbm6IoZ4FPTZdv2Enk1KBCVXME6VQAjMpYpfbv0amZoFLvyJN8qIQarLBP79WG_jEJn9-8JWhGbBWwhEHx2KZXAOL7ALZJ6mDXY8_3K7Y04Ci7kF3th7ZuLi3j3O8mn8rc",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQxMzg0MzgsImV4cCI6MTUyNDEzODczOCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY1OTczNTIxNTU5NDc5MjEuT1Rjd016TmtOREl0TUdVeVppMDBOekExTFdKaFpqa3RaRGxrWlRVd09ESmtOR1prTkdOa01XSTBNbVl0WkdKaU15MDBNekk0TFRrelpUQXRabVF3WXpsaU1qTmpNRFU0IiwiaWF0IjoxNTI0MTM4NDM4LCJhdF9oYXNoIjoiU3hOQ0gxR29sdE40dTZGZ255SWhadyIsInNpZCI6IjUxNTUyNzRjYjFlYmMwOTAzMmFjZjI0NjEzN2VkODg0Iiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0MTM4NDI5LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.sl9Nq8t06BDOpLI20zbeMBZ7rrU_7D5Y-NDR2H95FzAHYhJ14pNvMNuTDt2xPrcqv5vo2wYXvp8kqf1TbSHgIusPWlwAXUwiFF_nlxwnP6SqEO_0vv3PoH3TXTpFymIYnQSDwzSqj49YjUlBpDYdzmTI1dwmeK8lgn0l4Lw9msTNNL06_wg_Ehf7L1pecvWc34MiamZZ9qqikvAtZjp1vX4kAVkzARH1lYn0NLO5aoxqcKiDCiRJ3Ll1dnPp-AGppARN3-nL-R_xEUHJL7crDVMhzIcCt35TaiOy5_OlfAg5VD6uURT_rk0HOVm6Djd1iAJtJT5ZY7xISqRnjbdiIA",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hykXZ-d2FPY7lqmWqC5h-rbm6IoZ4FPTZdv2Enk1KBCVXME6VQAjMpYpfbv0amZoFLvyJN8qIQarLBP79WG_jEJn9-8JWhGbBWwhEHx2KZXAOL7ALZJ6mDXY8_3K7Y04Ci7kF3th7ZuLi3j3O8mn8rc",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 14:47:42.263 +03:00 [DBG] Success validating end session request from mvc
2018-04-19 14:47:42.290 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:47:42.295 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:47:42.312 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-19 14:47:42.317 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 14:47:42.322 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-19 14:47:42.327 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD5T9AV2N12:0000000E",
  "TimeStamp": "2018-04-19T11:47:42Z",
  "ProcessId": 33092,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:47:42.493 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-19 14:47:42.501 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-19 14:47:42.508 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-19 14:47:42.519 +03:00 [DBG] Processing signout callback request
2018-04-19 14:47:42.541 +03:00 [DBG] No client front-channel logout URLs
2018-04-19 14:47:42.544 +03:00 [DBG] No client back-channel logout URLs
2018-04-19 14:47:42.548 +03:00 [INF] Successful signout callback.
2018-04-19 14:47:42.551 +03:00 [DBG] No client front-channel iframe urls
2018-04-19 14:47:42.558 +03:00 [DBG] No client back-channel iframe urls
2018-04-19 14:49:41.475 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 14:49:45.962 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 14:50:04.622 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:50:41.617 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-19 14:50:46.905 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-19 14:50:48.126 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "aad",
  "ProviderUserId": "kf7GBTTP-bR2JBCjNWq_BNVumdJG9GUT8xsTCTpJ3rQ",
  "SubjectId": "b520ea67-68d2-4096-a5d3-fa24d7456330",
  "DisplayName": "Bahadır Civelek",
  "Endpoint": "UI",
  "ActivityId": "0HLD5T9AV2N12:00000015",
  "TimeStamp": "2018-04-19T11:50:48Z",
  "ProcessId": 33092,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:50:48.133 +03:00 [DBG] Augmenting SignInContext
2018-04-19 14:50:48.136 +03:00 [DBG] Adding amr claim with value: external
2018-04-19 14:50:48.140 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 14:50:48.144 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 14:50:48.169 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:50:48.173 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:50:55.337 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:50:55.343 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:51:01.027 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:51:01.032 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:51:13.745 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:51:13.752 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:51:13.755 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-19 14:51:13.759 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-19 14:51:13.765 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-19 14:51:13.771 +03:00 [DBG] Start authorize request
2018-04-19 14:51:13.775 +03:00 [DBG] User in authorize request: b520ea67-68d2-4096-a5d3-fa24d7456330
2018-04-19 14:51:13.780 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 14:51:13.784 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 14:51:13.788 +03:00 [DBG] No PKCE used.
2018-04-19 14:51:13.793 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 14:51:13.798 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "b520ea67-68d2-4096-a5d3-fa24d7456330",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hx2sgThkL09O-ACzJMyEqAdbbZCRFZZ5_qqyBgV5aCjuvZLw0xibZQbkVR5KCC3uNFdL_AAdb4dkb4ZZl6vgDcfkbqUJSgPo-eBd3FPM31rwrv4UiHICPcyQqWwUMVybGzL6L0nEr7AuR4TSo59ruVEuzG7rDx5qguK1WAhHX9CPCQ5XdkuINZi6nj0avYOgvxImMtO_-tKZmzZhZYm5IaemQa9RL8YFzx8gFOHvfDcMejAuK3DFLe_afn0HSaRmG0X6fwFR9WH9RgGBO7hBfV7aO0qw1uiINhCzQrFgnVR5XtGa_76I_GbgKXO6yY7KPw",
  "Nonce": "636597354737347993.OGU1N2Q0MzMtZDFlYy00NDJjLTkwMzUtZWExODgzMTUyNmNjZGYwYWI2ZWYtZmI4MS00NjJhLWEwNWMtZTU4ZjMyMmRhODVi",
  "SessionId": "b3cbd9c45bbd7899fd4831b103b0f67d",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636597354737347993.OGU1N2Q0MzMtZDFlYy00NDJjLTkwMzUtZWExODgzMTUyNmNjZGYwYWI2ZWYtZmI4MS00NjJhLWEwNWMtZTU4ZjMyMmRhODVi",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hx2sgThkL09O-ACzJMyEqAdbbZCRFZZ5_qqyBgV5aCjuvZLw0xibZQbkVR5KCC3uNFdL_AAdb4dkb4ZZl6vgDcfkbqUJSgPo-eBd3FPM31rwrv4UiHICPcyQqWwUMVybGzL6L0nEr7AuR4TSo59ruVEuzG7rDx5qguK1WAhHX9CPCQ5XdkuINZi6nj0avYOgvxImMtO_-tKZmzZhZYm5IaemQa9RL8YFzx8gFOHvfDcMejAuK3DFLe_afn0HSaRmG0X6fwFR9WH9RgGBO7hBfV7aO0qw1uiINhCzQrFgnVR5XtGa_76I_GbgKXO6yY7KPw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 14:51:13.892 +03:00 [DBG] user_consent grant with value: mvc|b520ea67-68d2-4096-a5d3-fa24d7456330 not found in store.
2018-04-19 14:51:13.896 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-19 14:51:13.899 +03:00 [INF] Showing consent: User has not yet consented
2018-04-19 14:51:13.911 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:51:13.915 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:51:13.924 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 14:51:13.927 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 14:51:13.930 +03:00 [DBG] No PKCE used.
2018-04-19 14:51:13.933 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 14:51:25.451 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 14:51:25.458 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:51:25.464 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:51:25.471 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 14:51:25.474 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 14:51:25.477 +03:00 [DBG] No PKCE used.
2018-04-19 14:51:25.481 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 14:51:25.500 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:51:25.505 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 14:51:25.508 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-19 14:51:25.512 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-19 14:51:25.515 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-19 14:51:25.519 +03:00 [DBG] Start authorize callback request
2018-04-19 14:51:25.522 +03:00 [DBG] User in authorize request: b520ea67-68d2-4096-a5d3-fa24d7456330
2018-04-19 14:51:25.526 +03:00 [DBG] Start authorize request protocol validation
2018-04-19 14:51:25.529 +03:00 [DBG] Checking for PKCE parameters
2018-04-19 14:51:25.532 +03:00 [DBG] No PKCE used.
2018-04-19 14:51:25.536 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-19 14:51:25.540 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "b520ea67-68d2-4096-a5d3-fa24d7456330",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hx2sgThkL09O-ACzJMyEqAdbbZCRFZZ5_qqyBgV5aCjuvZLw0xibZQbkVR5KCC3uNFdL_AAdb4dkb4ZZl6vgDcfkbqUJSgPo-eBd3FPM31rwrv4UiHICPcyQqWwUMVybGzL6L0nEr7AuR4TSo59ruVEuzG7rDx5qguK1WAhHX9CPCQ5XdkuINZi6nj0avYOgvxImMtO_-tKZmzZhZYm5IaemQa9RL8YFzx8gFOHvfDcMejAuK3DFLe_afn0HSaRmG0X6fwFR9WH9RgGBO7hBfV7aO0qw1uiINhCzQrFgnVR5XtGa_76I_GbgKXO6yY7KPw",
  "Nonce": "636597354737347993.OGU1N2Q0MzMtZDFlYy00NDJjLTkwMzUtZWExODgzMTUyNmNjZGYwYWI2ZWYtZmI4MS00NjJhLWEwNWMtZTU4ZjMyMmRhODVi",
  "SessionId": "b3cbd9c45bbd7899fd4831b103b0f67d",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636597354737347993.OGU1N2Q0MzMtZDFlYy00NDJjLTkwMzUtZWExODgzMTUyNmNjZGYwYWI2ZWYtZmI4MS00NjJhLWEwNWMtZTU4ZjMyMmRhODVi",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hx2sgThkL09O-ACzJMyEqAdbbZCRFZZ5_qqyBgV5aCjuvZLw0xibZQbkVR5KCC3uNFdL_AAdb4dkb4ZZl6vgDcfkbqUJSgPo-eBd3FPM31rwrv4UiHICPcyQqWwUMVybGzL6L0nEr7AuR4TSo59ruVEuzG7rDx5qguK1WAhHX9CPCQ5XdkuINZi6nj0avYOgvxImMtO_-tKZmzZhZYm5IaemQa9RL8YFzx8gFOHvfDcMejAuK3DFLe_afn0HSaRmG0X6fwFR9WH9RgGBO7hBfV7aO0qw1uiINhCzQrFgnVR5XtGa_76I_GbgKXO6yY7KPw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-19 14:51:25.635 +03:00 [DBG] user_consent grant with value: mvc|b520ea67-68d2-4096-a5d3-fa24d7456330 not found in store.
2018-04-19 14:51:25.639 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-19 14:51:25.642 +03:00 [INF] User consented to scopes: ["openid","profile","api1"]
2018-04-19 14:51:25.647 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1"]
2018-04-19 14:51:25.652 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: b520ea67-68d2-4096-a5d3-fa24d7456330
2018-04-19 14:51:25.661 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-19 14:51:25.683 +03:00 [DBG] Creating Implicit Flow response.
2018-04-19 14:51:25.688 +03:00 [DBG] Getting claims for identity token for subject: b520ea67-68d2-4096-a5d3-fa24d7456330 and client: mvc
2018-04-19 14:51:25.691 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 14:51:25.698 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "b520ea67-68d2-4096-a5d3-fa24d7456330",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****jsPg"
    },
    {
      "TokenType": "code",
      "TokenValue": "****0f22"
    }
  ],
  "ActivityId": "0HLD5T9AV2N12:0000001C",
  "TimeStamp": "2018-04-19T11:51:25Z",
  "ProcessId": 33092,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:51:25.703 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "b520ea67-68d2-4096-a5d3-fa24d7456330",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hx2sgThkL09O-ACzJMyEqAdbbZCRFZZ5_qqyBgV5aCjuvZLw0xibZQbkVR5KCC3uNFdL_AAdb4dkb4ZZl6vgDcfkbqUJSgPo-eBd3FPM31rwrv4UiHICPcyQqWwUMVybGzL6L0nEr7AuR4TSo59ruVEuzG7rDx5qguK1WAhHX9CPCQ5XdkuINZi6nj0avYOgvxImMtO_-tKZmzZhZYm5IaemQa9RL8YFzx8gFOHvfDcMejAuK3DFLe_afn0HSaRmG0X6fwFR9WH9RgGBO7hBfV7aO0qw1uiINhCzQrFgnVR5XtGa_76I_GbgKXO6yY7KPw",
  "Scope": "openid profile api1"
}
2018-04-19 14:51:25.711 +03:00 [DBG] Augmenting SignInContext
2018-04-19 14:51:25.714 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 14:51:25.992 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-19 14:51:25.998 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-19 14:51:26.003 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-19 14:51:26.009 +03:00 [DBG] Start token request.
2018-04-19 14:51:26.012 +03:00 [DBG] Start client validation
2018-04-19 14:51:26.016 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-19 14:51:26.020 +03:00 [DBG] Start parsing for secret in post body
2018-04-19 14:51:26.024 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-19 14:51:26.028 +03:00 [DBG] Secret id found: mvc
2018-04-19 14:51:26.033 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-19 14:51:26.039 +03:00 [DBG] Client validation success
2018-04-19 14:51:26.042 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD5T9AV2N1G:00000001",
  "TimeStamp": "2018-04-19T11:51:26Z",
  "ProcessId": 33092,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:51:26.048 +03:00 [DBG] Start token request validation
2018-04-19 14:51:26.052 +03:00 [DBG] Start validation of authorization code token request
2018-04-19 14:51:26.156 +03:00 [DBG] Validation of authorization code token request success
2018-04-19 14:51:26.159 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "8733ebe79736705c0d2cb283e917226b4d01feb082607e9eb953f8ba93ba0f22",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "8733ebe79736705c0d2cb283e917226b4d01feb082607e9eb953f8ba93ba0f22",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-19 14:51:26.166 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-19 14:51:26.169 +03:00 [DBG] Getting claims for access token for subject: b520ea67-68d2-4096-a5d3-fa24d7456330
2018-04-19 14:51:26.316 +03:00 [DBG] Getting claims for identity token for subject: b520ea67-68d2-4096-a5d3-fa24d7456330 and client: mvc
2018-04-19 14:51:26.321 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-19 14:51:26.326 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****mQDQ"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****bVkw"
    }
  ],
  "ActivityId": "0HLD5T9AV2N1G:00000001",
  "TimeStamp": "2018-04-19T11:51:26Z",
  "ProcessId": 33092,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 14:51:26.332 +03:00 [DBG] Token request success.
2018-04-19 14:51:26.342 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-19 14:51:26.346 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-19 14:51:26.351 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-19 14:51:26.355 +03:00 [DBG] Start userinfo request
2018-04-19 14:51:26.357 +03:00 [DBG] Bearer token found in header
2018-04-19 14:51:26.438 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-19 14:51:26.443 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524138686,
    "exp": 1524142286,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "b520ea67-68d2-4096-a5d3-fa24d7456330",
    "auth_time": 1524138648,
    "idp": "aad",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "external"
  }
}
2018-04-19 14:51:26.447 +03:00 [DBG] Creating userinfo response
2018-04-19 14:51:26.450 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-19 14:51:26.458 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-19 14:51:26.462 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-19 14:51:26.468 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-19 14:51:26.611 +03:00 [INF] Profile service returned to the following claim types: sub name preferred_username
2018-04-19 14:51:26.616 +03:00 [DBG] End userinfo request
2018-04-19 15:15:40.068 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 15:15:40.129 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 15:15:40.137 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 15:15:40.140 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 15:15:40.143 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 15:15:40.146 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 15:15:42.688 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 15:15:42.711 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 15:17:43.949 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 15:17:43.954 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 15:17:46.673 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 15:17:46.681 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 15:17:46.686 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 15:17:46.783 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-19 15:17:46.792 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 15:17:46.797 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-19 15:17:46.881 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "b520ea67-68d2-4096-a5d3-fa24d7456330",
  "DisplayName": "Bahadır Civelek",
  "ActivityId": "0HLD5TT278CG9:00000003",
  "TimeStamp": "2018-04-19T12:17:46Z",
  "ProcessId": 7264,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 15:17:47.611 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 15:17:47.619 +03:00 [INF] AuthenticationScheme: aad signed out.
2018-04-19 15:18:05.073 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 15:18:53.684 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 15:19:35.423 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 15:19:35.497 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 15:19:35.504 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 15:19:35.507 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 15:19:35.509 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 15:19:35.511 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 15:20:01.414 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 15:20:50.777 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 15:20:51.312 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 15:21:45.213 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-19 15:21:47.414 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-19 15:21:50.978 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "aad",
  "ProviderUserId": "kf7GBTTP-bR2JBCjNWq_BNVumdJG9GUT8xsTCTpJ3rQ",
  "SubjectId": "b520ea67-68d2-4096-a5d3-fa24d7456330",
  "DisplayName": "Bahadır Civelek",
  "Endpoint": "UI",
  "ActivityId": "0HLD5TV8A5HU7:00000006",
  "TimeStamp": "2018-04-19T12:21:50Z",
  "ProcessId": 23832,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 15:21:50.998 +03:00 [DBG] Augmenting SignInContext
2018-04-19 15:21:51.005 +03:00 [DBG] Adding amr claim with value: external
2018-04-19 15:21:51.017 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-19 15:21:51.029 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 15:21:51.055 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 15:21:51.061 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 15:42:02.774 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 15:42:02.841 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 15:42:02.848 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 15:42:02.851 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 15:42:02.854 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 15:42:02.857 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 15:42:05.055 +03:00 [WRN] Heartbeat took longer than ""00:00:01"" at ""2018-04-19T12:42:05.0505940+00:00"".
2018-04-19 15:42:05.167 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 15:42:05.189 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 15:42:14.946 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 15:42:14.952 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 15:42:17.525 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 15:42:17.533 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 15:42:17.537 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-19 15:42:17.628 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-19 15:42:17.638 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-19 15:42:17.644 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-19 15:42:17.765 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "b520ea67-68d2-4096-a5d3-fa24d7456330",
  "DisplayName": "Bahadır Civelek",
  "ActivityId": "0HLD5UBPQMLB7:00000003",
  "TimeStamp": "2018-04-19T12:42:17Z",
  "ProcessId": 11508,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-19 15:42:18.416 +03:00 [INF] AuthenticationScheme: aad signed out.
2018-04-19 15:42:26.602 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 15:42:59.747 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 15:43:07.286 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 15:43:47.028 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 15:43:47.086 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 15:43:47.093 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 15:43:47.096 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 15:43:47.099 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 15:43:47.103 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 15:43:56.053 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 15:44:02.008 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 15:44:02.453 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 15:44:26.123 +03:00 [ERR] Exception occurred while processing message.
System.InvalidOperationException: No service for type 'Microsoft.AspNetCore.Identity.UserManager`1[PrimeApps.Auth.Models.ApplicationUser]' has been registered.
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at PrimeApps.Auth.Startup.<<ConfigureServices>b__10_6>d.MoveNext() in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Startup.cs:line 116
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler.<RunTokenValidatedEventAsync>d__30.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler.<HandleRemoteAuthenticateAsync>d__21.MoveNext()
2018-04-19 15:44:26.217 +03:00 [INF] Error from RemoteAuthentication: No service for type 'Microsoft.AspNetCore.Identity.UserManager`1[PrimeApps.Auth.Models.ApplicationUser]' has been registered..
2018-04-19 15:44:26.523 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.InvalidOperationException: No service for type 'Microsoft.AspNetCore.Identity.UserManager`1[PrimeApps.Auth.Models.ApplicationUser]' has been registered.
   at Microsoft.AspNetCore.Authentication.RemoteAuthenticationHandler`1.<HandleRequestAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOut.AuthenticationRequestHandlerWrapper.<HandleRequestAsync>d__6.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\FederatedSignOut\AuthenticationRequestHandlerWrapper.cs:line 38
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-19 15:44:34.961 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 15:44:36.252 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 15:44:36.717 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 15:44:40.472 +03:00 [ERR] Exception occurred while processing message.
System.InvalidOperationException: No service for type 'Microsoft.AspNetCore.Identity.UserManager`1[PrimeApps.Auth.Models.ApplicationUser]' has been registered.
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at PrimeApps.Auth.Startup.<<ConfigureServices>b__10_6>d.MoveNext() in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Startup.cs:line 116
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler.<RunTokenValidatedEventAsync>d__30.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler.<HandleRemoteAuthenticateAsync>d__21.MoveNext()
2018-04-19 15:44:40.495 +03:00 [INF] Error from RemoteAuthentication: No service for type 'Microsoft.AspNetCore.Identity.UserManager`1[PrimeApps.Auth.Models.ApplicationUser]' has been registered..
2018-04-19 15:44:40.780 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.InvalidOperationException: No service for type 'Microsoft.AspNetCore.Identity.UserManager`1[PrimeApps.Auth.Models.ApplicationUser]' has been registered.
   at Microsoft.AspNetCore.Authentication.RemoteAuthenticationHandler`1.<HandleRequestAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOut.AuthenticationRequestHandlerWrapper.<HandleRequestAsync>d__6.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\FederatedSignOut\AuthenticationRequestHandlerWrapper.cs:line 38
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-19 15:45:03.254 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 15:45:04.180 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 15:45:04.637 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 15:45:37.617 +03:00 [ERR] Exception occurred while processing message.
System.InvalidOperationException: No service for type 'Microsoft.AspNetCore.Identity.UserManager`1[PrimeApps.Auth.Models.ApplicationUser]' has been registered.
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at PrimeApps.Auth.Startup.<<ConfigureServices>b__10_6>d.MoveNext() in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Startup.cs:line 116
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler.<RunTokenValidatedEventAsync>d__30.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler.<HandleRemoteAuthenticateAsync>d__21.MoveNext()
2018-04-19 15:45:37.644 +03:00 [INF] Error from RemoteAuthentication: No service for type 'Microsoft.AspNetCore.Identity.UserManager`1[PrimeApps.Auth.Models.ApplicationUser]' has been registered..
2018-04-19 15:45:37.932 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.InvalidOperationException: No service for type 'Microsoft.AspNetCore.Identity.UserManager`1[PrimeApps.Auth.Models.ApplicationUser]' has been registered.
   at Microsoft.AspNetCore.Authentication.RemoteAuthenticationHandler`1.<HandleRequestAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOut.AuthenticationRequestHandlerWrapper.<HandleRequestAsync>d__6.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\FederatedSignOut\AuthenticationRequestHandlerWrapper.cs:line 38
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-19 15:46:42.481 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 15:46:42.540 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 15:46:42.547 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 15:46:42.550 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 15:46:42.553 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 15:46:42.555 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 15:47:12.379 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 15:47:18.189 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 15:47:18.931 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 15:47:29.839 +03:00 [ERR] Exception occurred while processing message.
System.InvalidOperationException: No service for type 'Microsoft.AspNetCore.Identity.UserManager`1[PrimeApps.Auth.Models.ApplicationUser]' has been registered.
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at PrimeApps.Auth.Startup.<<ConfigureServices>b__10_6>d.MoveNext() in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Startup.cs:line 115
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler.<RunTokenValidatedEventAsync>d__30.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler.<HandleRemoteAuthenticateAsync>d__21.MoveNext()
2018-04-19 15:47:29.926 +03:00 [INF] Error from RemoteAuthentication: No service for type 'Microsoft.AspNetCore.Identity.UserManager`1[PrimeApps.Auth.Models.ApplicationUser]' has been registered..
2018-04-19 15:47:30.263 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.InvalidOperationException: No service for type 'Microsoft.AspNetCore.Identity.UserManager`1[PrimeApps.Auth.Models.ApplicationUser]' has been registered.
   at Microsoft.AspNetCore.Authentication.RemoteAuthenticationHandler`1.<HandleRequestAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOut.AuthenticationRequestHandlerWrapper.<HandleRequestAsync>d__6.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\FederatedSignOut\AuthenticationRequestHandlerWrapper.cs:line 38
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-19 15:47:35.888 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 15:47:36.902 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 15:47:37.418 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 15:56:30.791 +03:00 [FTL] Application startup exception
System.InvalidOperationException: Cannot resolve scoped service 'Microsoft.AspNetCore.Identity.UserManager`1[PrimeApps.Auth.Models.ApplicationUser]' from root provider.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, ServiceProvider serviceProvider)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at PrimeApps.Auth.Startup.Configure(IApplicationBuilder app, IHostingEnvironment env) in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Startup.cs:line 182
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.ApplicationInsights.HostingStartup.ApplicationInsightsLoggerStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.ApplicationInsights.AspNetCore.ApplicationInsightsStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2018-04-19 16:15:05.648 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 16:15:05.709 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 16:15:05.718 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 16:15:05.721 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 16:15:05.724 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 16:15:05.727 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 16:15:16.498 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 16:15:21.059 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 16:15:21.818 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 16:15:29.027 +03:00 [ERR] Exception occurred while processing message.
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'AspNetUserManager`1'.
   at Microsoft.AspNetCore.Identity.UserManager`1.ThrowIfDisposed()
   at Microsoft.AspNetCore.Identity.UserManager`1.FindByEmailAsync(String email)
   at PrimeApps.Auth.Startup.<<ConfigureServices>b__11_6>d.MoveNext() in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Startup.cs:line 114
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler.<RunTokenValidatedEventAsync>d__30.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler.<HandleRemoteAuthenticateAsync>d__21.MoveNext()
2018-04-19 16:15:29.113 +03:00 [INF] Error from RemoteAuthentication: Cannot access a disposed object.
Object name: 'AspNetUserManager`1'..
2018-04-19 16:15:29.391 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'AspNetUserManager`1'.
   at Microsoft.AspNetCore.Authentication.RemoteAuthenticationHandler`1.<HandleRequestAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOut.AuthenticationRequestHandlerWrapper.<HandleRequestAsync>d__6.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\FederatedSignOut\AuthenticationRequestHandlerWrapper.cs:line 38
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-19 16:31:32.680 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 16:31:32.744 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 16:31:32.751 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 16:31:32.754 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 16:31:32.758 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 16:31:32.762 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 16:36:07.424 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 16:36:12.905 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 16:36:13.829 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 16:36:27.056 +03:00 [ERR] Exception occurred while processing message.
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'AspNetUserManager`1'.
   at Microsoft.AspNetCore.Identity.UserManager`1.ThrowIfDisposed()
   at Microsoft.AspNetCore.Identity.UserManager`1.FindByEmailAsync(String email)
   at PrimeApps.Auth.Startup.<<ConfigureServices>b__11_6>d.MoveNext() in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Startup.cs:line 114
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler.<RunTokenValidatedEventAsync>d__30.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler.<HandleRemoteAuthenticateAsync>d__21.MoveNext()
2018-04-19 16:36:27.153 +03:00 [INF] Error from RemoteAuthentication: Cannot access a disposed object.
Object name: 'AspNetUserManager`1'..
2018-04-19 16:36:27.454 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'AspNetUserManager`1'.
   at Microsoft.AspNetCore.Authentication.RemoteAuthenticationHandler`1.<HandleRequestAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOut.AuthenticationRequestHandlerWrapper.<HandleRequestAsync>d__6.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\FederatedSignOut\AuthenticationRequestHandlerWrapper.cs:line 38
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-19 16:58:41.906 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-19 16:58:41.963 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-19 16:58:41.970 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-19 16:58:41.974 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-19 16:58:41.978 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-19 16:58:41.980 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-19 16:58:51.008 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-19 16:58:56.021 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-19 16:58:56.957 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-19 16:59:20.377 +03:00 [ERR] Exception occurred while processing message.
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'AspNetUserManager`1'.
   at Microsoft.AspNetCore.Identity.UserManager`1.ThrowIfDisposed()
   at Microsoft.AspNetCore.Identity.UserManager`1.FindByEmailAsync(String email)
   at PrimeApps.Auth.Startup.<<ConfigureServices>b__11_6>d.MoveNext() in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Startup.cs:line 114
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler.<RunTokenValidatedEventAsync>d__30.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler.<HandleRemoteAuthenticateAsync>d__21.MoveNext()
2018-04-19 16:59:20.479 +03:00 [INF] Error from RemoteAuthentication: Cannot access a disposed object.
Object name: 'AspNetUserManager`1'..
2018-04-19 16:59:20.775 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'AspNetUserManager`1'.
   at Microsoft.AspNetCore.Authentication.RemoteAuthenticationHandler`1.<HandleRequestAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOut.AuthenticationRequestHandlerWrapper.<HandleRequestAsync>d__6.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\FederatedSignOut\AuthenticationRequestHandlerWrapper.cs:line 38
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-20 11:56:48.334 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-20 11:56:48.688 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-20 11:56:48.770 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-20 11:56:48.929 +03:00 [DBG] Processing signout request for anonymous
2018-04-20 11:56:48.981 +03:00 [DBG] Start end session request validation
2018-04-20 11:56:49.095 +03:00 [DBG] Start identity token validation
2018-04-20 11:56:49.173 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-20 11:56:54.931 +03:00 [ERR] User marked as not active: b520ea67-68d2-4096-a5d3-fa24d7456330
2018-04-20 11:56:55.008 +03:00 [INF] End session request validation failure: Error validating id token hint
{
  "SubjectId": "unknown",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQxMzg2ODYsImV4cCI6MTUyNDEzODk4NiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY1OTczNTQ3MzczNDc5OTMuT0dVMU4yUTBNek10WkRGbFl5MDBOREpqTFRrd016VXRaV0V4T0Rnek1UVXlObU5qWkdZd1lXSTJaV1l0Wm1JNE1TMDBOakpoTFdFd05XTXRaVFU0WmpNeU1tUmhPRFZpIiwiaWF0IjoxNTI0MTM4Njg2LCJhdF9oYXNoIjoibTdFc1pHcXdydENuWHRNaEs4UXVrZyIsInNpZCI6ImIzY2JkOWM0NWJiZDc4OTlmZDQ4MzFiMTAzYjBmNjdkIiwic3ViIjoiYjUyMGVhNjctNjhkMi00MDk2LWE1ZDMtZmEyNGQ3NDU2MzMwIiwiYXV0aF90aW1lIjoxNTI0MTM4NjQ4LCJpZHAiOiJhYWQiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.PXIff7L41xSQq3-gy6_Z-IL_SMkAGS_LGrm3kWoa3VO4SEufz8r0U1k0jpL1T4SYfsqgKY2xtj8THc3ZDXAf6TgUS9NxatldtE40HhX9N0X0SVZO8kDmBP_tyasNv4QYIPV13Zh-ZUgIXy5Bo0PKwCAU2dVt05DD734YJM_8bbnQA3vpsaprJqXfld2T9HUfo__ENkZYvneL4t3bhD-XWk2l5a09C-p946pkTSF9HrEOQSUUAdJdzilOiQtVzsnZZ7jT8-F3dmErO_ugrXYAATh3WFM54HLJM5tzzGmo5ygfqVAG5ItWrqC1wh7yq00w1vsGVb8VwV-uDnGlDrmQDQ",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hzVoqPY8o07aqr4z5qCAZqmzpJ0YvTrJvSSGh477qZBECsqnPoEsiP2iyyzMgHviv79Pal9AweJ0Rvj8k_-v0tolZLHwXaBTdRHrcEyJMJ4LrZ5G_xTt7b9XIpiqs8qDw9bG5NsrQ9k4X1HkYbpfEUG",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-20 11:56:55.014 +03:00 [ERR] Error processing end session request Invalid request
2018-04-20 11:57:06.412 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-20 11:57:06.430 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-20 11:57:06.434 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-20 11:57:06.445 +03:00 [DBG] Start authorize request
2018-04-20 11:57:06.455 +03:00 [DBG] No user present in authorize request
2018-04-20 11:57:06.465 +03:00 [DBG] Start authorize request protocol validation
2018-04-20 11:57:06.519 +03:00 [DBG] Checking for PKCE parameters
2018-04-20 11:57:06.526 +03:00 [DBG] No PKCE used.
2018-04-20 11:57:06.595 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-20 11:57:06.652 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxo__DtY_EiKfu7aN1-s0h9LqziuoA7hfW46waFrmZJyDmkdQn6fRf9iWwfMMRZe7OhkJnzpo1wVpbznqrrE6z7LFMzfIFLQ106y-fvjoauokyYfIv863x7Luf5fYnEwXoIkBCUraU9k-6WbhZZlJIhcqDFO-FnSX6MzjQixHnQ_kezJ4jyTj0QwJ0AJxZkp23lMDmAoNsmfIk7H4JEeIYYFZXpNBBrP9EXf93koO6wrWv0JfpVosH6T6hiaVNPekIelE2dhcJGL2UpDEDtKJebCiSl5_a_N6XfRZYg3f6yMk3zPRRJFGFgOj48TcSNI-w",
  "Nonce": "636598114263862498.NGY3ZmE0MjktMjRhOS00NjVhLTkwMWUtZTc1ZDljMWQ0Mjk1Nzg0NWZmOTEtMzljZi00ZmMxLTkwNmItYjIxMDQ3NDI5MjU4",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636598114263862498.NGY3ZmE0MjktMjRhOS00NjVhLTkwMWUtZTc1ZDljMWQ0Mjk1Nzg0NWZmOTEtMzljZi00ZmMxLTkwNmItYjIxMDQ3NDI5MjU4",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hxo__DtY_EiKfu7aN1-s0h9LqziuoA7hfW46waFrmZJyDmkdQn6fRf9iWwfMMRZe7OhkJnzpo1wVpbznqrrE6z7LFMzfIFLQ106y-fvjoauokyYfIv863x7Luf5fYnEwXoIkBCUraU9k-6WbhZZlJIhcqDFO-FnSX6MzjQixHnQ_kezJ4jyTj0QwJ0AJxZkp23lMDmAoNsmfIk7H4JEeIYYFZXpNBBrP9EXf93koO6wrWv0JfpVosH6T6hiaVNPekIelE2dhcJGL2UpDEDtKJebCiSl5_a_N6XfRZYg3f6yMk3zPRRJFGFgOj48TcSNI-w",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-20 11:57:06.671 +03:00 [INF] Showing login: User is not authenticated
2018-04-20 11:57:06.736 +03:00 [DBG] Start authorize request protocol validation
2018-04-20 11:57:06.742 +03:00 [DBG] Checking for PKCE parameters
2018-04-20 11:57:06.745 +03:00 [DBG] No PKCE used.
2018-04-20 11:57:06.748 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-20 11:57:12.575 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-20 11:57:13.248 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 11:59:06.602 +03:00 [ERR] Exception occurred while processing message.
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'AspNetUserManager`1'.
   at Microsoft.AspNetCore.Identity.UserManager`1.ThrowIfDisposed()
   at Microsoft.AspNetCore.Identity.UserManager`1.FindByEmailAsync(String email)
   at PrimeApps.Auth.Startup.<<ConfigureServices>b__11_6>d.MoveNext() in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Startup.cs:line 114
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler.<RunTokenValidatedEventAsync>d__30.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler.<HandleRemoteAuthenticateAsync>d__21.MoveNext()
2018-04-20 11:59:06.649 +03:00 [INF] Error from RemoteAuthentication: Cannot access a disposed object.
Object name: 'AspNetUserManager`1'..
2018-04-20 11:59:06.962 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.ObjectDisposedException: Cannot access a disposed object.
Object name: 'AspNetUserManager`1'.
   at Microsoft.AspNetCore.Authentication.RemoteAuthenticationHandler`1.<HandleRequestAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.FederatedSignOut.AuthenticationRequestHandlerWrapper.<HandleRequestAsync>d__6.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\FederatedSignOut\AuthenticationRequestHandlerWrapper.cs:line 38
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-20 12:57:48.761 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-20 12:57:48.819 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-20 12:57:48.826 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-20 12:57:48.829 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-20 12:57:48.832 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-20 12:57:48.834 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-20 12:58:46.396 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 12:58:54.327 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-20 12:58:55.117 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 12:59:04.093 +03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-04-20 12:59:11.908 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.Exception: External authentication error
   at PrimeApps.Auth.UI.AccountController.<ExternalLoginCallback>d__10.MoveNext() in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Quickstart\Account\AccountController.cs:line 165
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeActionMethodAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeNextActionFilterAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-20 12:59:51.775 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-20 12:59:51.839 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-20 12:59:51.845 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-20 12:59:51.848 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-20 12:59:51.851 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-20 12:59:51.854 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-20 13:00:01.366 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 13:00:09.014 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-20 13:00:09.820 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 13:00:10.026 +03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-04-20 13:00:27.423 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.Exception: External authentication error
   at PrimeApps.Auth.UI.AccountController.<ExternalLoginCallback>d__10.MoveNext() in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Quickstart\Account\AccountController.cs:line 165
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeActionMethodAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeNextActionFilterAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-20 13:00:52.860 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 13:00:54.183 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-20 13:00:54.778 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 13:00:54.785 +03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-04-20 13:01:40.198 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.Exception: External authentication error
   at PrimeApps.Auth.UI.AccountController.<ExternalLoginCallback>d__10.MoveNext() in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Quickstart\Account\AccountController.cs:line 165
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeActionMethodAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeNextActionFilterAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-20 13:35:20.245 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-20 13:35:20.303 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-20 13:35:20.309 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-20 13:35:20.312 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-20 13:35:20.314 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-20 13:35:20.317 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-20 13:35:31.232 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 13:35:51.895 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 13:35:55.397 +03:00 [DBG] Augmenting SignInContext
2018-04-20 13:35:55.402 +03:00 [DBG] Adding idp claim with value: local
2018-04-20 13:35:55.405 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-20 13:35:55.409 +03:00 [DBG] Adding auth_time claim with value: 1524220555
2018-04-20 13:35:55.428 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-20 13:35:55.617 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD6L9L9HTJH:00000004",
  "TimeStamp": "2018-04-20T10:35:55Z",
  "ProcessId": 5976,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-20 13:35:55.649 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 13:35:55.656 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 13:35:58.829 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 13:35:58.837 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 13:36:01.050 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 13:36:01.060 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 13:36:01.063 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 13:36:01.100 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-20 13:36:01.108 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-20 13:36:01.111 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-20 13:36:01.129 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD6L9L9HTJH:00000007",
  "TimeStamp": "2018-04-20T10:36:01Z",
  "ProcessId": 5976,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-20 13:36:04.653 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 13:36:06.627 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-20 13:36:07.549 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 13:36:17.148 +03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-04-20 13:36:41.056 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.Exception: External authentication error
   at PrimeApps.Auth.UI.AccountController.<ExternalLoginCallback>d__10.MoveNext() in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Quickstart\Account\AccountController.cs:line 165
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeActionMethodAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeNextActionFilterAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-20 13:37:44.813 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 13:37:46.284 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-20 13:37:51.863 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 13:37:57.693 +03:00 [INF] AuthenticationScheme: idsrv.external signed in.
2018-04-20 13:39:18.654 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-20 13:39:18.714 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-20 13:39:18.721 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-20 13:39:18.725 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-20 13:39:18.727 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-20 13:39:18.730 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-20 13:39:44.157 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 13:39:49.901 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-20 13:39:50.412 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 13:39:50.613 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-20 13:39:50.650 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-20 13:44:35.082 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-20 13:44:35.163 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-20 13:44:35.169 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-20 13:44:35.172 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-20 13:44:35.174 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-20 13:44:35.177 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-20 13:44:45.190 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 13:44:50.938 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-20 13:44:51.711 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 13:44:51.903 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-20 13:44:51.932 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-20 13:47:40.320 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "aad",
  "ProviderUserId": "49GFh37iqoZ9XiOTuwFeU-O3dGMibu07jeBXS9Z1TaM",
  "SubjectId": "61eea490-4898-41d2-b8d9-fb01933dfe43",
  "DisplayName": "Fatih Sever",
  "Endpoint": "UI",
  "ActivityId": "0HLD6LEQMAQ0T:00000006",
  "TimeStamp": "2018-04-20T10:47:40Z",
  "ProcessId": 34596,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-20 13:47:40.344 +03:00 [DBG] Augmenting SignInContext
2018-04-20 13:47:40.350 +03:00 [DBG] Adding amr claim with value: external
2018-04-20 13:47:40.367 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-20 13:47:40.377 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-20 13:47:40.406 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 13:47:40.412 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 13:49:40.905 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-20 13:50:20.168 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-20 13:50:20.227 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-20 13:50:20.233 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-20 13:50:20.237 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-20 13:50:20.240 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-20 13:50:20.243 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-20 13:50:23.112 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 13:50:23.135 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 13:51:58.567 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 13:51:58.572 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 13:52:01.717 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 13:52:01.722 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 13:52:01.729 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 13:52:01.835 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-20 13:52:01.841 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-20 13:52:01.845 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-20 13:52:01.974 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "61eea490-4898-41d2-b8d9-fb01933dfe43",
  "DisplayName": "Fatih Sever",
  "ActivityId": "0HLD6LI1ISUQ1:00000003",
  "TimeStamp": "2018-04-20T10:52:01Z",
  "ProcessId": 35832,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-20 13:52:02.704 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 13:52:02.711 +03:00 [INF] AuthenticationScheme: aad signed out.
2018-04-20 14:02:03.712 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-20 14:02:03.771 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-20 14:02:03.778 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-20 14:02:03.780 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-20 14:02:03.783 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-20 14:02:03.786 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-20 14:02:23.775 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 14:02:30.444 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-20 14:02:40.489 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 14:02:40.689 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-20 14:02:40.724 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-20 14:03:10.622 +03:00 [WRN] Heartbeat took longer than ""00:00:01"" at ""2018-04-20T11:03:09.1537223+00:00"".
2018-04-20 14:03:14.715 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "aad",
  "ProviderUserId": "49GFh37iqoZ9XiOTuwFeU-O3dGMibu07jeBXS9Z1TaM",
  "SubjectId": "3a3e5590-1f7d-468d-ba59-d68fa4cc16a8",
  "DisplayName": "Fatih Sever",
  "Endpoint": "UI",
  "ActivityId": "0HLD6LOJ6I5EA:00000006",
  "TimeStamp": "2018-04-20T11:03:14Z",
  "ProcessId": 13388,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-20 14:03:14.737 +03:00 [DBG] Augmenting SignInContext
2018-04-20 14:03:14.744 +03:00 [DBG] Adding amr claim with value: external
2018-04-20 14:03:14.760 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-20 14:03:14.775 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-20 14:03:14.805 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 14:03:14.808 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 15:42:47.301 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 15:42:47.310 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 15:42:50.952 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 15:42:50.960 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 15:42:50.965 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 15:42:51.019 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-20 15:42:51.026 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-20 15:42:51.035 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-20 15:42:51.056 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "3a3e5590-1f7d-468d-ba59-d68fa4cc16a8",
  "DisplayName": "Fatih Sever",
  "ActivityId": "0HLD6LOJ6I5EF:00000004",
  "TimeStamp": "2018-04-20T12:42:51Z",
  "ProcessId": 13388,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-20 15:42:51.081 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 15:42:51.087 +03:00 [INF] AuthenticationScheme: aad signed out.
2018-04-20 15:43:02.948 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 15:43:04.622 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-20 15:43:34.418 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 15:43:34.429 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-20 15:43:34.450 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-20 15:44:11.914 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "aad",
  "ProviderUserId": "49GFh37iqoZ9XiOTuwFeU-O3dGMibu07jeBXS9Z1TaM",
  "SubjectId": "3a3e5590-1f7d-468d-ba59-d68fa4cc16a8",
  "DisplayName": "Fatih Sever",
  "Endpoint": "UI",
  "ActivityId": "0HLD6LOJ6I5EF:0000000D",
  "TimeStamp": "2018-04-20T12:44:11Z",
  "ProcessId": 13388,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-20 15:44:12.408 +03:00 [DBG] Augmenting SignInContext
2018-04-20 15:44:12.412 +03:00 [DBG] Adding amr claim with value: external
2018-04-20 15:44:12.418 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-20 15:44:12.905 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-20 15:44:16.742 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 15:44:16.751 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 15:44:27.867 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 15:44:27.876 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 15:44:29.454 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 15:44:29.459 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 15:44:29.464 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 15:44:29.480 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-20 15:44:29.484 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-20 15:44:29.489 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-20 15:44:29.496 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "3a3e5590-1f7d-468d-ba59-d68fa4cc16a8",
  "DisplayName": "Fatih Sever",
  "ActivityId": "0HLD6LOJ6I5EF:00000010",
  "TimeStamp": "2018-04-20T12:44:29Z",
  "ProcessId": 13388,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-20 15:44:29.503 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 15:44:29.508 +03:00 [INF] AuthenticationScheme: aad signed out.
2018-04-20 15:44:34.648 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 15:45:18.464 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-20 15:45:38.196 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 15:45:38.202 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-20 15:45:38.219 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-20 15:49:35.575 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-20 15:49:35.641 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-20 15:49:35.650 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-20 15:49:35.652 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-20 15:49:35.654 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-20 15:49:35.655 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-20 15:49:39.690 +03:00 [WRN] Heartbeat took longer than ""00:00:01"" at ""2018-04-20T12:49:39.6773594+00:00"".
2018-04-20 15:49:59.024 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 15:50:11.041 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-20 15:50:12.870 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 15:50:13.077 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-20 15:50:36.623 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.FormatException: String was not recognized as a valid DateTime.
   at System.DateTime.ParseExact(String s, String format, IFormatProvider provider)
   at PrimeApps.Auth.UI.AccountController.<ExternalLoginCallback>d__10.MoveNext() in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Quickstart\Account\AccountController.cs:line 157
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeActionMethodAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeNextActionFilterAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-20 15:51:58.839 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-20 15:51:58.910 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-20 15:51:58.917 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-20 15:51:58.919 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-20 15:51:58.939 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-20 15:51:58.942 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-20 15:52:04.187 +03:00 [WRN] Heartbeat took longer than ""00:00:01"" at ""2018-04-20T12:52:04.1736109+00:00"".
2018-04-20 15:52:04.187 +03:00 [WRN] Heartbeat took longer than ""00:00:01"" at ""2018-04-20T12:52:04.1723869+00:00"".
2018-04-20 15:52:35.568 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 15:52:39.917 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 15:53:00.439 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-20 15:53:07.956 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 15:53:08.171 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-20 16:03:21.408 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-20 16:03:21.475 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-20 16:03:21.482 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-20 16:03:21.485 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-20 16:03:21.487 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-20 16:03:21.490 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-20 16:03:35.481 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 16:03:38.611 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 16:03:46.747 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-20 16:03:46.747 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-20 16:04:04.835 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 16:04:05.028 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-20 16:04:05.061 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-20 16:04:22.753 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "aad",
  "ProviderUserId": "49GFh37iqoZ9XiOTuwFeU-O3dGMibu07jeBXS9Z1TaM",
  "SubjectId": "2d935166-99af-4fca-bd3d-f8b26aa87fea",
  "DisplayName": "ed6489ec-957b-4a91-9952-6a76adb66604",
  "Endpoint": "UI",
  "ActivityId": "0HLD6NSC4VN5A:00000003",
  "TimeStamp": "2018-04-20T13:04:22Z",
  "ProcessId": 26472,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-20 16:04:22.776 +03:00 [DBG] Augmenting SignInContext
2018-04-20 16:04:22.781 +03:00 [DBG] Adding amr claim with value: external
2018-04-20 16:04:22.794 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-20 16:04:22.806 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-20 16:04:22.835 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:04:22.839 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:08:20.232 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-20 16:08:20.294 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-20 16:08:20.301 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-20 16:08:20.304 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-20 16:08:20.306 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-20 16:08:20.308 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-20 16:08:26.518 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:08:26.552 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:08:39.757 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:08:39.763 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:20:38.946 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-20 16:20:39.024 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-20 16:20:39.031 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-20 16:20:39.034 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-20 16:20:39.037 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-20 16:20:39.040 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-20 16:20:41.398 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:20:41.426 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:20:51.439 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:20:51.450 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:20:54.057 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 16:20:54.064 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:20:54.069 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:20:54.158 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-20 16:20:54.169 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-20 16:20:54.172 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-20 16:20:54.301 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "2d935166-99af-4fca-bd3d-f8b26aa87fea",
  "DisplayName": "ed6489ec-957b-4a91-9952-6a76adb66604",
  "ActivityId": "0HLD6O61AGILO:00000003",
  "TimeStamp": "2018-04-20T13:20:54Z",
  "ProcessId": 30860,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-20 16:20:55.202 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:20:55.210 +03:00 [INF] AuthenticationScheme: aad signed out.
2018-04-20 16:21:05.428 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 16:21:09.447 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-20 16:21:25.522 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 16:21:25.688 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-20 16:21:25.715 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-20 16:22:26.622 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "aad",
  "ProviderUserId": "49GFh37iqoZ9XiOTuwFeU-O3dGMibu07jeBXS9Z1TaM",
  "SubjectId": "1897c91b-c120-4e54-9204-8b3382b72136",
  "DisplayName": "Fatih Sever",
  "Endpoint": "UI",
  "ActivityId": "0HLD6O61AGILO:0000000B",
  "TimeStamp": "2018-04-20T13:22:26Z",
  "ProcessId": 30860,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-20 16:22:26.645 +03:00 [DBG] Augmenting SignInContext
2018-04-20 16:22:26.652 +03:00 [DBG] Adding amr claim with value: external
2018-04-20 16:22:26.661 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-20 16:22:26.666 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-20 16:22:26.686 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:22:26.689 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:23:09.151 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:23:09.160 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:23:48.498 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:23:48.504 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:23:50.671 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:23:50.677 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:23:51.894 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 16:23:51.900 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:23:51.905 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:23:51.913 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-20 16:23:51.917 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-20 16:23:51.921 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-20 16:23:51.925 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "1897c91b-c120-4e54-9204-8b3382b72136",
  "DisplayName": "Fatih Sever",
  "ActivityId": "0HLD6O61AGILO:00000010",
  "TimeStamp": "2018-04-20T13:23:51Z",
  "ProcessId": 30860,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-20 16:23:51.937 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:23:51.941 +03:00 [INF] AuthenticationScheme: aad signed out.
2018-04-20 16:24:16.301 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-20 16:24:16.364 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-20 16:24:16.371 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-20 16:24:16.373 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-20 16:24:16.376 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-20 16:24:16.379 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-20 16:24:28.894 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 16:24:45.936 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-20 16:24:57.595 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 16:24:57.803 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-20 16:24:57.834 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-20 16:26:01.796 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "aad",
  "ProviderUserId": "49GFh37iqoZ9XiOTuwFeU-O3dGMibu07jeBXS9Z1TaM",
  "SubjectId": "1897c91b-c120-4e54-9204-8b3382b72136",
  "DisplayName": "Fatih Sever",
  "Endpoint": "UI",
  "ActivityId": "0HLD6O827M8R5:00000006",
  "TimeStamp": "2018-04-20T13:26:01Z",
  "ProcessId": 35724,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-20 16:26:02.012 +03:00 [DBG] Augmenting SignInContext
2018-04-20 16:26:02.018 +03:00 [DBG] Adding amr claim with value: external
2018-04-20 16:26:02.032 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-20 16:26:02.184 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-20 16:26:05.010 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:26:05.016 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:26:26.302 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:26:26.307 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:26:39.125 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 16:26:39.132 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:26:39.140 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:26:39.189 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-20 16:26:39.197 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-20 16:26:39.203 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-20 16:26:39.217 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "1897c91b-c120-4e54-9204-8b3382b72136",
  "DisplayName": "Fatih Sever",
  "ActivityId": "0HLD6O827M8R5:00000009",
  "TimeStamp": "2018-04-20T13:26:39Z",
  "ProcessId": 35724,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-20 16:26:39.234 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:26:39.238 +03:00 [INF] AuthenticationScheme: aad signed out.
2018-04-20 16:26:45.450 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-20 16:26:52.594 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 16:26:52.922 +03:00 [DBG] Augmenting SignInContext
2018-04-20 16:26:52.938 +03:00 [DBG] Adding idp claim with value: local
2018-04-20 16:26:52.946 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-20 16:26:52.949 +03:00 [DBG] Adding auth_time claim with value: 1524230812
2018-04-20 16:26:52.952 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-20 16:26:53.027 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "fatih@ofisim.onmicrosoft.com",
  "SubjectId": "1897c91b-c120-4e54-9204-8b3382b72136",
  "DisplayName": "fatih@ofisim.onmicrosoft.com",
  "Endpoint": "UI",
  "ActivityId": "0HLD6O827M8R5:0000000F",
  "TimeStamp": "2018-04-20T13:26:53Z",
  "ProcessId": 35724,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-20 16:26:53.048 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:26:53.055 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:31:20.968 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-20 16:31:21.017 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-20 16:31:21.021 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-20 16:31:21.022 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-20 16:31:21.022 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-20 16:31:21.022 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-20 16:31:21.492 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:31:21.512 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:32:50.120 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-20 16:32:50.132 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-20 16:32:50.133 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-20 16:32:50.139 +03:00 [DBG] Start discovery request
2018-04-20 16:32:50.476 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-20 16:32:50.479 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-20 16:32:50.480 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-20 16:32:50.485 +03:00 [DBG] Start key discovery request
2018-04-20 16:32:50.547 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:32:50.549 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:32:50.550 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-20 16:32:50.558 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-20 16:32:50.559 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-20 16:32:50.566 +03:00 [DBG] Start authorize request
2018-04-20 16:32:50.584 +03:00 [DBG] User in authorize request: 1897c91b-c120-4e54-9204-8b3382b72136
2018-04-20 16:32:50.590 +03:00 [DBG] Start authorize request protocol validation
2018-04-20 16:32:50.606 +03:00 [DBG] Checking for PKCE parameters
2018-04-20 16:32:50.608 +03:00 [DBG] No PKCE used.
2018-04-20 16:32:50.653 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-20 16:32:50.672 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "1897c91b-c120-4e54-9204-8b3382b72136",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxS9avxNaiHumYTsiZ0dJ-CdtnCAXou5-rhWddBeD2dwtzAtko3_8QTfSkjZtz9GicTM-lEwdLvn2fptyE3ydSb1f3uV86dCXdhgXRM5MVEl5e7Sg0wXo4po-XHP3Abo4wBsKNqu_uuaOd3PftFF4NHHLERzLn9uhckHbSNqFR9cn-d1mutkmC2bUuMrRBvXjT-WkuZoWDoz1hcZyHKtuc0OeABhHmHGr87q9L42Tp5XjtNVsQwUqmNempMvTBdCJlv1cAGVy88jaMlRMjDpGoHW8Jfy-pHJNsIh26KfOcNc-jeGMGVKAXBPEbjAHxRIkY",
  "Nonce": "636598279705376841.ODc5NDQwMTgtYTkzYS00ZGNjLTk4NDYtMjcyZDBjNDJmZmI2YWMxMjk5NDctZmExMS00M2UxLWJhYmEtNzg3NjU3ZGE5YzJj",
  "SessionId": "51bfc6859711e3b081024c255f23dc1d",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636598279705376841.ODc5NDQwMTgtYTkzYS00ZGNjLTk4NDYtMjcyZDBjNDJmZmI2YWMxMjk5NDctZmExMS00M2UxLWJhYmEtNzg3NjU3ZGE5YzJj",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hxS9avxNaiHumYTsiZ0dJ-CdtnCAXou5-rhWddBeD2dwtzAtko3_8QTfSkjZtz9GicTM-lEwdLvn2fptyE3ydSb1f3uV86dCXdhgXRM5MVEl5e7Sg0wXo4po-XHP3Abo4wBsKNqu_uuaOd3PftFF4NHHLERzLn9uhckHbSNqFR9cn-d1mutkmC2bUuMrRBvXjT-WkuZoWDoz1hcZyHKtuc0OeABhHmHGr87q9L42Tp5XjtNVsQwUqmNempMvTBdCJlv1cAGVy88jaMlRMjDpGoHW8Jfy-pHJNsIh26KfOcNc-jeGMGVKAXBPEbjAHxRIkY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-20 16:32:51.756 +03:00 [DBG] user_consent grant with value: mvc|1897c91b-c120-4e54-9204-8b3382b72136 not found in store.
2018-04-20 16:32:51.758 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-20 16:32:51.759 +03:00 [INF] Showing consent: User has not yet consented
2018-04-20 16:32:51.772 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:32:51.776 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:32:51.845 +03:00 [DBG] Start authorize request protocol validation
2018-04-20 16:32:51.845 +03:00 [DBG] Checking for PKCE parameters
2018-04-20 16:32:51.852 +03:00 [DBG] No PKCE used.
2018-04-20 16:32:51.853 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-20 16:34:02.744 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-20 16:34:02.749 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:34:02.752 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:34:02.799 +03:00 [DBG] Start authorize request protocol validation
2018-04-20 16:34:02.800 +03:00 [DBG] Checking for PKCE parameters
2018-04-20 16:34:02.808 +03:00 [DBG] No PKCE used.
2018-04-20 16:34:02.809 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-20 16:34:02.839 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:34:02.841 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-20 16:34:02.842 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-20 16:34:02.845 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-20 16:34:02.846 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-20 16:34:02.853 +03:00 [DBG] Start authorize callback request
2018-04-20 16:34:02.886 +03:00 [DBG] User in authorize request: 1897c91b-c120-4e54-9204-8b3382b72136
2018-04-20 16:34:02.888 +03:00 [DBG] Start authorize request protocol validation
2018-04-20 16:34:02.889 +03:00 [DBG] Checking for PKCE parameters
2018-04-20 16:34:02.890 +03:00 [DBG] No PKCE used.
2018-04-20 16:34:02.891 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-20 16:34:02.893 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "1897c91b-c120-4e54-9204-8b3382b72136",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxS9avxNaiHumYTsiZ0dJ-CdtnCAXou5-rhWddBeD2dwtzAtko3_8QTfSkjZtz9GicTM-lEwdLvn2fptyE3ydSb1f3uV86dCXdhgXRM5MVEl5e7Sg0wXo4po-XHP3Abo4wBsKNqu_uuaOd3PftFF4NHHLERzLn9uhckHbSNqFR9cn-d1mutkmC2bUuMrRBvXjT-WkuZoWDoz1hcZyHKtuc0OeABhHmHGr87q9L42Tp5XjtNVsQwUqmNempMvTBdCJlv1cAGVy88jaMlRMjDpGoHW8Jfy-pHJNsIh26KfOcNc-jeGMGVKAXBPEbjAHxRIkY",
  "Nonce": "636598279705376841.ODc5NDQwMTgtYTkzYS00ZGNjLTk4NDYtMjcyZDBjNDJmZmI2YWMxMjk5NDctZmExMS00M2UxLWJhYmEtNzg3NjU3ZGE5YzJj",
  "SessionId": "51bfc6859711e3b081024c255f23dc1d",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636598279705376841.ODc5NDQwMTgtYTkzYS00ZGNjLTk4NDYtMjcyZDBjNDJmZmI2YWMxMjk5NDctZmExMS00M2UxLWJhYmEtNzg3NjU3ZGE5YzJj",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hxS9avxNaiHumYTsiZ0dJ-CdtnCAXou5-rhWddBeD2dwtzAtko3_8QTfSkjZtz9GicTM-lEwdLvn2fptyE3ydSb1f3uV86dCXdhgXRM5MVEl5e7Sg0wXo4po-XHP3Abo4wBsKNqu_uuaOd3PftFF4NHHLERzLn9uhckHbSNqFR9cn-d1mutkmC2bUuMrRBvXjT-WkuZoWDoz1hcZyHKtuc0OeABhHmHGr87q9L42Tp5XjtNVsQwUqmNempMvTBdCJlv1cAGVy88jaMlRMjDpGoHW8Jfy-pHJNsIh26KfOcNc-jeGMGVKAXBPEbjAHxRIkY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-20 16:34:02.977 +03:00 [DBG] user_consent grant with value: mvc|1897c91b-c120-4e54-9204-8b3382b72136 not found in store.
2018-04-20 16:34:02.979 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-20 16:34:02.990 +03:00 [INF] User consented to scopes: ["openid","api1"]
2018-04-20 16:34:03.006 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","api1"]
2018-04-20 16:34:03.013 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 1897c91b-c120-4e54-9204-8b3382b72136
2018-04-20 16:34:03.035 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-20 16:34:03.071 +03:00 [DBG] Creating Implicit Flow response.
2018-04-20 16:34:03.086 +03:00 [DBG] Getting claims for identity token for subject: 1897c91b-c120-4e54-9204-8b3382b72136 and client: mvc
2018-04-20 16:34:03.091 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-20 16:34:03.185 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "1897c91b-c120-4e54-9204-8b3382b72136",
  "Scopes": "openid api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****4NNw"
    },
    {
      "TokenType": "code",
      "TokenValue": "****5bbd"
    }
  ],
  "ActivityId": "0HLD6OC0J43TH:00000006",
  "TimeStamp": "2018-04-20T13:34:03Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-20 16:34:03.195 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "1897c91b-c120-4e54-9204-8b3382b72136",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxS9avxNaiHumYTsiZ0dJ-CdtnCAXou5-rhWddBeD2dwtzAtko3_8QTfSkjZtz9GicTM-lEwdLvn2fptyE3ydSb1f3uV86dCXdhgXRM5MVEl5e7Sg0wXo4po-XHP3Abo4wBsKNqu_uuaOd3PftFF4NHHLERzLn9uhckHbSNqFR9cn-d1mutkmC2bUuMrRBvXjT-WkuZoWDoz1hcZyHKtuc0OeABhHmHGr87q9L42Tp5XjtNVsQwUqmNempMvTBdCJlv1cAGVy88jaMlRMjDpGoHW8Jfy-pHJNsIh26KfOcNc-jeGMGVKAXBPEbjAHxRIkY",
  "Scope": "openid api1"
}
2018-04-20 16:34:03.231 +03:00 [DBG] Augmenting SignInContext
2018-04-20 16:34:03.239 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-20 16:34:03.624 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-20 16:34:03.631 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-20 16:34:03.634 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-20 16:34:03.649 +03:00 [DBG] Start token request.
2018-04-20 16:34:03.656 +03:00 [DBG] Start client validation
2018-04-20 16:34:03.665 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-20 16:34:03.669 +03:00 [DBG] Start parsing for secret in post body
2018-04-20 16:34:03.670 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-20 16:34:03.671 +03:00 [DBG] Secret id found: mvc
2018-04-20 16:34:03.684 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-20 16:34:03.685 +03:00 [DBG] Client validation success
2018-04-20 16:34:03.693 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD6OC0J43TO:00000001",
  "TimeStamp": "2018-04-20T13:34:03Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-20 16:34:03.705 +03:00 [DBG] Start token request validation
2018-04-20 16:34:03.718 +03:00 [DBG] Start validation of authorization code token request
2018-04-20 16:34:03.824 +03:00 [DBG] Validation of authorization code token request success
2018-04-20 16:34:03.831 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "b75735a5e9112620e7b7c508fde00b9710f70d4d98e23c48e2d2f394ca725bbd",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "b75735a5e9112620e7b7c508fde00b9710f70d4d98e23c48e2d2f394ca725bbd",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-20 16:34:03.867 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-20 16:34:03.868 +03:00 [DBG] Getting claims for access token for subject: 1897c91b-c120-4e54-9204-8b3382b72136
2018-04-20 16:34:04.138 +03:00 [DBG] Getting claims for identity token for subject: 1897c91b-c120-4e54-9204-8b3382b72136 and client: mvc
2018-04-20 16:34:04.140 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-20 16:34:04.148 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****xHCg"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****fFGQ"
    }
  ],
  "ActivityId": "0HLD6OC0J43TO:00000001",
  "TimeStamp": "2018-04-20T13:34:04Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-20 16:34:04.152 +03:00 [DBG] Token request success.
2018-04-20 16:34:04.166 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-20 16:34:04.169 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-20 16:34:04.170 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-20 16:34:04.179 +03:00 [DBG] Start userinfo request
2018-04-20 16:34:04.183 +03:00 [DBG] Bearer token found in header
2018-04-20 16:34:04.319 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-20 16:34:04.332 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524231244,
    "exp": 1524234844,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "1897c91b-c120-4e54-9204-8b3382b72136",
    "auth_time": 1524230812,
    "idp": "local",
    "scope": [
      "openid",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-04-20 16:34:04.343 +03:00 [DBG] Creating userinfo response
2018-04-20 16:34:04.349 +03:00 [DBG] Scopes in access token: openid api1
2018-04-20 16:34:04.352 +03:00 [DBG] Scopes in access token: openid api1
2018-04-20 16:34:04.356 +03:00 [DBG] Requested claim types: sub
2018-04-20 16:34:04.356 +03:00 [DBG] Scopes in access token: openid api1
2018-04-20 16:34:04.500 +03:00 [INF] Profile service returned to the following claim types: sub
2018-04-20 16:34:04.502 +03:00 [DBG] End userinfo request
2018-04-24 11:59:50.735 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 11:59:50.806 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 11:59:50.809 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 11:59:50.813 +03:00 [DBG] Start discovery request
2018-04-24 11:59:51.641 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 11:59:51.644 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 11:59:51.645 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 11:59:51.647 +03:00 [DBG] Start key discovery request
2018-04-24 11:59:54.252 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 11:59:54.255 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 11:59:54.256 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-24 11:59:54.262 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-24 11:59:54.269 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-24 11:59:54.283 +03:00 [DBG] Processing signout request for 1897c91b-c120-4e54-9204-8b3382b72136
2018-04-24 11:59:54.295 +03:00 [DBG] Start end session request validation
2018-04-24 11:59:54.305 +03:00 [DBG] Start identity token validation
2018-04-24 11:59:54.311 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-24 11:59:54.320 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-24 11:59:54.323 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524231244,
    "exp": 1524231544,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636598279705376841.ODc5NDQwMTgtYTkzYS00ZGNjLTk4NDYtMjcyZDBjNDJmZmI2YWMxMjk5NDctZmExMS00M2UxLWJhYmEtNzg3NjU3ZGE5YzJj",
    "iat": 1524231244,
    "at_hash": "_wOlOoJ8g0QKSshe11bglQ",
    "sid": "51bfc6859711e3b081024c255f23dc1d",
    "sub": "1897c91b-c120-4e54-9204-8b3382b72136",
    "auth_time": 1524230812,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-24 11:59:54.382 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "1897c91b-c120-4e54-9204-8b3382b72136",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hz03n654mqeBcUYCd4yIqmmTNruXtxBgP5lZ7XvKLEkbD9Uds1QdXzrbbgsxiqCB7J54ogt-jEb1O98A_RqEuS6IQlMPjd6LLRwfnA_qB5qi0zhxoyy-fldCPpC3Q8wyYK1P-OqDAyUTkiNbbvQOQpW",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQyMzEyNDQsImV4cCI6MTUyNDIzMTU0NCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY1OTgyNzk3MDUzNzY4NDEuT0RjNU5EUXdNVGd0WVRrellTMDBaR05qTFRrNE5EWXRNamN5WkRCak5ESm1abUkyWVdNeE1qazVORGN0Wm1FeE1TMDBNMlV4TFdKaFltRXROemczTmpVM1pHRTVZekpqIiwiaWF0IjoxNTI0MjMxMjQ0LCJhdF9oYXNoIjoiX3dPbE9vSjhnMFFLU3NoZTExYmdsUSIsInNpZCI6IjUxYmZjNjg1OTcxMWUzYjA4MTAyNGMyNTVmMjNkYzFkIiwic3ViIjoiMTg5N2M5MWItYzEyMC00ZTU0LTkyMDQtOGIzMzgyYjcyMTM2IiwiYXV0aF90aW1lIjoxNTI0MjMwODEyLCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.cqIIe8E_Q43rj8XafMDX747aWcOdqc9fOitDNX78m9jM3jXRHo9Um9RvYWAOxsXM8CX8ipxP5cP1Ye0JqWTEGEVRjGP5OejXCtzW2PNmBF8Hezly2Ha5bbKgoKFw08v-uI0-HKI1KbZgD_CIrI34qYDe5UJwZDPwohpPJJl48FRdjd0f648o17RwASimQrIYmkR_XGlpC2c6MvKVPmUFRHIV6J1dxgBs7_JsOfNgBtWdWjRlbpwvmCxkX7qdRLqzngqKuUkz4OJoVufOXCXllRX7NqCFPISPAkzRfrrdcfueYVTiDtsngtxr1iX47WelknJpIRaKDj0WSx02wMxHCg",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hz03n654mqeBcUYCd4yIqmmTNruXtxBgP5lZ7XvKLEkbD9Uds1QdXzrbbgsxiqCB7J54ogt-jEb1O98A_RqEuS6IQlMPjd6LLRwfnA_qB5qi0zhxoyy-fldCPpC3Q8wyYK1P-OqDAyUTkiNbbvQOQpW",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 11:59:54.395 +03:00 [DBG] Success validating end session request from mvc
2018-04-24 11:59:54.441 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 11:59:54.443 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 11:59:54.523 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-24 11:59:54.526 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-24 11:59:54.527 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-24 11:59:54.542 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "1897c91b-c120-4e54-9204-8b3382b72136",
  "DisplayName": "Fatih Sever",
  "ActivityId": "0HLD6OC0J43TQ:00000002",
  "TimeStamp": "2018-04-24T08:59:54Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 11:59:55.425 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-24 11:59:55.431 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-24 11:59:55.434 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-24 11:59:55.444 +03:00 [DBG] Processing signout callback request
2018-04-24 11:59:55.464 +03:00 [DBG] No client front-channel logout URLs
2018-04-24 11:59:55.464 +03:00 [DBG] No client back-channel logout URLs
2018-04-24 11:59:55.465 +03:00 [INF] Successful signout callback.
2018-04-24 11:59:55.466 +03:00 [DBG] No client front-channel iframe urls
2018-04-24 11:59:55.466 +03:00 [DBG] No client back-channel iframe urls
2018-04-24 12:04:42.707 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 12:04:42.711 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 12:04:42.716 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 12:04:42.717 +03:00 [DBG] Start discovery request
2018-04-24 12:04:42.935 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 12:04:42.939 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 12:04:42.941 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 12:04:42.943 +03:00 [DBG] Start key discovery request
2018-04-24 12:04:42.976 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 12:04:42.980 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 12:04:42.985 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 12:04:42.986 +03:00 [DBG] Start authorize request
2018-04-24 12:04:42.987 +03:00 [DBG] No user present in authorize request
2018-04-24 12:04:42.990 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 12:04:42.992 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 12:04:42.993 +03:00 [DBG] No PKCE used.
2018-04-24 12:04:42.997 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 12:04:42.998 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hyRCdXABi-PBm8wZCL1CuZyiMDOhxybZMkiGdPAlTUGBpAx71T3jg1yKfTj5hJrAVsM6Svwq2ynVs1yBT40vbtYMRF91e3qjJS3vPTm2MD1kKiu4pGukEWuP7mlfp-lf_7CdBl4Iz6erUgAT7h84xhRchJaCCm2OpZtx--91KYt3fpHaGF7RVH0YLvhPPBypCMonZR-jpedUGBiOstAJFRDjvfHVQwNWxfE_SMYOPrQo2WL_d1C6g8gnyjwzrly-YFa94B11bGpkios8JBFdoWd0HmydDkudN7gcm2Om4E6PrkW6PD96cVX5f6H5od2wnw",
  "Nonce": "636601574829638844.ZGQ1MzJhOTItZDhmMC00YWY3LTkyMTUtY2VjNDc0MzJmMDM4MWMxZTI1NmYtMzBlZS00YjU3LThiMDgtZmViNzBkZDc0N2U3",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601574829638844.ZGQ1MzJhOTItZDhmMC00YWY3LTkyMTUtY2VjNDc0MzJmMDM4MWMxZTI1NmYtMzBlZS00YjU3LThiMDgtZmViNzBkZDc0N2U3",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hyRCdXABi-PBm8wZCL1CuZyiMDOhxybZMkiGdPAlTUGBpAx71T3jg1yKfTj5hJrAVsM6Svwq2ynVs1yBT40vbtYMRF91e3qjJS3vPTm2MD1kKiu4pGukEWuP7mlfp-lf_7CdBl4Iz6erUgAT7h84xhRchJaCCm2OpZtx--91KYt3fpHaGF7RVH0YLvhPPBypCMonZR-jpedUGBiOstAJFRDjvfHVQwNWxfE_SMYOPrQo2WL_d1C6g8gnyjwzrly-YFa94B11bGpkios8JBFdoWd0HmydDkudN7gcm2Om4E6PrkW6PD96cVX5f6H5od2wnw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 12:04:43.007 +03:00 [INF] Showing login: User is not authenticated
2018-04-24 12:04:43.027 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 12:04:43.028 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 12:04:43.030 +03:00 [DBG] No PKCE used.
2018-04-24 12:04:43.031 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 12:05:56.251 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 12:05:56.253 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 12:05:56.255 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 12:05:56.256 +03:00 [DBG] Start authorize request
2018-04-24 12:05:56.257 +03:00 [DBG] No user present in authorize request
2018-04-24 12:05:56.257 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 12:05:56.257 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 12:05:56.258 +03:00 [DBG] No PKCE used.
2018-04-24 12:05:56.259 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 12:05:56.262 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hwQySJAnzmpIPfZsvn2f-vmr6_4Izt2ZkbsyZjQzbGXwJUdqxVs_kv6ue_lqdMeqc5spPhhN3g1nrdhT0jat8Lgbfp4bRoczuHKz2qXDT-gt4EfDsrotslk6ViATCZS0Fz13-Rpifw6YdsDzqPnjN_ujiI_iyBWtaF3XjGrx1ETl_QNxlYCp_bkuu7PBzyfeLSQlOzmxl_FQWKmjYmM46N2iep7hP8Ao-I1lKc1KdRrqqtluUp4jCKAQm7d9P6abGQCOpn9_xGUZn6_rOmw7pnwdOGYnb8Zd3IfvljaeHxHnbKCGancgGZB1wmsDKGJXqY",
  "Nonce": "636601575562357680.ZmUzNWFiZjQtMWUxZi00ZjlkLWFiYWMtMTE0ODkyMTI3ODRkYmUxMTIwNGUtOGViOS00YjUxLTkzYzUtMTM4ZTkyZWNhZmE3",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601575562357680.ZmUzNWFiZjQtMWUxZi00ZjlkLWFiYWMtMTE0ODkyMTI3ODRkYmUxMTIwNGUtOGViOS00YjUxLTkzYzUtMTM4ZTkyZWNhZmE3",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwQySJAnzmpIPfZsvn2f-vmr6_4Izt2ZkbsyZjQzbGXwJUdqxVs_kv6ue_lqdMeqc5spPhhN3g1nrdhT0jat8Lgbfp4bRoczuHKz2qXDT-gt4EfDsrotslk6ViATCZS0Fz13-Rpifw6YdsDzqPnjN_ujiI_iyBWtaF3XjGrx1ETl_QNxlYCp_bkuu7PBzyfeLSQlOzmxl_FQWKmjYmM46N2iep7hP8Ao-I1lKc1KdRrqqtluUp4jCKAQm7d9P6abGQCOpn9_xGUZn6_rOmw7pnwdOGYnb8Zd3IfvljaeHxHnbKCGancgGZB1wmsDKGJXqY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 12:05:56.270 +03:00 [INF] Showing login: User is not authenticated
2018-04-24 12:05:56.277 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 12:05:56.277 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 12:05:56.278 +03:00 [DBG] No PKCE used.
2018-04-24 12:05:56.279 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 12:06:06.865 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 12:06:07.498 +03:00 [DBG] Augmenting SignInContext
2018-04-24 12:06:07.499 +03:00 [DBG] Adding idp claim with value: local
2018-04-24 12:06:07.500 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-24 12:06:07.502 +03:00 [DBG] Adding auth_time claim with value: 1524560767
2018-04-24 12:06:07.503 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-24 12:06:07.588 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD6OC0J43TU:00000005",
  "TimeStamp": "2018-04-24T09:06:07Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 12:06:07.604 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 12:06:07.609 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 12:06:07.612 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 12:06:07.614 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 12:06:07.616 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 12:06:07.617 +03:00 [DBG] Start authorize callback request
2018-04-24 12:06:07.618 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 12:06:07.619 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 12:06:07.620 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 12:06:07.621 +03:00 [DBG] No PKCE used.
2018-04-24 12:06:07.626 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 12:06:07.629 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hwQySJAnzmpIPfZsvn2f-vmr6_4Izt2ZkbsyZjQzbGXwJUdqxVs_kv6ue_lqdMeqc5spPhhN3g1nrdhT0jat8Lgbfp4bRoczuHKz2qXDT-gt4EfDsrotslk6ViATCZS0Fz13-Rpifw6YdsDzqPnjN_ujiI_iyBWtaF3XjGrx1ETl_QNxlYCp_bkuu7PBzyfeLSQlOzmxl_FQWKmjYmM46N2iep7hP8Ao-I1lKc1KdRrqqtluUp4jCKAQm7d9P6abGQCOpn9_xGUZn6_rOmw7pnwdOGYnb8Zd3IfvljaeHxHnbKCGancgGZB1wmsDKGJXqY",
  "Nonce": "636601575562357680.ZmUzNWFiZjQtMWUxZi00ZjlkLWFiYWMtMTE0ODkyMTI3ODRkYmUxMTIwNGUtOGViOS00YjUxLTkzYzUtMTM4ZTkyZWNhZmE3",
  "SessionId": "fb6da4dec74fbed750031206f87b208c",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601575562357680.ZmUzNWFiZjQtMWUxZi00ZjlkLWFiYWMtMTE0ODkyMTI3ODRkYmUxMTIwNGUtOGViOS00YjUxLTkzYzUtMTM4ZTkyZWNhZmE3",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwQySJAnzmpIPfZsvn2f-vmr6_4Izt2ZkbsyZjQzbGXwJUdqxVs_kv6ue_lqdMeqc5spPhhN3g1nrdhT0jat8Lgbfp4bRoczuHKz2qXDT-gt4EfDsrotslk6ViATCZS0Fz13-Rpifw6YdsDzqPnjN_ujiI_iyBWtaF3XjGrx1ETl_QNxlYCp_bkuu7PBzyfeLSQlOzmxl_FQWKmjYmM46N2iep7hP8Ao-I1lKc1KdRrqqtluUp4jCKAQm7d9P6abGQCOpn9_xGUZn6_rOmw7pnwdOGYnb8Zd3IfvljaeHxHnbKCGancgGZB1wmsDKGJXqY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 12:06:07.715 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 12:06:07.717 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 12:06:07.718 +03:00 [INF] Showing consent: User has not yet consented
2018-04-24 12:06:07.724 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 12:06:07.725 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 12:06:07.734 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 12:06:07.734 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 12:06:07.735 +03:00 [DBG] No PKCE used.
2018-04-24 12:06:07.736 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 12:06:09.525 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 12:06:09.528 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 12:06:09.532 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 12:06:09.544 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 12:06:09.546 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 12:06:09.547 +03:00 [DBG] No PKCE used.
2018-04-24 12:06:09.548 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 12:06:09.555 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 12:06:09.556 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 12:06:09.558 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 12:06:09.560 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 12:06:09.568 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 12:06:09.569 +03:00 [DBG] Start authorize callback request
2018-04-24 12:06:09.570 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 12:06:09.571 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 12:06:09.572 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 12:06:09.572 +03:00 [DBG] No PKCE used.
2018-04-24 12:06:09.573 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 12:06:09.594 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hwQySJAnzmpIPfZsvn2f-vmr6_4Izt2ZkbsyZjQzbGXwJUdqxVs_kv6ue_lqdMeqc5spPhhN3g1nrdhT0jat8Lgbfp4bRoczuHKz2qXDT-gt4EfDsrotslk6ViATCZS0Fz13-Rpifw6YdsDzqPnjN_ujiI_iyBWtaF3XjGrx1ETl_QNxlYCp_bkuu7PBzyfeLSQlOzmxl_FQWKmjYmM46N2iep7hP8Ao-I1lKc1KdRrqqtluUp4jCKAQm7d9P6abGQCOpn9_xGUZn6_rOmw7pnwdOGYnb8Zd3IfvljaeHxHnbKCGancgGZB1wmsDKGJXqY",
  "Nonce": "636601575562357680.ZmUzNWFiZjQtMWUxZi00ZjlkLWFiYWMtMTE0ODkyMTI3ODRkYmUxMTIwNGUtOGViOS00YjUxLTkzYzUtMTM4ZTkyZWNhZmE3",
  "SessionId": "fb6da4dec74fbed750031206f87b208c",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601575562357680.ZmUzNWFiZjQtMWUxZi00ZjlkLWFiYWMtMTE0ODkyMTI3ODRkYmUxMTIwNGUtOGViOS00YjUxLTkzYzUtMTM4ZTkyZWNhZmE3",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwQySJAnzmpIPfZsvn2f-vmr6_4Izt2ZkbsyZjQzbGXwJUdqxVs_kv6ue_lqdMeqc5spPhhN3g1nrdhT0jat8Lgbfp4bRoczuHKz2qXDT-gt4EfDsrotslk6ViATCZS0Fz13-Rpifw6YdsDzqPnjN_ujiI_iyBWtaF3XjGrx1ETl_QNxlYCp_bkuu7PBzyfeLSQlOzmxl_FQWKmjYmM46N2iep7hP8Ao-I1lKc1KdRrqqtluUp4jCKAQm7d9P6abGQCOpn9_xGUZn6_rOmw7pnwdOGYnb8Zd3IfvljaeHxHnbKCGancgGZB1wmsDKGJXqY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 12:06:09.681 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 12:06:09.683 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 12:06:09.684 +03:00 [INF] User consented to scopes: ["openid","profile","api1"]
2018-04-24 12:06:09.687 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1"]
2018-04-24 12:06:09.690 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 12:06:09.698 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 12:06:09.709 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 12:06:09.710 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 12:06:09.715 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 12:06:09.722 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Qo2g"
    },
    {
      "TokenType": "code",
      "TokenValue": "****68bd"
    }
  ],
  "ActivityId": "0HLD6OC0J43TU:0000000A",
  "TimeStamp": "2018-04-24T09:06:09Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 12:06:09.727 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hwQySJAnzmpIPfZsvn2f-vmr6_4Izt2ZkbsyZjQzbGXwJUdqxVs_kv6ue_lqdMeqc5spPhhN3g1nrdhT0jat8Lgbfp4bRoczuHKz2qXDT-gt4EfDsrotslk6ViATCZS0Fz13-Rpifw6YdsDzqPnjN_ujiI_iyBWtaF3XjGrx1ETl_QNxlYCp_bkuu7PBzyfeLSQlOzmxl_FQWKmjYmM46N2iep7hP8Ao-I1lKc1KdRrqqtluUp4jCKAQm7d9P6abGQCOpn9_xGUZn6_rOmw7pnwdOGYnb8Zd3IfvljaeHxHnbKCGancgGZB1wmsDKGJXqY",
  "Scope": "openid profile api1"
}
2018-04-24 12:06:09.731 +03:00 [DBG] Augmenting SignInContext
2018-04-24 12:06:09.731 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-24 12:06:10.003 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-24 12:06:10.006 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-24 12:06:10.007 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-24 12:06:10.009 +03:00 [DBG] Start token request.
2018-04-24 12:06:10.010 +03:00 [DBG] Start client validation
2018-04-24 12:06:10.011 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-24 12:06:10.011 +03:00 [DBG] Start parsing for secret in post body
2018-04-24 12:06:10.013 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-24 12:06:10.021 +03:00 [DBG] Secret id found: mvc
2018-04-24 12:06:10.022 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-24 12:06:10.022 +03:00 [DBG] Client validation success
2018-04-24 12:06:10.023 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD6OC0J43TV:00000001",
  "TimeStamp": "2018-04-24T09:06:10Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 12:06:10.034 +03:00 [DBG] Start token request validation
2018-04-24 12:06:10.034 +03:00 [DBG] Start validation of authorization code token request
2018-04-24 12:06:10.126 +03:00 [DBG] Validation of authorization code token request success
2018-04-24 12:06:10.127 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "458f837e65288fe59b4354fdc7e994e62dda81d36823c4f66ecd64cc8c7468bd",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "458f837e65288fe59b4354fdc7e994e62dda81d36823c4f66ecd64cc8c7468bd",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-24 12:06:10.130 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-24 12:06:10.131 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 12:06:10.274 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 12:06:10.279 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 12:06:10.286 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****BJ5A"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****Oy3w"
    }
  ],
  "ActivityId": "0HLD6OC0J43TV:00000001",
  "TimeStamp": "2018-04-24T09:06:10Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 12:06:10.290 +03:00 [DBG] Token request success.
2018-04-24 12:06:10.316 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-24 12:06:10.319 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-24 12:06:10.320 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-24 12:06:10.325 +03:00 [DBG] Start userinfo request
2018-04-24 12:06:10.326 +03:00 [DBG] Bearer token found in header
2018-04-24 12:06:10.401 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-24 12:06:10.404 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524560770,
    "exp": 1524564370,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524560767,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-04-24 12:06:10.411 +03:00 [DBG] Creating userinfo response
2018-04-24 12:06:10.418 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 12:06:10.419 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 12:06:10.420 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-24 12:06:10.422 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 12:06:10.563 +03:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-04-24 12:06:10.565 +03:00 [DBG] End userinfo request
2018-04-24 12:17:49.021 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 12:17:49.025 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 12:17:49.026 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 12:17:49.029 +03:00 [DBG] Start discovery request
2018-04-24 12:17:49.320 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 12:17:49.325 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 12:17:49.621 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 12:17:49.623 +03:00 [DBG] Start key discovery request
2018-04-24 12:17:49.701 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 12:17:49.702 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 12:17:49.704 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-24 12:17:49.707 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-24 12:17:49.709 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-24 12:17:49.710 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 12:17:49.717 +03:00 [DBG] Start end session request validation
2018-04-24 12:17:49.718 +03:00 [DBG] Start identity token validation
2018-04-24 12:17:49.719 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-24 12:17:50.034 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-24 12:17:50.036 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524560770,
    "exp": 1524561070,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636601575562357680.ZmUzNWFiZjQtMWUxZi00ZjlkLWFiYWMtMTE0ODkyMTI3ODRkYmUxMTIwNGUtOGViOS00YjUxLTkzYzUtMTM4ZTkyZWNhZmE3",
    "iat": 1524560770,
    "at_hash": "-N_T7V6PQRZnxpYx6wtdZg",
    "sid": "fb6da4dec74fbed750031206f87b208c",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524560767,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-24 12:17:50.043 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hwv3MNG2sL6oYddAlv-ZolEInd3OQZ6WFHpalaqMOJfJ5_xtPtL0vBBvETeu9w1C9EgoLfOkR76IrN9X08o4FouxBsIwWx1ll-P-Vh_Mzn4f96I4F8oU8qnDNIW0Xa_QNt1ZICx-qFYOojQSUiQhvA3",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQ1NjA3NzAsImV4cCI6MTUyNDU2MTA3MCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY2MDE1NzU1NjIzNTc2ODAuWm1Vek5XRmlaalF0TVdVeFppMDBaamxrTFdGaVlXTXRNVEUwT0RreU1USTNPRFJrWW1VeE1USXdOR1V0T0dWaU9TMDBZalV4TFRrell6VXRNVE00WlRreVpXTmhabUUzIiwiaWF0IjoxNTI0NTYwNzcwLCJhdF9oYXNoIjoiLU5fVDdWNlBRUlpueHBZeDZ3dGRaZyIsInNpZCI6ImZiNmRhNGRlYzc0ZmJlZDc1MDAzMTIwNmY4N2IyMDhjIiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0NTYwNzY3LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.KyWlkJa1dniBRNS1T4W43GZecPdW4aXbEaQCmT7XrVg1ShWqHgRDHib-4KrEReJIUErjyOllSJcv35J42uTv5hDgyZMjLO3N-iGOzA5gZMaKu6CnyWfAvTGut7fW8iTvJoiS3JPZSrLjSJ6KvY6Q-OIMu23u0r7UR47m1bmik-LQ7dHH77HY4oU7nUciZRkpy1Gn8eCzZfxXh7R7z98DcJt5m5Bf5f1k5i2UXxzL9tTsfjfE98ontCHeovTjVFTbbX-6LGBnLvSSXVz2T6UqymQUqDNe8-CDwjgFrUvbbHyYDXfoITIYG9ll2KWWLYYqxdyUegP0LScKVEOWdEBJ5A",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwv3MNG2sL6oYddAlv-ZolEInd3OQZ6WFHpalaqMOJfJ5_xtPtL0vBBvETeu9w1C9EgoLfOkR76IrN9X08o4FouxBsIwWx1ll-P-Vh_Mzn4f96I4F8oU8qnDNIW0Xa_QNt1ZICx-qFYOojQSUiQhvA3",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 12:17:50.054 +03:00 [DBG] Success validating end session request from mvc
2018-04-24 12:17:50.061 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 12:17:50.063 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 12:17:50.067 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-24 12:17:50.068 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-24 12:17:50.070 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-24 12:17:50.077 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD6OC0J43U1:00000002",
  "TimeStamp": "2018-04-24T09:17:50Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 12:17:50.245 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-24 12:17:50.248 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-24 12:17:50.255 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-24 12:17:50.259 +03:00 [DBG] Processing signout callback request
2018-04-24 12:17:50.261 +03:00 [DBG] No client front-channel logout URLs
2018-04-24 12:17:50.271 +03:00 [DBG] No client back-channel logout URLs
2018-04-24 12:17:50.283 +03:00 [INF] Successful signout callback.
2018-04-24 12:17:50.284 +03:00 [DBG] No client front-channel iframe urls
2018-04-24 12:17:50.285 +03:00 [DBG] No client back-channel iframe urls
2018-04-24 12:18:06.524 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 12:18:06.527 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 12:18:06.533 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 12:18:06.538 +03:00 [DBG] Start authorize request
2018-04-24 12:18:06.539 +03:00 [DBG] No user present in authorize request
2018-04-24 12:18:06.540 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 12:18:06.540 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 12:18:06.544 +03:00 [DBG] No PKCE used.
2018-04-24 12:18:06.546 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 12:18:06.549 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxW-8Xzik1oaJY61fppp25vwhVHKJUJHj3KhbeAqPVGpQ0wuNILqG2iSWLGwKJgHYJMgDyk80bs6ZIfeVyhoHE49-1WrinJeMVmd6yhNKCOCwDQMvEtKh4KPQ5Qy45ABlR4RhjXmsudiWuotf2OGxwaIwmWeiDoeBu4Wztk76RcDD1YyoTOb4zimW3xcyzjsqXo-S6UfIFAMXTFrKd9b4e0DmQSsYtxB-eDi-7b8a3kRD8Pa5alzLY7n5veNsZNiv9WQONw6Dzgvy8fm1F4pP3Y0HsgaUEXMzXUpHIoDaGmRT4yca-WePVrqdSHWyTAejs",
  "Nonce": "636601582865015550.NWM4OWFkMzEtNGUxYy00Zjk3LTg4MzUtNzAzYjBiNWViMmViYWQ4OGIyNDUtMmVhMC00YmQ0LWJiNzUtNWIyZDYyZmQwN2Qy",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601582865015550.NWM4OWFkMzEtNGUxYy00Zjk3LTg4MzUtNzAzYjBiNWViMmViYWQ4OGIyNDUtMmVhMC00YmQ0LWJiNzUtNWIyZDYyZmQwN2Qy",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hxW-8Xzik1oaJY61fppp25vwhVHKJUJHj3KhbeAqPVGpQ0wuNILqG2iSWLGwKJgHYJMgDyk80bs6ZIfeVyhoHE49-1WrinJeMVmd6yhNKCOCwDQMvEtKh4KPQ5Qy45ABlR4RhjXmsudiWuotf2OGxwaIwmWeiDoeBu4Wztk76RcDD1YyoTOb4zimW3xcyzjsqXo-S6UfIFAMXTFrKd9b4e0DmQSsYtxB-eDi-7b8a3kRD8Pa5alzLY7n5veNsZNiv9WQONw6Dzgvy8fm1F4pP3Y0HsgaUEXMzXUpHIoDaGmRT4yca-WePVrqdSHWyTAejs",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 12:18:06.556 +03:00 [INF] Showing login: User is not authenticated
2018-04-24 12:18:06.565 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 12:18:06.566 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 12:18:06.566 +03:00 [DBG] No PKCE used.
2018-04-24 12:18:06.568 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 12:18:14.615 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 12:18:14.836 +03:00 [DBG] Augmenting SignInContext
2018-04-24 12:18:14.838 +03:00 [DBG] Adding idp claim with value: local
2018-04-24 12:18:14.842 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-24 12:18:14.845 +03:00 [DBG] Adding auth_time claim with value: 1524561494
2018-04-24 12:18:14.846 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-24 12:18:14.915 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD6OC0J43U1:00000006",
  "TimeStamp": "2018-04-24T09:18:14Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 12:18:14.926 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 12:18:14.929 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 12:18:14.930 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 12:18:14.934 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 12:18:14.936 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 12:18:14.937 +03:00 [DBG] Start authorize callback request
2018-04-24 12:18:14.938 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 12:18:14.941 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 12:18:14.948 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 12:18:14.951 +03:00 [DBG] No PKCE used.
2018-04-24 12:18:14.954 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 12:18:14.955 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxW-8Xzik1oaJY61fppp25vwhVHKJUJHj3KhbeAqPVGpQ0wuNILqG2iSWLGwKJgHYJMgDyk80bs6ZIfeVyhoHE49-1WrinJeMVmd6yhNKCOCwDQMvEtKh4KPQ5Qy45ABlR4RhjXmsudiWuotf2OGxwaIwmWeiDoeBu4Wztk76RcDD1YyoTOb4zimW3xcyzjsqXo-S6UfIFAMXTFrKd9b4e0DmQSsYtxB-eDi-7b8a3kRD8Pa5alzLY7n5veNsZNiv9WQONw6Dzgvy8fm1F4pP3Y0HsgaUEXMzXUpHIoDaGmRT4yca-WePVrqdSHWyTAejs",
  "Nonce": "636601582865015550.NWM4OWFkMzEtNGUxYy00Zjk3LTg4MzUtNzAzYjBiNWViMmViYWQ4OGIyNDUtMmVhMC00YmQ0LWJiNzUtNWIyZDYyZmQwN2Qy",
  "SessionId": "c0f64ad5108172361f30a4bce3fb0edd",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601582865015550.NWM4OWFkMzEtNGUxYy00Zjk3LTg4MzUtNzAzYjBiNWViMmViYWQ4OGIyNDUtMmVhMC00YmQ0LWJiNzUtNWIyZDYyZmQwN2Qy",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hxW-8Xzik1oaJY61fppp25vwhVHKJUJHj3KhbeAqPVGpQ0wuNILqG2iSWLGwKJgHYJMgDyk80bs6ZIfeVyhoHE49-1WrinJeMVmd6yhNKCOCwDQMvEtKh4KPQ5Qy45ABlR4RhjXmsudiWuotf2OGxwaIwmWeiDoeBu4Wztk76RcDD1YyoTOb4zimW3xcyzjsqXo-S6UfIFAMXTFrKd9b4e0DmQSsYtxB-eDi-7b8a3kRD8Pa5alzLY7n5veNsZNiv9WQONw6Dzgvy8fm1F4pP3Y0HsgaUEXMzXUpHIoDaGmRT4yca-WePVrqdSHWyTAejs",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 12:18:15.066 +03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-04-24 12:18:15.068 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 12:18:15.096 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 12:18:15.097 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 12:18:15.100 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 12:18:15.107 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****TyBQ"
    },
    {
      "TokenType": "code",
      "TokenValue": "****da36"
    }
  ],
  "ActivityId": "0HLD6OC0J43U1:00000007",
  "TimeStamp": "2018-04-24T09:18:15Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 12:18:15.113 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxW-8Xzik1oaJY61fppp25vwhVHKJUJHj3KhbeAqPVGpQ0wuNILqG2iSWLGwKJgHYJMgDyk80bs6ZIfeVyhoHE49-1WrinJeMVmd6yhNKCOCwDQMvEtKh4KPQ5Qy45ABlR4RhjXmsudiWuotf2OGxwaIwmWeiDoeBu4Wztk76RcDD1YyoTOb4zimW3xcyzjsqXo-S6UfIFAMXTFrKd9b4e0DmQSsYtxB-eDi-7b8a3kRD8Pa5alzLY7n5veNsZNiv9WQONw6Dzgvy8fm1F4pP3Y0HsgaUEXMzXUpHIoDaGmRT4yca-WePVrqdSHWyTAejs",
  "Scope": "openid profile api1"
}
2018-04-24 12:18:15.115 +03:00 [DBG] Augmenting SignInContext
2018-04-24 12:18:15.116 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-24 12:18:15.374 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-24 12:18:15.376 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-24 12:18:15.377 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-24 12:18:15.379 +03:00 [DBG] Start token request.
2018-04-24 12:18:15.380 +03:00 [DBG] Start client validation
2018-04-24 12:18:15.380 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-24 12:18:15.381 +03:00 [DBG] Start parsing for secret in post body
2018-04-24 12:18:15.381 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-24 12:18:15.382 +03:00 [DBG] Secret id found: mvc
2018-04-24 12:18:15.384 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-24 12:18:15.385 +03:00 [DBG] Client validation success
2018-04-24 12:18:15.392 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD6OC0J43U0:00000003",
  "TimeStamp": "2018-04-24T09:18:15Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 12:18:15.397 +03:00 [DBG] Start token request validation
2018-04-24 12:18:15.398 +03:00 [DBG] Start validation of authorization code token request
2018-04-24 12:18:15.524 +03:00 [DBG] Validation of authorization code token request success
2018-04-24 12:18:15.525 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "51c4917f98720a469e476c3e6712d60fa0c3002464550262209f8df629b5da36",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "51c4917f98720a469e476c3e6712d60fa0c3002464550262209f8df629b5da36",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-24 12:18:15.530 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-24 12:18:15.536 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 12:18:15.686 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 12:18:15.688 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 12:18:15.692 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****uolA"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****Tk5Q"
    }
  ],
  "ActivityId": "0HLD6OC0J43U0:00000003",
  "TimeStamp": "2018-04-24T09:18:15Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 12:18:15.696 +03:00 [DBG] Token request success.
2018-04-24 12:18:15.712 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-24 12:18:15.713 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-24 12:18:15.715 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-24 12:18:15.720 +03:00 [DBG] Start userinfo request
2018-04-24 12:18:15.721 +03:00 [DBG] Bearer token found in header
2018-04-24 12:18:15.806 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-24 12:18:15.812 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524561495,
    "exp": 1524565095,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524561494,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-04-24 12:18:15.814 +03:00 [DBG] Creating userinfo response
2018-04-24 12:18:15.814 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 12:18:15.815 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 12:18:15.816 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-24 12:18:15.816 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 12:18:15.953 +03:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-04-24 12:18:15.956 +03:00 [DBG] End userinfo request
2018-04-24 13:34:11.796 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 13:34:11.799 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 13:34:11.800 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 13:34:11.828 +03:00 [DBG] Start discovery request
2018-04-24 13:34:12.082 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 13:34:12.085 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 13:34:12.088 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 13:34:12.093 +03:00 [DBG] Start key discovery request
2018-04-24 13:34:12.777 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 13:34:12.780 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 13:34:12.781 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-24 13:34:12.782 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-24 13:34:12.783 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-24 13:34:12.784 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 13:34:12.785 +03:00 [DBG] Start end session request validation
2018-04-24 13:34:12.785 +03:00 [DBG] Start identity token validation
2018-04-24 13:34:12.786 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-24 13:34:12.788 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-24 13:34:12.792 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524561495,
    "exp": 1524561795,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636601582865015550.NWM4OWFkMzEtNGUxYy00Zjk3LTg4MzUtNzAzYjBiNWViMmViYWQ4OGIyNDUtMmVhMC00YmQ0LWJiNzUtNWIyZDYyZmQwN2Qy",
    "iat": 1524561495,
    "at_hash": "GlMAybaXAj5l1vLo21O1UA",
    "sid": "c0f64ad5108172361f30a4bce3fb0edd",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524561494,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-24 13:34:12.795 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hz11wUo-SWKBNI7gE5dWcvtyF3JCermKqasjveCFB1ixTxQY8ZlP-5x1a_wmUfp-FZizNwlVQgzkWt68AhTKrsILsLJjXA8FPcC1qrpAPqPKZxuhbumL65u3MeGXIUURrR7nYvjcTHSKNEqx9FC21nR",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQ1NjE0OTUsImV4cCI6MTUyNDU2MTc5NSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY2MDE1ODI4NjUwMTU1NTAuTldNNE9XRmtNekV0TkdVeFl5MDBaamszTFRnNE16VXROekF6WWpCaU5XVmlNbVZpWVdRNE9HSXlORFV0TW1WaE1DMDBZbVEwTFdKaU56VXROV0l5WkRZeVptUXdOMlF5IiwiaWF0IjoxNTI0NTYxNDk1LCJhdF9oYXNoIjoiR2xNQXliYVhBajVsMXZMbzIxTzFVQSIsInNpZCI6ImMwZjY0YWQ1MTA4MTcyMzYxZjMwYTRiY2UzZmIwZWRkIiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0NTYxNDk0LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.O15bgHgE6wR4kiIz45HEUkRO3V98XwkLVkMCSjbMtNoRMy9q-kCuS3FaVJ2QgAStyn-1bmdoZ4czTL-OVJCL7ZKk94B4W2AiHnL-fNZv6ReUM_23Q4gtySahIrmt_761lset438Qa6Eqgfj8uC1w62u48FQt8xIrBXOB3pexpEafK6rXBNRGQ38do50BnCOJIX3-qAWyA0NZMNCfWoWYd5TgMFvIuxzfeRPlgd9wKXeuU4fy8n4ewRrxWL0WO87CxUNerlehYvHF1DFc4tiicST-mSnmDoklr52fFYGAd4GD2o9kfv0A2N_5dA7IsNz4OQYs2Bdv4b0aGplmKUuolA",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hz11wUo-SWKBNI7gE5dWcvtyF3JCermKqasjveCFB1ixTxQY8ZlP-5x1a_wmUfp-FZizNwlVQgzkWt68AhTKrsILsLJjXA8FPcC1qrpAPqPKZxuhbumL65u3MeGXIUURrR7nYvjcTHSKNEqx9FC21nR",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 13:34:12.831 +03:00 [DBG] Success validating end session request from mvc
2018-04-24 13:34:12.841 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 13:34:12.842 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 13:34:12.844 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-24 13:34:12.845 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-24 13:34:12.846 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-24 13:34:12.847 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD6OC0J43U4:00000002",
  "TimeStamp": "2018-04-24T10:34:12Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 13:34:13.050 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-24 13:34:13.055 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-24 13:34:13.058 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-24 13:34:13.060 +03:00 [DBG] Processing signout callback request
2018-04-24 13:34:13.061 +03:00 [DBG] No client front-channel logout URLs
2018-04-24 13:34:13.063 +03:00 [DBG] No client back-channel logout URLs
2018-04-24 13:34:13.067 +03:00 [INF] Successful signout callback.
2018-04-24 13:34:13.068 +03:00 [DBG] No client front-channel iframe urls
2018-04-24 13:34:13.069 +03:00 [DBG] No client back-channel iframe urls
2018-04-24 13:34:22.266 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 13:34:22.294 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 13:34:22.296 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 13:34:22.297 +03:00 [DBG] Start authorize request
2018-04-24 13:34:22.298 +03:00 [DBG] No user present in authorize request
2018-04-24 13:34:22.299 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 13:34:22.300 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 13:34:22.300 +03:00 [DBG] No PKCE used.
2018-04-24 13:34:22.301 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 13:34:22.306 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hyZSP4ME4-bQLu92nEYG80n-H2xQIRW4LPv0V7Orbcrl6EfOq1JCJkIIOG_yqUGGQwAsPGdhpm4nHY4cxgtfxaxLaJJbJy8YgWMbS9tPrv6Q2tFhXjaPnsGYRYOCMQKs0NKTGKabK43gkYBhWCsjCpDpyWHGHxk9c37ulHClD8KLY_VKH6bsf1BVxk31Cz4DH3BzvGWiH_UVPbR1rBl617FGuEXfAJUzouWoTgW-O0OJTfngiAOCl_dLhr2ewwXsy9HY6FVBZ4sfaO7eVFsTBHBd-WyXhzwCxlr1R3L5ICINOOmOA4C2snWa30ksuT7ifc",
  "Nonce": "636601628622248777.NDlmMDA0OWEtNzY0OC00MzQyLTgxMjctYzM1ZmU4YmVhYzBlZmExYTM1MzktYzcxMi00YjJlLTg4YjYtMDVkYjI4M2QyYjJl",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601628622248777.NDlmMDA0OWEtNzY0OC00MzQyLTgxMjctYzM1ZmU4YmVhYzBlZmExYTM1MzktYzcxMi00YjJlLTg4YjYtMDVkYjI4M2QyYjJl",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hyZSP4ME4-bQLu92nEYG80n-H2xQIRW4LPv0V7Orbcrl6EfOq1JCJkIIOG_yqUGGQwAsPGdhpm4nHY4cxgtfxaxLaJJbJy8YgWMbS9tPrv6Q2tFhXjaPnsGYRYOCMQKs0NKTGKabK43gkYBhWCsjCpDpyWHGHxk9c37ulHClD8KLY_VKH6bsf1BVxk31Cz4DH3BzvGWiH_UVPbR1rBl617FGuEXfAJUzouWoTgW-O0OJTfngiAOCl_dLhr2ewwXsy9HY6FVBZ4sfaO7eVFsTBHBd-WyXhzwCxlr1R3L5ICINOOmOA4C2snWa30ksuT7ifc",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 13:34:22.319 +03:00 [INF] Showing login: User is not authenticated
2018-04-24 13:34:22.336 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 13:34:22.337 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 13:34:22.340 +03:00 [DBG] No PKCE used.
2018-04-24 13:34:22.341 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 13:34:32.181 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 13:34:32.511 +03:00 [DBG] Augmenting SignInContext
2018-04-24 13:34:32.512 +03:00 [DBG] Adding idp claim with value: local
2018-04-24 13:34:32.515 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-24 13:34:32.517 +03:00 [DBG] Adding auth_time claim with value: 1524566072
2018-04-24 13:34:32.518 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-24 13:34:32.673 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD6OC0J43U4:00000006",
  "TimeStamp": "2018-04-24T10:34:32Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 13:34:32.682 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 13:34:32.684 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 13:34:32.690 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 13:34:32.691 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 13:34:32.692 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 13:34:32.693 +03:00 [DBG] Start authorize callback request
2018-04-24 13:34:32.694 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 13:34:32.722 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 13:34:32.723 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 13:34:32.725 +03:00 [DBG] No PKCE used.
2018-04-24 13:34:32.726 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 13:34:32.727 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hyZSP4ME4-bQLu92nEYG80n-H2xQIRW4LPv0V7Orbcrl6EfOq1JCJkIIOG_yqUGGQwAsPGdhpm4nHY4cxgtfxaxLaJJbJy8YgWMbS9tPrv6Q2tFhXjaPnsGYRYOCMQKs0NKTGKabK43gkYBhWCsjCpDpyWHGHxk9c37ulHClD8KLY_VKH6bsf1BVxk31Cz4DH3BzvGWiH_UVPbR1rBl617FGuEXfAJUzouWoTgW-O0OJTfngiAOCl_dLhr2ewwXsy9HY6FVBZ4sfaO7eVFsTBHBd-WyXhzwCxlr1R3L5ICINOOmOA4C2snWa30ksuT7ifc",
  "Nonce": "636601628622248777.NDlmMDA0OWEtNzY0OC00MzQyLTgxMjctYzM1ZmU4YmVhYzBlZmExYTM1MzktYzcxMi00YjJlLTg4YjYtMDVkYjI4M2QyYjJl",
  "SessionId": "dcba186baec8efdf801d80bc6755f682",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601628622248777.NDlmMDA0OWEtNzY0OC00MzQyLTgxMjctYzM1ZmU4YmVhYzBlZmExYTM1MzktYzcxMi00YjJlLTg4YjYtMDVkYjI4M2QyYjJl",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hyZSP4ME4-bQLu92nEYG80n-H2xQIRW4LPv0V7Orbcrl6EfOq1JCJkIIOG_yqUGGQwAsPGdhpm4nHY4cxgtfxaxLaJJbJy8YgWMbS9tPrv6Q2tFhXjaPnsGYRYOCMQKs0NKTGKabK43gkYBhWCsjCpDpyWHGHxk9c37ulHClD8KLY_VKH6bsf1BVxk31Cz4DH3BzvGWiH_UVPbR1rBl617FGuEXfAJUzouWoTgW-O0OJTfngiAOCl_dLhr2ewwXsy9HY6FVBZ4sfaO7eVFsTBHBd-WyXhzwCxlr1R3L5ICINOOmOA4C2snWa30ksuT7ifc",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 13:34:32.849 +03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-04-24 13:34:32.851 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 13:34:32.881 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 13:34:32.882 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 13:34:32.886 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 13:34:32.894 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****sxKw"
    },
    {
      "TokenType": "code",
      "TokenValue": "****41e8"
    }
  ],
  "ActivityId": "0HLD6OC0J43U4:00000007",
  "TimeStamp": "2018-04-24T10:34:32Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 13:34:32.898 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hyZSP4ME4-bQLu92nEYG80n-H2xQIRW4LPv0V7Orbcrl6EfOq1JCJkIIOG_yqUGGQwAsPGdhpm4nHY4cxgtfxaxLaJJbJy8YgWMbS9tPrv6Q2tFhXjaPnsGYRYOCMQKs0NKTGKabK43gkYBhWCsjCpDpyWHGHxk9c37ulHClD8KLY_VKH6bsf1BVxk31Cz4DH3BzvGWiH_UVPbR1rBl617FGuEXfAJUzouWoTgW-O0OJTfngiAOCl_dLhr2ewwXsy9HY6FVBZ4sfaO7eVFsTBHBd-WyXhzwCxlr1R3L5ICINOOmOA4C2snWa30ksuT7ifc",
  "Scope": "openid profile api1"
}
2018-04-24 13:34:32.901 +03:00 [DBG] Augmenting SignInContext
2018-04-24 13:34:32.905 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-24 13:38:21.817 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 13:38:21.819 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 13:38:21.820 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 13:38:21.824 +03:00 [DBG] Start discovery request
2018-04-24 13:38:22.114 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 13:38:22.116 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 13:38:22.117 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 13:38:22.122 +03:00 [DBG] Start key discovery request
2018-04-24 13:38:22.208 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 13:38:22.211 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 13:38:22.216 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 13:38:22.218 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 13:38:22.301 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 13:38:22.303 +03:00 [DBG] Start authorize request
2018-04-24 13:38:22.304 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 13:38:22.308 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 13:38:22.309 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 13:38:22.310 +03:00 [DBG] No PKCE used.
2018-04-24 13:38:22.311 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 13:38:22.312 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxVMr7-AeDsrfz1g1BCLtTivkZr_s2Ra9t9A5Vdm465oWTEVP7m3FdZw3P7NFAyUIDKBikKeH9GbJJRtop96Y9Etb993x_OnLBkHQ5-HfoTj3UN1xDcpD9lbTr77NKmZwPyDNxOoUJWgofQkNP622tDGdSsWven8ndEu2_YLAZ002_T5HI3sZvRv28Tt3_e_TJWrouT-xqrwlSsCrITDfWxIFlSmlLJizw4A57l-5DhnOlx1v4n_AKaxpeUliFTMTaJlGwRlFEzmxUiIVy760R72dglfnCf1LIkTbpBCGhTAWASPXTRe94VlSmwkCB_BN8",
  "Nonce": "636601631021639767.NDA0NDZiMmQtNTNkNy00YzU0LWFjMWUtMDZjZTJlZWZkMjNjMTMyNDIzNjktNjQxYy00NmFmLWIxZjEtMzhkYmZhOWFjY2Ez",
  "SessionId": "dcba186baec8efdf801d80bc6755f682",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601631021639767.NDA0NDZiMmQtNTNkNy00YzU0LWFjMWUtMDZjZTJlZWZkMjNjMTMyNDIzNjktNjQxYy00NmFmLWIxZjEtMzhkYmZhOWFjY2Ez",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hxVMr7-AeDsrfz1g1BCLtTivkZr_s2Ra9t9A5Vdm465oWTEVP7m3FdZw3P7NFAyUIDKBikKeH9GbJJRtop96Y9Etb993x_OnLBkHQ5-HfoTj3UN1xDcpD9lbTr77NKmZwPyDNxOoUJWgofQkNP622tDGdSsWven8ndEu2_YLAZ002_T5HI3sZvRv28Tt3_e_TJWrouT-xqrwlSsCrITDfWxIFlSmlLJizw4A57l-5DhnOlx1v4n_AKaxpeUliFTMTaJlGwRlFEzmxUiIVy760R72dglfnCf1LIkTbpBCGhTAWASPXTRe94VlSmwkCB_BN8",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 13:38:22.411 +03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-04-24 13:38:22.413 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 13:38:22.459 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 13:38:22.461 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 13:38:22.468 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 13:38:22.472 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****pmBA"
    },
    {
      "TokenType": "code",
      "TokenValue": "****fdf9"
    }
  ],
  "ActivityId": "0HLD6OC0J43U8:00000001",
  "TimeStamp": "2018-04-24T10:38:22Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 13:38:22.474 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxVMr7-AeDsrfz1g1BCLtTivkZr_s2Ra9t9A5Vdm465oWTEVP7m3FdZw3P7NFAyUIDKBikKeH9GbJJRtop96Y9Etb993x_OnLBkHQ5-HfoTj3UN1xDcpD9lbTr77NKmZwPyDNxOoUJWgofQkNP622tDGdSsWven8ndEu2_YLAZ002_T5HI3sZvRv28Tt3_e_TJWrouT-xqrwlSsCrITDfWxIFlSmlLJizw4A57l-5DhnOlx1v4n_AKaxpeUliFTMTaJlGwRlFEzmxUiIVy760R72dglfnCf1LIkTbpBCGhTAWASPXTRe94VlSmwkCB_BN8",
  "Scope": "openid profile api1"
}
2018-04-24 13:38:22.899 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-24 13:38:22.902 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-24 13:38:22.903 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-24 13:38:22.905 +03:00 [DBG] Start token request.
2018-04-24 13:38:22.906 +03:00 [DBG] Start client validation
2018-04-24 13:38:22.907 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-24 13:38:22.907 +03:00 [DBG] Start parsing for secret in post body
2018-04-24 13:38:22.909 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-24 13:38:22.909 +03:00 [DBG] Secret id found: mvc
2018-04-24 13:38:22.910 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-24 13:38:22.914 +03:00 [DBG] Client validation success
2018-04-24 13:38:22.914 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD6OC0J43U7:00000003",
  "TimeStamp": "2018-04-24T10:38:22Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 13:38:22.916 +03:00 [DBG] Start token request validation
2018-04-24 13:38:22.917 +03:00 [DBG] Start validation of authorization code token request
2018-04-24 13:38:23.033 +03:00 [DBG] Validation of authorization code token request success
2018-04-24 13:38:23.034 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "cc5d35de15aa55ffb58c6b05a3304762150cdddfa08b523101540702b488fdf9",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "cc5d35de15aa55ffb58c6b05a3304762150cdddfa08b523101540702b488fdf9",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-24 13:38:23.038 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-24 13:38:23.039 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 13:38:23.218 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 13:38:23.219 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 13:38:23.224 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****0Qqw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****GoTg"
    }
  ],
  "ActivityId": "0HLD6OC0J43U7:00000003",
  "TimeStamp": "2018-04-24T10:38:23Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 13:38:23.232 +03:00 [DBG] Token request success.
2018-04-24 13:38:23.247 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-24 13:38:23.248 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-24 13:38:23.250 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-24 13:38:23.252 +03:00 [DBG] Start userinfo request
2018-04-24 13:38:23.253 +03:00 [DBG] Bearer token found in header
2018-04-24 13:38:23.324 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-24 13:38:23.328 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524566303,
    "exp": 1524569903,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524566072,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-04-24 13:38:23.332 +03:00 [DBG] Creating userinfo response
2018-04-24 13:38:23.332 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 13:38:23.333 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 13:38:23.333 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-24 13:38:23.334 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 13:38:23.476 +03:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-04-24 13:38:23.479 +03:00 [DBG] End userinfo request
2018-04-24 13:59:46.926 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 13:59:46.955 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 13:59:46.956 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 13:59:46.957 +03:00 [DBG] Start discovery request
2018-04-24 13:59:47.238 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 13:59:47.241 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 13:59:47.243 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 13:59:47.245 +03:00 [DBG] Start key discovery request
2018-04-24 13:59:47.311 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 13:59:47.313 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 13:59:47.316 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-24 13:59:47.318 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-24 13:59:47.319 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-24 13:59:47.321 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 13:59:47.328 +03:00 [DBG] Start end session request validation
2018-04-24 13:59:47.329 +03:00 [DBG] Start identity token validation
2018-04-24 13:59:47.330 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-24 13:59:47.399 +03:00 [ERR] An error occurred using the connection to database 'auth1' on server 'tcp://pg-dev.ofisim.com:5433'.
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Npgsql.TaskExtensions.<WithCancellation>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.TaskExtensions.<WithTimeout>d__1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ConnectAsync>d__148.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<RawOpen>d__146.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<Open>d__143.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ConnectorPool.<AllocateLong>d__24.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnection.<Open>d__28.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnection.<>c__DisplayClass26_0.<<OpenAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.<OpenAsync>d__34.MoveNext()
2018-04-24 13:59:47.402 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 13:59:48.265 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 13:59:48.267 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-24 13:59:48.268 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-24 13:59:48.269 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-24 13:59:48.271 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 13:59:48.272 +03:00 [DBG] Start end session request validation
2018-04-24 13:59:48.272 +03:00 [INF] End session request validation success
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwvY7c_rZAmp8QheaQBIr5T8jB4OzTE-_LyMa4Kern-FojhwBgkKKRaD1Ibu1_xuhy9X8SxfWCpjxh-XMDFVY6m1d68hglkVVQ4vlJGnfwTrf_yeDoeEsY-5fJFMVH-mgXsrSVaF1iNXh-aBNj5fNI4",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 13:59:48.277 +03:00 [DBG] Success validating end session request from null
2018-04-24 13:59:48.313 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 13:59:48.328 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 13:59:48.433 +03:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Npgsql.TaskExtensions.<WithCancellation>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.TaskExtensions.<WithTimeout>d__1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ConnectAsync>d__148.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<RawOpen>d__146.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<Open>d__143.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ConnectorPool.<AllocateLong>d__24.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnection.<Open>d__28.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnection.<>c__DisplayClass26_0.<<OpenAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.<OpenAsync>d__34.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Npgsql.TaskExtensions.<WithCancellation>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.TaskExtensions.<WithTimeout>d__1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ConnectAsync>d__148.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<RawOpen>d__146.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<Open>d__143.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ConnectorPool.<AllocateLong>d__24.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnection.<Open>d__28.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnection.<>c__DisplayClass26_0.<<OpenAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.<OpenAsync>d__34.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
2018-04-24 13:59:48.637 +03:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Npgsql.TaskExtensions.<WithCancellation>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.TaskExtensions.<WithTimeout>d__1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ConnectAsync>d__148.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<RawOpen>d__146.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<Open>d__143.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ConnectorPool.<AllocateLong>d__24.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnection.<Open>d__28.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnection.<>c__DisplayClass26_0.<<OpenAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.<OpenAsync>d__34.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Npgsql.TaskExtensions.<WithCancellation>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.TaskExtensions.<WithTimeout>d__1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ConnectAsync>d__148.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<RawOpen>d__146.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<Open>d__143.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ConnectorPool.<AllocateLong>d__24.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnection.<Open>d__28.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnection.<>c__DisplayClass26_0.<<OpenAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.<OpenAsync>d__34.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()
2018-04-24 13:59:48.931 +03:00 [INF] {
  "Name": "Unhandled Exception",
  "Category": "Error",
  "EventType": "Error",
  "Id": 3000,
  "Details": "System.Threading.Tasks.TaskCanceledException: A task was canceled.\r\n   at Npgsql.TaskExtensions.<WithCancellation>d__3.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Npgsql.TaskExtensions.<WithTimeout>d__1.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Npgsql.NpgsqlConnector.<ConnectAsync>d__148.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Npgsql.NpgsqlConnector.<RawOpen>d__146.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Npgsql.NpgsqlConnector.<Open>d__143.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Npgsql.ConnectorPool.<AllocateLong>d__24.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()\r\n   at Npgsql.NpgsqlConnection.<Open>d__28.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Npgsql.NpgsqlConnection.<>c__DisplayClass26_0.<<OpenAsync>b__0>d.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.<OpenAsync>d__34.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()\r\n   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()\r\n   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()\r\n   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.AspNetIdentity.ProfileService`1.<IsActiveAsync>d__4.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Validation.TokenValidator.<ValidateIdentityTokenAsync>d__12.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Validation\\TokenValidator.cs:line 121\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Validation.EndSessionRequestValidator.<ValidateAsync>d__9.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Validation\\EndSessionRequestValidator.cs:line 74\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Endpoints.EndSessionEndpoint.<ProcessAsync>d__4.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Endpoints\\EndSessionEndpoint.cs:line 56\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Hosting\\IdentityServerMiddleware.cs:line 54",
  "Message": "A task was canceled.",
  "ActivityId": "0HLD6OC0J43UB:00000001",
  "TimeStamp": "2018-04-24T10:59:48Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 13:59:49.019 +03:00 [FTL] Unhandled exception: System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Npgsql.TaskExtensions.<WithCancellation>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.TaskExtensions.<WithTimeout>d__1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ConnectAsync>d__148.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<RawOpen>d__146.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<Open>d__143.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ConnectorPool.<AllocateLong>d__24.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnection.<Open>d__28.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnection.<>c__DisplayClass26_0.<<OpenAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.<OpenAsync>d__34.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.AspNetIdentity.ProfileService`1.<IsActiveAsync>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Validation.TokenValidator.<ValidateIdentityTokenAsync>d__12.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Validation\TokenValidator.cs:line 121
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Validation.EndSessionRequestValidator.<ValidateAsync>d__9.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Validation\EndSessionRequestValidator.cs:line 74
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Endpoints.EndSessionEndpoint.<ProcessAsync>d__4.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Endpoints\EndSessionEndpoint.cs:line 56
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 54
2018-04-24 13:59:50.172 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at Npgsql.TaskExtensions.<WithCancellation>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.TaskExtensions.<WithTimeout>d__1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<ConnectAsync>d__148.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<RawOpen>d__146.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnector.<Open>d__143.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.ConnectorPool.<AllocateLong>d__24.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at System.Runtime.CompilerServices.ValueTaskAwaiter`1.GetResult()
   at Npgsql.NpgsqlConnection.<Open>d__28.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Npgsql.NpgsqlConnection.<>c__DisplayClass26_0.<<OpenAsync>b__0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.<OpenAsync>d__34.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<BufferlessMoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.<ExecuteAsync>d__7`2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.<MoveNext>d__9.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.<FirstOrDefault_>d__165`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.<MoveNext>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.AspNetIdentity.ProfileService`1.<IsActiveAsync>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Validation.TokenValidator.<ValidateIdentityTokenAsync>d__12.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Validation\TokenValidator.cs:line 121
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Validation.EndSessionRequestValidator.<ValidateAsync>d__9.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Validation\EndSessionRequestValidator.cs:line 74
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Endpoints.EndSessionEndpoint.<ProcessAsync>d__4.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Endpoints\EndSessionEndpoint.cs:line 56
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 54
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-24 13:59:50.893 +03:00 [DBG] CORS request made for path: /account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 13:59:50.897 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 13:59:50.899 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 13:59:50.920 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-24 13:59:50.921 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-24 13:59:50.926 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-24 13:59:50.929 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD6OC0J43UC:00000003",
  "TimeStamp": "2018-04-24T10:59:50Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 13:59:51.086 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-24 13:59:51.092 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-24 13:59:51.099 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-24 13:59:51.101 +03:00 [DBG] Processing signout callback request
2018-04-24 13:59:51.109 +03:00 [DBG] No client front-channel logout URLs
2018-04-24 13:59:51.111 +03:00 [DBG] No client back-channel logout URLs
2018-04-24 13:59:51.112 +03:00 [INF] Successful signout callback.
2018-04-24 13:59:51.113 +03:00 [DBG] No client front-channel iframe urls
2018-04-24 13:59:51.113 +03:00 [DBG] No client back-channel iframe urls
2018-04-24 14:00:04.239 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 14:00:04.241 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 14:00:04.247 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 14:00:04.248 +03:00 [DBG] Start authorize request
2018-04-24 14:00:04.249 +03:00 [DBG] No user present in authorize request
2018-04-24 14:00:04.249 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 14:00:04.251 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 14:00:04.255 +03:00 [DBG] No PKCE used.
2018-04-24 14:00:04.257 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 14:00:04.260 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hy2lqkVdxXT9Vl8f3NI6H3ruw0y3MrC-_YL9x_YxrO8-YeNcAwvzNtewjx_WkYz-hS2w2tzakwleKGn4qjs7OrBzA1mtiE4_KUSBYRT4W3uxiBYCCN0qmAGFkWoMXaXHxh9QFRNjhuZ6pgd6wtDTWxyiDeOyI4KwGZbNFI8CCbNfX7cPKa71WZPRXwDzfRQWqCAKswsTm7i_BMTw5RVt4E7NoNwTOceDItkNm_sHDF9vRedRyHsBx5gbIWOdBSiAW_RMv4SQlbtuedHXXQoiZ1MQiAOt9XaBcEE53RDG6mNu-_sWFHa3IDgtC2gTnuAwxQ",
  "Nonce": "636601644042167928.YTA1YjIyMjQtY2I5Yy00YTBkLTgzNjUtNWQ4NWNlMDMxMWZkMzE4ODEwNTUtMjEyZC00ZDIwLTkzNTktN2M4NGUzYzAwM2Ux",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601644042167928.YTA1YjIyMjQtY2I5Yy00YTBkLTgzNjUtNWQ4NWNlMDMxMWZkMzE4ODEwNTUtMjEyZC00ZDIwLTkzNTktN2M4NGUzYzAwM2Ux",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hy2lqkVdxXT9Vl8f3NI6H3ruw0y3MrC-_YL9x_YxrO8-YeNcAwvzNtewjx_WkYz-hS2w2tzakwleKGn4qjs7OrBzA1mtiE4_KUSBYRT4W3uxiBYCCN0qmAGFkWoMXaXHxh9QFRNjhuZ6pgd6wtDTWxyiDeOyI4KwGZbNFI8CCbNfX7cPKa71WZPRXwDzfRQWqCAKswsTm7i_BMTw5RVt4E7NoNwTOceDItkNm_sHDF9vRedRyHsBx5gbIWOdBSiAW_RMv4SQlbtuedHXXQoiZ1MQiAOt9XaBcEE53RDG6mNu-_sWFHa3IDgtC2gTnuAwxQ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 14:00:04.276 +03:00 [INF] Showing login: User is not authenticated
2018-04-24 14:00:04.284 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 14:00:04.285 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 14:00:04.286 +03:00 [DBG] No PKCE used.
2018-04-24 14:00:04.287 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 14:00:10.466 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 14:00:10.910 +03:00 [DBG] Augmenting SignInContext
2018-04-24 14:00:10.910 +03:00 [DBG] Adding idp claim with value: local
2018-04-24 14:00:10.912 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-24 14:00:10.914 +03:00 [DBG] Adding auth_time claim with value: 1524567610
2018-04-24 14:00:10.917 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-24 14:00:11.019 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD6OC0J43UC:00000007",
  "TimeStamp": "2018-04-24T11:00:11Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 14:00:11.030 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:00:11.035 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:00:11.036 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 14:00:11.038 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 14:00:11.039 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 14:00:11.040 +03:00 [DBG] Start authorize callback request
2018-04-24 14:00:11.044 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 14:00:11.048 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 14:00:11.049 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 14:00:11.049 +03:00 [DBG] No PKCE used.
2018-04-24 14:00:11.050 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 14:00:11.052 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hy2lqkVdxXT9Vl8f3NI6H3ruw0y3MrC-_YL9x_YxrO8-YeNcAwvzNtewjx_WkYz-hS2w2tzakwleKGn4qjs7OrBzA1mtiE4_KUSBYRT4W3uxiBYCCN0qmAGFkWoMXaXHxh9QFRNjhuZ6pgd6wtDTWxyiDeOyI4KwGZbNFI8CCbNfX7cPKa71WZPRXwDzfRQWqCAKswsTm7i_BMTw5RVt4E7NoNwTOceDItkNm_sHDF9vRedRyHsBx5gbIWOdBSiAW_RMv4SQlbtuedHXXQoiZ1MQiAOt9XaBcEE53RDG6mNu-_sWFHa3IDgtC2gTnuAwxQ",
  "Nonce": "636601644042167928.YTA1YjIyMjQtY2I5Yy00YTBkLTgzNjUtNWQ4NWNlMDMxMWZkMzE4ODEwNTUtMjEyZC00ZDIwLTkzNTktN2M4NGUzYzAwM2Ux",
  "SessionId": "0034d572e04855e40b029ca11bef1df1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601644042167928.YTA1YjIyMjQtY2I5Yy00YTBkLTgzNjUtNWQ4NWNlMDMxMWZkMzE4ODEwNTUtMjEyZC00ZDIwLTkzNTktN2M4NGUzYzAwM2Ux",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hy2lqkVdxXT9Vl8f3NI6H3ruw0y3MrC-_YL9x_YxrO8-YeNcAwvzNtewjx_WkYz-hS2w2tzakwleKGn4qjs7OrBzA1mtiE4_KUSBYRT4W3uxiBYCCN0qmAGFkWoMXaXHxh9QFRNjhuZ6pgd6wtDTWxyiDeOyI4KwGZbNFI8CCbNfX7cPKa71WZPRXwDzfRQWqCAKswsTm7i_BMTw5RVt4E7NoNwTOceDItkNm_sHDF9vRedRyHsBx5gbIWOdBSiAW_RMv4SQlbtuedHXXQoiZ1MQiAOt9XaBcEE53RDG6mNu-_sWFHa3IDgtC2gTnuAwxQ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 14:00:11.255 +03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-04-24 14:00:11.257 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 14:00:11.276 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 14:00:11.277 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 14:00:11.281 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 14:00:11.289 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****eKrw"
    },
    {
      "TokenType": "code",
      "TokenValue": "****5967"
    }
  ],
  "ActivityId": "0HLD6OC0J43UC:00000008",
  "TimeStamp": "2018-04-24T11:00:11Z",
  "ProcessId": 14144,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 14:00:11.292 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hy2lqkVdxXT9Vl8f3NI6H3ruw0y3MrC-_YL9x_YxrO8-YeNcAwvzNtewjx_WkYz-hS2w2tzakwleKGn4qjs7OrBzA1mtiE4_KUSBYRT4W3uxiBYCCN0qmAGFkWoMXaXHxh9QFRNjhuZ6pgd6wtDTWxyiDeOyI4KwGZbNFI8CCbNfX7cPKa71WZPRXwDzfRQWqCAKswsTm7i_BMTw5RVt4E7NoNwTOceDItkNm_sHDF9vRedRyHsBx5gbIWOdBSiAW_RMv4SQlbtuedHXXQoiZ1MQiAOt9XaBcEE53RDG6mNu-_sWFHa3IDgtC2gTnuAwxQ",
  "Scope": "openid profile api1"
}
2018-04-24 14:00:11.294 +03:00 [DBG] Augmenting SignInContext
2018-04-24 14:00:11.295 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-24 14:17:44.174 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-24 14:17:44.225 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-24 14:17:44.229 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-24 14:17:44.229 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-24 14:17:44.229 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-24 14:17:44.230 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-24 14:17:45.096 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:17:45.120 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:18:27.796 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 14:18:27.805 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 14:18:27.806 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 14:18:27.815 +03:00 [DBG] Start discovery request
2018-04-24 14:18:28.193 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 14:18:28.198 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 14:18:28.201 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 14:18:28.207 +03:00 [DBG] Start key discovery request
2018-04-24 14:18:28.308 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:18:28.310 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:18:28.312 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 14:18:28.324 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 14:18:28.325 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 14:18:28.335 +03:00 [DBG] Start authorize request
2018-04-24 14:18:28.350 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 14:18:28.363 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 14:18:28.382 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 14:18:28.384 +03:00 [DBG] No PKCE used.
2018-04-24 14:18:28.438 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 14:18:28.461 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hynN65lFI7Stcu1TbAMHhI4NgPethNbTpikH-cSJ-OgBXqvmitIXxcr-o8CAysrdsABAdfQtLvQ_PginrPvxP1iTgXsvBUXVjTEGE_xZ_m5iUDNE7U17JtjyHfGNiGzZvmPYhTv_fhVW_Z7W2PpRRGiVzSl0eJlkrm0f0FXUIFLUdDaF1io25HZe04BT1KnpiQTlqaHFxHgimxjKMD1f4ku4wd4Iv_OND2Z9Q6IrkGUWgZouL1zi5inVt-xeH6QEdqa9_BsFTYlvfw03hmdK75BB-rCopL6nC3xcr3ROtDPVYzfzdv326aUD1WEzmuu04U",
  "Nonce": "636601655082845001.MDRiODI4NzQtNjVkMS00ZWFhLTg5M2QtZGI5MWI3NWY1NmRhZDU3ZWU3ZWQtZDU5Ni00OTFhLWI0NzQtNDBiODIzNjA1OTZm",
  "SessionId": "0034d572e04855e40b029ca11bef1df1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601655082845001.MDRiODI4NzQtNjVkMS00ZWFhLTg5M2QtZGI5MWI3NWY1NmRhZDU3ZWU3ZWQtZDU5Ni00OTFhLWI0NzQtNDBiODIzNjA1OTZm",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hynN65lFI7Stcu1TbAMHhI4NgPethNbTpikH-cSJ-OgBXqvmitIXxcr-o8CAysrdsABAdfQtLvQ_PginrPvxP1iTgXsvBUXVjTEGE_xZ_m5iUDNE7U17JtjyHfGNiGzZvmPYhTv_fhVW_Z7W2PpRRGiVzSl0eJlkrm0f0FXUIFLUdDaF1io25HZe04BT1KnpiQTlqaHFxHgimxjKMD1f4ku4wd4Iv_OND2Z9Q6IrkGUWgZouL1zi5inVt-xeH6QEdqa9_BsFTYlvfw03hmdK75BB-rCopL6nC3xcr3ROtDPVYzfzdv326aUD1WEzmuu04U",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 14:18:29.697 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 14:18:29.706 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 14:18:29.707 +03:00 [INF] Showing consent: User has not yet consented
2018-04-24 14:18:29.720 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:18:29.722 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:18:29.799 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 14:18:29.801 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 14:18:29.804 +03:00 [DBG] No PKCE used.
2018-04-24 14:18:29.805 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 14:18:33.372 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 14:18:33.378 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:18:33.383 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:18:33.435 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 14:18:33.436 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 14:18:33.438 +03:00 [DBG] No PKCE used.
2018-04-24 14:18:33.439 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 14:18:33.471 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:18:33.474 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:18:33.477 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 14:18:33.483 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 14:18:33.484 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 14:18:33.491 +03:00 [DBG] Start authorize callback request
2018-04-24 14:18:33.521 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 14:18:33.527 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 14:18:33.528 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 14:18:33.528 +03:00 [DBG] No PKCE used.
2018-04-24 14:18:33.529 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 14:18:33.530 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hynN65lFI7Stcu1TbAMHhI4NgPethNbTpikH-cSJ-OgBXqvmitIXxcr-o8CAysrdsABAdfQtLvQ_PginrPvxP1iTgXsvBUXVjTEGE_xZ_m5iUDNE7U17JtjyHfGNiGzZvmPYhTv_fhVW_Z7W2PpRRGiVzSl0eJlkrm0f0FXUIFLUdDaF1io25HZe04BT1KnpiQTlqaHFxHgimxjKMD1f4ku4wd4Iv_OND2Z9Q6IrkGUWgZouL1zi5inVt-xeH6QEdqa9_BsFTYlvfw03hmdK75BB-rCopL6nC3xcr3ROtDPVYzfzdv326aUD1WEzmuu04U",
  "Nonce": "636601655082845001.MDRiODI4NzQtNjVkMS00ZWFhLTg5M2QtZGI5MWI3NWY1NmRhZDU3ZWU3ZWQtZDU5Ni00OTFhLWI0NzQtNDBiODIzNjA1OTZm",
  "SessionId": "0034d572e04855e40b029ca11bef1df1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601655082845001.MDRiODI4NzQtNjVkMS00ZWFhLTg5M2QtZGI5MWI3NWY1NmRhZDU3ZWU3ZWQtZDU5Ni00OTFhLWI0NzQtNDBiODIzNjA1OTZm",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hynN65lFI7Stcu1TbAMHhI4NgPethNbTpikH-cSJ-OgBXqvmitIXxcr-o8CAysrdsABAdfQtLvQ_PginrPvxP1iTgXsvBUXVjTEGE_xZ_m5iUDNE7U17JtjyHfGNiGzZvmPYhTv_fhVW_Z7W2PpRRGiVzSl0eJlkrm0f0FXUIFLUdDaF1io25HZe04BT1KnpiQTlqaHFxHgimxjKMD1f4ku4wd4Iv_OND2Z9Q6IrkGUWgZouL1zi5inVt-xeH6QEdqa9_BsFTYlvfw03hmdK75BB-rCopL6nC3xcr3ROtDPVYzfzdv326aUD1WEzmuu04U",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 14:18:33.599 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 14:18:33.603 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 14:18:33.615 +03:00 [INF] User consented to scopes: ["openid","profile","api1"]
2018-04-24 14:18:33.631 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1"]
2018-04-24 14:18:33.637 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 14:18:33.660 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 14:18:33.697 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 14:18:33.709 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 14:18:33.715 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 14:18:33.822 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****e8wA"
    },
    {
      "TokenType": "code",
      "TokenValue": "****69d7"
    }
  ],
  "ActivityId": "0HLD9QK0B140L:00000007",
  "TimeStamp": "2018-04-24T11:18:33Z",
  "ProcessId": 22752,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 14:18:33.835 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hynN65lFI7Stcu1TbAMHhI4NgPethNbTpikH-cSJ-OgBXqvmitIXxcr-o8CAysrdsABAdfQtLvQ_PginrPvxP1iTgXsvBUXVjTEGE_xZ_m5iUDNE7U17JtjyHfGNiGzZvmPYhTv_fhVW_Z7W2PpRRGiVzSl0eJlkrm0f0FXUIFLUdDaF1io25HZe04BT1KnpiQTlqaHFxHgimxjKMD1f4ku4wd4Iv_OND2Z9Q6IrkGUWgZouL1zi5inVt-xeH6QEdqa9_BsFTYlvfw03hmdK75BB-rCopL6nC3xcr3ROtDPVYzfzdv326aUD1WEzmuu04U",
  "Scope": "openid profile api1"
}
2018-04-24 14:21:57.195 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 14:21:57.201 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 14:21:57.202 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 14:21:57.204 +03:00 [DBG] Start discovery request
2018-04-24 14:21:57.483 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 14:21:57.486 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 14:21:57.488 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 14:21:57.491 +03:00 [DBG] Start key discovery request
2018-04-24 14:21:57.563 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:21:57.565 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:21:57.568 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 14:21:57.569 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 14:21:57.571 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 14:21:57.572 +03:00 [DBG] Start authorize request
2018-04-24 14:21:57.573 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 14:21:57.578 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 14:21:57.580 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 14:21:57.581 +03:00 [DBG] No PKCE used.
2018-04-24 14:21:57.581 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 14:21:57.583 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 email",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hwOqk9ArliN0g_XI749EhQXTNxGjfj0A3y1fWFXYYRiDX36DFyvuOvnqYmOWvXiHwfmSwPUi5OqCuNI-iFcpMuohkoa6x8MvjgbnzRFMdHGxhQ9YdRvQ3fKexXEby0HNiPbV4Fhwt2U596Jp44CACPO7hfmvuID12gqgqJO7Dw60ItG0NC2rFsE_m7Cl5u2yuyKNsPcoY5OIPkbI6zmSczPf6tfUIoGg7OotPDNf6vKqv6PqSrEfik580QXyvlop1L7GDjU6z9TID9FxzCyDQk1b2O4-VDziCzOOgg1vgHrT7yDA3CM6ltsh0btOcNqbmM",
  "Nonce": "636601657175369162.NzQ3NjE4MjAtZjYzNC00M2ZjLThkZGEtOTIzNDUwNjE1NTBiZGZlMTYzOTQtMjliNS00ODRiLThlNGQtMzkzODdhMzBmYzA4",
  "SessionId": "0034d572e04855e40b029ca11bef1df1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 email",
    "response_mode": "form_post",
    "nonce": "636601657175369162.NzQ3NjE4MjAtZjYzNC00M2ZjLThkZGEtOTIzNDUwNjE1NTBiZGZlMTYzOTQtMjliNS00ODRiLThlNGQtMzkzODdhMzBmYzA4",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwOqk9ArliN0g_XI749EhQXTNxGjfj0A3y1fWFXYYRiDX36DFyvuOvnqYmOWvXiHwfmSwPUi5OqCuNI-iFcpMuohkoa6x8MvjgbnzRFMdHGxhQ9YdRvQ3fKexXEby0HNiPbV4Fhwt2U596Jp44CACPO7hfmvuID12gqgqJO7Dw60ItG0NC2rFsE_m7Cl5u2yuyKNsPcoY5OIPkbI6zmSczPf6tfUIoGg7OotPDNf6vKqv6PqSrEfik580QXyvlop1L7GDjU6z9TID9FxzCyDQk1b2O4-VDziCzOOgg1vgHrT7yDA3CM6ltsh0btOcNqbmM",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 14:21:57.674 +03:00 [DBG] Consent found in consent store is different than current request, consent is required
2018-04-24 14:21:57.676 +03:00 [INF] Showing consent: User has not yet consented
2018-04-24 14:21:57.681 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:21:57.682 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:21:57.684 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 14:21:57.686 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 14:21:57.687 +03:00 [DBG] No PKCE used.
2018-04-24 14:21:57.688 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 14:21:59.167 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 14:21:59.172 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:21:59.180 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:21:59.186 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 14:21:59.187 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 14:21:59.188 +03:00 [DBG] No PKCE used.
2018-04-24 14:21:59.191 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 14:21:59.201 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:21:59.205 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:21:59.206 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 14:21:59.208 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 14:21:59.209 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 14:21:59.215 +03:00 [DBG] Start authorize callback request
2018-04-24 14:21:59.216 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 14:21:59.217 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 14:21:59.217 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 14:21:59.218 +03:00 [DBG] No PKCE used.
2018-04-24 14:21:59.218 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 14:21:59.219 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 email",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hwOqk9ArliN0g_XI749EhQXTNxGjfj0A3y1fWFXYYRiDX36DFyvuOvnqYmOWvXiHwfmSwPUi5OqCuNI-iFcpMuohkoa6x8MvjgbnzRFMdHGxhQ9YdRvQ3fKexXEby0HNiPbV4Fhwt2U596Jp44CACPO7hfmvuID12gqgqJO7Dw60ItG0NC2rFsE_m7Cl5u2yuyKNsPcoY5OIPkbI6zmSczPf6tfUIoGg7OotPDNf6vKqv6PqSrEfik580QXyvlop1L7GDjU6z9TID9FxzCyDQk1b2O4-VDziCzOOgg1vgHrT7yDA3CM6ltsh0btOcNqbmM",
  "Nonce": "636601657175369162.NzQ3NjE4MjAtZjYzNC00M2ZjLThkZGEtOTIzNDUwNjE1NTBiZGZlMTYzOTQtMjliNS00ODRiLThlNGQtMzkzODdhMzBmYzA4",
  "SessionId": "0034d572e04855e40b029ca11bef1df1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 email",
    "response_mode": "form_post",
    "nonce": "636601657175369162.NzQ3NjE4MjAtZjYzNC00M2ZjLThkZGEtOTIzNDUwNjE1NTBiZGZlMTYzOTQtMjliNS00ODRiLThlNGQtMzkzODdhMzBmYzA4",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwOqk9ArliN0g_XI749EhQXTNxGjfj0A3y1fWFXYYRiDX36DFyvuOvnqYmOWvXiHwfmSwPUi5OqCuNI-iFcpMuohkoa6x8MvjgbnzRFMdHGxhQ9YdRvQ3fKexXEby0HNiPbV4Fhwt2U596Jp44CACPO7hfmvuID12gqgqJO7Dw60ItG0NC2rFsE_m7Cl5u2yuyKNsPcoY5OIPkbI6zmSczPf6tfUIoGg7OotPDNf6vKqv6PqSrEfik580QXyvlop1L7GDjU6z9TID9FxzCyDQk1b2O4-VDziCzOOgg1vgHrT7yDA3CM6ltsh0btOcNqbmM",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 14:21:59.366 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 14:21:59.369 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:21:59.373 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:21:59.381 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 14:21:59.381 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 14:21:59.383 +03:00 [DBG] No PKCE used.
2018-04-24 14:21:59.388 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 14:21:59.397 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:21:59.398 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:21:59.401 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 14:21:59.405 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 14:21:59.414 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 14:21:59.420 +03:00 [DBG] Start authorize callback request
2018-04-24 14:21:59.421 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 14:21:59.424 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 14:21:59.425 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 14:21:59.426 +03:00 [DBG] No PKCE used.
2018-04-24 14:21:59.427 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 14:21:59.429 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 email",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hwOqk9ArliN0g_XI749EhQXTNxGjfj0A3y1fWFXYYRiDX36DFyvuOvnqYmOWvXiHwfmSwPUi5OqCuNI-iFcpMuohkoa6x8MvjgbnzRFMdHGxhQ9YdRvQ3fKexXEby0HNiPbV4Fhwt2U596Jp44CACPO7hfmvuID12gqgqJO7Dw60ItG0NC2rFsE_m7Cl5u2yuyKNsPcoY5OIPkbI6zmSczPf6tfUIoGg7OotPDNf6vKqv6PqSrEfik580QXyvlop1L7GDjU6z9TID9FxzCyDQk1b2O4-VDziCzOOgg1vgHrT7yDA3CM6ltsh0btOcNqbmM",
  "Nonce": "636601657175369162.NzQ3NjE4MjAtZjYzNC00M2ZjLThkZGEtOTIzNDUwNjE1NTBiZGZlMTYzOTQtMjliNS00ODRiLThlNGQtMzkzODdhMzBmYzA4",
  "SessionId": "0034d572e04855e40b029ca11bef1df1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 email",
    "response_mode": "form_post",
    "nonce": "636601657175369162.NzQ3NjE4MjAtZjYzNC00M2ZjLThkZGEtOTIzNDUwNjE1NTBiZGZlMTYzOTQtMjliNS00ODRiLThlNGQtMzkzODdhMzBmYzA4",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwOqk9ArliN0g_XI749EhQXTNxGjfj0A3y1fWFXYYRiDX36DFyvuOvnqYmOWvXiHwfmSwPUi5OqCuNI-iFcpMuohkoa6x8MvjgbnzRFMdHGxhQ9YdRvQ3fKexXEby0HNiPbV4Fhwt2U596Jp44CACPO7hfmvuID12gqgqJO7Dw60ItG0NC2rFsE_m7Cl5u2yuyKNsPcoY5OIPkbI6zmSczPf6tfUIoGg7OotPDNf6vKqv6PqSrEfik580QXyvlop1L7GDjU6z9TID9FxzCyDQk1b2O4-VDziCzOOgg1vgHrT7yDA3CM6ltsh0btOcNqbmM",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 14:21:59.620 +03:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
System.NullReferenceException: Object reference not set to an instance of an object.
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
System.NullReferenceException: Object reference not set to an instance of an object.
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
2018-04-24 14:21:59.642 +03:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'PrimeApps.Auth.Data.ApplicationDbContext'.
System.NullReferenceException: Object reference not set to an instance of an object.
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()
System.NullReferenceException: Object reference not set to an instance of an object.
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()
2018-04-24 14:21:59.695 +03:00 [INF] {
  "Name": "Unhandled Exception",
  "Category": "Error",
  "EventType": "Error",
  "Id": 3000,
  "Details": "System.NullReferenceException: Object reference not set to an instance of an object.\r\n   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()\r\n   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.AspNetIdentity.ProfileService`1.<IsActiveAsync>d__4.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator.<ProcessLoginAsync>d__6.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\ResponseHandling\\AuthorizeInteractionResponseGenerator.cs:line 124\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator.<ProcessInteractionAsync>d__5.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\ResponseHandling\\AuthorizeInteractionResponseGenerator.cs:line 83\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Endpoints.AuthorizeEndpointBase.<ProcessAuthorizeRequestAsync>d__14.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Endpoints\\AuthorizeEndpointBase.cs:line 81\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Endpoints.AuthorizeCallbackEndpoint.<ProcessAsync>d__2.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Endpoints\\AuthorizeCallbackEndpoint.cs:line 59\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at IdentityServer4.Endpoints.AuthorizeCallbackEndpoint.<ProcessAsync>d__2.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Endpoints\\AuthorizeCallbackEndpoint.cs:line 69\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Hosting\\IdentityServerMiddleware.cs:line 54",
  "Message": "Object reference not set to an instance of an object.",
  "ActivityId": "0HLD9QK0B140S:00000004",
  "TimeStamp": "2018-04-24T11:21:59Z",
  "ProcessId": 22752,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 14:21:59.721 +03:00 [FTL] Unhandled exception: System.NullReferenceException: Object reference not set to an instance of an object.
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.AspNetIdentity.ProfileService`1.<IsActiveAsync>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator.<ProcessLoginAsync>d__6.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\ResponseHandling\AuthorizeInteractionResponseGenerator.cs:line 124
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator.<ProcessInteractionAsync>d__5.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\ResponseHandling\AuthorizeInteractionResponseGenerator.cs:line 83
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Endpoints.AuthorizeEndpointBase.<ProcessAuthorizeRequestAsync>d__14.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Endpoints\AuthorizeEndpointBase.cs:line 81
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Endpoints.AuthorizeCallbackEndpoint.<ProcessAsync>d__2.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Endpoints\AuthorizeCallbackEndpoint.cs:line 59
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at IdentityServer4.Endpoints.AuthorizeCallbackEndpoint.<ProcessAsync>d__2.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Endpoints\AuthorizeCallbackEndpoint.cs:line 69
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 54
2018-04-24 14:21:59.771 +03:00 [DBG] Consent found in consent store is different than current request, consent is required
2018-04-24 14:21:59.774 +03:00 [INF] User consented to scopes: ["openid","email","profile","api1"]
2018-04-24 14:21:59.781 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1"]
2018-04-24 14:21:59.783 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 14:21:59.786 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 14:21:59.799 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 14:21:59.799 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 14:21:59.802 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 14:21:59.809 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile email api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****SfAg"
    },
    {
      "TokenType": "code",
      "TokenValue": "****e46c"
    }
  ],
  "ActivityId": "0HLD9QK0B140T:00000002",
  "TimeStamp": "2018-04-24T11:21:59Z",
  "ProcessId": 22752,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 14:21:59.813 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hwOqk9ArliN0g_XI749EhQXTNxGjfj0A3y1fWFXYYRiDX36DFyvuOvnqYmOWvXiHwfmSwPUi5OqCuNI-iFcpMuohkoa6x8MvjgbnzRFMdHGxhQ9YdRvQ3fKexXEby0HNiPbV4Fhwt2U596Jp44CACPO7hfmvuID12gqgqJO7Dw60ItG0NC2rFsE_m7Cl5u2yuyKNsPcoY5OIPkbI6zmSczPf6tfUIoGg7OotPDNf6vKqv6PqSrEfik580QXyvlop1L7GDjU6z9TID9FxzCyDQk1b2O4-VDziCzOOgg1vgHrT7yDA3CM6ltsh0btOcNqbmM",
  "Scope": "openid profile email api1"
}
2018-04-24 14:22:00.684 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.NullReferenceException: Object reference not set to an instance of an object.
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.<MoveNextCore>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()
   at System.Linq.AsyncEnumerable.AsyncIterator`1.<MoveNext>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.<MoveNext>d__5.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<ExecuteSingletonAsyncQuery>d__23`1.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.AspNetIdentity.ProfileService`1.<IsActiveAsync>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator.<ProcessLoginAsync>d__6.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\ResponseHandling\AuthorizeInteractionResponseGenerator.cs:line 124
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator.<ProcessInteractionAsync>d__5.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\ResponseHandling\AuthorizeInteractionResponseGenerator.cs:line 83
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Endpoints.AuthorizeEndpointBase.<ProcessAuthorizeRequestAsync>d__14.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Endpoints\AuthorizeEndpointBase.cs:line 81
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Endpoints.AuthorizeCallbackEndpoint.<ProcessAsync>d__2.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Endpoints\AuthorizeCallbackEndpoint.cs:line 59
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at IdentityServer4.Endpoints.AuthorizeCallbackEndpoint.<ProcessAsync>d__2.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Endpoints\AuthorizeCallbackEndpoint.cs:line 69
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 54
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-24 14:50:59.015 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 14:50:59.017 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 14:50:59.018 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 14:50:59.020 +03:00 [DBG] Start discovery request
2018-04-24 14:50:59.288 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 14:50:59.290 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 14:50:59.291 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 14:50:59.292 +03:00 [DBG] Start key discovery request
2018-04-24 14:51:00.106 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:51:00.111 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:51:00.116 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 14:51:00.119 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 14:51:00.124 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 14:51:00.125 +03:00 [DBG] Start authorize request
2018-04-24 14:51:00.125 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 14:51:00.126 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 14:51:00.127 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 14:51:00.128 +03:00 [DBG] No PKCE used.
2018-04-24 14:51:00.130 +03:00 [ERR] Invalid scope: roles
2018-04-24 14:51:00.137 +03:00 [ERR] Request validation failed
2018-04-24 14:51:00.138 +03:00 [INF] {
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile roles",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzrU2kYbl_O_7BC8QnDYVHD0qqmTbI1k7OXBgYhUrLog93u63Pp3r8afHTivZmbOxr0ExojMeYOPpKu9eiSQP0VPKyzVYtiUObL0M0xp0wN9rPV_c2MIdCJvz7kuQEuQgGFqROf3tEVrnrPGwxizY13xVOOLoAQl8kI3KjMGL2M4WQdjhZkIjRGBf1zDVrSu-3Jq46UUp9ItK0KN50rAhTjbpLlPfjIr4E2PrRkLGL9EvdlJbODuhFEX5JKXOmhP_27RcdMldMHMti-dA5WW9EHW9INJWTPYZfdmVOx8ApTQD4edGhmfjPA4xlP4fv7ias",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile roles",
    "response_mode": "form_post",
    "nonce": "636601674593334889.NzRiMGVkODYtMzgxNi00MGNlLThhN2EtMTZkNDBkOWMxNTVhNjc2MWJjNWEtNWE1Yy00NDM0LWIyZTItMTc2Mjg1MDM4YjQ5",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hzrU2kYbl_O_7BC8QnDYVHD0qqmTbI1k7OXBgYhUrLog93u63Pp3r8afHTivZmbOxr0ExojMeYOPpKu9eiSQP0VPKyzVYtiUObL0M0xp0wN9rPV_c2MIdCJvz7kuQEuQgGFqROf3tEVrnrPGwxizY13xVOOLoAQl8kI3KjMGL2M4WQdjhZkIjRGBf1zDVrSu-3Jq46UUp9ItK0KN50rAhTjbpLlPfjIr4E2PrRkLGL9EvdlJbODuhFEX5JKXOmhP_27RcdMldMHMti-dA5WW9EHW9INJWTPYZfdmVOx8ApTQD4edGhmfjPA4xlP4fv7ias",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 14:51:00.160 +03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile roles",
  "GrantType": "hybrid",
  "Error": "invalid_scope",
  "ActivityId": "0HLD9QK0B1410:00000001",
  "TimeStamp": "2018-04-24T11:51:00Z",
  "ProcessId": 22752,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 14:51:00.194 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:51:00.196 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:53:20.179 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 14:53:20.183 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 14:53:20.186 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 14:53:20.188 +03:00 [DBG] Start discovery request
2018-04-24 14:53:20.453 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 14:53:20.457 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 14:53:20.458 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 14:53:20.459 +03:00 [DBG] Start key discovery request
2018-04-24 14:53:20.525 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:53:20.532 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:53:20.535 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 14:53:20.541 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 14:53:20.546 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 14:53:20.548 +03:00 [DBG] Start authorize request
2018-04-24 14:53:20.548 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 14:53:20.550 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 14:53:20.550 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 14:53:20.551 +03:00 [DBG] No PKCE used.
2018-04-24 14:53:20.552 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 14:53:20.560 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hygT8xx6X4Le62PC_Rt6wuzECcjkPfLP5UCx5o5CJ0r20C2NaIowBAJU-5D7NuJDCX7im3bnrRHW0qfiLKO8dZvKNyha8HhSCa2mevi_ffU8KsYHJ3YxCP5hqBqmVYFwysOGA4YLIQ8cfSj8FQ_WmUJEc877bHXhnsDBzMjnKu5eVd4uzOy6aR4YgAiLQf7wh_7xiN_CteGnzZFXG13WClN3Xmo5rb1tHMBuLv-wG9uzkq8iPxOyTTI6Oss2EGVLKBbzmfz7lOOkAysv1f4LNSicipESEPx8HYOcY66oLlD9qeUE-2RW5XAoLVXncw-A_k",
  "Nonce": "636601676004988714.ODQwZjg1MmUtMWI0OC00MGE3LThiYjMtYThjYjI2MzJmMzcwYTQ4ZTMwNjAtMzc3MC00MTgxLWI4YWMtYTZkYTVjNjJjOTI4",
  "SessionId": "0034d572e04855e40b029ca11bef1df1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile",
    "response_mode": "form_post",
    "nonce": "636601676004988714.ODQwZjg1MmUtMWI0OC00MGE3LThiYjMtYThjYjI2MzJmMzcwYTQ4ZTMwNjAtMzc3MC00MTgxLWI4YWMtYTZkYTVjNjJjOTI4",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hygT8xx6X4Le62PC_Rt6wuzECcjkPfLP5UCx5o5CJ0r20C2NaIowBAJU-5D7NuJDCX7im3bnrRHW0qfiLKO8dZvKNyha8HhSCa2mevi_ffU8KsYHJ3YxCP5hqBqmVYFwysOGA4YLIQ8cfSj8FQ_WmUJEc877bHXhnsDBzMjnKu5eVd4uzOy6aR4YgAiLQf7wh_7xiN_CteGnzZFXG13WClN3Xmo5rb1tHMBuLv-wG9uzkq8iPxOyTTI6Oss2EGVLKBbzmfz7lOOkAysv1f4LNSicipESEPx8HYOcY66oLlD9qeUE-2RW5XAoLVXncw-A_k",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 14:53:20.678 +03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-04-24 14:53:20.680 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 14:53:20.697 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 14:53:20.697 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 14:53:20.702 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 14:53:20.707 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****uMsQ"
    },
    {
      "TokenType": "code",
      "TokenValue": "****0ff1"
    }
  ],
  "ActivityId": "0HLD9QK0B1412:00000001",
  "TimeStamp": "2018-04-24T11:53:20Z",
  "ProcessId": 22752,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 14:53:20.714 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hygT8xx6X4Le62PC_Rt6wuzECcjkPfLP5UCx5o5CJ0r20C2NaIowBAJU-5D7NuJDCX7im3bnrRHW0qfiLKO8dZvKNyha8HhSCa2mevi_ffU8KsYHJ3YxCP5hqBqmVYFwysOGA4YLIQ8cfSj8FQ_WmUJEc877bHXhnsDBzMjnKu5eVd4uzOy6aR4YgAiLQf7wh_7xiN_CteGnzZFXG13WClN3Xmo5rb1tHMBuLv-wG9uzkq8iPxOyTTI6Oss2EGVLKBbzmfz7lOOkAysv1f4LNSicipESEPx8HYOcY66oLlD9qeUE-2RW5XAoLVXncw-A_k",
  "Scope": "openid profile"
}
2018-04-24 14:55:15.687 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 14:55:15.693 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 14:55:15.693 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 14:55:15.694 +03:00 [DBG] Start discovery request
2018-04-24 14:55:15.963 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 14:55:15.966 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 14:55:15.968 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 14:55:15.974 +03:00 [DBG] Start key discovery request
2018-04-24 14:55:16.048 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:55:16.050 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 14:55:16.052 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 14:55:16.054 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 14:55:16.056 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 14:55:16.062 +03:00 [DBG] Start authorize request
2018-04-24 14:55:16.065 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 14:55:16.067 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 14:55:16.068 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 14:55:16.068 +03:00 [DBG] No PKCE used.
2018-04-24 14:55:16.069 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 14:55:16.070 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzqct7-Om2CGDcfY1z1HmxB3OoKo6qJXWL8UeJSMZHHnXx50iWUrpR3tB0UPgoNOl8HAd2yXodcaNIO4Z5D9s_QCVD6G9m-Azav-wsQMnQmyEDyy7klBhI_BVxweJfLq4tg19NkCaHtV4gVRtgpIQP4ztofSh4oCepI9mMTcGNW5ZGYGE3FqDPGk6gtzFpsL_rnn4EbTn2pnEiVeFuZ6MpvQegcszwHLiBfnSJ0JP3KBVQZ_8NkNcS6qyOVHZeXP40wEyzuWGM4KT4V6DE_h-vvDDxIvPMievHX97vnq-qneAe9Q6lDIsmwGl94Gz7recg",
  "Nonce": "636601677160176671.NjY0ZmI2MWMtNjRjMS00N2Q3LTkzNTMtMzdkNzQwZmYyZmNkZDE0MzJiMmYtODgzMS00MzA5LWE1MTktYTM1MDQzZDhiOWUy",
  "SessionId": "0034d572e04855e40b029ca11bef1df1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email",
    "response_mode": "form_post",
    "nonce": "636601677160176671.NjY0ZmI2MWMtNjRjMS00N2Q3LTkzNTMtMzdkNzQwZmYyZmNkZDE0MzJiMmYtODgzMS00MzA5LWE1MTktYTM1MDQzZDhiOWUy",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hzqct7-Om2CGDcfY1z1HmxB3OoKo6qJXWL8UeJSMZHHnXx50iWUrpR3tB0UPgoNOl8HAd2yXodcaNIO4Z5D9s_QCVD6G9m-Azav-wsQMnQmyEDyy7klBhI_BVxweJfLq4tg19NkCaHtV4gVRtgpIQP4ztofSh4oCepI9mMTcGNW5ZGYGE3FqDPGk6gtzFpsL_rnn4EbTn2pnEiVeFuZ6MpvQegcszwHLiBfnSJ0JP3KBVQZ_8NkNcS6qyOVHZeXP40wEyzuWGM4KT4V6DE_h-vvDDxIvPMievHX97vnq-qneAe9Q6lDIsmwGl94Gz7recg",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 14:55:16.240 +03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-04-24 14:55:16.242 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 14:55:16.256 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 14:55:16.256 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 14:55:16.260 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 14:55:16.267 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile email",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****EWdw"
    },
    {
      "TokenType": "code",
      "TokenValue": "****5137"
    }
  ],
  "ActivityId": "0HLD9QK0B1412:00000002",
  "TimeStamp": "2018-04-24T11:55:16Z",
  "ProcessId": 22752,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 14:55:16.271 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzqct7-Om2CGDcfY1z1HmxB3OoKo6qJXWL8UeJSMZHHnXx50iWUrpR3tB0UPgoNOl8HAd2yXodcaNIO4Z5D9s_QCVD6G9m-Azav-wsQMnQmyEDyy7klBhI_BVxweJfLq4tg19NkCaHtV4gVRtgpIQP4ztofSh4oCepI9mMTcGNW5ZGYGE3FqDPGk6gtzFpsL_rnn4EbTn2pnEiVeFuZ6MpvQegcszwHLiBfnSJ0JP3KBVQZ_8NkNcS6qyOVHZeXP40wEyzuWGM4KT4V6DE_h-vvDDxIvPMievHX97vnq-qneAe9Q6lDIsmwGl94Gz7recg",
  "Scope": "openid profile email"
}
2018-04-24 15:02:31.660 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-24 15:02:31.731 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-24 15:02:31.735 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-24 15:02:31.735 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-24 15:02:31.736 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-24 15:02:31.736 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-24 15:02:32.240 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:02:32.261 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:03:20.924 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 15:03:20.932 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 15:03:20.934 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 15:03:20.943 +03:00 [DBG] Start discovery request
2018-04-24 15:03:21.318 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 15:03:21.321 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 15:03:21.327 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 15:03:21.332 +03:00 [DBG] Start key discovery request
2018-04-24 15:03:21.439 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:03:21.442 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:03:21.444 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 15:03:21.455 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 15:03:21.456 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 15:03:21.463 +03:00 [DBG] Start authorize request
2018-04-24 15:03:21.478 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 15:03:21.490 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 15:03:21.509 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 15:03:21.512 +03:00 [DBG] No PKCE used.
2018-04-24 15:03:21.554 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 15:03:21.575 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hznP4OIfvhWq963Sa6Z_A_iwigEEgZ9-kxvueWXy09LdhdPjhszwo0N3mg3YAE_ChSRbHiUIHzvCX4HjL__zl7P5UnxV69jbY4zSYpgRSIJIubKwvUbfZe0DeqHpgK9EoS2AClWsKFgdwuiVC4yVrSqV_iI5QR1bakOnCD9_o2YejBYh-t8iDTm3EYlFY8xI5bWmOuDOsyqSVCLH0NrzqwvAFKFZBTQ0JOWUNVPQVnXdysc_BTrUV4b6XG25YYOBzIDc3O0b0Vhp36zLorupNOfbo3_6DAgJ9fQ_C3Z--zRFZ_k1C1spmXPv8seeI9AR5o",
  "Nonce": "636601682014131698.Zjk4YTUwNzYtNTM2Ny00YjQ0LTkzZjctN2IwOWM5MzRmOTY5MTllNDI5ZjEtZThiMC00OTBkLWFiMWUtOTAyMWY4YjRmNzgz",
  "SessionId": "0034d572e04855e40b029ca11bef1df1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email",
    "response_mode": "form_post",
    "nonce": "636601682014131698.Zjk4YTUwNzYtNTM2Ny00YjQ0LTkzZjctN2IwOWM5MzRmOTY5MTllNDI5ZjEtZThiMC00OTBkLWFiMWUtOTAyMWY4YjRmNzgz",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hznP4OIfvhWq963Sa6Z_A_iwigEEgZ9-kxvueWXy09LdhdPjhszwo0N3mg3YAE_ChSRbHiUIHzvCX4HjL__zl7P5UnxV69jbY4zSYpgRSIJIubKwvUbfZe0DeqHpgK9EoS2AClWsKFgdwuiVC4yVrSqV_iI5QR1bakOnCD9_o2YejBYh-t8iDTm3EYlFY8xI5bWmOuDOsyqSVCLH0NrzqwvAFKFZBTQ0JOWUNVPQVnXdysc_BTrUV4b6XG25YYOBzIDc3O0b0Vhp36zLorupNOfbo3_6DAgJ9fQ_C3Z--zRFZ_k1C1spmXPv8seeI9AR5o",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 15:03:22.827 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 15:03:22.829 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 15:03:22.830 +03:00 [INF] Showing consent: User has not yet consented
2018-04-24 15:03:22.843 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:03:22.845 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:03:22.920 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 15:03:22.921 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 15:03:22.922 +03:00 [DBG] No PKCE used.
2018-04-24 15:03:22.925 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 15:03:25.867 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 15:03:25.870 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:03:25.871 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:03:25.914 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 15:03:25.917 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 15:03:25.923 +03:00 [DBG] No PKCE used.
2018-04-24 15:03:25.924 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 15:03:25.954 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:03:25.956 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:03:25.958 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 15:03:25.961 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 15:03:25.962 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 15:03:25.970 +03:00 [DBG] Start authorize callback request
2018-04-24 15:03:26.000 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 15:03:26.001 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 15:03:26.003 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 15:03:26.004 +03:00 [DBG] No PKCE used.
2018-04-24 15:03:26.005 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 15:03:26.007 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hznP4OIfvhWq963Sa6Z_A_iwigEEgZ9-kxvueWXy09LdhdPjhszwo0N3mg3YAE_ChSRbHiUIHzvCX4HjL__zl7P5UnxV69jbY4zSYpgRSIJIubKwvUbfZe0DeqHpgK9EoS2AClWsKFgdwuiVC4yVrSqV_iI5QR1bakOnCD9_o2YejBYh-t8iDTm3EYlFY8xI5bWmOuDOsyqSVCLH0NrzqwvAFKFZBTQ0JOWUNVPQVnXdysc_BTrUV4b6XG25YYOBzIDc3O0b0Vhp36zLorupNOfbo3_6DAgJ9fQ_C3Z--zRFZ_k1C1spmXPv8seeI9AR5o",
  "Nonce": "636601682014131698.Zjk4YTUwNzYtNTM2Ny00YjQ0LTkzZjctN2IwOWM5MzRmOTY5MTllNDI5ZjEtZThiMC00OTBkLWFiMWUtOTAyMWY4YjRmNzgz",
  "SessionId": "0034d572e04855e40b029ca11bef1df1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email",
    "response_mode": "form_post",
    "nonce": "636601682014131698.Zjk4YTUwNzYtNTM2Ny00YjQ0LTkzZjctN2IwOWM5MzRmOTY5MTllNDI5ZjEtZThiMC00OTBkLWFiMWUtOTAyMWY4YjRmNzgz",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hznP4OIfvhWq963Sa6Z_A_iwigEEgZ9-kxvueWXy09LdhdPjhszwo0N3mg3YAE_ChSRbHiUIHzvCX4HjL__zl7P5UnxV69jbY4zSYpgRSIJIubKwvUbfZe0DeqHpgK9EoS2AClWsKFgdwuiVC4yVrSqV_iI5QR1bakOnCD9_o2YejBYh-t8iDTm3EYlFY8xI5bWmOuDOsyqSVCLH0NrzqwvAFKFZBTQ0JOWUNVPQVnXdysc_BTrUV4b6XG25YYOBzIDc3O0b0Vhp36zLorupNOfbo3_6DAgJ9fQ_C3Z--zRFZ_k1C1spmXPv8seeI9AR5o",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 15:03:26.105 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 15:03:26.108 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 15:03:26.123 +03:00 [INF] User consented to scopes: ["openid","email","profile"]
2018-04-24 15:03:26.140 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email"]
2018-04-24 15:03:26.148 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 15:03:26.174 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 15:03:26.221 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 15:03:26.234 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 15:03:26.238 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 15:03:26.338 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile email",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****yCkQ"
    },
    {
      "TokenType": "code",
      "TokenValue": "****d19d"
    }
  ],
  "ActivityId": "0HLD9RD15B7C4:00000005",
  "TimeStamp": "2018-04-24T12:03:26Z",
  "ProcessId": 31496,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 15:03:26.352 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hznP4OIfvhWq963Sa6Z_A_iwigEEgZ9-kxvueWXy09LdhdPjhszwo0N3mg3YAE_ChSRbHiUIHzvCX4HjL__zl7P5UnxV69jbY4zSYpgRSIJIubKwvUbfZe0DeqHpgK9EoS2AClWsKFgdwuiVC4yVrSqV_iI5QR1bakOnCD9_o2YejBYh-t8iDTm3EYlFY8xI5bWmOuDOsyqSVCLH0NrzqwvAFKFZBTQ0JOWUNVPQVnXdysc_BTrUV4b6XG25YYOBzIDc3O0b0Vhp36zLorupNOfbo3_6DAgJ9fQ_C3Z--zRFZ_k1C1spmXPv8seeI9AR5o",
  "Scope": "openid profile email"
}
2018-04-24 15:08:39.632 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-24 15:08:39.684 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-24 15:08:39.689 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-24 15:08:39.690 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-24 15:08:39.691 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-24 15:08:39.691 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-24 15:08:40.134 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:08:40.155 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:09:08.575 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 15:09:08.582 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 15:09:08.584 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 15:09:08.594 +03:00 [DBG] Start discovery request
2018-04-24 15:09:08.974 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 15:09:08.978 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 15:09:08.982 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 15:09:08.987 +03:00 [DBG] Start key discovery request
2018-04-24 15:09:09.097 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:09:09.099 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:09:09.100 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 15:09:09.109 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 15:09:09.110 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 15:09:09.116 +03:00 [DBG] Start authorize request
2018-04-24 15:09:09.135 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 15:09:09.144 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 15:09:09.159 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 15:09:09.160 +03:00 [DBG] No PKCE used.
2018-04-24 15:09:09.192 +03:00 [ERR] Invalid scope: openid
2018-04-24 15:09:09.196 +03:00 [ERR] Request validation failed
2018-04-24 15:09:09.216 +03:00 [INF] {
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzyBE9h7PFduiQeaJpYlXklS-3p1p8ibiWoMwySSGBCuYnVnXV-7mG7pUgsyDNO503kff6avbDVwyisS34ezpkntJa97OWQ1fTN-8IQR9hHwGhNLzTfsNdcmR8KEEOX4keiA8AERE4Zaz6bPXiPbUeQ-LEgZT890zAMtMq9-t-LyWtLjyMU3LZK0AuRGK_y1WGU6vdV34rKUcNQR0nPqLDKLJsVEgL5dvGFtVDYyi32ZvW5pZu28Q73kfvB_94_hMxEq40mRoVW3DdC_EwXr6acC1bB8sJA6ZO5f1x6ZVpa0UJct_uQk5FTEgQ_8xuhrYM",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email",
    "response_mode": "form_post",
    "nonce": "636601685490676167.NTAyNDNmN2EtNDgxZC00Y2FmLWIwZTktZTllZDU4OTg4NDk3YzEyMmEwZmUtZjdjNy00ZTljLTk1M2YtZWY4ZmRhMjMxMjA5",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hzyBE9h7PFduiQeaJpYlXklS-3p1p8ibiWoMwySSGBCuYnVnXV-7mG7pUgsyDNO503kff6avbDVwyisS34ezpkntJa97OWQ1fTN-8IQR9hHwGhNLzTfsNdcmR8KEEOX4keiA8AERE4Zaz6bPXiPbUeQ-LEgZT890zAMtMq9-t-LyWtLjyMU3LZK0AuRGK_y1WGU6vdV34rKUcNQR0nPqLDKLJsVEgL5dvGFtVDYyi32ZvW5pZu28Q73kfvB_94_hMxEq40mRoVW3DdC_EwXr6acC1bB8sJA6ZO5f1x6ZVpa0UJct_uQk5FTEgQ_8xuhrYM",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 15:09:09.273 +03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile email",
  "GrantType": "hybrid",
  "Error": "invalid_scope",
  "ActivityId": "0HLD9RGEQFIQJ:00000002",
  "TimeStamp": "2018-04-24T12:09:09Z",
  "ProcessId": 28320,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 15:09:09.303 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:09:09.304 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:11:25.970 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-24 15:11:26.020 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-24 15:11:26.024 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-24 15:11:26.024 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-24 15:11:26.024 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-24 15:11:26.025 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-24 15:11:27.020 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:11:27.045 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:11:51.115 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 15:11:51.124 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 15:11:51.126 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 15:11:51.134 +03:00 [DBG] Start discovery request
2018-04-24 15:11:51.534 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 15:11:51.537 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 15:11:51.538 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 15:11:51.544 +03:00 [DBG] Start key discovery request
2018-04-24 15:11:51.644 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:11:51.646 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:11:51.647 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 15:11:51.656 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 15:11:51.657 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 15:11:51.665 +03:00 [DBG] Start authorize request
2018-04-24 15:11:51.679 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 15:11:51.687 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 15:11:51.706 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 15:11:51.708 +03:00 [DBG] No PKCE used.
2018-04-24 15:11:51.737 +03:00 [ERR] Invalid scope: openid
2018-04-24 15:11:51.741 +03:00 [ERR] Request validation failed
2018-04-24 15:11:51.757 +03:00 [INF] {
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hy9VyLLZCiLZBUML7N0lTRTtFyorqIvN7_IcOTPvpvqgO2lwE1GOxlrR_mJmfFHd17SMjg_pYp1W1MtBMK1FBv8UR6NINyT6uUoRtQ_sH0mdVt4kWriDXiyoVSHCKsIeclH9JHbewMn886A-xQ61FuYcIohWsPSGrhesUsWIANFwskHprbvFext7eRPj_NkvgQpmR0AvRDFAvKUgXLyey1w8sFJESrupSqqsaqpVxVdMGKxQhP2RGjPUEnPPcRnjork4j2xuQ7_zB1VZxmS7XtgpwzEfOR8OML32nIbYECYM7SZ4F2S4O6BLH2Nc32OG0I",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636601687116188007.Y2FiNDZkYTItNTgxNy00ZTY2LWJmNDMtNjdkZjllM2QxY2UxZDRlMzI0ZGYtZjkyYi00MzAwLWJlNjItZGU0MjgxZjg4MjMx",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hy9VyLLZCiLZBUML7N0lTRTtFyorqIvN7_IcOTPvpvqgO2lwE1GOxlrR_mJmfFHd17SMjg_pYp1W1MtBMK1FBv8UR6NINyT6uUoRtQ_sH0mdVt4kWriDXiyoVSHCKsIeclH9JHbewMn886A-xQ61FuYcIohWsPSGrhesUsWIANFwskHprbvFext7eRPj_NkvgQpmR0AvRDFAvKUgXLyey1w8sFJESrupSqqsaqpVxVdMGKxQhP2RGjPUEnPPcRnjork4j2xuQ7_zB1VZxmS7XtgpwzEfOR8OML32nIbYECYM7SZ4F2S4O6BLH2Nc32OG0I",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 15:11:51.813 +03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile email api1",
  "GrantType": "hybrid",
  "Error": "invalid_scope",
  "ActivityId": "0HLD9RI0HCIDP:00000002",
  "TimeStamp": "2018-04-24T12:11:51Z",
  "ProcessId": 29160,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 15:11:51.847 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:11:51.849 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:24:57.912 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-24 15:24:57.963 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-24 15:24:57.967 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-24 15:24:57.967 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-24 15:24:57.968 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-24 15:24:57.968 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-24 15:25:00.354 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:25:00.378 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:25:35.270 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 15:25:35.279 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 15:25:35.284 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 15:25:35.290 +03:00 [DBG] Start discovery request
2018-04-24 15:25:35.686 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 15:25:35.688 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 15:25:35.689 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 15:25:35.694 +03:00 [DBG] Start key discovery request
2018-04-24 15:25:35.793 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:25:35.795 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:25:35.802 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 15:25:35.815 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 15:25:35.816 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 15:25:35.827 +03:00 [DBG] Start authorize request
2018-04-24 15:25:35.838 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 15:25:35.850 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 15:25:35.865 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 15:25:35.867 +03:00 [DBG] No PKCE used.
2018-04-24 15:25:35.896 +03:00 [ERR] Invalid scope: openid
2018-04-24 15:25:35.900 +03:00 [ERR] Request validation failed
2018-04-24 15:25:35.920 +03:00 [INF] {
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxCtvJPKcB_hEBvVzOHN-__CR5qHKgfMZYqC6kGJcQflTG-F_wA_u03dZr_y7GXtPy8BWcWl7wX4EVIln-0GDJw1HTFPAyAPs7prerkse_7G9JmjTec7xC_lNtifzAvkLOntC462--JheVJoFuXH8gmu28k1NP-ZQERa20JiUvYP7jy1W8fU6wdS3sXfNcnGCi32G9o91HNVvgNqods2lwURAQxUfIY2DkjQfLcBRlviYQEad31VhJTbFizWD0mgCMyDBvChgV3fmMLC6oP0VD72zlaoE1XYlzxeJskTz-ULkcxXrHN6GjA8Nd7G3dC2-o",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636601695357677450.OTk2OWIxMmYtNjQwOC00NjY1LWJkYmYtYzYwNWQ5NDE5NTRjMWVhYmZjYTQtOGRiYy00OThjLWFmOGYtM2FjZjQ5MmM2YzQ5",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hxCtvJPKcB_hEBvVzOHN-__CR5qHKgfMZYqC6kGJcQflTG-F_wA_u03dZr_y7GXtPy8BWcWl7wX4EVIln-0GDJw1HTFPAyAPs7prerkse_7G9JmjTec7xC_lNtifzAvkLOntC462--JheVJoFuXH8gmu28k1NP-ZQERa20JiUvYP7jy1W8fU6wdS3sXfNcnGCi32G9o91HNVvgNqods2lwURAQxUfIY2DkjQfLcBRlviYQEad31VhJTbFizWD0mgCMyDBvChgV3fmMLC6oP0VD72zlaoE1XYlzxeJskTz-ULkcxXrHN6GjA8Nd7G3dC2-o",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 15:25:35.971 +03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile email api1",
  "GrantType": "hybrid",
  "Error": "invalid_scope",
  "ActivityId": "0HLD9RPICHK6O:00000002",
  "TimeStamp": "2018-04-24T12:25:35Z",
  "ProcessId": 35004,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 15:25:36.006 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:25:36.008 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:27:43.967 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-24 15:27:44.016 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-24 15:27:44.021 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-24 15:27:44.021 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-24 15:27:44.021 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-24 15:27:44.021 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-24 15:27:44.550 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:27:44.570 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:29:31.150 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 15:29:31.160 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 15:29:31.162 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 15:29:31.168 +03:00 [DBG] Start discovery request
2018-04-24 15:29:31.554 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 15:29:31.557 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 15:29:31.558 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 15:29:31.565 +03:00 [DBG] Start key discovery request
2018-04-24 15:29:31.700 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:29:31.702 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:29:31.704 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 15:29:31.711 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 15:29:31.713 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 15:29:31.723 +03:00 [DBG] Start authorize request
2018-04-24 15:29:31.738 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 15:29:31.744 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 15:29:31.761 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 15:29:31.764 +03:00 [DBG] No PKCE used.
2018-04-24 15:29:31.809 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 15:29:31.830 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hwLsGwDv7gBg3OLm8PxEFMmObeWVbY6pMd2Sta612hbd3q60AnGuIe4pNyydYmJ9LPWnG-VZlfyk-aNpsadmmfFBSgGSdzQZr4EkjqHNvViWxtxJRfpIhcdDWBvhaH3zXf1YxbkGUNnROuHPEU8_oOiHOUqNM9EIrNOBghd_Z_dsmmF2CA0rIDOevSVVwVbvsska_3wyDO5_26scjMUSP0Wk9NSCUPepMZ8jhq1d0QGsS7ijGBrNDhxccVg323Cu8T_eB3iVcdWB-a5049wDpX7X_p0DE-jX1qmHJHjAUIf8L888Wizk9tfSYfeBSW1rnw",
  "Nonce": "636601697716532647.NWUwZjZlNmEtNTU4OS00ZjQyLWI0MTUtYWMyNTQ1ZjQwNGY3ZTVhY2I1YzAtYjc2NC00MmY3LThhNGMtYjEyOTFlMzg1Zjg5",
  "SessionId": "0034d572e04855e40b029ca11bef1df1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636601697716532647.NWUwZjZlNmEtNTU4OS00ZjQyLWI0MTUtYWMyNTQ1ZjQwNGY3ZTVhY2I1YzAtYjc2NC00MmY3LThhNGMtYjEyOTFlMzg1Zjg5",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwLsGwDv7gBg3OLm8PxEFMmObeWVbY6pMd2Sta612hbd3q60AnGuIe4pNyydYmJ9LPWnG-VZlfyk-aNpsadmmfFBSgGSdzQZr4EkjqHNvViWxtxJRfpIhcdDWBvhaH3zXf1YxbkGUNnROuHPEU8_oOiHOUqNM9EIrNOBghd_Z_dsmmF2CA0rIDOevSVVwVbvsska_3wyDO5_26scjMUSP0Wk9NSCUPepMZ8jhq1d0QGsS7ijGBrNDhxccVg323Cu8T_eB3iVcdWB-a5049wDpX7X_p0DE-jX1qmHJHjAUIf8L888Wizk9tfSYfeBSW1rnw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 15:29:32.966 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 15:29:32.977 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 15:29:32.979 +03:00 [INF] Showing consent: User has not yet consented
2018-04-24 15:29:32.993 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:29:32.998 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:29:33.076 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 15:29:33.077 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 15:29:33.078 +03:00 [DBG] No PKCE used.
2018-04-24 15:29:33.080 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 15:29:35.638 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 15:29:35.642 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:29:35.643 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:29:35.683 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 15:29:35.684 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 15:29:35.686 +03:00 [DBG] No PKCE used.
2018-04-24 15:29:35.688 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 15:29:35.721 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:29:35.722 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:29:35.724 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 15:29:35.726 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 15:29:35.726 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 15:29:35.736 +03:00 [DBG] Start authorize callback request
2018-04-24 15:29:35.769 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 15:29:35.771 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 15:29:35.773 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 15:29:35.774 +03:00 [DBG] No PKCE used.
2018-04-24 15:29:35.775 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 15:29:35.778 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hwLsGwDv7gBg3OLm8PxEFMmObeWVbY6pMd2Sta612hbd3q60AnGuIe4pNyydYmJ9LPWnG-VZlfyk-aNpsadmmfFBSgGSdzQZr4EkjqHNvViWxtxJRfpIhcdDWBvhaH3zXf1YxbkGUNnROuHPEU8_oOiHOUqNM9EIrNOBghd_Z_dsmmF2CA0rIDOevSVVwVbvsska_3wyDO5_26scjMUSP0Wk9NSCUPepMZ8jhq1d0QGsS7ijGBrNDhxccVg323Cu8T_eB3iVcdWB-a5049wDpX7X_p0DE-jX1qmHJHjAUIf8L888Wizk9tfSYfeBSW1rnw",
  "Nonce": "636601697716532647.NWUwZjZlNmEtNTU4OS00ZjQyLWI0MTUtYWMyNTQ1ZjQwNGY3ZTVhY2I1YzAtYjc2NC00MmY3LThhNGMtYjEyOTFlMzg1Zjg5",
  "SessionId": "0034d572e04855e40b029ca11bef1df1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636601697716532647.NWUwZjZlNmEtNTU4OS00ZjQyLWI0MTUtYWMyNTQ1ZjQwNGY3ZTVhY2I1YzAtYjc2NC00MmY3LThhNGMtYjEyOTFlMzg1Zjg5",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwLsGwDv7gBg3OLm8PxEFMmObeWVbY6pMd2Sta612hbd3q60AnGuIe4pNyydYmJ9LPWnG-VZlfyk-aNpsadmmfFBSgGSdzQZr4EkjqHNvViWxtxJRfpIhcdDWBvhaH3zXf1YxbkGUNnROuHPEU8_oOiHOUqNM9EIrNOBghd_Z_dsmmF2CA0rIDOevSVVwVbvsska_3wyDO5_26scjMUSP0Wk9NSCUPepMZ8jhq1d0QGsS7ijGBrNDhxccVg323Cu8T_eB3iVcdWB-a5049wDpX7X_p0DE-jX1qmHJHjAUIf8L888Wizk9tfSYfeBSW1rnw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 15:29:35.872 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 15:29:35.879 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 15:29:35.892 +03:00 [INF] User consented to scopes: ["openid","email","profile","api1"]
2018-04-24 15:29:35.909 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1"]
2018-04-24 15:29:35.914 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 15:29:35.948 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 15:29:35.989 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 15:29:36.002 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 15:29:36.006 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 15:29:36.105 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile email api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****q8jw"
    },
    {
      "TokenType": "code",
      "TokenValue": "****8d73"
    }
  ],
  "ActivityId": "0HLD9RR3S3JKK:00000005",
  "TimeStamp": "2018-04-24T12:29:36Z",
  "ProcessId": 27812,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 15:29:36.114 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hwLsGwDv7gBg3OLm8PxEFMmObeWVbY6pMd2Sta612hbd3q60AnGuIe4pNyydYmJ9LPWnG-VZlfyk-aNpsadmmfFBSgGSdzQZr4EkjqHNvViWxtxJRfpIhcdDWBvhaH3zXf1YxbkGUNnROuHPEU8_oOiHOUqNM9EIrNOBghd_Z_dsmmF2CA0rIDOevSVVwVbvsska_3wyDO5_26scjMUSP0Wk9NSCUPepMZ8jhq1d0QGsS7ijGBrNDhxccVg323Cu8T_eB3iVcdWB-a5049wDpX7X_p0DE-jX1qmHJHjAUIf8L888Wizk9tfSYfeBSW1rnw",
  "Scope": "openid profile email api1"
}
2018-04-24 15:58:20.813 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-24 15:58:20.874 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-24 15:58:20.881 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-24 15:58:20.884 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-24 15:58:20.886 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-24 15:58:20.889 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-24 15:58:26.130 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:58:26.156 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:58:51.986 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:58:51.994 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:58:57.097 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:58:57.103 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:59:12.931 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:59:12.937 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:59:55.429 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 15:59:55.440 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 15:59:55.445 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 15:59:55.454 +03:00 [DBG] Start discovery request
2018-04-24 15:59:55.833 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 15:59:55.840 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 15:59:55.844 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 15:59:55.853 +03:00 [DBG] Start key discovery request
2018-04-24 15:59:55.986 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:59:55.990 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 15:59:55.994 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 15:59:56.004 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 15:59:56.008 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 15:59:56.018 +03:00 [DBG] Start authorize request
2018-04-24 15:59:56.032 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 15:59:56.044 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 15:59:56.067 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 15:59:56.073 +03:00 [DBG] No PKCE used.
2018-04-24 15:59:56.130 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 15:59:56.157 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hy_PCFHA6cek9pJnSSJPJhOFhmF114FUo8rKAxX1fhAkMcU_FyxxD9mCmGY70R8iBwlho2EEw3Q1KvGnne9zvXnDss7A5W4rehX7Yl8BwzbweD2ubuVqh6u7m3riMd8HrAWIpiM-NoHFYiAjMe6OVBm-v_G2N7zYzh9AZV9slmfZgy5vkIdaQZpxpU-sag9zN2ujB-Szx7JJFBEV8RVp-ciYtnf-nrEPVNhcyarGGZCG5ltx2qFfbu4cgi1b83u1qxQmpV9dpvCGs72HBaWlECqgdG6cuz_zkMZ_UFgmfUuZZdiEAF6IbhRRZGkD1icNPs",
  "Nonce": "636601715959430236.ZjU5M2ViNWEtNDhkZi00MGE5LWJkMWQtODVhYzc1Yzg0YjhjN2E3NDE5NzItMDYzZi00NDY1LTljNjYtNGNjZjI3MjczYjAy",
  "SessionId": "0034d572e04855e40b029ca11bef1df1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636601715959430236.ZjU5M2ViNWEtNDhkZi00MGE5LWJkMWQtODVhYzc1Yzg0YjhjN2E3NDE5NzItMDYzZi00NDY1LTljNjYtNGNjZjI3MjczYjAy",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hy_PCFHA6cek9pJnSSJPJhOFhmF114FUo8rKAxX1fhAkMcU_FyxxD9mCmGY70R8iBwlho2EEw3Q1KvGnne9zvXnDss7A5W4rehX7Yl8BwzbweD2ubuVqh6u7m3riMd8HrAWIpiM-NoHFYiAjMe6OVBm-v_G2N7zYzh9AZV9slmfZgy5vkIdaQZpxpU-sag9zN2ujB-Szx7JJFBEV8RVp-ciYtnf-nrEPVNhcyarGGZCG5ltx2qFfbu4cgi1b83u1qxQmpV9dpvCGs72HBaWlECqgdG6cuz_zkMZ_UFgmfUuZZdiEAF6IbhRRZGkD1icNPs",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:00:27.194 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 16:00:27.203 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 16:00:27.207 +03:00 [INF] Showing consent: User has not yet consented
2018-04-24 16:00:27.236 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:00:27.239 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:00:27.316 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:00:27.321 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:00:27.325 +03:00 [DBG] No PKCE used.
2018-04-24 16:00:27.328 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:00:33.815 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 16:00:33.823 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:00:33.828 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:00:33.890 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:00:33.893 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:00:33.897 +03:00 [DBG] No PKCE used.
2018-04-24 16:00:33.901 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:00:33.947 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:00:33.953 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:00:33.957 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 16:00:33.962 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 16:00:33.972 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 16:00:33.984 +03:00 [DBG] Start authorize callback request
2018-04-24 16:00:34.032 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:00:34.038 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:00:34.042 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:00:34.046 +03:00 [DBG] No PKCE used.
2018-04-24 16:00:34.050 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:00:34.054 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hy_PCFHA6cek9pJnSSJPJhOFhmF114FUo8rKAxX1fhAkMcU_FyxxD9mCmGY70R8iBwlho2EEw3Q1KvGnne9zvXnDss7A5W4rehX7Yl8BwzbweD2ubuVqh6u7m3riMd8HrAWIpiM-NoHFYiAjMe6OVBm-v_G2N7zYzh9AZV9slmfZgy5vkIdaQZpxpU-sag9zN2ujB-Szx7JJFBEV8RVp-ciYtnf-nrEPVNhcyarGGZCG5ltx2qFfbu4cgi1b83u1qxQmpV9dpvCGs72HBaWlECqgdG6cuz_zkMZ_UFgmfUuZZdiEAF6IbhRRZGkD1icNPs",
  "Nonce": "636601715959430236.ZjU5M2ViNWEtNDhkZi00MGE5LWJkMWQtODVhYzc1Yzg0YjhjN2E3NDE5NzItMDYzZi00NDY1LTljNjYtNGNjZjI3MjczYjAy",
  "SessionId": "0034d572e04855e40b029ca11bef1df1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636601715959430236.ZjU5M2ViNWEtNDhkZi00MGE5LWJkMWQtODVhYzc1Yzg0YjhjN2E3NDE5NzItMDYzZi00NDY1LTljNjYtNGNjZjI3MjczYjAy",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hy_PCFHA6cek9pJnSSJPJhOFhmF114FUo8rKAxX1fhAkMcU_FyxxD9mCmGY70R8iBwlho2EEw3Q1KvGnne9zvXnDss7A5W4rehX7Yl8BwzbweD2ubuVqh6u7m3riMd8HrAWIpiM-NoHFYiAjMe6OVBm-v_G2N7zYzh9AZV9slmfZgy5vkIdaQZpxpU-sag9zN2ujB-Szx7JJFBEV8RVp-ciYtnf-nrEPVNhcyarGGZCG5ltx2qFfbu4cgi1b83u1qxQmpV9dpvCGs72HBaWlECqgdG6cuz_zkMZ_UFgmfUuZZdiEAF6IbhRRZGkD1icNPs",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:00:44.389 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 16:00:44.397 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 16:00:44.414 +03:00 [INF] User consented to scopes: ["openid","email","profile","api1"]
2018-04-24 16:00:44.437 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1"]
2018-04-24 16:00:44.445 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:00:44.487 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 16:00:44.541 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 16:00:44.562 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 16:00:44.570 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 16:00:44.715 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile email api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****knHQ"
    },
    {
      "TokenType": "code",
      "TokenValue": "****9bf3"
    }
  ],
  "ActivityId": "0HLD9SC7CH72V:00000008",
  "TimeStamp": "2018-04-24T13:00:44Z",
  "ProcessId": 20232,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:00:44.731 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hy_PCFHA6cek9pJnSSJPJhOFhmF114FUo8rKAxX1fhAkMcU_FyxxD9mCmGY70R8iBwlho2EEw3Q1KvGnne9zvXnDss7A5W4rehX7Yl8BwzbweD2ubuVqh6u7m3riMd8HrAWIpiM-NoHFYiAjMe6OVBm-v_G2N7zYzh9AZV9slmfZgy5vkIdaQZpxpU-sag9zN2ujB-Szx7JJFBEV8RVp-ciYtnf-nrEPVNhcyarGGZCG5ltx2qFfbu4cgi1b83u1qxQmpV9dpvCGs72HBaWlECqgdG6cuz_zkMZ_UFgmfUuZZdiEAF6IbhRRZGkD1icNPs",
  "Scope": "openid profile email api1"
}
2018-04-24 16:02:20.825 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-24 16:02:20.838 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-24 16:02:20.842 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-24 16:02:20.854 +03:00 [DBG] Start token request.
2018-04-24 16:02:20.866 +03:00 [DBG] Start client validation
2018-04-24 16:02:20.876 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-24 16:02:20.883 +03:00 [DBG] Start parsing for secret in post body
2018-04-24 16:02:20.888 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-24 16:02:20.891 +03:00 [DBG] Secret id found: mvc
2018-04-24 16:02:20.910 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-24 16:02:20.912 +03:00 [DBG] Client validation success
2018-04-24 16:02:20.921 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD9SC7CH736:00000001",
  "TimeStamp": "2018-04-24T13:02:20Z",
  "ProcessId": 20232,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:02:20.930 +03:00 [DBG] Start token request validation
2018-04-24 16:02:20.946 +03:00 [DBG] Start validation of authorization code token request
2018-04-24 16:02:23.051 +03:00 [DBG] Validation of authorization code token request success
2018-04-24 16:02:23.061 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "1b0e9605a8d699d42d438a6dc4b3a5509791316f7f693517aea9c94190f39bf3",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "1b0e9605a8d699d42d438a6dc4b3a5509791316f7f693517aea9c94190f39bf3",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-24 16:02:23.099 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-24 16:02:23.104 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:02:38.605 +03:00 [INF] {
  "Name": "Unhandled Exception",
  "Category": "Error",
  "EventType": "Error",
  "Id": 3000,
  "Details": "System.ArgumentNullException: Value cannot be null.\r\nParameter name: value\r\n   at System.Security.Claims.Claim..ctor(String type, String value, String valueType, String issuer, String originalIssuer, ClaimsIdentity subject, String propertyKey, String propertyValue)\r\n   at System.Security.Claims.Claim..ctor(String type, String value)\r\n   at PrimeApps.Auth.CustomProfileService.<GetProfileDataAsync>d__2.MoveNext() in C:\\Users\\Developer\\Desktop\\IdentityServer4.Samples-dev\\IdentityServer4.Samples-dev\\Quickstarts\\6_AspNetIdentity\\src\\PrimeApps.Auth\\Configuration\\CustomProfileService.cs:line 29\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Services.DefaultClaimsService.<GetAccessTokenClaimsAsync>d__4.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Services\\DefaultClaimsService.cs:line 200\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Services.DefaultTokenService.<CreateAccessTokenAsync>d__8.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Services\\DefaultTokenService.cs:line 159\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.ResponseHandling.TokenResponseGenerator.<CreateAccessTokenAsync>d__14.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\ResponseHandling\\TokenResponseGenerator.cs:line 312\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.ResponseHandling.TokenResponseGenerator.<ProcessAuthorizationCodeRequestAsync>d__10.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\ResponseHandling\\TokenResponseGenerator.cs:line 133\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.ResponseHandling.TokenResponseGenerator.<ProcessAsync>d__7.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\ResponseHandling\\TokenResponseGenerator.cs:line 88\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Endpoints.TokenEndpoint.<ProcessTokenRequestAsync>d__7.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Endpoints\\TokenEndpoint.cs:line 98\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Endpoints.TokenEndpoint.<ProcessAsync>d__6.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Endpoints\\TokenEndpoint.cs:line 70\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\\local\\identity\\server4\\IdentityServer4\\src\\IdentityServer4\\Hosting\\IdentityServerMiddleware.cs:line 54",
  "Message": "Value cannot be null.\r\nParameter name: value",
  "ActivityId": "0HLD9SC7CH736:00000001",
  "TimeStamp": "2018-04-24T13:02:38Z",
  "ProcessId": 20232,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:02:38.637 +03:00 [FTL] Unhandled exception: System.ArgumentNullException: Value cannot be null.
Parameter name: value
   at System.Security.Claims.Claim..ctor(String type, String value, String valueType, String issuer, String originalIssuer, ClaimsIdentity subject, String propertyKey, String propertyValue)
   at System.Security.Claims.Claim..ctor(String type, String value)
   at PrimeApps.Auth.CustomProfileService.<GetProfileDataAsync>d__2.MoveNext() in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Configuration\CustomProfileService.cs:line 29
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Services.DefaultClaimsService.<GetAccessTokenClaimsAsync>d__4.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Services\DefaultClaimsService.cs:line 200
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Services.DefaultTokenService.<CreateAccessTokenAsync>d__8.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Services\DefaultTokenService.cs:line 159
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.ResponseHandling.TokenResponseGenerator.<CreateAccessTokenAsync>d__14.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\ResponseHandling\TokenResponseGenerator.cs:line 312
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.ResponseHandling.TokenResponseGenerator.<ProcessAuthorizationCodeRequestAsync>d__10.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\ResponseHandling\TokenResponseGenerator.cs:line 133
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.ResponseHandling.TokenResponseGenerator.<ProcessAsync>d__7.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\ResponseHandling\TokenResponseGenerator.cs:line 88
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Endpoints.TokenEndpoint.<ProcessTokenRequestAsync>d__7.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Endpoints\TokenEndpoint.cs:line 98
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Endpoints.TokenEndpoint.<ProcessAsync>d__6.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Endpoints\TokenEndpoint.cs:line 70
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 54
2018-04-24 16:02:39.651 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.ArgumentNullException: Value cannot be null.
Parameter name: value
   at System.Security.Claims.Claim..ctor(String type, String value, String valueType, String issuer, String originalIssuer, ClaimsIdentity subject, String propertyKey, String propertyValue)
   at System.Security.Claims.Claim..ctor(String type, String value)
   at PrimeApps.Auth.CustomProfileService.<GetProfileDataAsync>d__2.MoveNext() in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Configuration\CustomProfileService.cs:line 29
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Services.DefaultClaimsService.<GetAccessTokenClaimsAsync>d__4.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Services\DefaultClaimsService.cs:line 200
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Services.DefaultTokenService.<CreateAccessTokenAsync>d__8.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Services\DefaultTokenService.cs:line 159
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.ResponseHandling.TokenResponseGenerator.<CreateAccessTokenAsync>d__14.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\ResponseHandling\TokenResponseGenerator.cs:line 312
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.ResponseHandling.TokenResponseGenerator.<ProcessAuthorizationCodeRequestAsync>d__10.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\ResponseHandling\TokenResponseGenerator.cs:line 133
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.ResponseHandling.TokenResponseGenerator.<ProcessAsync>d__7.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\ResponseHandling\TokenResponseGenerator.cs:line 88
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Endpoints.TokenEndpoint.<ProcessTokenRequestAsync>d__7.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Endpoints\TokenEndpoint.cs:line 98
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Endpoints.TokenEndpoint.<ProcessAsync>d__6.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Endpoints\TokenEndpoint.cs:line 70
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 54
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-24 16:14:31.832 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-24 16:14:31.893 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-24 16:14:31.900 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-24 16:14:31.903 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-24 16:14:31.906 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-24 16:14:31.909 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-24 16:14:34.134 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:14:34.164 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:14:42.519 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 16:14:42.532 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 16:14:42.536 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 16:14:42.547 +03:00 [DBG] Start discovery request
2018-04-24 16:14:42.933 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 16:14:42.939 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 16:14:42.943 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 16:14:42.951 +03:00 [DBG] Start key discovery request
2018-04-24 16:14:43.074 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:14:43.079 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:14:43.084 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 16:14:43.097 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 16:14:43.101 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 16:14:43.112 +03:00 [DBG] Start authorize request
2018-04-24 16:14:43.130 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:14:43.140 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:14:43.159 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:14:43.163 +03:00 [DBG] No PKCE used.
2018-04-24 16:14:43.217 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:14:43.242 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hw1SQ_QG72-uLMqhirOGHUnGQ4Ib6J71ApSSuT88BCI6SkkbcMAZdaMxliz-73q6es13OICgp-HXIl5zHi0oIbCU9LEHbASP5yLxsJFhO8RdoPUkcm-vd8Wsd2P4Y2Ixlp6aJ2HIvuD1mgUlGuFytx7UC1e_KHf0nhARxHpAUEe09YtJX4X1RrstVw6Okvk0xvgR4EnuolcOzNmmtyzYd0M_TK5dXkatgMu-D8hVFXWwmXVRE0zB8Z22tg5H69x9KZ_aQsflUkCLZc41Q6KRRjiTjulHCTkzXcBAwXFjSKbv5ggadSvDSOC3feOQlwVdUE",
  "Nonce": "636601724830442705.MjFlZDA5MTEtYjQwNC00NzZmLWJkNTQtZjlhODc5ZWM5NWFjODFmNjdiMGItZjRmMC00Njg2LWFkYTUtNzEzNjFhZWRmZWM3",
  "SessionId": "0034d572e04855e40b029ca11bef1df1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601724830442705.MjFlZDA5MTEtYjQwNC00NzZmLWJkNTQtZjlhODc5ZWM5NWFjODFmNjdiMGItZjRmMC00Njg2LWFkYTUtNzEzNjFhZWRmZWM3",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hw1SQ_QG72-uLMqhirOGHUnGQ4Ib6J71ApSSuT88BCI6SkkbcMAZdaMxliz-73q6es13OICgp-HXIl5zHi0oIbCU9LEHbASP5yLxsJFhO8RdoPUkcm-vd8Wsd2P4Y2Ixlp6aJ2HIvuD1mgUlGuFytx7UC1e_KHf0nhARxHpAUEe09YtJX4X1RrstVw6Okvk0xvgR4EnuolcOzNmmtyzYd0M_TK5dXkatgMu-D8hVFXWwmXVRE0zB8Z22tg5H69x9KZ_aQsflUkCLZc41Q6KRRjiTjulHCTkzXcBAwXFjSKbv5ggadSvDSOC3feOQlwVdUE",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:14:53.077 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 16:14:53.086 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 16:14:53.090 +03:00 [INF] Showing consent: User has not yet consented
2018-04-24 16:14:53.113 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:14:53.118 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:14:53.209 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:14:53.215 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:14:53.222 +03:00 [DBG] No PKCE used.
2018-04-24 16:14:53.224 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:15:02.779 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 16:15:02.787 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:15:02.793 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:15:02.853 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:15:02.859 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:15:02.867 +03:00 [DBG] No PKCE used.
2018-04-24 16:15:02.871 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:15:02.924 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:15:02.929 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:15:02.936 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 16:15:02.944 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 16:15:02.948 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 16:15:02.960 +03:00 [DBG] Start authorize callback request
2018-04-24 16:15:02.999 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:15:03.002 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:15:03.005 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:15:03.009 +03:00 [DBG] No PKCE used.
2018-04-24 16:15:03.013 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:15:03.017 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hw1SQ_QG72-uLMqhirOGHUnGQ4Ib6J71ApSSuT88BCI6SkkbcMAZdaMxliz-73q6es13OICgp-HXIl5zHi0oIbCU9LEHbASP5yLxsJFhO8RdoPUkcm-vd8Wsd2P4Y2Ixlp6aJ2HIvuD1mgUlGuFytx7UC1e_KHf0nhARxHpAUEe09YtJX4X1RrstVw6Okvk0xvgR4EnuolcOzNmmtyzYd0M_TK5dXkatgMu-D8hVFXWwmXVRE0zB8Z22tg5H69x9KZ_aQsflUkCLZc41Q6KRRjiTjulHCTkzXcBAwXFjSKbv5ggadSvDSOC3feOQlwVdUE",
  "Nonce": "636601724830442705.MjFlZDA5MTEtYjQwNC00NzZmLWJkNTQtZjlhODc5ZWM5NWFjODFmNjdiMGItZjRmMC00Njg2LWFkYTUtNzEzNjFhZWRmZWM3",
  "SessionId": "0034d572e04855e40b029ca11bef1df1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601724830442705.MjFlZDA5MTEtYjQwNC00NzZmLWJkNTQtZjlhODc5ZWM5NWFjODFmNjdiMGItZjRmMC00Njg2LWFkYTUtNzEzNjFhZWRmZWM3",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hw1SQ_QG72-uLMqhirOGHUnGQ4Ib6J71ApSSuT88BCI6SkkbcMAZdaMxliz-73q6es13OICgp-HXIl5zHi0oIbCU9LEHbASP5yLxsJFhO8RdoPUkcm-vd8Wsd2P4Y2Ixlp6aJ2HIvuD1mgUlGuFytx7UC1e_KHf0nhARxHpAUEe09YtJX4X1RrstVw6Okvk0xvgR4EnuolcOzNmmtyzYd0M_TK5dXkatgMu-D8hVFXWwmXVRE0zB8Z22tg5H69x9KZ_aQsflUkCLZc41Q6KRRjiTjulHCTkzXcBAwXFjSKbv5ggadSvDSOC3feOQlwVdUE",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:15:05.840 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 16:15:05.845 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 16:15:05.863 +03:00 [INF] User consented to scopes: ["openid","profile","api1"]
2018-04-24 16:15:05.880 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1"]
2018-04-24 16:15:05.888 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:15:05.916 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 16:15:05.960 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 16:15:05.976 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 16:15:05.985 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 16:15:06.115 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****4XEA"
    },
    {
      "TokenType": "code",
      "TokenValue": "****a5ab"
    }
  ],
  "ActivityId": "0HLD9SL8PE6KA:00000005",
  "TimeStamp": "2018-04-24T13:15:06Z",
  "ProcessId": 23872,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:15:06.131 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hw1SQ_QG72-uLMqhirOGHUnGQ4Ib6J71ApSSuT88BCI6SkkbcMAZdaMxliz-73q6es13OICgp-HXIl5zHi0oIbCU9LEHbASP5yLxsJFhO8RdoPUkcm-vd8Wsd2P4Y2Ixlp6aJ2HIvuD1mgUlGuFytx7UC1e_KHf0nhARxHpAUEe09YtJX4X1RrstVw6Okvk0xvgR4EnuolcOzNmmtyzYd0M_TK5dXkatgMu-D8hVFXWwmXVRE0zB8Z22tg5H69x9KZ_aQsflUkCLZc41Q6KRRjiTjulHCTkzXcBAwXFjSKbv5ggadSvDSOC3feOQlwVdUE",
  "Scope": "openid profile api1"
}
2018-04-24 16:15:28.457 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-24 16:15:28.468 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-24 16:15:28.472 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-24 16:15:28.485 +03:00 [DBG] Start token request.
2018-04-24 16:15:28.496 +03:00 [DBG] Start client validation
2018-04-24 16:15:28.505 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-24 16:15:28.514 +03:00 [DBG] Start parsing for secret in post body
2018-04-24 16:15:28.518 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-24 16:15:28.522 +03:00 [DBG] Secret id found: mvc
2018-04-24 16:15:28.535 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-24 16:15:28.538 +03:00 [DBG] Client validation success
2018-04-24 16:15:28.549 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD9SL8PE6KB:00000003",
  "TimeStamp": "2018-04-24T13:15:28Z",
  "ProcessId": 23872,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:15:28.563 +03:00 [DBG] Start token request validation
2018-04-24 16:15:28.580 +03:00 [DBG] Start validation of authorization code token request
2018-04-24 16:15:33.463 +03:00 [DBG] Validation of authorization code token request success
2018-04-24 16:15:33.475 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "5bd4cf69075dccac4db32c63aaefa66e99433582f4c3ca495e95a4398666a5ab",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "5bd4cf69075dccac4db32c63aaefa66e99433582f4c3ca495e95a4398666a5ab",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-24 16:15:33.508 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-24 16:15:33.516 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:16:09.787 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 16:16:09.805 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 16:16:09.816 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****pImA"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****hRDA"
    }
  ],
  "ActivityId": "0HLD9SL8PE6KB:00000003",
  "TimeStamp": "2018-04-24T13:16:09Z",
  "ProcessId": 23872,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:16:09.829 +03:00 [DBG] Token request success.
2018-04-24 16:16:09.855 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-24 16:16:09.862 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-24 16:16:09.866 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-24 16:16:09.878 +03:00 [DBG] Start userinfo request
2018-04-24 16:16:09.888 +03:00 [DBG] Bearer token found in header
2018-04-24 16:16:11.526 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-24 16:16:11.536 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524575769,
    "exp": 1524579369,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524567610,
    "idp": "local",
    "http://www.w3.org/2001/XMLSchema#string": "alice@email.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-04-24 16:16:12.904 +03:00 [DBG] Creating userinfo response
2018-04-24 16:16:12.912 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 16:16:12.919 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 16:16:12.927 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-24 16:16:12.932 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 16:16:14.156 +03:00 [INF] Profile service returned to the following claim types: http://www.w3.org/2001/XMLSchema#string
2018-04-24 16:16:14.162 +03:00 [DBG] End userinfo request
2018-04-24 16:40:24.041 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-24 16:40:24.105 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-24 16:40:24.111 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-24 16:40:24.113 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-24 16:40:24.115 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-24 16:40:24.116 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-24 16:40:29.876 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:40:29.904 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:42:09.786 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 16:42:09.798 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 16:42:09.803 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 16:42:09.810 +03:00 [DBG] Start discovery request
2018-04-24 16:42:10.184 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 16:42:10.191 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 16:42:10.194 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 16:42:10.203 +03:00 [DBG] Start key discovery request
2018-04-24 16:42:10.338 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:42:10.346 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:42:10.350 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 16:42:10.365 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 16:42:10.369 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 16:42:10.381 +03:00 [DBG] Start authorize request
2018-04-24 16:42:10.399 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:42:10.410 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:42:10.432 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:42:10.436 +03:00 [DBG] No PKCE used.
2018-04-24 16:42:10.489 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:42:10.516 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzrpLf1BRDsUCFb-iV9QPRSGo-B7XYVAcvC3fyygHCJADdR6iN2F4udoHRjUqW6RYDbLW5qtz9XSd0vjsCv9ENnBwdH27KEY1wu_tmqFKzWKvnosFQhqI6a2LtbWnJaBYFjDIZOhG4ho6gfu1JsnYdhH_Tu-2FbpLr38KxkBLyVseyPO4pQdw98eNpMOgX5pY9zfRocQML0DeyEidSQkFuYwV1AqzLOscHL6bf96h2yxbhhr814Uf0pgb1unJmeFDiJdYKzpcLCLcwwAptIMDfY7HhfpIcm8JWTu-IeW3RyR4Bhs8i6DVCnhV7VT2WLyfU",
  "Nonce": "636601741302874737.YTUxMWNmNjQtNTgwZC00NDg5LTkyNGMtNGI5ODNjYjFmNjVjMGQ5ZmZkYTUtMTI3Yy00NmU3LTg0ZGQtMmE1NmFiY2NkNDM0",
  "SessionId": "0034d572e04855e40b029ca11bef1df1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601741302874737.YTUxMWNmNjQtNTgwZC00NDg5LTkyNGMtNGI5ODNjYjFmNjVjMGQ5ZmZkYTUtMTI3Yy00NmU3LTg0ZGQtMmE1NmFiY2NkNDM0",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hzrpLf1BRDsUCFb-iV9QPRSGo-B7XYVAcvC3fyygHCJADdR6iN2F4udoHRjUqW6RYDbLW5qtz9XSd0vjsCv9ENnBwdH27KEY1wu_tmqFKzWKvnosFQhqI6a2LtbWnJaBYFjDIZOhG4ho6gfu1JsnYdhH_Tu-2FbpLr38KxkBLyVseyPO4pQdw98eNpMOgX5pY9zfRocQML0DeyEidSQkFuYwV1AqzLOscHL6bf96h2yxbhhr814Uf0pgb1unJmeFDiJdYKzpcLCLcwwAptIMDfY7HhfpIcm8JWTu-IeW3RyR4Bhs8i6DVCnhV7VT2WLyfU",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:42:10.555 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 16:42:10.563 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 16:42:10.566 +03:00 [INF] Showing consent: User has not yet consented
2018-04-24 16:42:10.586 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:42:10.591 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:42:10.684 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:42:10.689 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:42:10.693 +03:00 [DBG] No PKCE used.
2018-04-24 16:42:10.697 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:42:17.095 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 16:42:17.102 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:42:17.108 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:42:17.165 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:42:17.170 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:42:17.173 +03:00 [DBG] No PKCE used.
2018-04-24 16:42:17.176 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:42:17.227 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:42:17.233 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:42:17.236 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 16:42:17.241 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 16:42:17.247 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 16:42:17.257 +03:00 [DBG] Start authorize callback request
2018-04-24 16:42:17.297 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:42:17.303 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:42:17.308 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:42:17.312 +03:00 [DBG] No PKCE used.
2018-04-24 16:42:17.314 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:42:17.318 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzrpLf1BRDsUCFb-iV9QPRSGo-B7XYVAcvC3fyygHCJADdR6iN2F4udoHRjUqW6RYDbLW5qtz9XSd0vjsCv9ENnBwdH27KEY1wu_tmqFKzWKvnosFQhqI6a2LtbWnJaBYFjDIZOhG4ho6gfu1JsnYdhH_Tu-2FbpLr38KxkBLyVseyPO4pQdw98eNpMOgX5pY9zfRocQML0DeyEidSQkFuYwV1AqzLOscHL6bf96h2yxbhhr814Uf0pgb1unJmeFDiJdYKzpcLCLcwwAptIMDfY7HhfpIcm8JWTu-IeW3RyR4Bhs8i6DVCnhV7VT2WLyfU",
  "Nonce": "636601741302874737.YTUxMWNmNjQtNTgwZC00NDg5LTkyNGMtNGI5ODNjYjFmNjVjMGQ5ZmZkYTUtMTI3Yy00NmU3LTg0ZGQtMmE1NmFiY2NkNDM0",
  "SessionId": "0034d572e04855e40b029ca11bef1df1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601741302874737.YTUxMWNmNjQtNTgwZC00NDg5LTkyNGMtNGI5ODNjYjFmNjVjMGQ5ZmZkYTUtMTI3Yy00NmU3LTg0ZGQtMmE1NmFiY2NkNDM0",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hzrpLf1BRDsUCFb-iV9QPRSGo-B7XYVAcvC3fyygHCJADdR6iN2F4udoHRjUqW6RYDbLW5qtz9XSd0vjsCv9ENnBwdH27KEY1wu_tmqFKzWKvnosFQhqI6a2LtbWnJaBYFjDIZOhG4ho6gfu1JsnYdhH_Tu-2FbpLr38KxkBLyVseyPO4pQdw98eNpMOgX5pY9zfRocQML0DeyEidSQkFuYwV1AqzLOscHL6bf96h2yxbhhr814Uf0pgb1unJmeFDiJdYKzpcLCLcwwAptIMDfY7HhfpIcm8JWTu-IeW3RyR4Bhs8i6DVCnhV7VT2WLyfU",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:42:17.328 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 16:42:17.333 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 16:42:17.349 +03:00 [INF] User consented to scopes: ["openid","profile","api1"]
2018-04-24 16:42:17.368 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1"]
2018-04-24 16:42:17.377 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:42:17.413 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 16:42:17.460 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 16:42:17.475 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 16:42:17.486 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 16:42:17.608 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****gVZQ"
    },
    {
      "TokenType": "code",
      "TokenValue": "****b64c"
    }
  ],
  "ActivityId": "0HLD9T3NBVLB6:00000005",
  "TimeStamp": "2018-04-24T13:42:17Z",
  "ProcessId": 18112,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:42:17.623 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzrpLf1BRDsUCFb-iV9QPRSGo-B7XYVAcvC3fyygHCJADdR6iN2F4udoHRjUqW6RYDbLW5qtz9XSd0vjsCv9ENnBwdH27KEY1wu_tmqFKzWKvnosFQhqI6a2LtbWnJaBYFjDIZOhG4ho6gfu1JsnYdhH_Tu-2FbpLr38KxkBLyVseyPO4pQdw98eNpMOgX5pY9zfRocQML0DeyEidSQkFuYwV1AqzLOscHL6bf96h2yxbhhr814Uf0pgb1unJmeFDiJdYKzpcLCLcwwAptIMDfY7HhfpIcm8JWTu-IeW3RyR4Bhs8i6DVCnhV7VT2WLyfU",
  "Scope": "openid profile api1"
}
2018-04-24 16:43:13.397 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-24 16:43:13.411 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-24 16:43:13.417 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-24 16:43:13.434 +03:00 [DBG] Start token request.
2018-04-24 16:43:13.444 +03:00 [DBG] Start client validation
2018-04-24 16:43:13.454 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-24 16:43:13.464 +03:00 [DBG] Start parsing for secret in post body
2018-04-24 16:43:13.469 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-24 16:43:13.474 +03:00 [DBG] Secret id found: mvc
2018-04-24 16:43:13.490 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-24 16:43:13.493 +03:00 [DBG] Client validation success
2018-04-24 16:43:13.504 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD9T3NBVLB8:00000001",
  "TimeStamp": "2018-04-24T13:43:13Z",
  "ProcessId": 18112,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:43:13.516 +03:00 [DBG] Start token request validation
2018-04-24 16:43:13.532 +03:00 [DBG] Start validation of authorization code token request
2018-04-24 16:43:13.569 +03:00 [DBG] Validation of authorization code token request success
2018-04-24 16:43:13.582 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "c16361ee6f0975bb435b27c9d56901ce5320bf6f0b6126f2f727153a884fb64c",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "c16361ee6f0975bb435b27c9d56901ce5320bf6f0b6126f2f727153a884fb64c",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-24 16:43:13.615 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-24 16:43:13.620 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:43:13.637 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 16:43:13.641 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 16:43:13.649 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****2gXw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****q4ZQ"
    }
  ],
  "ActivityId": "0HLD9T3NBVLB8:00000001",
  "TimeStamp": "2018-04-24T13:43:13Z",
  "ProcessId": 18112,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:43:13.655 +03:00 [DBG] Token request success.
2018-04-24 16:43:13.692 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-24 16:43:13.699 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-24 16:43:13.703 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-24 16:43:13.716 +03:00 [DBG] Start userinfo request
2018-04-24 16:43:13.725 +03:00 [DBG] Bearer token found in header
2018-04-24 16:43:13.801 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-24 16:43:13.813 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524577393,
    "exp": 1524580993,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524567610,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-04-24 16:43:13.828 +03:00 [DBG] Creating userinfo response
2018-04-24 16:43:13.837 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 16:43:13.846 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 16:43:13.854 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-24 16:43:13.859 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 16:43:13.865 +03:00 [INF] Profile service returned to the following claim types: 
2018-04-24 16:43:13.870 +03:00 [DBG] End userinfo request
2018-04-24 16:44:30.517 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-24 16:44:30.585 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-24 16:44:30.594 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-24 16:44:30.596 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-24 16:44:30.599 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-24 16:44:30.601 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-24 16:44:32.664 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:44:32.688 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:44:48.539 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:44:48.547 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:44:48.557 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-24 16:44:48.569 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-24 16:44:48.574 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-24 16:44:48.591 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:44:48.604 +03:00 [DBG] Start end session request validation
2018-04-24 16:44:48.616 +03:00 [DBG] Start identity token validation
2018-04-24 16:44:48.681 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-24 16:44:52.972 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-24 16:44:53.014 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524577393,
    "exp": 1524577693,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636601741302874737.YTUxMWNmNjQtNTgwZC00NDg5LTkyNGMtNGI5ODNjYjFmNjVjMGQ5ZmZkYTUtMTI3Yy00NmU3LTg0ZGQtMmE1NmFiY2NkNDM0",
    "iat": 1524577393,
    "at_hash": "_0ROqYGrAimBHi97Py-NVg",
    "sid": "0034d572e04855e40b029ca11bef1df1",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524567610,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-24 16:44:53.058 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hysMzaTZfK7tVudzNgOYsxQ66bBPzL4XUv97UILqFm43UCV05P7CzOSYlwuA9yBodNUw-faH-TDgMsAak4D8sNFct_-tE_y1hxCQySBksyX0N006gVQoBIQKQqKpPUYxIT6_NtaXQp4ppf1QYKIMa1a",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQ1NzczOTMsImV4cCI6MTUyNDU3NzY5MywiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY2MDE3NDEzMDI4NzQ3MzcuWVRVeE1XTm1OalF0TlRnd1pDMDBORGc1TFRreU5HTXROR0k1T0ROallqRm1OalZqTUdRNVptWmtZVFV0TVRJM1l5MDBObVUzTFRnMFpHUXRNbUUxTm1GaVkyTmtORE0wIiwiaWF0IjoxNTI0NTc3MzkzLCJhdF9oYXNoIjoiXzBST3FZR3JBaW1CSGk5N1B5LU5WZyIsInNpZCI6IjAwMzRkNTcyZTA0ODU1ZTQwYjAyOWNhMTFiZWYxZGYxIiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0NTY3NjEwLCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.MWFwI7XWkKARZRci9VmhhBDjgvaPp8x-bTYfTGHU-DweRhfzt6SHgTkfnN_TktTKNz98R493P-H4KxeTqu2hHXfebtzCoaJgAv2k7xD5J16Mlobn4N1AaWFgQ7v8Li9m-39t6vDMGMsLC-49uXUm8S4rD7PvWSeP3xCf9Y8s7lF2kJEuJJJDQYDL2ALIMxLGgE53NOtQLnltQ5rDT5udn_ht5iKkOrEBzkyuebDMloAEgf4oGAQzW-MD0Q3twQ2Ts5S2xMTKLbiuVet2dWtHkMzbqv3LrO4E3XwrZfyq9NTXdNnk_vzd_Hdfmvb0gRGKnKJQ0iUc5X0QSGbXC12gXw",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hysMzaTZfK7tVudzNgOYsxQ66bBPzL4XUv97UILqFm43UCV05P7CzOSYlwuA9yBodNUw-faH-TDgMsAak4D8sNFct_-tE_y1hxCQySBksyX0N006gVQoBIQKQqKpPUYxIT6_NtaXQp4ppf1QYKIMa1a",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:44:53.072 +03:00 [DBG] Success validating end session request from mvc
2018-04-24 16:44:53.116 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:44:53.119 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:44:53.271 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-24 16:44:53.278 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-24 16:44:53.284 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-24 16:44:53.361 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD9T60PNT5R:00000003",
  "TimeStamp": "2018-04-24T13:44:53Z",
  "ProcessId": 29916,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:44:54.654 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-24 16:44:54.662 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-24 16:44:54.666 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-24 16:44:54.678 +03:00 [DBG] Processing signout callback request
2018-04-24 16:44:54.693 +03:00 [DBG] No client front-channel logout URLs
2018-04-24 16:44:54.697 +03:00 [DBG] No client back-channel logout URLs
2018-04-24 16:44:54.703 +03:00 [INF] Successful signout callback.
2018-04-24 16:44:54.706 +03:00 [DBG] No client front-channel iframe urls
2018-04-24 16:44:54.710 +03:00 [DBG] No client back-channel iframe urls
2018-04-24 16:45:00.020 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 16:45:00.030 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 16:45:00.036 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 16:45:00.046 +03:00 [DBG] Start authorize request
2018-04-24 16:45:00.055 +03:00 [DBG] No user present in authorize request
2018-04-24 16:45:00.067 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:45:00.083 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:45:00.089 +03:00 [DBG] No PKCE used.
2018-04-24 16:45:00.142 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:45:00.163 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxOt_QCjlAMFqxBlQX4UTbkZoBoAvTu_KEWOkN9kbC_MvRANxbQAf3PKvZE-LQEk1Q5tIBQlrVUvGm_rOxxceV1S0rckSs6G2PYj6eSpVFRCVNNQjvQYvSaVn9jly0Q_zrnEna_5hJy5O2Yuc5hOyfno6171duxW0ggDTs5w6Gw4sFcb0BbIrmw3BSmFbx0QXL6WAf33kX5167jYqTjre9R2P3G3cb_3V-6LtNeK6dEkYyvHnhWLQaooRIdS41P7jwVWhmoPct74oNJsd0wv48OoGHsA3T1H64d2qozxvm0AEhzJyYyBpZJmY74zljM5Zk",
  "Nonce": "636601742999795684.NjI0YWM3NTktZDZiMS00MTEyLThkMDEtNzU2ZjliYTM1M2E1NWNiYjJhYjItMjI5Yy00NmQwLThhN2YtYzljOGMxN2QwZTgw",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601742999795684.NjI0YWM3NTktZDZiMS00MTEyLThkMDEtNzU2ZjliYTM1M2E1NWNiYjJhYjItMjI5Yy00NmQwLThhN2YtYzljOGMxN2QwZTgw",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hxOt_QCjlAMFqxBlQX4UTbkZoBoAvTu_KEWOkN9kbC_MvRANxbQAf3PKvZE-LQEk1Q5tIBQlrVUvGm_rOxxceV1S0rckSs6G2PYj6eSpVFRCVNNQjvQYvSaVn9jly0Q_zrnEna_5hJy5O2Yuc5hOyfno6171duxW0ggDTs5w6Gw4sFcb0BbIrmw3BSmFbx0QXL6WAf33kX5167jYqTjre9R2P3G3cb_3V-6LtNeK6dEkYyvHnhWLQaooRIdS41P7jwVWhmoPct74oNJsd0wv48OoGHsA3T1H64d2qozxvm0AEhzJyYyBpZJmY74zljM5Zk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:45:00.189 +03:00 [INF] Showing login: User is not authenticated
2018-04-24 16:45:00.254 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:45:00.259 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:45:00.263 +03:00 [DBG] No PKCE used.
2018-04-24 16:45:00.267 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:45:09.816 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 16:45:12.491 +03:00 [WRN] Invalid password for user 8dce434c-0b38-4578-9788-7ff306388283.
2018-04-24 16:45:12.496 +03:00 [WRN] User 8dce434c-0b38-4578-9788-7ff306388283 failed to provide the correct password.
2018-04-24 16:45:12.917 +03:00 [INF] {
  "Name": "User Login Failure",
  "Category": "Authentication",
  "EventType": "Failure",
  "Id": 1001,
  "Username": "alice",
  "Endpoint": "UI",
  "Message": "invalid credentials",
  "ActivityId": "0HLD9T60PNT5R:00000007",
  "TimeStamp": "2018-04-24T13:45:12Z",
  "ProcessId": 29916,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:45:12.926 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:45:12.929 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:45:12.932 +03:00 [DBG] No PKCE used.
2018-04-24 16:45:12.935 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:45:20.708 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 16:45:20.806 +03:00 [INF] {
  "Name": "User Login Failure",
  "Category": "Authentication",
  "EventType": "Failure",
  "Id": 1001,
  "Username": "alice@mail.com",
  "Endpoint": "UI",
  "Message": "invalid credentials",
  "ActivityId": "0HLD9T60PNT5R:00000008",
  "TimeStamp": "2018-04-24T13:45:20Z",
  "ProcessId": 29916,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:45:20.815 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:45:20.817 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:45:20.820 +03:00 [DBG] No PKCE used.
2018-04-24 16:45:20.825 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:45:32.180 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 16:45:32.884 +03:00 [DBG] Augmenting SignInContext
2018-04-24 16:45:32.890 +03:00 [DBG] Adding idp claim with value: local
2018-04-24 16:45:32.893 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-24 16:45:32.899 +03:00 [DBG] Adding auth_time claim with value: 1524577532
2018-04-24 16:45:32.913 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-24 16:45:32.999 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD9T60PNT5R:00000009",
  "TimeStamp": "2018-04-24T13:45:32Z",
  "ProcessId": 29916,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:45:33.027 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:45:33.032 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:45:33.036 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 16:45:33.041 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 16:45:33.044 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 16:45:33.055 +03:00 [DBG] Start authorize callback request
2018-04-24 16:45:33.066 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:45:33.073 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:45:33.078 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:45:33.082 +03:00 [DBG] No PKCE used.
2018-04-24 16:45:33.086 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:45:33.095 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxOt_QCjlAMFqxBlQX4UTbkZoBoAvTu_KEWOkN9kbC_MvRANxbQAf3PKvZE-LQEk1Q5tIBQlrVUvGm_rOxxceV1S0rckSs6G2PYj6eSpVFRCVNNQjvQYvSaVn9jly0Q_zrnEna_5hJy5O2Yuc5hOyfno6171duxW0ggDTs5w6Gw4sFcb0BbIrmw3BSmFbx0QXL6WAf33kX5167jYqTjre9R2P3G3cb_3V-6LtNeK6dEkYyvHnhWLQaooRIdS41P7jwVWhmoPct74oNJsd0wv48OoGHsA3T1H64d2qozxvm0AEhzJyYyBpZJmY74zljM5Zk",
  "Nonce": "636601742999795684.NjI0YWM3NTktZDZiMS00MTEyLThkMDEtNzU2ZjliYTM1M2E1NWNiYjJhYjItMjI5Yy00NmQwLThhN2YtYzljOGMxN2QwZTgw",
  "SessionId": "fd502eff67987f0ef5c8c9a7f4edeb2d",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601742999795684.NjI0YWM3NTktZDZiMS00MTEyLThkMDEtNzU2ZjliYTM1M2E1NWNiYjJhYjItMjI5Yy00NmQwLThhN2YtYzljOGMxN2QwZTgw",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hxOt_QCjlAMFqxBlQX4UTbkZoBoAvTu_KEWOkN9kbC_MvRANxbQAf3PKvZE-LQEk1Q5tIBQlrVUvGm_rOxxceV1S0rckSs6G2PYj6eSpVFRCVNNQjvQYvSaVn9jly0Q_zrnEna_5hJy5O2Yuc5hOyfno6171duxW0ggDTs5w6Gw4sFcb0BbIrmw3BSmFbx0QXL6WAf33kX5167jYqTjre9R2P3G3cb_3V-6LtNeK6dEkYyvHnhWLQaooRIdS41P7jwVWhmoPct74oNJsd0wv48OoGHsA3T1H64d2qozxvm0AEhzJyYyBpZJmY74zljM5Zk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:45:35.286 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 16:45:35.292 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 16:45:35.295 +03:00 [INF] Showing consent: User has not yet consented
2018-04-24 16:45:35.312 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:45:35.317 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:45:35.349 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:45:35.353 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:45:35.357 +03:00 [DBG] No PKCE used.
2018-04-24 16:45:35.361 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:45:44.468 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 16:45:44.475 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:45:44.483 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:45:44.517 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:45:44.522 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:45:44.526 +03:00 [DBG] No PKCE used.
2018-04-24 16:45:44.532 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:45:44.575 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:45:44.581 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:45:44.585 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 16:45:44.592 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 16:45:44.596 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 16:45:44.600 +03:00 [DBG] Start authorize callback request
2018-04-24 16:45:44.608 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:45:44.614 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:45:44.619 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:45:44.624 +03:00 [DBG] No PKCE used.
2018-04-24 16:45:44.628 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:45:44.634 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxOt_QCjlAMFqxBlQX4UTbkZoBoAvTu_KEWOkN9kbC_MvRANxbQAf3PKvZE-LQEk1Q5tIBQlrVUvGm_rOxxceV1S0rckSs6G2PYj6eSpVFRCVNNQjvQYvSaVn9jly0Q_zrnEna_5hJy5O2Yuc5hOyfno6171duxW0ggDTs5w6Gw4sFcb0BbIrmw3BSmFbx0QXL6WAf33kX5167jYqTjre9R2P3G3cb_3V-6LtNeK6dEkYyvHnhWLQaooRIdS41P7jwVWhmoPct74oNJsd0wv48OoGHsA3T1H64d2qozxvm0AEhzJyYyBpZJmY74zljM5Zk",
  "Nonce": "636601742999795684.NjI0YWM3NTktZDZiMS00MTEyLThkMDEtNzU2ZjliYTM1M2E1NWNiYjJhYjItMjI5Yy00NmQwLThhN2YtYzljOGMxN2QwZTgw",
  "SessionId": "fd502eff67987f0ef5c8c9a7f4edeb2d",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601742999795684.NjI0YWM3NTktZDZiMS00MTEyLThkMDEtNzU2ZjliYTM1M2E1NWNiYjJhYjItMjI5Yy00NmQwLThhN2YtYzljOGMxN2QwZTgw",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hxOt_QCjlAMFqxBlQX4UTbkZoBoAvTu_KEWOkN9kbC_MvRANxbQAf3PKvZE-LQEk1Q5tIBQlrVUvGm_rOxxceV1S0rckSs6G2PYj6eSpVFRCVNNQjvQYvSaVn9jly0Q_zrnEna_5hJy5O2Yuc5hOyfno6171duxW0ggDTs5w6Gw4sFcb0BbIrmw3BSmFbx0QXL6WAf33kX5167jYqTjre9R2P3G3cb_3V-6LtNeK6dEkYyvHnhWLQaooRIdS41P7jwVWhmoPct74oNJsd0wv48OoGHsA3T1H64d2qozxvm0AEhzJyYyBpZJmY74zljM5Zk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:45:48.579 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 16:45:48.583 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 16:45:48.598 +03:00 [INF] User consented to scopes: ["openid","profile","api1"]
2018-04-24 16:45:48.617 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1"]
2018-04-24 16:45:48.626 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:45:48.650 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 16:45:48.688 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 16:45:48.703 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 16:45:48.711 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 16:45:48.769 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****ET6w"
    },
    {
      "TokenType": "code",
      "TokenValue": "****adb4"
    }
  ],
  "ActivityId": "0HLD9T60PNT5R:0000000D",
  "TimeStamp": "2018-04-24T13:45:48Z",
  "ProcessId": 29916,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:45:48.783 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxOt_QCjlAMFqxBlQX4UTbkZoBoAvTu_KEWOkN9kbC_MvRANxbQAf3PKvZE-LQEk1Q5tIBQlrVUvGm_rOxxceV1S0rckSs6G2PYj6eSpVFRCVNNQjvQYvSaVn9jly0Q_zrnEna_5hJy5O2Yuc5hOyfno6171duxW0ggDTs5w6Gw4sFcb0BbIrmw3BSmFbx0QXL6WAf33kX5167jYqTjre9R2P3G3cb_3V-6LtNeK6dEkYyvHnhWLQaooRIdS41P7jwVWhmoPct74oNJsd0wv48OoGHsA3T1H64d2qozxvm0AEhzJyYyBpZJmY74zljM5Zk",
  "Scope": "openid profile api1"
}
2018-04-24 16:45:48.805 +03:00 [DBG] Augmenting SignInContext
2018-04-24 16:45:48.811 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-24 16:45:56.832 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-24 16:45:56.843 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-24 16:45:56.847 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-24 16:45:56.860 +03:00 [DBG] Start token request.
2018-04-24 16:45:56.869 +03:00 [DBG] Start client validation
2018-04-24 16:45:56.879 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-24 16:45:56.888 +03:00 [DBG] Start parsing for secret in post body
2018-04-24 16:45:56.892 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-24 16:45:56.894 +03:00 [DBG] Secret id found: mvc
2018-04-24 16:45:56.907 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-24 16:45:56.912 +03:00 [DBG] Client validation success
2018-04-24 16:45:56.925 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD9T60PNT62:00000001",
  "TimeStamp": "2018-04-24T13:45:56Z",
  "ProcessId": 29916,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:45:56.941 +03:00 [DBG] Start token request validation
2018-04-24 16:45:56.961 +03:00 [DBG] Start validation of authorization code token request
2018-04-24 16:45:58.383 +03:00 [DBG] Validation of authorization code token request success
2018-04-24 16:45:58.394 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "94d0dabc5aa0ebce4b05df78337be125d7e4728a271101e6e671b5f87375adb4",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "94d0dabc5aa0ebce4b05df78337be125d7e4728a271101e6e671b5f87375adb4",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-24 16:45:58.431 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-24 16:45:58.438 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:46:04.593 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 16:46:04.600 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 16:46:04.609 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Tkyw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****cvjw"
    }
  ],
  "ActivityId": "0HLD9T60PNT62:00000001",
  "TimeStamp": "2018-04-24T13:46:04Z",
  "ProcessId": 29916,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:46:04.624 +03:00 [DBG] Token request success.
2018-04-24 16:46:04.663 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-24 16:46:04.672 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-24 16:46:04.676 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-24 16:46:04.690 +03:00 [DBG] Start userinfo request
2018-04-24 16:46:04.698 +03:00 [DBG] Bearer token found in header
2018-04-24 16:46:06.250 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-24 16:46:06.254 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524577564,
    "exp": 1524581164,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524577532,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-04-24 16:46:07.209 +03:00 [DBG] Creating userinfo response
2018-04-24 16:46:07.219 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 16:46:07.226 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 16:46:07.234 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-24 16:46:07.240 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 16:46:08.226 +03:00 [INF] Profile service returned to the following claim types: 
2018-04-24 16:46:08.231 +03:00 [DBG] End userinfo request
2018-04-24 16:47:48.846 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-24 16:47:48.904 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-24 16:47:48.911 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-24 16:47:48.913 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-24 16:47:48.916 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-24 16:47:48.918 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-24 16:47:51.368 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:47:51.395 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:48:18.382 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:48:18.388 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:48:18.399 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-24 16:48:18.414 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-24 16:48:18.421 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-24 16:48:18.439 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:48:18.450 +03:00 [DBG] Start end session request validation
2018-04-24 16:48:18.464 +03:00 [DBG] Start identity token validation
2018-04-24 16:48:18.528 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-24 16:48:18.613 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-24 16:48:18.649 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524577564,
    "exp": 1524577864,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636601742999795684.NjI0YWM3NTktZDZiMS00MTEyLThkMDEtNzU2ZjliYTM1M2E1NWNiYjJhYjItMjI5Yy00NmQwLThhN2YtYzljOGMxN2QwZTgw",
    "iat": 1524577564,
    "at_hash": "VPFHZ11x9m-e2mo0BHKXpA",
    "sid": "fd502eff67987f0ef5c8c9a7f4edeb2d",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524577532,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-24 16:48:18.695 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hwtJ1kDXpxq-Ax0fxZRdhwMpuP3LeYQwRFZH_OZlY66n5Ndo-f531x3FWGHon6uSE_-E_Y0uF041zOEHfIBulT7Rv-4V5uSce0LfCw-mRSkDcQqth1aGvIZuzO2Fzppdzre-oVV-sc1TruaHDiDpBLF",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQ1Nzc1NjQsImV4cCI6MTUyNDU3Nzg2NCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY2MDE3NDI5OTk3OTU2ODQuTmpJMFlXTTNOVGt0WkRaaU1TMDBNVEV5TFRoa01ERXROelUyWmpsaVlUTTFNMkUxTldOaVlqSmhZakl0TWpJNVl5MDBObVF3TFRoaE4yWXRZemxqT0dNeE4yUXdaVGd3IiwiaWF0IjoxNTI0NTc3NTY0LCJhdF9oYXNoIjoiVlBGSFoxMXg5bS1lMm1vMEJIS1hwQSIsInNpZCI6ImZkNTAyZWZmNjc5ODdmMGVmNWM4YzlhN2Y0ZWRlYjJkIiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0NTc3NTMyLCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.JlXJ28i_G-XtuZQCoGMLhZwmfWAtEOF3JlDzKrVB2pG4Hsfa7nCFQsBZ7TPBRrumr2ZZu1QCXWvFHocXJl3uHghzefV5WOBTBVDhYAKzuGH-Jn3jonLd7vrm8Yk05Y3q7YbtqH_wwzvIS3PHRiqE20R4yMi42y5-iaZUrZwQmmJ0ojkcQgEg7Rh1M59wMcSJPmxp25kUP3a9DjcWANojipxBXUY7UF4KqUG09N3oZkdzUnlBf43Zze8RVVSEBT4OxglsNGtKg1_YQu6VKYe0_Gv5re174eoz3HQm1pG8-lMB6wk6Y0M62VAlgsx7M-xvoKUPV0ypqptqFx5iRHTkyw",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwtJ1kDXpxq-Ax0fxZRdhwMpuP3LeYQwRFZH_OZlY66n5Ndo-f531x3FWGHon6uSE_-E_Y0uF041zOEHfIBulT7Rv-4V5uSce0LfCw-mRSkDcQqth1aGvIZuzO2Fzppdzre-oVV-sc1TruaHDiDpBLF",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:48:18.712 +03:00 [DBG] Success validating end session request from mvc
2018-04-24 16:48:18.755 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:48:18.759 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:48:18.906 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-24 16:48:18.913 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-24 16:48:18.918 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-24 16:48:18.992 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD9T7RVR7JN:00000003",
  "TimeStamp": "2018-04-24T13:48:18Z",
  "ProcessId": 25848,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:48:20.287 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-24 16:48:20.295 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-24 16:48:20.300 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-24 16:48:20.309 +03:00 [DBG] Processing signout callback request
2018-04-24 16:48:20.330 +03:00 [DBG] No client front-channel logout URLs
2018-04-24 16:48:20.335 +03:00 [DBG] No client back-channel logout URLs
2018-04-24 16:48:20.339 +03:00 [INF] Successful signout callback.
2018-04-24 16:48:20.342 +03:00 [DBG] No client front-channel iframe urls
2018-04-24 16:48:20.345 +03:00 [DBG] No client back-channel iframe urls
2018-04-24 16:48:24.285 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 16:48:24.294 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 16:48:24.302 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 16:48:24.310 +03:00 [DBG] Start authorize request
2018-04-24 16:48:24.319 +03:00 [DBG] No user present in authorize request
2018-04-24 16:48:24.329 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:48:24.347 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:48:24.352 +03:00 [DBG] No PKCE used.
2018-04-24 16:48:24.403 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:48:24.425 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzZTKbyx_rNC1SurtHZaUDZun9P6QYAO9-cX7InZPqtYJ2xFIbDshYp3gzNOWN_O5M1EdZkRrTSpJsqztZ68ET5-k0m0MrudJywlfDtyqC3MPqqgkC9hosJshnfF2nAWZ1xLFB7HKNOY1ztYONhaY4Z4PcHAmvzEiJ2R89EIAwmnNFV3UQfH3srerAVgNI1an-d05wIRXSXwrSKIEHHD5JkZADpH5BxbR55mFOWSnrCUaGKm7hewSw2BKigJrbTE_Y2cRoue9KD5ce5Wtw2L-WqBdCWgMJLMY8UmTvYoBCzZm_o6FxwvJSEIYymf4egIOE",
  "Nonce": "636601745042437653.NjdmNDk4NmYtYzcwMC00MzQxLTkyNTAtMDJjYzc5NzI3NjRjYWU4MzYyYmItYmQ0YS00Zjk5LTllNmMtYmU2NTdhOTE0ZDlm",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601745042437653.NjdmNDk4NmYtYzcwMC00MzQxLTkyNTAtMDJjYzc5NzI3NjRjYWU4MzYyYmItYmQ0YS00Zjk5LTllNmMtYmU2NTdhOTE0ZDlm",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hzZTKbyx_rNC1SurtHZaUDZun9P6QYAO9-cX7InZPqtYJ2xFIbDshYp3gzNOWN_O5M1EdZkRrTSpJsqztZ68ET5-k0m0MrudJywlfDtyqC3MPqqgkC9hosJshnfF2nAWZ1xLFB7HKNOY1ztYONhaY4Z4PcHAmvzEiJ2R89EIAwmnNFV3UQfH3srerAVgNI1an-d05wIRXSXwrSKIEHHD5JkZADpH5BxbR55mFOWSnrCUaGKm7hewSw2BKigJrbTE_Y2cRoue9KD5ce5Wtw2L-WqBdCWgMJLMY8UmTvYoBCzZm_o6FxwvJSEIYymf4egIOE",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:48:24.456 +03:00 [INF] Showing login: User is not authenticated
2018-04-24 16:48:24.507 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:48:24.512 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:48:24.519 +03:00 [DBG] No PKCE used.
2018-04-24 16:48:24.523 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:48:35.120 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 16:48:38.310 +03:00 [DBG] Augmenting SignInContext
2018-04-24 16:48:38.319 +03:00 [DBG] Adding idp claim with value: local
2018-04-24 16:48:38.323 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-24 16:48:38.327 +03:00 [DBG] Adding auth_time claim with value: 1524577718
2018-04-24 16:48:38.339 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-24 16:48:38.428 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD9T7RVR7JN:00000007",
  "TimeStamp": "2018-04-24T13:48:38Z",
  "ProcessId": 25848,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:48:38.463 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:48:38.468 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:48:38.472 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 16:48:38.479 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 16:48:38.485 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 16:48:38.495 +03:00 [DBG] Start authorize callback request
2018-04-24 16:48:38.506 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:48:38.512 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:48:38.518 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:48:38.521 +03:00 [DBG] No PKCE used.
2018-04-24 16:48:38.523 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:48:38.530 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzZTKbyx_rNC1SurtHZaUDZun9P6QYAO9-cX7InZPqtYJ2xFIbDshYp3gzNOWN_O5M1EdZkRrTSpJsqztZ68ET5-k0m0MrudJywlfDtyqC3MPqqgkC9hosJshnfF2nAWZ1xLFB7HKNOY1ztYONhaY4Z4PcHAmvzEiJ2R89EIAwmnNFV3UQfH3srerAVgNI1an-d05wIRXSXwrSKIEHHD5JkZADpH5BxbR55mFOWSnrCUaGKm7hewSw2BKigJrbTE_Y2cRoue9KD5ce5Wtw2L-WqBdCWgMJLMY8UmTvYoBCzZm_o6FxwvJSEIYymf4egIOE",
  "Nonce": "636601745042437653.NjdmNDk4NmYtYzcwMC00MzQxLTkyNTAtMDJjYzc5NzI3NjRjYWU4MzYyYmItYmQ0YS00Zjk5LTllNmMtYmU2NTdhOTE0ZDlm",
  "SessionId": "612914b316e78661248e5b7420357577",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601745042437653.NjdmNDk4NmYtYzcwMC00MzQxLTkyNTAtMDJjYzc5NzI3NjRjYWU4MzYyYmItYmQ0YS00Zjk5LTllNmMtYmU2NTdhOTE0ZDlm",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hzZTKbyx_rNC1SurtHZaUDZun9P6QYAO9-cX7InZPqtYJ2xFIbDshYp3gzNOWN_O5M1EdZkRrTSpJsqztZ68ET5-k0m0MrudJywlfDtyqC3MPqqgkC9hosJshnfF2nAWZ1xLFB7HKNOY1ztYONhaY4Z4PcHAmvzEiJ2R89EIAwmnNFV3UQfH3srerAVgNI1an-d05wIRXSXwrSKIEHHD5JkZADpH5BxbR55mFOWSnrCUaGKm7hewSw2BKigJrbTE_Y2cRoue9KD5ce5Wtw2L-WqBdCWgMJLMY8UmTvYoBCzZm_o6FxwvJSEIYymf4egIOE",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:48:40.572 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 16:48:40.578 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 16:48:40.582 +03:00 [INF] Showing consent: User has not yet consented
2018-04-24 16:48:40.599 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:48:40.602 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:48:40.636 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:48:40.640 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:48:40.644 +03:00 [DBG] No PKCE used.
2018-04-24 16:48:40.647 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:48:48.520 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 16:48:48.526 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:48:48.530 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:48:48.566 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:48:48.570 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:48:48.574 +03:00 [DBG] No PKCE used.
2018-04-24 16:48:48.577 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:48:48.613 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:48:48.617 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:48:48.620 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 16:48:48.623 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 16:48:48.630 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 16:48:48.635 +03:00 [DBG] Start authorize callback request
2018-04-24 16:48:48.642 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:48:48.649 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:48:48.652 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:48:48.655 +03:00 [DBG] No PKCE used.
2018-04-24 16:48:48.658 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:48:48.662 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzZTKbyx_rNC1SurtHZaUDZun9P6QYAO9-cX7InZPqtYJ2xFIbDshYp3gzNOWN_O5M1EdZkRrTSpJsqztZ68ET5-k0m0MrudJywlfDtyqC3MPqqgkC9hosJshnfF2nAWZ1xLFB7HKNOY1ztYONhaY4Z4PcHAmvzEiJ2R89EIAwmnNFV3UQfH3srerAVgNI1an-d05wIRXSXwrSKIEHHD5JkZADpH5BxbR55mFOWSnrCUaGKm7hewSw2BKigJrbTE_Y2cRoue9KD5ce5Wtw2L-WqBdCWgMJLMY8UmTvYoBCzZm_o6FxwvJSEIYymf4egIOE",
  "Nonce": "636601745042437653.NjdmNDk4NmYtYzcwMC00MzQxLTkyNTAtMDJjYzc5NzI3NjRjYWU4MzYyYmItYmQ0YS00Zjk5LTllNmMtYmU2NTdhOTE0ZDlm",
  "SessionId": "612914b316e78661248e5b7420357577",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601745042437653.NjdmNDk4NmYtYzcwMC00MzQxLTkyNTAtMDJjYzc5NzI3NjRjYWU4MzYyYmItYmQ0YS00Zjk5LTllNmMtYmU2NTdhOTE0ZDlm",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hzZTKbyx_rNC1SurtHZaUDZun9P6QYAO9-cX7InZPqtYJ2xFIbDshYp3gzNOWN_O5M1EdZkRrTSpJsqztZ68ET5-k0m0MrudJywlfDtyqC3MPqqgkC9hosJshnfF2nAWZ1xLFB7HKNOY1ztYONhaY4Z4PcHAmvzEiJ2R89EIAwmnNFV3UQfH3srerAVgNI1an-d05wIRXSXwrSKIEHHD5JkZADpH5BxbR55mFOWSnrCUaGKm7hewSw2BKigJrbTE_Y2cRoue9KD5ce5Wtw2L-WqBdCWgMJLMY8UmTvYoBCzZm_o6FxwvJSEIYymf4egIOE",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:48:52.258 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 16:48:52.266 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 16:48:52.278 +03:00 [INF] User consented to scopes: ["openid","profile","api1"]
2018-04-24 16:48:52.302 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1"]
2018-04-24 16:48:52.310 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:48:52.334 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 16:48:52.368 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 16:48:52.388 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 16:48:52.395 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 16:48:52.458 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Enhg"
    },
    {
      "TokenType": "code",
      "TokenValue": "****227f"
    }
  ],
  "ActivityId": "0HLD9T7RVR7JN:0000000B",
  "TimeStamp": "2018-04-24T13:48:52Z",
  "ProcessId": 25848,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:48:52.472 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzZTKbyx_rNC1SurtHZaUDZun9P6QYAO9-cX7InZPqtYJ2xFIbDshYp3gzNOWN_O5M1EdZkRrTSpJsqztZ68ET5-k0m0MrudJywlfDtyqC3MPqqgkC9hosJshnfF2nAWZ1xLFB7HKNOY1ztYONhaY4Z4PcHAmvzEiJ2R89EIAwmnNFV3UQfH3srerAVgNI1an-d05wIRXSXwrSKIEHHD5JkZADpH5BxbR55mFOWSnrCUaGKm7hewSw2BKigJrbTE_Y2cRoue9KD5ce5Wtw2L-WqBdCWgMJLMY8UmTvYoBCzZm_o6FxwvJSEIYymf4egIOE",
  "Scope": "openid profile api1"
}
2018-04-24 16:48:52.501 +03:00 [DBG] Augmenting SignInContext
2018-04-24 16:48:52.505 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-24 16:49:10.602 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-24 16:49:10.611 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-24 16:49:10.617 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-24 16:49:10.630 +03:00 [DBG] Start token request.
2018-04-24 16:49:10.643 +03:00 [DBG] Start client validation
2018-04-24 16:49:10.651 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-24 16:49:10.660 +03:00 [DBG] Start parsing for secret in post body
2018-04-24 16:49:10.663 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-24 16:49:10.666 +03:00 [DBG] Secret id found: mvc
2018-04-24 16:49:10.679 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-24 16:49:10.685 +03:00 [DBG] Client validation success
2018-04-24 16:49:10.697 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD9T7RVR7JS:00000001",
  "TimeStamp": "2018-04-24T13:49:10Z",
  "ProcessId": 25848,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:49:10.717 +03:00 [DBG] Start token request validation
2018-04-24 16:49:10.736 +03:00 [DBG] Start validation of authorization code token request
2018-04-24 16:49:12.843 +03:00 [DBG] Validation of authorization code token request success
2018-04-24 16:49:12.863 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "3945e27455eac389b1a05ad4527c96e2c8183ad2fb43112e62f334bb3b57227f",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "3945e27455eac389b1a05ad4527c96e2c8183ad2fb43112e62f334bb3b57227f",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-24 16:49:12.898 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-24 16:49:12.903 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:49:13.498 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 16:49:13.503 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 16:49:13.519 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****JgPA"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****tR_Q"
    }
  ],
  "ActivityId": "0HLD9T7RVR7JS:00000001",
  "TimeStamp": "2018-04-24T13:49:13Z",
  "ProcessId": 25848,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:49:13.529 +03:00 [DBG] Token request success.
2018-04-24 16:49:13.553 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-24 16:49:13.560 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-24 16:49:13.564 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-24 16:49:13.575 +03:00 [DBG] Start userinfo request
2018-04-24 16:49:13.582 +03:00 [DBG] Bearer token found in header
2018-04-24 16:49:14.760 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-24 16:49:14.766 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524577753,
    "exp": 1524581353,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524577718,
    "idp": "local",
    "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress": "aloo",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-04-24 16:49:15.428 +03:00 [DBG] Creating userinfo response
2018-04-24 16:49:15.438 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 16:49:15.445 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 16:49:15.452 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-24 16:49:15.457 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 16:49:17.119 +03:00 [INF] Profile service returned to the following claim types: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress
2018-04-24 16:49:17.126 +03:00 [DBG] End userinfo request
2018-04-24 16:51:23.651 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:51:23.660 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:51:23.664 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-24 16:51:23.668 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-24 16:51:23.676 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-24 16:51:23.682 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:51:23.685 +03:00 [DBG] Start end session request validation
2018-04-24 16:51:23.689 +03:00 [DBG] Start identity token validation
2018-04-24 16:51:23.692 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-24 16:51:25.136 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-24 16:51:25.142 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524577753,
    "exp": 1524578053,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636601745042437653.NjdmNDk4NmYtYzcwMC00MzQxLTkyNTAtMDJjYzc5NzI3NjRjYWU4MzYyYmItYmQ0YS00Zjk5LTllNmMtYmU2NTdhOTE0ZDlm",
    "iat": 1524577753,
    "at_hash": "m7nD6YXl2ltazvcNErsHSg",
    "sid": "612914b316e78661248e5b7420357577",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524577718,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-24 16:51:25.149 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hwzI1GnJZnRxk0x_IQghSSlJz-zIHDpafa8KGhGS0IPieBsy04xdKmUtN2ZddI47vsDIO5o6kxBtz26QEriKw79ziO8bORU-hGzVjTKG7J1xtTqrSuazpW5ozXfaxe73l5jmZb-eZMGZT_w1kn0JbuM",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQ1Nzc3NTMsImV4cCI6MTUyNDU3ODA1MywiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY2MDE3NDUwNDI0Mzc2NTMuTmpkbU5EazRObVl0WXpjd01DMDBNelF4TFRreU5UQXRNREpqWXpjNU56STNOalJqWVdVNE16WXlZbUl0WW1RMFlTMDBaams1TFRsbE5tTXRZbVUyTlRkaE9URTBaRGxtIiwiaWF0IjoxNTI0NTc3NzUzLCJhdF9oYXNoIjoibTduRDZZWGwybHRhenZjTkVyc0hTZyIsInNpZCI6IjYxMjkxNGIzMTZlNzg2NjEyNDhlNWI3NDIwMzU3NTc3Iiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0NTc3NzE4LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.OgKpLnzRGN488SqCgB5riuauRjCVbXQ9bqTRrMhjL1c7CnZrRTggQji6Y5i5SB7I-sSynoTNtxq9t--m_Fv9WkKTrS1i4OSTy4zVPSo7EeB5ivm0tfJHJUjecbF3MWS3aKTMnus8mZgP2GCJ6khA_zYSFtlWoK9NXf3s6AeBIYmy1jbVdbaiCbJOPVr8_bMvPSlUWqs8r7xr_4AgLUcdZhRoM4BTcA9cpYB8Iy7wKnnvjRQ06d8jeq54Bg7RAFfA-l7Nw4UAsqVjJpGzmx0IUk0Gt3UeeOFlvB4_ySQ5rQhKo198LeD-RleKpXmv4ObUb98TE89SgafHN2CeM4JgPA",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwzI1GnJZnRxk0x_IQghSSlJz-zIHDpafa8KGhGS0IPieBsy04xdKmUtN2ZddI47vsDIO5o6kxBtz26QEriKw79ziO8bORU-hGzVjTKG7J1xtTqrSuazpW5ozXfaxe73l5jmZb-eZMGZT_w1kn0JbuM",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:51:25.162 +03:00 [DBG] Success validating end session request from mvc
2018-04-24 16:51:25.216 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:51:25.223 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:51:25.229 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-24 16:51:25.232 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-24 16:51:25.236 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-24 16:51:25.241 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD9T7RVR7JN:0000000D",
  "TimeStamp": "2018-04-24T13:51:25Z",
  "ProcessId": 25848,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:51:25.588 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-24 16:51:25.595 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-24 16:51:25.600 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-24 16:51:25.606 +03:00 [DBG] Processing signout callback request
2018-04-24 16:51:25.610 +03:00 [DBG] No client front-channel logout URLs
2018-04-24 16:51:25.616 +03:00 [DBG] No client back-channel logout URLs
2018-04-24 16:51:25.621 +03:00 [INF] Successful signout callback.
2018-04-24 16:51:25.626 +03:00 [DBG] No client front-channel iframe urls
2018-04-24 16:51:25.630 +03:00 [DBG] No client back-channel iframe urls
2018-04-24 16:51:33.091 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 16:51:33.106 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 16:51:33.113 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 16:51:33.116 +03:00 [DBG] Start authorize request
2018-04-24 16:51:33.121 +03:00 [DBG] No user present in authorize request
2018-04-24 16:51:33.126 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:51:33.146 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:51:33.155 +03:00 [DBG] No PKCE used.
2018-04-24 16:51:33.158 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:51:33.162 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzOP-ClQ-shf9KFqvJaFPm_QN0D8e1h9-5cZhr2crHaUIWILFbarKm749aRvK_XBI63F3mp1aj4ju44BQ_MWGi8DTvfspIaSUdTkJi1igz3rdXA729JeezZIKoDVM1Wkss06nUqx7Fa6fePeTRjPJ35eOzk0RmVDWaN5AYa77S7gjCPvbXA2pmVd9N5oyX-T5OUp3xgnDojsrH9Vt_xUvPcpUiereAKN8EHTAu5arriBSEzrdYR3irapZSsOLcB4hNVGfZqvxrv2qZcFxosh14CtnPDXIaKvhnINq3fb0yevMqS3rQudTgO0Pgtdpi2POM",
  "Nonce": "636601746930384812.Njk5MGMyODItMjA1MS00MzE1LWE1MTUtNmIwNmQ1OTJkOTRjZTg0ODhmZmQtZWU3My00M2I5LTkzMzYtNGIwYjc3NTQ1NzM4",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601746930384812.Njk5MGMyODItMjA1MS00MzE1LWE1MTUtNmIwNmQ1OTJkOTRjZTg0ODhmZmQtZWU3My00M2I5LTkzMzYtNGIwYjc3NTQ1NzM4",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hzOP-ClQ-shf9KFqvJaFPm_QN0D8e1h9-5cZhr2crHaUIWILFbarKm749aRvK_XBI63F3mp1aj4ju44BQ_MWGi8DTvfspIaSUdTkJi1igz3rdXA729JeezZIKoDVM1Wkss06nUqx7Fa6fePeTRjPJ35eOzk0RmVDWaN5AYa77S7gjCPvbXA2pmVd9N5oyX-T5OUp3xgnDojsrH9Vt_xUvPcpUiereAKN8EHTAu5arriBSEzrdYR3irapZSsOLcB4hNVGfZqvxrv2qZcFxosh14CtnPDXIaKvhnINq3fb0yevMqS3rQudTgO0Pgtdpi2POM",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:51:33.176 +03:00 [INF] Showing login: User is not authenticated
2018-04-24 16:51:33.195 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:51:33.198 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:51:33.201 +03:00 [DBG] No PKCE used.
2018-04-24 16:51:33.204 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:51:37.653 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 16:51:37.958 +03:00 [DBG] Augmenting SignInContext
2018-04-24 16:51:37.962 +03:00 [DBG] Adding idp claim with value: local
2018-04-24 16:51:37.966 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-24 16:51:37.969 +03:00 [DBG] Adding auth_time claim with value: 1524577897
2018-04-24 16:51:37.973 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-24 16:51:38.047 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD9T7RVR7JN:00000011",
  "TimeStamp": "2018-04-24T13:51:38Z",
  "ProcessId": 25848,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:51:38.070 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:51:38.074 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:51:38.077 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 16:51:38.081 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 16:51:38.088 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 16:51:38.099 +03:00 [DBG] Start authorize callback request
2018-04-24 16:51:38.104 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:51:38.108 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:51:38.112 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:51:38.116 +03:00 [DBG] No PKCE used.
2018-04-24 16:51:38.121 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:51:38.129 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzOP-ClQ-shf9KFqvJaFPm_QN0D8e1h9-5cZhr2crHaUIWILFbarKm749aRvK_XBI63F3mp1aj4ju44BQ_MWGi8DTvfspIaSUdTkJi1igz3rdXA729JeezZIKoDVM1Wkss06nUqx7Fa6fePeTRjPJ35eOzk0RmVDWaN5AYa77S7gjCPvbXA2pmVd9N5oyX-T5OUp3xgnDojsrH9Vt_xUvPcpUiereAKN8EHTAu5arriBSEzrdYR3irapZSsOLcB4hNVGfZqvxrv2qZcFxosh14CtnPDXIaKvhnINq3fb0yevMqS3rQudTgO0Pgtdpi2POM",
  "Nonce": "636601746930384812.Njk5MGMyODItMjA1MS00MzE1LWE1MTUtNmIwNmQ1OTJkOTRjZTg0ODhmZmQtZWU3My00M2I5LTkzMzYtNGIwYjc3NTQ1NzM4",
  "SessionId": "a6b1c865b853b5516b4ae8b896315a30",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601746930384812.Njk5MGMyODItMjA1MS00MzE1LWE1MTUtNmIwNmQ1OTJkOTRjZTg0ODhmZmQtZWU3My00M2I5LTkzMzYtNGIwYjc3NTQ1NzM4",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hzOP-ClQ-shf9KFqvJaFPm_QN0D8e1h9-5cZhr2crHaUIWILFbarKm749aRvK_XBI63F3mp1aj4ju44BQ_MWGi8DTvfspIaSUdTkJi1igz3rdXA729JeezZIKoDVM1Wkss06nUqx7Fa6fePeTRjPJ35eOzk0RmVDWaN5AYa77S7gjCPvbXA2pmVd9N5oyX-T5OUp3xgnDojsrH9Vt_xUvPcpUiereAKN8EHTAu5arriBSEzrdYR3irapZSsOLcB4hNVGfZqvxrv2qZcFxosh14CtnPDXIaKvhnINq3fb0yevMqS3rQudTgO0Pgtdpi2POM",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:51:42.063 +03:00 [DBG] Consent found in consent store is same as current request, consent is not required
2018-04-24 16:51:42.071 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 16:51:42.091 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 16:51:42.096 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 16:51:42.104 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 16:51:42.112 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****q7Kg"
    },
    {
      "TokenType": "code",
      "TokenValue": "****c936"
    }
  ],
  "ActivityId": "0HLD9T7RVR7JN:00000012",
  "TimeStamp": "2018-04-24T13:51:42Z",
  "ProcessId": 25848,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:51:42.125 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzOP-ClQ-shf9KFqvJaFPm_QN0D8e1h9-5cZhr2crHaUIWILFbarKm749aRvK_XBI63F3mp1aj4ju44BQ_MWGi8DTvfspIaSUdTkJi1igz3rdXA729JeezZIKoDVM1Wkss06nUqx7Fa6fePeTRjPJ35eOzk0RmVDWaN5AYa77S7gjCPvbXA2pmVd9N5oyX-T5OUp3xgnDojsrH9Vt_xUvPcpUiereAKN8EHTAu5arriBSEzrdYR3irapZSsOLcB4hNVGfZqvxrv2qZcFxosh14CtnPDXIaKvhnINq3fb0yevMqS3rQudTgO0Pgtdpi2POM",
  "Scope": "openid profile api1"
}
2018-04-24 16:51:42.132 +03:00 [DBG] Augmenting SignInContext
2018-04-24 16:51:42.135 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-24 16:58:55.601 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-24 16:58:55.661 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-24 16:58:55.669 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-24 16:58:55.672 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-24 16:58:55.675 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-24 16:58:55.677 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-24 16:58:58.219 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:58:58.242 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:59:23.205 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 16:59:23.218 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 16:59:23.222 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 16:59:23.230 +03:00 [DBG] Start discovery request
2018-04-24 16:59:23.610 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 16:59:23.615 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 16:59:23.619 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 16:59:23.626 +03:00 [DBG] Start key discovery request
2018-04-24 16:59:23.770 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:59:23.776 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:59:23.782 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 16:59:23.793 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 16:59:23.798 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 16:59:23.807 +03:00 [DBG] Start authorize request
2018-04-24 16:59:23.828 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:59:23.838 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:59:23.859 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:59:23.863 +03:00 [DBG] No PKCE used.
2018-04-24 16:59:23.920 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:59:23.948 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hweZw2l9uKOlkJL-6fg9dpdl9HlkP26yHx-db9q3__PH_2YwWrmQZ63GxnCqwM_YMBW-rGTZ_nXe_ZTP2vDW91lTPQAeMVDj_1Q3Inj483D3a9kVyv_9iqnpxcRs05A_K4SmfINaLe7K1uzMmVQVMP3ohMNg0X5BINGHrMRQxDynz34qoo_ZAoJODsDl6YushV6rTcOqZGvTnC3IYb4daUIpPMCWMUSLCIX7ISf4NGHxvhq3d2-GijPeCCpQvVqMP9eaTTGFz4z_v4gJdV4tLyh2QLhYZEsARzgtXaGamRteqCIUfPDEm1uHSJtVkUpfoI",
  "Nonce": "636601751637401084.ZDY2NWMyOGYtMDZhYy00MjM4LTg2OTYtZjM3N2I0Y2JiMDg5M2IxNGVlMDgtODM2Yy00ZWUwLThkMGQtNjFmYWM3ZWJmNDdm",
  "SessionId": "a6b1c865b853b5516b4ae8b896315a30",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636601751637401084.ZDY2NWMyOGYtMDZhYy00MjM4LTg2OTYtZjM3N2I0Y2JiMDg5M2IxNGVlMDgtODM2Yy00ZWUwLThkMGQtNjFmYWM3ZWJmNDdm",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hweZw2l9uKOlkJL-6fg9dpdl9HlkP26yHx-db9q3__PH_2YwWrmQZ63GxnCqwM_YMBW-rGTZ_nXe_ZTP2vDW91lTPQAeMVDj_1Q3Inj483D3a9kVyv_9iqnpxcRs05A_K4SmfINaLe7K1uzMmVQVMP3ohMNg0X5BINGHrMRQxDynz34qoo_ZAoJODsDl6YushV6rTcOqZGvTnC3IYb4daUIpPMCWMUSLCIX7ISf4NGHxvhq3d2-GijPeCCpQvVqMP9eaTTGFz4z_v4gJdV4tLyh2QLhYZEsARzgtXaGamRteqCIUfPDEm1uHSJtVkUpfoI",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:59:27.557 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 16:59:27.563 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 16:59:27.567 +03:00 [INF] Showing consent: User has not yet consented
2018-04-24 16:59:27.590 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:59:27.594 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:59:27.702 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:59:27.706 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:59:27.710 +03:00 [DBG] No PKCE used.
2018-04-24 16:59:27.715 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:59:36.766 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 16:59:36.773 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:59:36.778 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:59:36.831 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:59:36.836 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:59:36.838 +03:00 [DBG] No PKCE used.
2018-04-24 16:59:36.841 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:59:36.888 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:59:36.892 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 16:59:36.896 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 16:59:36.900 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 16:59:36.904 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 16:59:36.915 +03:00 [DBG] Start authorize callback request
2018-04-24 16:59:36.955 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:59:36.961 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 16:59:36.965 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 16:59:36.967 +03:00 [DBG] No PKCE used.
2018-04-24 16:59:36.971 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 16:59:36.975 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hweZw2l9uKOlkJL-6fg9dpdl9HlkP26yHx-db9q3__PH_2YwWrmQZ63GxnCqwM_YMBW-rGTZ_nXe_ZTP2vDW91lTPQAeMVDj_1Q3Inj483D3a9kVyv_9iqnpxcRs05A_K4SmfINaLe7K1uzMmVQVMP3ohMNg0X5BINGHrMRQxDynz34qoo_ZAoJODsDl6YushV6rTcOqZGvTnC3IYb4daUIpPMCWMUSLCIX7ISf4NGHxvhq3d2-GijPeCCpQvVqMP9eaTTGFz4z_v4gJdV4tLyh2QLhYZEsARzgtXaGamRteqCIUfPDEm1uHSJtVkUpfoI",
  "Nonce": "636601751637401084.ZDY2NWMyOGYtMDZhYy00MjM4LTg2OTYtZjM3N2I0Y2JiMDg5M2IxNGVlMDgtODM2Yy00ZWUwLThkMGQtNjFmYWM3ZWJmNDdm",
  "SessionId": "a6b1c865b853b5516b4ae8b896315a30",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636601751637401084.ZDY2NWMyOGYtMDZhYy00MjM4LTg2OTYtZjM3N2I0Y2JiMDg5M2IxNGVlMDgtODM2Yy00ZWUwLThkMGQtNjFmYWM3ZWJmNDdm",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hweZw2l9uKOlkJL-6fg9dpdl9HlkP26yHx-db9q3__PH_2YwWrmQZ63GxnCqwM_YMBW-rGTZ_nXe_ZTP2vDW91lTPQAeMVDj_1Q3Inj483D3a9kVyv_9iqnpxcRs05A_K4SmfINaLe7K1uzMmVQVMP3ohMNg0X5BINGHrMRQxDynz34qoo_ZAoJODsDl6YushV6rTcOqZGvTnC3IYb4daUIpPMCWMUSLCIX7ISf4NGHxvhq3d2-GijPeCCpQvVqMP9eaTTGFz4z_v4gJdV4tLyh2QLhYZEsARzgtXaGamRteqCIUfPDEm1uHSJtVkUpfoI",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 16:59:46.476 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 16:59:46.481 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 16:59:46.497 +03:00 [INF] User consented to scopes: ["openid","email","profile","api1"]
2018-04-24 16:59:46.516 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1"]
2018-04-24 16:59:46.524 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 16:59:46.552 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 16:59:46.593 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 16:59:46.609 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 16:59:46.615 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 16:59:46.729 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile email api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****1tSg"
    },
    {
      "TokenType": "code",
      "TokenValue": "****ec58"
    }
  ],
  "ActivityId": "0HLD9TE2N14OG:00000005",
  "TimeStamp": "2018-04-24T13:59:46Z",
  "ProcessId": 1744,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 16:59:46.741 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hweZw2l9uKOlkJL-6fg9dpdl9HlkP26yHx-db9q3__PH_2YwWrmQZ63GxnCqwM_YMBW-rGTZ_nXe_ZTP2vDW91lTPQAeMVDj_1Q3Inj483D3a9kVyv_9iqnpxcRs05A_K4SmfINaLe7K1uzMmVQVMP3ohMNg0X5BINGHrMRQxDynz34qoo_ZAoJODsDl6YushV6rTcOqZGvTnC3IYb4daUIpPMCWMUSLCIX7ISf4NGHxvhq3d2-GijPeCCpQvVqMP9eaTTGFz4z_v4gJdV4tLyh2QLhYZEsARzgtXaGamRteqCIUfPDEm1uHSJtVkUpfoI",
  "Scope": "openid profile email api1"
}
2018-04-24 17:04:31.695 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-24 17:04:31.707 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-24 17:04:31.711 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-24 17:04:31.724 +03:00 [DBG] Start token request.
2018-04-24 17:04:31.735 +03:00 [DBG] Start client validation
2018-04-24 17:04:31.745 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-24 17:04:31.752 +03:00 [DBG] Start parsing for secret in post body
2018-04-24 17:04:31.756 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-24 17:04:31.761 +03:00 [DBG] Secret id found: mvc
2018-04-24 17:04:31.774 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-24 17:04:31.777 +03:00 [DBG] Client validation success
2018-04-24 17:04:31.787 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD9TE2N14ON:00000001",
  "TimeStamp": "2018-04-24T14:04:31Z",
  "ProcessId": 1744,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 17:04:31.799 +03:00 [DBG] Start token request validation
2018-04-24 17:04:31.814 +03:00 [DBG] Start validation of authorization code token request
2018-04-24 17:04:44.207 +03:00 [DBG] Validation of authorization code token request success
2018-04-24 17:04:44.217 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "699533ccec39714c9a34a6379cc75c0755dfa27aa98f808a4cbd5a34cf5aec58",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "699533ccec39714c9a34a6379cc75c0755dfa27aa98f808a4cbd5a34cf5aec58",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-24 17:04:44.257 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-24 17:04:44.262 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 17:04:52.755 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 17:04:52.759 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 17:04:52.769 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile email api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****vcIA"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****Klsg"
    }
  ],
  "ActivityId": "0HLD9TE2N14ON:00000001",
  "TimeStamp": "2018-04-24T14:04:52Z",
  "ProcessId": 1744,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 17:04:52.785 +03:00 [DBG] Token request success.
2018-04-24 17:04:52.810 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-24 17:04:52.817 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-24 17:04:52.819 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-24 17:04:52.830 +03:00 [DBG] Start userinfo request
2018-04-24 17:04:52.840 +03:00 [DBG] Bearer token found in header
2018-04-24 17:04:53.809 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-24 17:04:53.822 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524578692,
    "exp": 1524582292,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524577897,
    "idp": "local",
    "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress": "aloo",
    "scope": [
      "openid",
      "email",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-04-24 17:04:54.623 +03:00 [DBG] Creating userinfo response
2018-04-24 17:04:54.631 +03:00 [DBG] Scopes in access token: openid email profile api1
2018-04-24 17:04:54.639 +03:00 [DBG] Scopes in access token: openid email profile api1
2018-04-24 17:04:54.647 +03:00 [DBG] Requested claim types: sub email email_verified name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-24 17:04:54.653 +03:00 [DBG] Scopes in access token: openid email profile api1
2018-04-24 17:04:55.494 +03:00 [INF] Profile service returned to the following claim types: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress
2018-04-24 17:04:55.502 +03:00 [DBG] End userinfo request
2018-04-24 17:13:09.558 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-24 17:13:09.620 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-24 17:13:09.626 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-24 17:13:09.628 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-24 17:13:09.631 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-24 17:13:09.632 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-24 17:13:12.046 +03:00 [WRN] Heartbeat took longer than ""00:00:01"" at ""2018-04-24T14:13:12.0395981+00:00"".
2018-04-24 17:13:12.157 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:13:12.181 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:15:25.652 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 17:15:25.663 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 17:15:25.668 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 17:15:25.677 +03:00 [DBG] Start discovery request
2018-04-24 17:15:26.031 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 17:15:26.035 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 17:15:26.038 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 17:15:26.046 +03:00 [DBG] Start key discovery request
2018-04-24 17:15:26.191 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:15:26.197 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:15:26.204 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-24 17:15:26.213 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-24 17:15:26.217 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-24 17:15:26.238 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 17:15:26.251 +03:00 [DBG] Start end session request validation
2018-04-24 17:15:26.264 +03:00 [DBG] Start identity token validation
2018-04-24 17:15:26.308 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-24 17:15:29.700 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-24 17:15:29.711 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524578692,
    "exp": 1524578992,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636601751637401084.ZDY2NWMyOGYtMDZhYy00MjM4LTg2OTYtZjM3N2I0Y2JiMDg5M2IxNGVlMDgtODM2Yy00ZWUwLThkMGQtNjFmYWM3ZWJmNDdm",
    "iat": 1524578692,
    "at_hash": "NFir79fiwqFnu0WbkI5eOQ",
    "sid": "a6b1c865b853b5516b4ae8b896315a30",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524577897,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-24 17:15:29.742 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzcz1lfzwsEKti3iq9lP4xfz3DdBQh6dy2zWyKxoOKmJznpGdGijEbSiPVbgPta78VjRBEmx6UkZbvrEmGTSq6htHIFnzFKrnIxHqPupxRJ3QhRZiDtRkUQ3Y2vcNhHxwJ4R9SjCFKLfHX3DiH8VjZ5",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQ1Nzg2OTIsImV4cCI6MTUyNDU3ODk5MiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY2MDE3NTE2Mzc0MDEwODQuWkRZMk5XTXlPR1l0TURaaFl5MDBNak00TFRnMk9UWXRaak0zTjJJMFkySmlNRGc1TTJJeE5HVmxNRGd0T0RNMll5MDBaV1V3TFRoa01HUXROakZtWVdNM1pXSm1ORGRtIiwiaWF0IjoxNTI0NTc4NjkyLCJhdF9oYXNoIjoiTkZpcjc5Zml3cUZudTBXYmtJNWVPUSIsInNpZCI6ImE2YjFjODY1Yjg1M2I1NTE2YjRhZThiODk2MzE1YTMwIiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0NTc3ODk3LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.nnOjspVg_732Gk_paXgNkHdU3rT-a6CctzXwNSC0iynuEGaI_sROzpKCHp2PjWHJmrszVYvlLnZtL1Y5ZCTDfj_ZrxkMZGP8AqFrWLx8RgbxV3uxZHeUNhFnTClWyq875OIeD5qTBT0CkrBJevMsMwLCW7prE4chR9gKFd4vmdgyJEaX1JsU30bBHr1lkUEt_3Q5DaSXUXNmOBmg48Go-S_MKpfYrD4i-ji9W8tCXHG2ONSLCz9EFtD4M7REKv_QHGo_Q_WQ3_MgaJx1Ljqk30qeTTtTbP5VeCIDfKNPo5Dw4cl3C1aw-zCZS29gTYB8whaHXCR9AtkjDBSA-KvcIA",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hzcz1lfzwsEKti3iq9lP4xfz3DdBQh6dy2zWyKxoOKmJznpGdGijEbSiPVbgPta78VjRBEmx6UkZbvrEmGTSq6htHIFnzFKrnIxHqPupxRJ3QhRZiDtRkUQ3Y2vcNhHxwJ4R9SjCFKLfHX3DiH8VjZ5",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 17:15:29.759 +03:00 [DBG] Success validating end session request from mvc
2018-04-24 17:15:29.796 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:15:29.800 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:15:29.941 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-24 17:15:29.948 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-24 17:15:29.953 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-24 17:15:30.016 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD9TM15J736:00000003",
  "TimeStamp": "2018-04-24T14:15:29Z",
  "ProcessId": 34676,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 17:15:31.254 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-24 17:15:31.262 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-24 17:15:31.269 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-24 17:15:31.278 +03:00 [DBG] Processing signout callback request
2018-04-24 17:15:31.296 +03:00 [DBG] No client front-channel logout URLs
2018-04-24 17:15:31.300 +03:00 [DBG] No client back-channel logout URLs
2018-04-24 17:15:31.303 +03:00 [INF] Successful signout callback.
2018-04-24 17:15:31.306 +03:00 [DBG] No client front-channel iframe urls
2018-04-24 17:15:31.310 +03:00 [DBG] No client back-channel iframe urls
2018-04-24 17:15:35.300 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 17:15:35.309 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 17:15:35.314 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 17:15:35.321 +03:00 [DBG] Start authorize request
2018-04-24 17:15:35.331 +03:00 [DBG] No user present in authorize request
2018-04-24 17:15:35.341 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 17:15:35.357 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 17:15:35.361 +03:00 [DBG] No PKCE used.
2018-04-24 17:15:35.407 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 17:15:35.425 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hw0eA1g9fm3MKVP2UxTp6CJ_8Qf9gNV0-BKnQr53mkdixEd-MVG9KFkV0JJzJKLaKITBoutqi7sY1-Xx55-5cVQyVgKXI5vuMQbUY1fWi28iG_sd3B6cOOy3VXtsDXvmmsLSnF5keTmK-7dr95TnusJcdk6z61k8WkULNwY8XhqbZB1yL4PC0qm6WatbmYZ1m6jTnGFdWN2nIH4nmOe3AXzvPKpSRj02PbG_q3p3NTgvPxiI7eQfM9jCyUtVS7Xg9hPvMevuHNIIpHVtMpitbw8K7tYoIVYTmzfYJ62HvkQ9rJqxD5fFMi5pDwxIRzrae8",
  "Nonce": "636601761352761769.ZjEwMjc5YzMtOGRmZi00NGZiLTljODEtNmQyNDU3MTU5YjM1YzUzYzNlNjktNmJiYi00ZDE0LWI0ZGUtMWMyOTM0MTA3Mzll",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601761352761769.ZjEwMjc5YzMtOGRmZi00NGZiLTljODEtNmQyNDU3MTU5YjM1YzUzYzNlNjktNmJiYi00ZDE0LWI0ZGUtMWMyOTM0MTA3Mzll",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hw0eA1g9fm3MKVP2UxTp6CJ_8Qf9gNV0-BKnQr53mkdixEd-MVG9KFkV0JJzJKLaKITBoutqi7sY1-Xx55-5cVQyVgKXI5vuMQbUY1fWi28iG_sd3B6cOOy3VXtsDXvmmsLSnF5keTmK-7dr95TnusJcdk6z61k8WkULNwY8XhqbZB1yL4PC0qm6WatbmYZ1m6jTnGFdWN2nIH4nmOe3AXzvPKpSRj02PbG_q3p3NTgvPxiI7eQfM9jCyUtVS7Xg9hPvMevuHNIIpHVtMpitbw8K7tYoIVYTmzfYJ62HvkQ9rJqxD5fFMi5pDwxIRzrae8",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 17:15:35.453 +03:00 [INF] Showing login: User is not authenticated
2018-04-24 17:15:35.504 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 17:15:35.508 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 17:15:35.512 +03:00 [DBG] No PKCE used.
2018-04-24 17:15:35.515 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 17:15:43.032 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 17:15:43.233 +03:00 [WRN] Invalid password for user 8dce434c-0b38-4578-9788-7ff306388283.
2018-04-24 17:15:43.237 +03:00 [WRN] User 8dce434c-0b38-4578-9788-7ff306388283 failed to provide the correct password.
2018-04-24 17:15:43.694 +03:00 [INF] {
  "Name": "User Login Failure",
  "Category": "Authentication",
  "EventType": "Failure",
  "Id": 1001,
  "Username": "alice",
  "Endpoint": "UI",
  "Message": "invalid credentials",
  "ActivityId": "0HLD9TM15J736:00000007",
  "TimeStamp": "2018-04-24T14:15:43Z",
  "ProcessId": 34676,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 17:15:43.708 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 17:15:43.712 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 17:15:43.715 +03:00 [DBG] No PKCE used.
2018-04-24 17:15:43.719 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 17:15:48.936 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 17:15:49.584 +03:00 [DBG] Augmenting SignInContext
2018-04-24 17:15:49.591 +03:00 [DBG] Adding idp claim with value: local
2018-04-24 17:15:49.595 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-24 17:15:49.598 +03:00 [DBG] Adding auth_time claim with value: 1524579349
2018-04-24 17:15:49.608 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-24 17:15:49.702 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD9TM15J736:00000008",
  "TimeStamp": "2018-04-24T14:15:49Z",
  "ProcessId": 34676,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 17:15:49.724 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:15:49.727 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:15:49.730 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 17:15:49.734 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 17:15:49.738 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 17:15:49.748 +03:00 [DBG] Start authorize callback request
2018-04-24 17:15:49.761 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 17:15:49.766 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 17:15:49.771 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 17:15:49.774 +03:00 [DBG] No PKCE used.
2018-04-24 17:15:49.777 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 17:15:49.780 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hw0eA1g9fm3MKVP2UxTp6CJ_8Qf9gNV0-BKnQr53mkdixEd-MVG9KFkV0JJzJKLaKITBoutqi7sY1-Xx55-5cVQyVgKXI5vuMQbUY1fWi28iG_sd3B6cOOy3VXtsDXvmmsLSnF5keTmK-7dr95TnusJcdk6z61k8WkULNwY8XhqbZB1yL4PC0qm6WatbmYZ1m6jTnGFdWN2nIH4nmOe3AXzvPKpSRj02PbG_q3p3NTgvPxiI7eQfM9jCyUtVS7Xg9hPvMevuHNIIpHVtMpitbw8K7tYoIVYTmzfYJ62HvkQ9rJqxD5fFMi5pDwxIRzrae8",
  "Nonce": "636601761352761769.ZjEwMjc5YzMtOGRmZi00NGZiLTljODEtNmQyNDU3MTU5YjM1YzUzYzNlNjktNmJiYi00ZDE0LWI0ZGUtMWMyOTM0MTA3Mzll",
  "SessionId": "ff935bfffccf9352e6dba308ed0828c6",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601761352761769.ZjEwMjc5YzMtOGRmZi00NGZiLTljODEtNmQyNDU3MTU5YjM1YzUzYzNlNjktNmJiYi00ZDE0LWI0ZGUtMWMyOTM0MTA3Mzll",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hw0eA1g9fm3MKVP2UxTp6CJ_8Qf9gNV0-BKnQr53mkdixEd-MVG9KFkV0JJzJKLaKITBoutqi7sY1-Xx55-5cVQyVgKXI5vuMQbUY1fWi28iG_sd3B6cOOy3VXtsDXvmmsLSnF5keTmK-7dr95TnusJcdk6z61k8WkULNwY8XhqbZB1yL4PC0qm6WatbmYZ1m6jTnGFdWN2nIH4nmOe3AXzvPKpSRj02PbG_q3p3NTgvPxiI7eQfM9jCyUtVS7Xg9hPvMevuHNIIpHVtMpitbw8K7tYoIVYTmzfYJ62HvkQ9rJqxD5fFMi5pDwxIRzrae8",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 17:15:49.886 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 17:15:49.891 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 17:15:49.894 +03:00 [INF] Showing consent: User has not yet consented
2018-04-24 17:15:49.909 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:15:49.915 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:15:49.948 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 17:15:49.952 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 17:15:49.956 +03:00 [DBG] No PKCE used.
2018-04-24 17:15:49.960 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 17:15:53.465 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 17:15:53.478 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:15:53.483 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:15:53.524 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 17:15:53.528 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 17:15:53.530 +03:00 [DBG] No PKCE used.
2018-04-24 17:15:53.533 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 17:15:53.569 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:15:53.573 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:15:53.577 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 17:15:53.580 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 17:15:53.583 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 17:15:53.587 +03:00 [DBG] Start authorize callback request
2018-04-24 17:15:53.593 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 17:15:53.600 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 17:15:53.603 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 17:15:53.606 +03:00 [DBG] No PKCE used.
2018-04-24 17:15:53.609 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 17:15:53.616 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hw0eA1g9fm3MKVP2UxTp6CJ_8Qf9gNV0-BKnQr53mkdixEd-MVG9KFkV0JJzJKLaKITBoutqi7sY1-Xx55-5cVQyVgKXI5vuMQbUY1fWi28iG_sd3B6cOOy3VXtsDXvmmsLSnF5keTmK-7dr95TnusJcdk6z61k8WkULNwY8XhqbZB1yL4PC0qm6WatbmYZ1m6jTnGFdWN2nIH4nmOe3AXzvPKpSRj02PbG_q3p3NTgvPxiI7eQfM9jCyUtVS7Xg9hPvMevuHNIIpHVtMpitbw8K7tYoIVYTmzfYJ62HvkQ9rJqxD5fFMi5pDwxIRzrae8",
  "Nonce": "636601761352761769.ZjEwMjc5YzMtOGRmZi00NGZiLTljODEtNmQyNDU3MTU5YjM1YzUzYzNlNjktNmJiYi00ZDE0LWI0ZGUtMWMyOTM0MTA3Mzll",
  "SessionId": "ff935bfffccf9352e6dba308ed0828c6",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601761352761769.ZjEwMjc5YzMtOGRmZi00NGZiLTljODEtNmQyNDU3MTU5YjM1YzUzYzNlNjktNmJiYi00ZDE0LWI0ZGUtMWMyOTM0MTA3Mzll",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hw0eA1g9fm3MKVP2UxTp6CJ_8Qf9gNV0-BKnQr53mkdixEd-MVG9KFkV0JJzJKLaKITBoutqi7sY1-Xx55-5cVQyVgKXI5vuMQbUY1fWi28iG_sd3B6cOOy3VXtsDXvmmsLSnF5keTmK-7dr95TnusJcdk6z61k8WkULNwY8XhqbZB1yL4PC0qm6WatbmYZ1m6jTnGFdWN2nIH4nmOe3AXzvPKpSRj02PbG_q3p3NTgvPxiI7eQfM9jCyUtVS7Xg9hPvMevuHNIIpHVtMpitbw8K7tYoIVYTmzfYJ62HvkQ9rJqxD5fFMi5pDwxIRzrae8",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 17:15:53.711 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 17:15:53.717 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 17:15:53.732 +03:00 [INF] User consented to scopes: ["openid","profile","api1"]
2018-04-24 17:15:53.747 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1"]
2018-04-24 17:15:53.755 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 17:15:53.779 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 17:15:53.811 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 17:15:53.825 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 17:15:53.831 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 17:15:53.883 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****eHMg"
    },
    {
      "TokenType": "code",
      "TokenValue": "****9323"
    }
  ],
  "ActivityId": "0HLD9TM15J736:0000000C",
  "TimeStamp": "2018-04-24T14:15:53Z",
  "ProcessId": 34676,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 17:15:53.897 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hw0eA1g9fm3MKVP2UxTp6CJ_8Qf9gNV0-BKnQr53mkdixEd-MVG9KFkV0JJzJKLaKITBoutqi7sY1-Xx55-5cVQyVgKXI5vuMQbUY1fWi28iG_sd3B6cOOy3VXtsDXvmmsLSnF5keTmK-7dr95TnusJcdk6z61k8WkULNwY8XhqbZB1yL4PC0qm6WatbmYZ1m6jTnGFdWN2nIH4nmOe3AXzvPKpSRj02PbG_q3p3NTgvPxiI7eQfM9jCyUtVS7Xg9hPvMevuHNIIpHVtMpitbw8K7tYoIVYTmzfYJ62HvkQ9rJqxD5fFMi5pDwxIRzrae8",
  "Scope": "openid profile api1"
}
2018-04-24 17:15:53.920 +03:00 [DBG] Augmenting SignInContext
2018-04-24 17:15:53.924 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-24 17:15:54.351 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-24 17:15:54.360 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-24 17:15:54.364 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-24 17:15:54.379 +03:00 [DBG] Start token request.
2018-04-24 17:15:54.390 +03:00 [DBG] Start client validation
2018-04-24 17:15:54.400 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-24 17:15:54.409 +03:00 [DBG] Start parsing for secret in post body
2018-04-24 17:15:54.413 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-24 17:15:54.417 +03:00 [DBG] Secret id found: mvc
2018-04-24 17:15:54.434 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-24 17:15:54.438 +03:00 [DBG] Client validation success
2018-04-24 17:15:54.449 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD9TM15J739:00000003",
  "TimeStamp": "2018-04-24T14:15:54Z",
  "ProcessId": 34676,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 17:15:54.463 +03:00 [DBG] Start token request validation
2018-04-24 17:15:54.478 +03:00 [DBG] Start validation of authorization code token request
2018-04-24 17:15:54.589 +03:00 [DBG] Validation of authorization code token request success
2018-04-24 17:15:54.598 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "85a7f21db929e1337ab5e45fbedb39f34c57fbaf217f15f1902c7b40fce39323",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "85a7f21db929e1337ab5e45fbedb39f34c57fbaf217f15f1902c7b40fce39323",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-24 17:15:54.637 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-24 17:15:54.643 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 17:15:54.655 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 17:15:54.660 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 17:15:54.670 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****ey3w"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****G1lw"
    }
  ],
  "ActivityId": "0HLD9TM15J739:00000003",
  "TimeStamp": "2018-04-24T14:15:54Z",
  "ProcessId": 34676,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 17:15:54.677 +03:00 [DBG] Token request success.
2018-04-24 17:15:54.717 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-24 17:15:54.722 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-24 17:15:54.726 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-24 17:15:54.738 +03:00 [DBG] Start userinfo request
2018-04-24 17:15:54.746 +03:00 [DBG] Bearer token found in header
2018-04-24 17:15:54.854 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-24 17:15:54.859 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524579354,
    "exp": 1524582954,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524579349,
    "idp": "local",
    "email": "alice@email.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-04-24 17:15:54.871 +03:00 [DBG] Creating userinfo response
2018-04-24 17:15:54.879 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 17:15:54.888 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 17:15:54.895 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-24 17:15:54.900 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 17:15:54.905 +03:00 [INF] Profile service returned to the following claim types: email
2018-04-24 17:15:54.910 +03:00 [DBG] End userinfo request
2018-04-24 17:26:59.606 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-24 17:26:59.670 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-24 17:26:59.676 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-24 17:26:59.678 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-24 17:26:59.681 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-24 17:26:59.684 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-24 17:27:02.462 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:27:02.486 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:27:12.971 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-24 17:27:12.985 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-24 17:27:12.989 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-24 17:27:12.999 +03:00 [DBG] Start discovery request
2018-04-24 17:27:13.450 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-24 17:27:13.457 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-24 17:27:13.460 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-24 17:27:13.467 +03:00 [DBG] Start key discovery request
2018-04-24 17:27:13.596 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:27:13.602 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:27:13.606 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-24 17:27:13.613 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-24 17:27:13.617 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-24 17:27:13.637 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 17:27:13.652 +03:00 [DBG] Start end session request validation
2018-04-24 17:27:13.665 +03:00 [DBG] Start identity token validation
2018-04-24 17:27:13.714 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-24 17:27:17.409 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-24 17:27:17.423 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524579354,
    "exp": 1524579654,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636601761352761769.ZjEwMjc5YzMtOGRmZi00NGZiLTljODEtNmQyNDU3MTU5YjM1YzUzYzNlNjktNmJiYi00ZDE0LWI0ZGUtMWMyOTM0MTA3Mzll",
    "iat": 1524579354,
    "at_hash": "FCxfsNl_yiHXtwGevVkeKg",
    "sid": "ff935bfffccf9352e6dba308ed0828c6",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524579349,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-24 17:27:17.447 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hywYwsgsV15pA2pF_2IHc3zSDOAIyzbXuB3XZaPnt5xW1jJT-nk4u7EgJpvqIbBXeOievEPnG1aMmvGNqdGYTM7V_VAVhgEaID6wjE7MzjsqxUr-S3CD1YgR-U1hdOPhu84S5NpAlSbHFMft-JmAqry",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQ1NzkzNTQsImV4cCI6MTUyNDU3OTY1NCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY2MDE3NjEzNTI3NjE3NjkuWmpFd01qYzVZek10T0dSbVppMDBOR1ppTFRsak9ERXRObVF5TkRVM01UVTVZak0xWXpVell6TmxOamt0Tm1KaVlpMDBaREUwTFdJMFpHVXRNV015T1RNME1UQTNNemxsIiwiaWF0IjoxNTI0NTc5MzU0LCJhdF9oYXNoIjoiRkN4ZnNObF95aUhYdHdHZXZWa2VLZyIsInNpZCI6ImZmOTM1YmZmZmNjZjkzNTJlNmRiYTMwOGVkMDgyOGM2Iiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0NTc5MzQ5LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.JhNx2XZC8kbKF0TrjHVyfK3AEfY4OODLJrreNrPZDZr7AfkUaRg19vDXFyR1LLCnsqetjhgkgpxyKjMoGj9MC91K-sYH0szg79ErQkhcFeDRmrflSdeole7YA3V6fXOFrwQyKdjZTbvm_5a3BGHViIZkKCP308WDMRHbo69-xxSskn2kLEYRylRVpDxBJIGLSrqkZ4xTjpDOr7OAsE41AFK_Uc3GejpHelRuRTHZztUB19a4c0xD-c0gkSPIbJtOCZeVgoT87kfxuIo5VeZgPdtW-qzC2DPR0C6kd4B4_njfCRA3PFMfiB3xx1RVs4nofzF3U-U1cSGowdMo74ey3w",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hywYwsgsV15pA2pF_2IHc3zSDOAIyzbXuB3XZaPnt5xW1jJT-nk4u7EgJpvqIbBXeOievEPnG1aMmvGNqdGYTM7V_VAVhgEaID6wjE7MzjsqxUr-S3CD1YgR-U1hdOPhu84S5NpAlSbHFMft-JmAqry",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 17:27:17.464 +03:00 [DBG] Success validating end session request from mvc
2018-04-24 17:27:17.501 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:27:17.505 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:27:17.623 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-24 17:27:17.630 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-24 17:27:17.635 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-24 17:27:17.692 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLD9TTOFQ8QJ:00000003",
  "TimeStamp": "2018-04-24T14:27:17Z",
  "ProcessId": 14860,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 17:27:18.961 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-24 17:27:18.968 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-24 17:27:18.973 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-24 17:27:18.982 +03:00 [DBG] Processing signout callback request
2018-04-24 17:27:19.002 +03:00 [DBG] No client front-channel logout URLs
2018-04-24 17:27:19.006 +03:00 [DBG] No client back-channel logout URLs
2018-04-24 17:27:19.011 +03:00 [INF] Successful signout callback.
2018-04-24 17:27:19.013 +03:00 [DBG] No client front-channel iframe urls
2018-04-24 17:27:19.018 +03:00 [DBG] No client back-channel iframe urls
2018-04-24 17:27:34.311 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-24 17:27:34.320 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-24 17:27:34.323 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-24 17:27:34.333 +03:00 [DBG] Start authorize request
2018-04-24 17:27:34.343 +03:00 [DBG] No user present in authorize request
2018-04-24 17:27:34.352 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 17:27:34.367 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 17:27:34.371 +03:00 [DBG] No PKCE used.
2018-04-24 17:27:34.423 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 17:27:34.442 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hyxTqoQ2aK5pGwgtx4mlDUuXxDZI7CRy7h6ArNVMrDJ9vjJg1UilUtkiXhR2_DuVcm_mXgA7_FKhPFvmQqk4CMKPlbjpimtbJajrEkOxyINIMLvWRAmV09Jc3FD30y_cwQacvpQywS8v0YvAB7EcNeOj_NiOsZyaJ17ESWSpWEulRhx16ai0bbv7dN08kfKxz64aIFXK_CwWhzN1N48sFWZ4-TfwCUi6jXpmQZFL_0W6KJn4I8H80rRlF51x_KIilcqYggznw6x6kz7qTxdlPe9yLcTJ4U8y6jmeoxvQU3t5UyCizCyZvIJfd0LSwjWMew",
  "Nonce": "636601768542904244.Y2E4OWVkYWMtZDRlZS00OTcwLWIyZWMtNzU4YzQ5NGMyYjI5Zjg4OGM0MmItZDkwZS00YjQ3LWEyYmUtM2JjMjg0ZjIwNWZh",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601768542904244.Y2E4OWVkYWMtZDRlZS00OTcwLWIyZWMtNzU4YzQ5NGMyYjI5Zjg4OGM0MmItZDkwZS00YjQ3LWEyYmUtM2JjMjg0ZjIwNWZh",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hyxTqoQ2aK5pGwgtx4mlDUuXxDZI7CRy7h6ArNVMrDJ9vjJg1UilUtkiXhR2_DuVcm_mXgA7_FKhPFvmQqk4CMKPlbjpimtbJajrEkOxyINIMLvWRAmV09Jc3FD30y_cwQacvpQywS8v0YvAB7EcNeOj_NiOsZyaJ17ESWSpWEulRhx16ai0bbv7dN08kfKxz64aIFXK_CwWhzN1N48sFWZ4-TfwCUi6jXpmQZFL_0W6KJn4I8H80rRlF51x_KIilcqYggznw6x6kz7qTxdlPe9yLcTJ4U8y6jmeoxvQU3t5UyCizCyZvIJfd0LSwjWMew",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 17:27:34.473 +03:00 [INF] Showing login: User is not authenticated
2018-04-24 17:27:34.526 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 17:27:34.530 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 17:27:34.534 +03:00 [DBG] No PKCE used.
2018-04-24 17:27:34.538 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 17:27:44.214 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 17:27:44.764 +03:00 [DBG] Augmenting SignInContext
2018-04-24 17:27:44.772 +03:00 [DBG] Adding idp claim with value: local
2018-04-24 17:27:44.775 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-24 17:27:44.779 +03:00 [DBG] Adding auth_time claim with value: 1524580064
2018-04-24 17:27:44.792 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-24 17:27:44.923 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLD9TTOFQ8QJ:00000007",
  "TimeStamp": "2018-04-24T14:27:44Z",
  "ProcessId": 14860,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 17:27:44.955 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:27:44.959 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:27:44.964 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 17:27:44.974 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 17:27:44.979 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 17:27:44.989 +03:00 [DBG] Start authorize callback request
2018-04-24 17:27:45.000 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 17:27:45.006 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 17:27:45.010 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 17:27:45.013 +03:00 [DBG] No PKCE used.
2018-04-24 17:27:45.017 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 17:27:45.022 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hyxTqoQ2aK5pGwgtx4mlDUuXxDZI7CRy7h6ArNVMrDJ9vjJg1UilUtkiXhR2_DuVcm_mXgA7_FKhPFvmQqk4CMKPlbjpimtbJajrEkOxyINIMLvWRAmV09Jc3FD30y_cwQacvpQywS8v0YvAB7EcNeOj_NiOsZyaJ17ESWSpWEulRhx16ai0bbv7dN08kfKxz64aIFXK_CwWhzN1N48sFWZ4-TfwCUi6jXpmQZFL_0W6KJn4I8H80rRlF51x_KIilcqYggznw6x6kz7qTxdlPe9yLcTJ4U8y6jmeoxvQU3t5UyCizCyZvIJfd0LSwjWMew",
  "Nonce": "636601768542904244.Y2E4OWVkYWMtZDRlZS00OTcwLWIyZWMtNzU4YzQ5NGMyYjI5Zjg4OGM0MmItZDkwZS00YjQ3LWEyYmUtM2JjMjg0ZjIwNWZh",
  "SessionId": "4dccf871be33e5e0ddab480d447ff205",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601768542904244.Y2E4OWVkYWMtZDRlZS00OTcwLWIyZWMtNzU4YzQ5NGMyYjI5Zjg4OGM0MmItZDkwZS00YjQ3LWEyYmUtM2JjMjg0ZjIwNWZh",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hyxTqoQ2aK5pGwgtx4mlDUuXxDZI7CRy7h6ArNVMrDJ9vjJg1UilUtkiXhR2_DuVcm_mXgA7_FKhPFvmQqk4CMKPlbjpimtbJajrEkOxyINIMLvWRAmV09Jc3FD30y_cwQacvpQywS8v0YvAB7EcNeOj_NiOsZyaJ17ESWSpWEulRhx16ai0bbv7dN08kfKxz64aIFXK_CwWhzN1N48sFWZ4-TfwCUi6jXpmQZFL_0W6KJn4I8H80rRlF51x_KIilcqYggznw6x6kz7qTxdlPe9yLcTJ4U8y6jmeoxvQU3t5UyCizCyZvIJfd0LSwjWMew",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 17:27:45.160 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 17:27:45.168 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 17:27:45.171 +03:00 [INF] Showing consent: User has not yet consented
2018-04-24 17:27:45.187 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:27:45.190 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:27:45.220 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 17:27:45.224 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 17:27:45.228 +03:00 [DBG] No PKCE used.
2018-04-24 17:27:45.232 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 17:27:49.006 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-24 17:27:49.011 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:27:49.016 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:27:49.054 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 17:27:49.058 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 17:27:49.062 +03:00 [DBG] No PKCE used.
2018-04-24 17:27:49.065 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 17:27:49.105 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:27:49.109 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 17:27:49.112 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-24 17:27:49.115 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-24 17:27:49.119 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-24 17:27:49.125 +03:00 [DBG] Start authorize callback request
2018-04-24 17:27:49.132 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 17:27:49.137 +03:00 [DBG] Start authorize request protocol validation
2018-04-24 17:27:49.142 +03:00 [DBG] Checking for PKCE parameters
2018-04-24 17:27:49.146 +03:00 [DBG] No PKCE used.
2018-04-24 17:27:49.149 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-24 17:27:49.153 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hyxTqoQ2aK5pGwgtx4mlDUuXxDZI7CRy7h6ArNVMrDJ9vjJg1UilUtkiXhR2_DuVcm_mXgA7_FKhPFvmQqk4CMKPlbjpimtbJajrEkOxyINIMLvWRAmV09Jc3FD30y_cwQacvpQywS8v0YvAB7EcNeOj_NiOsZyaJ17ESWSpWEulRhx16ai0bbv7dN08kfKxz64aIFXK_CwWhzN1N48sFWZ4-TfwCUi6jXpmQZFL_0W6KJn4I8H80rRlF51x_KIilcqYggznw6x6kz7qTxdlPe9yLcTJ4U8y6jmeoxvQU3t5UyCizCyZvIJfd0LSwjWMew",
  "Nonce": "636601768542904244.Y2E4OWVkYWMtZDRlZS00OTcwLWIyZWMtNzU4YzQ5NGMyYjI5Zjg4OGM0MmItZDkwZS00YjQ3LWEyYmUtM2JjMjg0ZjIwNWZh",
  "SessionId": "4dccf871be33e5e0ddab480d447ff205",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636601768542904244.Y2E4OWVkYWMtZDRlZS00OTcwLWIyZWMtNzU4YzQ5NGMyYjI5Zjg4OGM0MmItZDkwZS00YjQ3LWEyYmUtM2JjMjg0ZjIwNWZh",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hyxTqoQ2aK5pGwgtx4mlDUuXxDZI7CRy7h6ArNVMrDJ9vjJg1UilUtkiXhR2_DuVcm_mXgA7_FKhPFvmQqk4CMKPlbjpimtbJajrEkOxyINIMLvWRAmV09Jc3FD30y_cwQacvpQywS8v0YvAB7EcNeOj_NiOsZyaJ17ESWSpWEulRhx16ai0bbv7dN08kfKxz64aIFXK_CwWhzN1N48sFWZ4-TfwCUi6jXpmQZFL_0W6KJn4I8H80rRlF51x_KIilcqYggznw6x6kz7qTxdlPe9yLcTJ4U8y6jmeoxvQU3t5UyCizCyZvIJfd0LSwjWMew",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-24 17:27:49.266 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-24 17:27:49.270 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-24 17:27:49.284 +03:00 [INF] User consented to scopes: ["openid","profile","api1"]
2018-04-24 17:27:49.302 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1"]
2018-04-24 17:27:49.312 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 17:27:49.333 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-24 17:27:49.365 +03:00 [DBG] Creating Implicit Flow response.
2018-04-24 17:27:49.382 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 17:27:49.389 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 17:27:49.445 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****cjlg"
    },
    {
      "TokenType": "code",
      "TokenValue": "****e240"
    }
  ],
  "ActivityId": "0HLD9TTOFQ8QJ:0000000B",
  "TimeStamp": "2018-04-24T14:27:49Z",
  "ProcessId": 14860,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 17:27:49.461 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hyxTqoQ2aK5pGwgtx4mlDUuXxDZI7CRy7h6ArNVMrDJ9vjJg1UilUtkiXhR2_DuVcm_mXgA7_FKhPFvmQqk4CMKPlbjpimtbJajrEkOxyINIMLvWRAmV09Jc3FD30y_cwQacvpQywS8v0YvAB7EcNeOj_NiOsZyaJ17ESWSpWEulRhx16ai0bbv7dN08kfKxz64aIFXK_CwWhzN1N48sFWZ4-TfwCUi6jXpmQZFL_0W6KJn4I8H80rRlF51x_KIilcqYggznw6x6kz7qTxdlPe9yLcTJ4U8y6jmeoxvQU3t5UyCizCyZvIJfd0LSwjWMew",
  "Scope": "openid profile api1"
}
2018-04-24 17:27:49.483 +03:00 [DBG] Augmenting SignInContext
2018-04-24 17:27:49.487 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-24 17:27:49.852 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-24 17:27:49.860 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-24 17:27:49.864 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-24 17:27:49.877 +03:00 [DBG] Start token request.
2018-04-24 17:27:49.888 +03:00 [DBG] Start client validation
2018-04-24 17:27:49.898 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-24 17:27:49.907 +03:00 [DBG] Start parsing for secret in post body
2018-04-24 17:27:49.911 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-24 17:27:49.914 +03:00 [DBG] Secret id found: mvc
2018-04-24 17:27:49.932 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-24 17:27:49.935 +03:00 [DBG] Client validation success
2018-04-24 17:27:49.946 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLD9TTOFQ8QK:00000003",
  "TimeStamp": "2018-04-24T14:27:49Z",
  "ProcessId": 14860,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 17:27:49.962 +03:00 [DBG] Start token request validation
2018-04-24 17:27:49.978 +03:00 [DBG] Start validation of authorization code token request
2018-04-24 17:27:50.126 +03:00 [DBG] Validation of authorization code token request success
2018-04-24 17:27:50.136 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "6f86626058a23de91c8fbfb58185f784da048e911b9a7f14538d3f5f783fe240",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "6f86626058a23de91c8fbfb58185f784da048e911b9a7f14538d3f5f783fe240",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-24 17:27:50.169 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-24 17:27:50.173 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-24 17:27:50.184 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-24 17:27:50.189 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-24 17:27:50.202 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****J_Aw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****WYPg"
    }
  ],
  "ActivityId": "0HLD9TTOFQ8QK:00000003",
  "TimeStamp": "2018-04-24T14:27:50Z",
  "ProcessId": 14860,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-24 17:27:50.213 +03:00 [DBG] Token request success.
2018-04-24 17:27:50.244 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-24 17:27:50.253 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-24 17:27:50.256 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-24 17:27:50.268 +03:00 [DBG] Start userinfo request
2018-04-24 17:27:50.278 +03:00 [DBG] Bearer token found in header
2018-04-24 17:27:50.416 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-24 17:27:50.422 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524580070,
    "exp": 1524583670,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524580064,
    "idp": "local",
    "email": "alice@email.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-04-24 17:27:50.433 +03:00 [DBG] Creating userinfo response
2018-04-24 17:27:50.443 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 17:27:50.453 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 17:27:50.459 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-24 17:27:50.464 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-24 17:27:50.468 +03:00 [INF] Profile service returned to the following claim types: email
2018-04-24 17:27:50.475 +03:00 [DBG] End userinfo request
2018-04-24 18:13:43.459 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-24 18:13:43.539 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-24 18:13:43.546 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-24 18:13:43.547 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-24 18:13:43.550 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-24 18:13:43.550 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-24 18:13:46.435 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-24 18:13:46.461 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-25 09:11:49.988 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-25 09:11:50.048 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-25 09:11:50.054 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-25 09:11:50.054 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-25 09:11:50.055 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-25 09:11:50.055 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-25 09:11:52.652 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-25 09:11:52.674 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 09:16:25.843 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-26 09:16:25.925 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-26 09:16:25.931 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-26 09:16:25.932 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-26 09:16:25.933 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-26 09:16:25.933 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-26 09:16:29.157 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 09:16:29.186 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 09:18:51.445 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-26 09:18:51.517 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-26 09:18:51.523 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-26 09:18:51.524 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-26 09:18:51.525 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-26 09:18:51.526 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-26 09:18:52.064 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 09:18:52.088 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 09:19:57.660 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-26 09:19:57.708 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-26 09:19:57.713 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-26 09:19:57.713 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-26 09:19:57.713 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-26 09:19:57.714 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-26 09:19:58.281 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 09:19:58.301 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:20:55.533 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-26 13:20:55.756 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-26 13:20:55.758 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-26 13:20:55.766 +03:00 [DBG] Start discovery request
2018-04-26 13:20:56.512 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-26 13:20:56.516 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-26 13:20:56.546 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-26 13:20:56.551 +03:00 [DBG] Start key discovery request
2018-04-26 13:20:59.134 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:20:59.137 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:20:59.141 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-26 13:20:59.148 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-26 13:20:59.150 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-26 13:20:59.165 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-26 13:20:59.178 +03:00 [DBG] Start end session request validation
2018-04-26 13:20:59.190 +03:00 [DBG] Start identity token validation
2018-04-26 13:20:59.247 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-26 13:20:59.319 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-26 13:20:59.330 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524580070,
    "exp": 1524580370,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636601768542904244.Y2E4OWVkYWMtZDRlZS00OTcwLWIyZWMtNzU4YzQ5NGMyYjI5Zjg4OGM0MmItZDkwZS00YjQ3LWEyYmUtM2JjMjg0ZjIwNWZh",
    "iat": 1524580070,
    "at_hash": "9Gv1Pl_cy5fDEDijA-4yPw",
    "sid": "4dccf871be33e5e0ddab480d447ff205",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524580064,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-26 13:20:59.373 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hyRZjd25K0IHJnTpLxDLK4bvRSf3SWams8-lsUFw5utyPPhdwfCKu4ATA5n6NsOxv_hR8x8XKPcLKcSnHp-9ZqsGlDnp6l1g0MVOZ8G7_lc2bFg4gimO68XKdd0zf67MSlzXfz_9ikgj5xLqzoQASOC",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQ1ODAwNzAsImV4cCI6MTUyNDU4MDM3MCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY2MDE3Njg1NDI5MDQyNDQuWTJFNE9XVmtZV010WkRSbFpTMDBPVGN3TFdJeVpXTXROelU0WXpRNU5HTXlZakk1WmpnNE9HTTBNbUl0WkRrd1pTMDBZalEzTFdFeVltVXRNMkpqTWpnMFpqSXdOV1poIiwiaWF0IjoxNTI0NTgwMDcwLCJhdF9oYXNoIjoiOUd2MVBsX2N5NWZERURpakEtNHlQdyIsInNpZCI6IjRkY2NmODcxYmUzM2U1ZTBkZGFiNDgwZDQ0N2ZmMjA1Iiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0NTgwMDY0LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.bjd8HCOvGrfPqUx_0KaAFFNUCgNU4oU0B5IQKH6Ufq9l6kV8U4vGUgC0sJxzLu-Qo7Tn0wM6daBjPfFsIrowaNLUd6FfDkwJgylx_3WUL9kaxVYZjKhSnkoNhldepynzgQeQlzjs8EkaZ2F_mbcBjU-MwOH31wHRnsPo_rtZR9E6qD5sJRocXn-TX_J-ZXhdVbo7UEC14ltsUuQthRbQFf0bhdyjBaDXfhLlR-CBH6Lxq1hD01vcKuU3oeesS6rcnGT6Uv9IFmWKO6fnSF8tvsGJl52CZBSqb1wJcRkLrXd-e54_VSpOO7YNLfznD6uK2wmdOrQ7ggNVmLRJpoJ_Aw",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hyRZjd25K0IHJnTpLxDLK4bvRSf3SWams8-lsUFw5utyPPhdwfCKu4ATA5n6NsOxv_hR8x8XKPcLKcSnHp-9ZqsGlDnp6l1g0MVOZ8G7_lc2bFg4gimO68XKdd0zf67MSlzXfz_9ikgj5xLqzoQASOC",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 13:20:59.380 +03:00 [DBG] Success validating end session request from mvc
2018-04-26 13:20:59.419 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:20:59.420 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:20:59.564 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-26 13:20:59.569 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-26 13:20:59.571 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-26 13:20:59.628 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLDB7MU01MCN:00000002",
  "TimeStamp": "2018-04-26T10:20:59Z",
  "ProcessId": 4376,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 13:21:00.802 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-26 13:21:00.809 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-26 13:21:00.812 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-26 13:21:00.827 +03:00 [DBG] Processing signout callback request
2018-04-26 13:21:00.840 +03:00 [DBG] No client front-channel logout URLs
2018-04-26 13:21:00.841 +03:00 [DBG] No client back-channel logout URLs
2018-04-26 13:21:00.841 +03:00 [INF] Successful signout callback.
2018-04-26 13:21:00.843 +03:00 [DBG] No client front-channel iframe urls
2018-04-26 13:21:00.847 +03:00 [DBG] No client back-channel iframe urls
2018-04-26 13:21:38.915 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-26 13:21:38.923 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-26 13:21:38.925 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-26 13:21:38.934 +03:00 [DBG] Start authorize request
2018-04-26 13:21:38.942 +03:00 [DBG] No user present in authorize request
2018-04-26 13:21:38.951 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 13:21:39.017 +03:00 [ERR] Invalid redirect_uri: http://localhost:5002/signin-oidc
{
  "ClientId": "client",
  "AllowedRedirectUris": [],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603348988920278.NWQ2MTg2NzQtOGE0My00YTkwLWEzMmUtNDAwYmExMjk3YWUzMTkwMzI1MTUtOTc2OS00ZjA0LTk1ZjMtMmYwYTU5NDU3MWQw",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hyheEidNY8QYIy9Y8EB_-qITCU6R8azF3NkL-y0yt-PtsRg2FWQwPdUjy1HaiTBZodR7MaFFNQ4ths85V3bJ7OyVNzg68jTb_CceOjK9BrQSnyqEhFq7utbFpZeKEljdR_umZFxVyAnyy6-BnZiSdjppaQkgYQl-5TRFtZSFvmzKc6No2m4vAuLOCHEmOZbrdKPd-CC_h2b7nMknStSlBFmFXen9UXeUzMJ55G9BBLi3hDjWksRdZKnPEpBEmAI7U5Ws_mG7CrEMbzs7J0xbLQvb1eWUIp5sWNMIKhrNx75u2yhdor0UpXRaNSbHAZ19n8",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 13:21:39.028 +03:00 [ERR] Request validation failed
2018-04-26 13:21:39.030 +03:00 [INF] {
  "ClientId": "client",
  "AllowedRedirectUris": [],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603348988920278.NWQ2MTg2NzQtOGE0My00YTkwLWEzMmUtNDAwYmExMjk3YWUzMTkwMzI1MTUtOTc2OS00ZjA0LTk1ZjMtMmYwYTU5NDU3MWQw",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hyheEidNY8QYIy9Y8EB_-qITCU6R8azF3NkL-y0yt-PtsRg2FWQwPdUjy1HaiTBZodR7MaFFNQ4ths85V3bJ7OyVNzg68jTb_CceOjK9BrQSnyqEhFq7utbFpZeKEljdR_umZFxVyAnyy6-BnZiSdjppaQkgYQl-5TRFtZSFvmzKc6No2m4vAuLOCHEmOZbrdKPd-CC_h2b7nMknStSlBFmFXen9UXeUzMJ55G9BBLi3hDjWksRdZKnPEpBEmAI7U5Ws_mG7CrEMbzs7J0xbLQvb1eWUIp5sWNMIKhrNx75u2yhdor0UpXRaNSbHAZ19n8",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 13:21:39.051 +03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "client",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HLDB7MU01MCO:00000003",
  "TimeStamp": "2018-04-26T10:21:39Z",
  "ProcessId": 4376,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 13:22:43.111 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-26 13:22:43.163 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-26 13:22:43.167 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-26 13:22:43.168 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-26 13:22:43.168 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-26 13:22:43.168 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-26 13:23:28.184 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-26 13:23:28.255 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-26 13:23:28.257 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-26 13:23:28.262 +03:00 [DBG] Start discovery request
2018-04-26 13:23:28.624 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-26 13:23:28.627 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-26 13:23:28.629 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-26 13:23:28.635 +03:00 [DBG] Start key discovery request
2018-04-26 13:23:28.734 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-26 13:23:28.743 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-26 13:23:28.745 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-26 13:23:28.753 +03:00 [DBG] Start authorize request
2018-04-26 13:23:28.764 +03:00 [DBG] No user present in authorize request
2018-04-26 13:23:28.770 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 13:23:28.801 +03:00 [ERR] Invalid redirect_uri: http://localhost:5002/signin-oidc
{
  "ClientId": "client",
  "AllowedRedirectUris": [],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603350087110183.MTEwNjNhOTUtNTc5Yi00YTY3LWFlZTEtODRmZDM3YzJlMTNkYWEyNzc2MGQtYWQxYy00YmMwLTk5ZjYtYzQ4NzFlNzJlNzY5",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwlLdn-qyxA4zJ_crA9aetTG6-3mGpFFVtS_SxsoyHV-PoNM_L9WT4h2Z7s8qc8OhFcXWDB1aNuShGwXjrD6oPk5-ewJM9Jc_mOOIzfJzA1S-yuUaPTZ0bunPVjljKx-W_BNwblhqRKFV8i0q8YtY_pEwes7imVpfMeWanplXPC6gtTOyE7QiZsnLy_pqaTtRWGWSmKt8W0ijYPuxH8aStEmQ0gssx6Nkd5f_8bgY0caLyusDYLQCA_Vg9NBnCRZxJA0Vdc8W4X5S1s3NwwPfaW6rBABVK8Jmv9jQS-_uQuXyFmqclrMK1P-bSe8HrNUOM",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 13:23:28.815 +03:00 [ERR] Request validation failed
2018-04-26 13:23:28.815 +03:00 [INF] {
  "ClientId": "client",
  "AllowedRedirectUris": [],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603350087110183.MTEwNjNhOTUtNTc5Yi00YTY3LWFlZTEtODRmZDM3YzJlMTNkYWEyNzc2MGQtYWQxYy00YmMwLTk5ZjYtYzQ4NzFlNzJlNzY5",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwlLdn-qyxA4zJ_crA9aetTG6-3mGpFFVtS_SxsoyHV-PoNM_L9WT4h2Z7s8qc8OhFcXWDB1aNuShGwXjrD6oPk5-ewJM9Jc_mOOIzfJzA1S-yuUaPTZ0bunPVjljKx-W_BNwblhqRKFV8i0q8YtY_pEwes7imVpfMeWanplXPC6gtTOyE7QiZsnLy_pqaTtRWGWSmKt8W0ijYPuxH8aStEmQ0gssx6Nkd5f_8bgY0caLyusDYLQCA_Vg9NBnCRZxJA0Vdc8W4X5S1s3NwwPfaW6rBABVK8Jmv9jQS-_uQuXyFmqclrMK1P-bSe8HrNUOM",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 13:23:28.871 +03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "client",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HLDBBUIV125D:00000003",
  "TimeStamp": "2018-04-26T10:23:28Z",
  "ProcessId": 30060,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 13:24:26.955 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-26 13:24:26.958 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-26 13:24:26.960 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-26 13:24:26.964 +03:00 [DBG] Start discovery request
2018-04-26 13:24:27.256 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-26 13:24:27.259 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-26 13:24:27.262 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-26 13:24:27.263 +03:00 [DBG] Start key discovery request
2018-04-26 13:24:27.351 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-26 13:24:27.354 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-26 13:24:27.358 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-26 13:24:27.361 +03:00 [DBG] Start authorize request
2018-04-26 13:24:27.362 +03:00 [DBG] No user present in authorize request
2018-04-26 13:24:27.364 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 13:24:27.365 +03:00 [ERR] Invalid redirect_uri: http://localhost:5002/signin-oidc
{
  "ClientId": "client",
  "AllowedRedirectUris": [],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603350673082799.ZmY0MjdkZDctZTk5Ni00ZDJkLWJhNzMtZjZmNTdlYzA3NWNiZTU4NDVhNGQtM2NjMy00YzVjLWIxMWUtMjJjYWVkYWRlZTA1",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hzrtVnEThPvO1BhBe4dlz5NqnIXM7We0uGxKMawOB6UgR0lGsfTDFQPEAB5l5Y38s240ZKuPTdz2hlWs92htN5Rp-6VJtX-U3x9eM9FGAtYAlqoYAV65p3BDG67n-6_KcElmNHN0AniYEmC9HfEWZWrQPNZxGE63HpwyRnhDgdAxBMzhQcCbpjCrbTQ0bH80WPG6ZkvMuUvHBj9hVxOS2QL4QpVICidtE0tf0HN--zQ4e4NwAjELo_U3D-s--UNRDlruPALRz8nLCsEAN7Vq47dG6YsL8k7EVHlN2vSiP_5XLEqkDehkrrG-3hE4_JxUDs",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 13:24:27.372 +03:00 [ERR] Request validation failed
2018-04-26 13:24:27.374 +03:00 [INF] {
  "ClientId": "client",
  "AllowedRedirectUris": [],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603350673082799.ZmY0MjdkZDctZTk5Ni00ZDJkLWJhNzMtZjZmNTdlYzA3NWNiZTU4NDVhNGQtM2NjMy00YzVjLWIxMWUtMjJjYWVkYWRlZTA1",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hzrtVnEThPvO1BhBe4dlz5NqnIXM7We0uGxKMawOB6UgR0lGsfTDFQPEAB5l5Y38s240ZKuPTdz2hlWs92htN5Rp-6VJtX-U3x9eM9FGAtYAlqoYAV65p3BDG67n-6_KcElmNHN0AniYEmC9HfEWZWrQPNZxGE63HpwyRnhDgdAxBMzhQcCbpjCrbTQ0bH80WPG6ZkvMuUvHBj9hVxOS2QL4QpVICidtE0tf0HN--zQ4e4NwAjELo_U3D-s--UNRDlruPALRz8nLCsEAN7Vq47dG6YsL8k7EVHlN2vSiP_5XLEqkDehkrrG-3hE4_JxUDs",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 13:24:27.382 +03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "client",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HLDBBUIV125D:00000005",
  "TimeStamp": "2018-04-26T10:24:27Z",
  "ProcessId": 30060,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 13:27:13.166 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-26 13:27:13.169 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-26 13:27:13.170 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-26 13:27:13.172 +03:00 [DBG] Start discovery request
2018-04-26 13:27:13.436 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-26 13:27:13.438 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-26 13:27:13.439 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-26 13:27:13.440 +03:00 [DBG] Start key discovery request
2018-04-26 13:27:13.547 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-26 13:27:13.549 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-26 13:27:13.550 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-26 13:27:13.551 +03:00 [DBG] Start authorize request
2018-04-26 13:27:13.552 +03:00 [DBG] No user present in authorize request
2018-04-26 13:27:13.552 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 13:27:13.556 +03:00 [ERR] Invalid redirect_uri: http://localhost:5002/signin-oidc
{
  "ClientId": "client",
  "AllowedRedirectUris": [],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603352334793330.YWYyZjcyOTYtZTNiMy00YzljLTg2YjEtMWU2ZDA1NGZkZjk4YzcyMzNiMTAtNTAwNi00YTg2LTkyY2MtYjBkY2E0NzYzZDg2",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwJDjBrjKFnvQENqMvdSgKFq6bdlj_Xbfamv0i1lFpGIuLbQENF0QFaWvrDUc58b36CFo0Hnh7w8nQSLV3Gy28RB9-SItin0l1ElNhQ4lTqJtINZ6D3SAFTrJZhnruo_jRw70NR_OGq1cHzoTDttrLkj484fzUBhHQoS93vxXdZ8tFr7Ofyw7zfdNqMbzjQQXwmtJO3Gs8Hf34tXRctrZD_fP1dmDTGQkBKzsD8Fqg7Z2Rn5NfyHOGnO8r6iJbS6MmCOfCSGhURbsKwVoERYuoniBzUXQC4BznV49Au-SV8NfMizt9gfxOvqpK9kzlUqpA",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 13:27:13.561 +03:00 [ERR] Request validation failed
2018-04-26 13:27:13.562 +03:00 [INF] {
  "ClientId": "client",
  "AllowedRedirectUris": [],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "client",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603352334793330.YWYyZjcyOTYtZTNiMy00YzljLTg2YjEtMWU2ZDA1NGZkZjk4YzcyMzNiMTAtNTAwNi00YTg2LTkyY2MtYjBkY2E0NzYzZDg2",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwJDjBrjKFnvQENqMvdSgKFq6bdlj_Xbfamv0i1lFpGIuLbQENF0QFaWvrDUc58b36CFo0Hnh7w8nQSLV3Gy28RB9-SItin0l1ElNhQ4lTqJtINZ6D3SAFTrJZhnruo_jRw70NR_OGq1cHzoTDttrLkj484fzUBhHQoS93vxXdZ8tFr7Ofyw7zfdNqMbzjQQXwmtJO3Gs8Hf34tXRctrZD_fP1dmDTGQkBKzsD8Fqg7Z2Rn5NfyHOGnO8r6iJbS6MmCOfCSGhURbsKwVoERYuoniBzUXQC4BznV49Au-SV8NfMizt9gfxOvqpK9kzlUqpA",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 13:27:13.565 +03:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "client",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HLDBBUIV125J:00000001",
  "TimeStamp": "2018-04-26T10:27:13Z",
  "ProcessId": 30060,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 13:35:12.197 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-26 13:35:12.200 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-26 13:35:12.201 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-26 13:35:12.203 +03:00 [DBG] Start discovery request
2018-04-26 13:35:12.480 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-26 13:35:12.483 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-26 13:35:12.485 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-26 13:35:12.487 +03:00 [DBG] Start key discovery request
2018-04-26 13:35:12.552 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-26 13:35:12.555 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-26 13:35:12.556 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-26 13:35:12.558 +03:00 [DBG] Start authorize request
2018-04-26 13:35:12.559 +03:00 [DBG] No user present in authorize request
2018-04-26 13:35:12.561 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 13:35:12.572 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 13:35:12.574 +03:00 [DBG] No PKCE used.
2018-04-26 13:35:12.627 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 13:35:12.629 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hyNxLK6shCLMWSllDRYir4cMp91b37n3QFuP2Bm0gQuCzIhfvI9DCcvIfzV62_QUNW3-5gwCeoGbGDKLC2tp_q8qgeu6rlqoIYoJ09ScpP4GSmO3InZhpHkpHP5XVM56Vo6HLIQWb1S3Wmyk9_QJVponQzEx_vSYAQIHxLXyMePtk5iid4XZYNjIT4E4zZ0BoUBd3WhVdH6JRFSLHP2KVgK24c6bR-f30KWtXhQFn_C1y5BMsdD3yLRs-6pwKntGuHQg19Cki8Kc-I4xr3FtGillTO89rk-feIzxVGdlZ7G3MMJdsnCTgmgvOZTJq2Ly6g",
  "Nonce": "636603357125269265.YTY4ZDBiY2QtMGI3ZC00MzQ5LWI0YjAtNTEzNGJjZjZiYzQ1YjJiMGJjMjItNTg3ZS00NzA4LTk2NTYtNzBjM2NkYmY5ZmFl",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603357125269265.YTY4ZDBiY2QtMGI3ZC00MzQ5LWI0YjAtNTEzNGJjZjZiYzQ1YjJiMGJjMjItNTg3ZS00NzA4LTk2NTYtNzBjM2NkYmY5ZmFl",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hyNxLK6shCLMWSllDRYir4cMp91b37n3QFuP2Bm0gQuCzIhfvI9DCcvIfzV62_QUNW3-5gwCeoGbGDKLC2tp_q8qgeu6rlqoIYoJ09ScpP4GSmO3InZhpHkpHP5XVM56Vo6HLIQWb1S3Wmyk9_QJVponQzEx_vSYAQIHxLXyMePtk5iid4XZYNjIT4E4zZ0BoUBd3WhVdH6JRFSLHP2KVgK24c6bR-f30KWtXhQFn_C1y5BMsdD3yLRs-6pwKntGuHQg19Cki8Kc-I4xr3FtGillTO89rk-feIzxVGdlZ7G3MMJdsnCTgmgvOZTJq2Ly6g",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 13:35:12.652 +03:00 [INF] Showing login: User is not authenticated
2018-04-26 13:35:12.695 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 13:35:12.696 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 13:35:12.697 +03:00 [DBG] No PKCE used.
2018-04-26 13:35:12.698 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 13:35:21.923 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-26 13:35:23.377 +03:00 [DBG] Augmenting SignInContext
2018-04-26 13:35:23.380 +03:00 [DBG] Adding idp claim with value: local
2018-04-26 13:35:23.382 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-26 13:35:23.387 +03:00 [DBG] Adding auth_time claim with value: 1524738923
2018-04-26 13:35:23.403 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-26 13:35:23.488 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLDBBUIV125M:00000003",
  "TimeStamp": "2018-04-26T10:35:23Z",
  "ProcessId": 30060,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 13:35:23.505 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:35:23.508 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:35:23.513 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-26 13:35:23.514 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-26 13:35:23.515 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-26 13:35:23.521 +03:00 [DBG] Start authorize callback request
2018-04-26 13:35:23.529 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-26 13:35:23.536 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 13:35:23.537 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 13:35:23.538 +03:00 [DBG] No PKCE used.
2018-04-26 13:35:23.539 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 13:35:23.541 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hyNxLK6shCLMWSllDRYir4cMp91b37n3QFuP2Bm0gQuCzIhfvI9DCcvIfzV62_QUNW3-5gwCeoGbGDKLC2tp_q8qgeu6rlqoIYoJ09ScpP4GSmO3InZhpHkpHP5XVM56Vo6HLIQWb1S3Wmyk9_QJVponQzEx_vSYAQIHxLXyMePtk5iid4XZYNjIT4E4zZ0BoUBd3WhVdH6JRFSLHP2KVgK24c6bR-f30KWtXhQFn_C1y5BMsdD3yLRs-6pwKntGuHQg19Cki8Kc-I4xr3FtGillTO89rk-feIzxVGdlZ7G3MMJdsnCTgmgvOZTJq2Ly6g",
  "Nonce": "636603357125269265.YTY4ZDBiY2QtMGI3ZC00MzQ5LWI0YjAtNTEzNGJjZjZiYzQ1YjJiMGJjMjItNTg3ZS00NzA4LTk2NTYtNzBjM2NkYmY5ZmFl",
  "SessionId": "fe1fdc589bae4c3ae0f178ba7c8ae0b9",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603357125269265.YTY4ZDBiY2QtMGI3ZC00MzQ5LWI0YjAtNTEzNGJjZjZiYzQ1YjJiMGJjMjItNTg3ZS00NzA4LTk2NTYtNzBjM2NkYmY5ZmFl",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hyNxLK6shCLMWSllDRYir4cMp91b37n3QFuP2Bm0gQuCzIhfvI9DCcvIfzV62_QUNW3-5gwCeoGbGDKLC2tp_q8qgeu6rlqoIYoJ09ScpP4GSmO3InZhpHkpHP5XVM56Vo6HLIQWb1S3Wmyk9_QJVponQzEx_vSYAQIHxLXyMePtk5iid4XZYNjIT4E4zZ0BoUBd3WhVdH6JRFSLHP2KVgK24c6bR-f30KWtXhQFn_C1y5BMsdD3yLRs-6pwKntGuHQg19Cki8Kc-I4xr3FtGillTO89rk-feIzxVGdlZ7G3MMJdsnCTgmgvOZTJq2Ly6g",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 13:35:23.649 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-26 13:35:23.679 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-26 13:35:23.681 +03:00 [INF] Showing consent: User has not yet consented
2018-04-26 13:35:23.690 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:35:23.692 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:35:23.710 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 13:35:23.711 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 13:35:23.712 +03:00 [DBG] No PKCE used.
2018-04-26 13:35:23.720 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 13:36:59.647 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-26 13:36:59.650 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-26 13:36:59.658 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-26 13:36:59.659 +03:00 [DBG] Start discovery request
2018-04-26 13:36:59.928 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-26 13:36:59.936 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-26 13:36:59.937 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-26 13:36:59.939 +03:00 [DBG] Start key discovery request
2018-04-26 13:37:00.015 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:37:00.017 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:37:00.023 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-26 13:37:00.028 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-26 13:37:00.030 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-26 13:37:00.031 +03:00 [DBG] Start authorize request
2018-04-26 13:37:00.033 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-26 13:37:00.034 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 13:37:00.035 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 13:37:00.035 +03:00 [DBG] No PKCE used.
2018-04-26 13:37:00.036 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 13:37:00.040 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hznlmP5azMw-t97jnudxBeURQ5UYECxp37RnttUIFc3M1IJsKOSm7fNA2JX9B7iuvkwNquW5Z1cN7Ac7jXNLSui2B2DF5V7J7-B4hmTJ2xKHhb1hjg9YQjb_c4nTw6gE2EwIgksU_y1sjXoKSB5CPqUz05kYRyCIM31gEOUZ3gRRglZ7MxIgXclzJhHLDdP8ZkwJZrOKzf4rTgeFdU46bEOYu_x-1u7txzLKpdo9wzPULj7ukWPEAHIy0JhSZWQPJp2rOoIrYnYnHHzKic6WwAqq6BclgwmEXVn392P8ZIOkdCEBMmnYvJG8hsgyQn3pgM",
  "Nonce": "636603358199883276.YjQyNmZjZjItYzNkYi00ZGUzLWE2NWEtZjMxMmRmYTkyZjEzYjY0YjNiY2QtNWRiMC00YjgwLTlhMjQtYmEyYTg1Y2UxMWM0",
  "SessionId": "fe1fdc589bae4c3ae0f178ba7c8ae0b9",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603358199883276.YjQyNmZjZjItYzNkYi00ZGUzLWE2NWEtZjMxMmRmYTkyZjEzYjY0YjNiY2QtNWRiMC00YjgwLTlhMjQtYmEyYTg1Y2UxMWM0",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hznlmP5azMw-t97jnudxBeURQ5UYECxp37RnttUIFc3M1IJsKOSm7fNA2JX9B7iuvkwNquW5Z1cN7Ac7jXNLSui2B2DF5V7J7-B4hmTJ2xKHhb1hjg9YQjb_c4nTw6gE2EwIgksU_y1sjXoKSB5CPqUz05kYRyCIM31gEOUZ3gRRglZ7MxIgXclzJhHLDdP8ZkwJZrOKzf4rTgeFdU46bEOYu_x-1u7txzLKpdo9wzPULj7ukWPEAHIy0JhSZWQPJp2rOoIrYnYnHHzKic6WwAqq6BclgwmEXVn392P8ZIOkdCEBMmnYvJG8hsgyQn3pgM",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 13:37:00.146 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-26 13:37:00.151 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-26 13:37:00.151 +03:00 [INF] Showing consent: User has not yet consented
2018-04-26 13:37:00.157 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:37:00.158 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:37:00.160 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 13:37:00.162 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 13:37:00.162 +03:00 [DBG] No PKCE used.
2018-04-26 13:37:00.163 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 13:37:08.617 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:37:08.624 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:37:10.094 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-26 13:37:10.097 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:37:10.098 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:37:10.121 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-26 13:37:10.124 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-26 13:37:10.125 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-26 13:37:10.133 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLDBBUIV125M:0000000A",
  "TimeStamp": "2018-04-26T10:37:10Z",
  "ProcessId": 30060,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 13:37:15.705 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-26 13:37:15.713 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-26 13:37:15.714 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-26 13:37:15.715 +03:00 [DBG] Start authorize request
2018-04-26 13:37:15.718 +03:00 [DBG] No user present in authorize request
2018-04-26 13:37:15.718 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 13:37:15.719 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 13:37:15.719 +03:00 [DBG] No PKCE used.
2018-04-26 13:37:15.720 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 13:37:15.721 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxiRGyrRfSNdki2lUHXWQPGEwGm-BhJpAuSG1ZwSkvTUrMijd491m4eXLT2dwXUjbhXXvuDj_mpguCR_16dVgwhnyRezmQDXS1VIarrRGHO2WGmP7MtsxHC3ayxViWSFXza8qECERFs8LpTa4czNeINxA69TcwaJnB_cZ0cnz2x43CPukyc9PKOIcO0KDJv0j7rlTY6XKQPAPT-IS2TV0-0p9CspzOcpXZToLzYet3WTFqINGDhMpNjZwf8Sw2XbDpHMCfFUQPl_HUwEHcHTPbRlw1JsBijJZWJH_lurHmWx9uzMkGSR3n8Dl3VgHZgE4g",
  "Nonce": "636603358356587859.MDRiYzJhMGQtYTZjMi00OWEyLWE1MmUtODZhZTZmNDRkNjUwMjg2NDhmN2QtODU2NC00Y2YxLTgwMjctMDcwMGQxZTM2Y2Y2",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603358356587859.MDRiYzJhMGQtYTZjMi00OWEyLWE1MmUtODZhZTZmNDRkNjUwMjg2NDhmN2QtODU2NC00Y2YxLTgwMjctMDcwMGQxZTM2Y2Y2",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hxiRGyrRfSNdki2lUHXWQPGEwGm-BhJpAuSG1ZwSkvTUrMijd491m4eXLT2dwXUjbhXXvuDj_mpguCR_16dVgwhnyRezmQDXS1VIarrRGHO2WGmP7MtsxHC3ayxViWSFXza8qECERFs8LpTa4czNeINxA69TcwaJnB_cZ0cnz2x43CPukyc9PKOIcO0KDJv0j7rlTY6XKQPAPT-IS2TV0-0p9CspzOcpXZToLzYet3WTFqINGDhMpNjZwf8Sw2XbDpHMCfFUQPl_HUwEHcHTPbRlw1JsBijJZWJH_lurHmWx9uzMkGSR3n8Dl3VgHZgE4g",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 13:37:15.726 +03:00 [INF] Showing login: User is not authenticated
2018-04-26 13:37:15.736 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 13:37:15.736 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 13:37:15.738 +03:00 [DBG] No PKCE used.
2018-04-26 13:37:15.742 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 13:37:21.445 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-26 13:37:21.679 +03:00 [DBG] Augmenting SignInContext
2018-04-26 13:37:21.681 +03:00 [DBG] Adding idp claim with value: local
2018-04-26 13:37:21.684 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-26 13:37:21.685 +03:00 [DBG] Adding auth_time claim with value: 1524739041
2018-04-26 13:37:21.686 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-26 13:37:21.759 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLDBBUIV125M:0000000D",
  "TimeStamp": "2018-04-26T10:37:21Z",
  "ProcessId": 30060,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 13:37:21.769 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:37:21.770 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:37:21.771 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-26 13:37:21.779 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-26 13:37:21.780 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-26 13:37:21.781 +03:00 [DBG] Start authorize callback request
2018-04-26 13:37:21.781 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-26 13:37:21.783 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 13:37:21.784 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 13:37:21.784 +03:00 [DBG] No PKCE used.
2018-04-26 13:37:21.785 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 13:37:21.787 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxiRGyrRfSNdki2lUHXWQPGEwGm-BhJpAuSG1ZwSkvTUrMijd491m4eXLT2dwXUjbhXXvuDj_mpguCR_16dVgwhnyRezmQDXS1VIarrRGHO2WGmP7MtsxHC3ayxViWSFXza8qECERFs8LpTa4czNeINxA69TcwaJnB_cZ0cnz2x43CPukyc9PKOIcO0KDJv0j7rlTY6XKQPAPT-IS2TV0-0p9CspzOcpXZToLzYet3WTFqINGDhMpNjZwf8Sw2XbDpHMCfFUQPl_HUwEHcHTPbRlw1JsBijJZWJH_lurHmWx9uzMkGSR3n8Dl3VgHZgE4g",
  "Nonce": "636603358356587859.MDRiYzJhMGQtYTZjMi00OWEyLWE1MmUtODZhZTZmNDRkNjUwMjg2NDhmN2QtODU2NC00Y2YxLTgwMjctMDcwMGQxZTM2Y2Y2",
  "SessionId": "c67a09ec7cb40b3293f9848ac1e68bec",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603358356587859.MDRiYzJhMGQtYTZjMi00OWEyLWE1MmUtODZhZTZmNDRkNjUwMjg2NDhmN2QtODU2NC00Y2YxLTgwMjctMDcwMGQxZTM2Y2Y2",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hxiRGyrRfSNdki2lUHXWQPGEwGm-BhJpAuSG1ZwSkvTUrMijd491m4eXLT2dwXUjbhXXvuDj_mpguCR_16dVgwhnyRezmQDXS1VIarrRGHO2WGmP7MtsxHC3ayxViWSFXza8qECERFs8LpTa4czNeINxA69TcwaJnB_cZ0cnz2x43CPukyc9PKOIcO0KDJv0j7rlTY6XKQPAPT-IS2TV0-0p9CspzOcpXZToLzYet3WTFqINGDhMpNjZwf8Sw2XbDpHMCfFUQPl_HUwEHcHTPbRlw1JsBijJZWJH_lurHmWx9uzMkGSR3n8Dl3VgHZgE4g",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 13:37:21.872 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-26 13:37:21.874 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-26 13:37:21.875 +03:00 [INF] Showing consent: User has not yet consented
2018-04-26 13:37:21.882 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:37:21.886 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:37:21.890 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 13:37:21.891 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 13:37:21.891 +03:00 [DBG] No PKCE used.
2018-04-26 13:37:21.893 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 13:40:23.734 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-26 13:40:23.737 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-26 13:40:23.739 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-26 13:40:23.744 +03:00 [DBG] Start discovery request
2018-04-26 13:40:23.996 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-26 13:40:23.999 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-26 13:40:24.002 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-26 13:40:24.004 +03:00 [DBG] Start key discovery request
2018-04-26 13:40:24.065 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:40:24.067 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:40:24.073 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-26 13:40:24.075 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-26 13:40:24.078 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-26 13:40:24.079 +03:00 [DBG] Start authorize request
2018-04-26 13:40:24.080 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-26 13:40:24.082 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 13:40:24.082 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 13:40:24.083 +03:00 [DBG] No PKCE used.
2018-04-26 13:40:24.084 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 13:40:24.086 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hwVjyXZB9L0A15kFXWlxRHByWQCEMhhSdbFZoTHmcK0qFdbfowyG-NvTyWxK6pSfAUAzUsV5fBlhQv2QZ9Dz8GFh5tfCNfIdNZ7RVN5i-REeFL8hxvOLq4Q-ZbP9c2ZkZyZOl7IDU9Dvfn7MrrKFgfhtlY1AVR5m347FT_k21qOW9fx0R7KIK3n4EuchZR_lmqtzITBtYN4ZFWiztFb3MdwWbQ_aeQ6QaMwRVl0MR064sAjb0bQ_jsh3inz07srlj4iHWMQOyuLDni5V091YaZJTHDWc4sw2jnWWaoY9W6L-DYceyFJmEB-yd-9p301XdI",
  "Nonce": "636603360240413303.ZDVhMzEyZWYtOTg0ZC00ZjgzLTk3ZDktZjhjMzk1YWFlNmFjMmI5OWU5MjYtZGM3Zi00N2U1LWI4OTQtNTVlYjQ3N2ExNDNj",
  "SessionId": "c67a09ec7cb40b3293f9848ac1e68bec",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email",
    "response_mode": "form_post",
    "nonce": "636603360240413303.ZDVhMzEyZWYtOTg0ZC00ZjgzLTk3ZDktZjhjMzk1YWFlNmFjMmI5OWU5MjYtZGM3Zi00N2U1LWI4OTQtNTVlYjQ3N2ExNDNj",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwVjyXZB9L0A15kFXWlxRHByWQCEMhhSdbFZoTHmcK0qFdbfowyG-NvTyWxK6pSfAUAzUsV5fBlhQv2QZ9Dz8GFh5tfCNfIdNZ7RVN5i-REeFL8hxvOLq4Q-ZbP9c2ZkZyZOl7IDU9Dvfn7MrrKFgfhtlY1AVR5m347FT_k21qOW9fx0R7KIK3n4EuchZR_lmqtzITBtYN4ZFWiztFb3MdwWbQ_aeQ6QaMwRVl0MR064sAjb0bQ_jsh3inz07srlj4iHWMQOyuLDni5V091YaZJTHDWc4sw2jnWWaoY9W6L-DYceyFJmEB-yd-9p301XdI",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 13:40:24.178 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-26 13:40:24.180 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-26 13:40:24.180 +03:00 [INF] Showing consent: User has not yet consented
2018-04-26 13:40:24.186 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:40:24.188 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:40:24.189 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 13:40:24.192 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 13:40:24.192 +03:00 [DBG] No PKCE used.
2018-04-26 13:40:24.193 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 13:40:31.136 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-26 13:40:31.141 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:40:31.145 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:40:31.169 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 13:40:31.169 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 13:40:31.170 +03:00 [DBG] No PKCE used.
2018-04-26 13:40:31.171 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 13:40:31.192 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:40:31.194 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:40:31.197 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-26 13:40:31.199 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-26 13:40:31.200 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-26 13:40:31.201 +03:00 [DBG] Start authorize callback request
2018-04-26 13:40:31.209 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-26 13:40:31.213 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 13:40:31.215 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 13:40:31.216 +03:00 [DBG] No PKCE used.
2018-04-26 13:40:31.217 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 13:40:31.218 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hwVjyXZB9L0A15kFXWlxRHByWQCEMhhSdbFZoTHmcK0qFdbfowyG-NvTyWxK6pSfAUAzUsV5fBlhQv2QZ9Dz8GFh5tfCNfIdNZ7RVN5i-REeFL8hxvOLq4Q-ZbP9c2ZkZyZOl7IDU9Dvfn7MrrKFgfhtlY1AVR5m347FT_k21qOW9fx0R7KIK3n4EuchZR_lmqtzITBtYN4ZFWiztFb3MdwWbQ_aeQ6QaMwRVl0MR064sAjb0bQ_jsh3inz07srlj4iHWMQOyuLDni5V091YaZJTHDWc4sw2jnWWaoY9W6L-DYceyFJmEB-yd-9p301XdI",
  "Nonce": "636603360240413303.ZDVhMzEyZWYtOTg0ZC00ZjgzLTk3ZDktZjhjMzk1YWFlNmFjMmI5OWU5MjYtZGM3Zi00N2U1LWI4OTQtNTVlYjQ3N2ExNDNj",
  "SessionId": "c67a09ec7cb40b3293f9848ac1e68bec",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email",
    "response_mode": "form_post",
    "nonce": "636603360240413303.ZDVhMzEyZWYtOTg0ZC00ZjgzLTk3ZDktZjhjMzk1YWFlNmFjMmI5OWU5MjYtZGM3Zi00N2U1LWI4OTQtNTVlYjQ3N2ExNDNj",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hwVjyXZB9L0A15kFXWlxRHByWQCEMhhSdbFZoTHmcK0qFdbfowyG-NvTyWxK6pSfAUAzUsV5fBlhQv2QZ9Dz8GFh5tfCNfIdNZ7RVN5i-REeFL8hxvOLq4Q-ZbP9c2ZkZyZOl7IDU9Dvfn7MrrKFgfhtlY1AVR5m347FT_k21qOW9fx0R7KIK3n4EuchZR_lmqtzITBtYN4ZFWiztFb3MdwWbQ_aeQ6QaMwRVl0MR064sAjb0bQ_jsh3inz07srlj4iHWMQOyuLDni5V091YaZJTHDWc4sw2jnWWaoY9W6L-DYceyFJmEB-yd-9p301XdI",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 13:40:31.330 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-26 13:40:31.332 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-26 13:40:31.343 +03:00 [INF] User consented to scopes: ["openid","email","profile"]
2018-04-26 13:40:31.362 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email"]
2018-04-26 13:40:31.369 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-26 13:40:31.393 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-26 13:40:31.432 +03:00 [DBG] Creating Implicit Flow response.
2018-04-26 13:40:31.445 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-26 13:40:31.450 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-26 13:40:31.520 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile email",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****HE1g"
    },
    {
      "TokenType": "code",
      "TokenValue": "****2c09"
    }
  ],
  "ActivityId": "0HLDBBUIV125U:00000004",
  "TimeStamp": "2018-04-26T10:40:31Z",
  "ProcessId": 30060,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 13:40:31.534 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hwVjyXZB9L0A15kFXWlxRHByWQCEMhhSdbFZoTHmcK0qFdbfowyG-NvTyWxK6pSfAUAzUsV5fBlhQv2QZ9Dz8GFh5tfCNfIdNZ7RVN5i-REeFL8hxvOLq4Q-ZbP9c2ZkZyZOl7IDU9Dvfn7MrrKFgfhtlY1AVR5m347FT_k21qOW9fx0R7KIK3n4EuchZR_lmqtzITBtYN4ZFWiztFb3MdwWbQ_aeQ6QaMwRVl0MR064sAjb0bQ_jsh3inz07srlj4iHWMQOyuLDni5V091YaZJTHDWc4sw2jnWWaoY9W6L-DYceyFJmEB-yd-9p301XdI",
  "Scope": "openid profile email"
}
2018-04-26 13:40:31.548 +03:00 [DBG] Augmenting SignInContext
2018-04-26 13:40:31.549 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-26 13:40:32.203 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-26 13:40:32.210 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-26 13:40:32.212 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-26 13:40:32.222 +03:00 [DBG] Start token request.
2018-04-26 13:40:32.229 +03:00 [DBG] Start client validation
2018-04-26 13:40:32.235 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-26 13:40:32.239 +03:00 [DBG] Start parsing for secret in post body
2018-04-26 13:40:32.241 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-26 13:40:32.246 +03:00 [DBG] Secret id found: mvc
2018-04-26 13:40:32.258 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-26 13:40:32.258 +03:00 [DBG] Client validation success
2018-04-26 13:40:32.267 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLDBBUIV125T:00000003",
  "TimeStamp": "2018-04-26T10:40:32Z",
  "ProcessId": 30060,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 13:40:32.278 +03:00 [DBG] Start token request validation
2018-04-26 13:40:32.289 +03:00 [DBG] Start validation of authorization code token request
2018-04-26 13:40:32.397 +03:00 [DBG] Validation of authorization code token request success
2018-04-26 13:40:32.407 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "7b212dc673a2ea00c781680e6e14718c102e52a03700cd1f3d3aed4248dd2c09",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "7b212dc673a2ea00c781680e6e14718c102e52a03700cd1f3d3aed4248dd2c09",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-26 13:40:32.440 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-26 13:40:32.441 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-26 13:40:32.451 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-26 13:40:32.454 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-26 13:40:32.460 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile email",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****QXHA"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****vceA"
    }
  ],
  "ActivityId": "0HLDBBUIV125T:00000003",
  "TimeStamp": "2018-04-26T10:40:32Z",
  "ProcessId": 30060,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 13:40:32.468 +03:00 [DBG] Token request success.
2018-04-26 13:40:32.497 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-26 13:40:32.500 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-26 13:40:32.502 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-26 13:40:32.512 +03:00 [DBG] Start userinfo request
2018-04-26 13:40:32.516 +03:00 [DBG] Bearer token found in header
2018-04-26 13:40:32.661 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-26 13:40:32.671 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524739232,
    "exp": 1524742832,
    "iss": "http://localhost:5000",
    "aud": "http://localhost:5000/resources",
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524739041,
    "idp": "local",
    "email": "alice@email.com",
    "scope": [
      "openid",
      "email",
      "profile"
    ],
    "amr": "pwd"
  }
}
2018-04-26 13:40:32.684 +03:00 [DBG] Creating userinfo response
2018-04-26 13:40:32.690 +03:00 [DBG] Scopes in access token: openid email profile
2018-04-26 13:40:32.694 +03:00 [DBG] Scopes in access token: openid email profile
2018-04-26 13:40:32.701 +03:00 [DBG] Requested claim types: sub email email_verified name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-26 13:40:32.702 +03:00 [DBG] Scopes in access token: openid email profile
2018-04-26 13:40:32.704 +03:00 [INF] Profile service returned to the following claim types: email
2018-04-26 13:40:32.705 +03:00 [DBG] End userinfo request
2018-04-26 13:40:53.558 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-26 13:40:53.560 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-26 13:40:53.560 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-26 13:40:53.561 +03:00 [DBG] Start discovery request
2018-04-26 13:40:53.788 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-26 13:40:53.790 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-26 13:40:53.791 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-26 13:40:53.792 +03:00 [DBG] Start key discovery request
2018-04-26 13:42:46.816 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-26 13:42:46.866 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-26 13:42:46.871 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-26 13:42:46.873 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-26 13:42:46.873 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-26 13:42:46.874 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-26 13:42:47.332 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:42:47.357 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:54:04.975 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-26 13:54:05.027 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-26 13:54:05.031 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-26 13:54:05.032 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-26 13:54:05.032 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-26 13:54:05.033 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-26 13:54:05.569 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:54:05.592 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:57:55.905 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-26 13:57:55.955 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-26 13:57:55.959 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-26 13:57:55.961 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-26 13:57:55.962 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-26 13:57:55.963 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-26 13:57:56.980 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 13:57:57.000 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:17:59.190 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-26 14:17:59.286 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-26 14:17:59.294 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-26 14:17:59.295 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-26 14:17:59.295 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-26 14:17:59.296 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-26 14:18:02.136 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:18:02.159 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:19:20.676 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:19:20.679 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:19:22.603 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-26 14:19:22.606 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:19:22.608 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:19:22.688 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-26 14:19:22.694 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-26 14:19:22.696 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-26 14:19:22.743 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLDBCTF5L5IR:00000002",
  "TimeStamp": "2018-04-26T11:19:22Z",
  "ProcessId": 22644,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 14:19:23.088 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-26 14:19:23.102 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-26 14:19:23.104 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-26 14:19:23.112 +03:00 [DBG] Processing signout callback request
2018-04-26 14:19:23.163 +03:00 [DBG] No client front-channel logout URLs
2018-04-26 14:19:23.163 +03:00 [DBG] No client back-channel logout URLs
2018-04-26 14:19:23.165 +03:00 [INF] Successful signout callback.
2018-04-26 14:19:23.166 +03:00 [DBG] No client front-channel iframe urls
2018-04-26 14:19:23.167 +03:00 [DBG] No client back-channel iframe urls
2018-04-26 14:19:45.982 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-26 14:19:45.986 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-26 14:19:45.987 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-26 14:19:45.994 +03:00 [DBG] Start discovery request
2018-04-26 14:19:46.310 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-26 14:19:46.312 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-26 14:19:46.314 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-26 14:19:46.320 +03:00 [DBG] Start key discovery request
2018-04-26 14:19:46.414 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-26 14:19:46.416 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-26 14:19:46.418 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-26 14:19:46.424 +03:00 [DBG] Processing signout request for anonymous
2018-04-26 14:19:46.430 +03:00 [DBG] Start end session request validation
2018-04-26 14:19:46.437 +03:00 [DBG] Start identity token validation
2018-04-26 14:19:46.460 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-26 14:19:46.613 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-26 14:19:46.620 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524739232,
    "exp": 1524739532,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636603360240413303.ZDVhMzEyZWYtOTg0ZC00ZjgzLTk3ZDktZjhjMzk1YWFlNmFjMmI5OWU5MjYtZGM3Zi00N2U1LWI4OTQtNTVlYjQ3N2ExNDNj",
    "iat": 1524739232,
    "at_hash": "lU7vhLFi6nw2FyH-_Q8t5g",
    "sid": "c67a09ec7cb40b3293f9848ac1e68bec",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524739041,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-26 14:19:46.634 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "unknown",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hz8EWjIpiqUaAvBYp171iQm0rWUVBxwXQXeBYzzEcBchW7H-t_ZVQvhVdkU6kz_abHfRIfa5iFXf-KvzfXK-bGCwvooYOBmTHQcpbH2B43RJatLtgRDxUp2CrLmL6nZALRdbLV-yJi80PaB4-IfPp0d",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQ3MzkyMzIsImV4cCI6MTUyNDczOTUzMiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY2MDMzNjAyNDA0MTMzMDMuWkRWaE16RXlaV1l0T1RnMFpDMDBaamd6TFRrM1pEa3RaamhqTXprMVlXRmxObUZqTW1JNU9XVTVNall0WkdNM1ppMDBOMlUxTFdJNE9UUXROVFZsWWpRM04yRXhORE5qIiwiaWF0IjoxNTI0NzM5MjMyLCJhdF9oYXNoIjoibFU3dmhMRmk2bncyRnlILV9ROHQ1ZyIsInNpZCI6ImM2N2EwOWVjN2NiNDBiMzI5M2Y5ODQ4YWMxZTY4YmVjIiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0NzM5MDQxLCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.bkaBsdHiLYBQDQ_MsYQrg2kkYYUDxRWgF2g2nIilnZaDVGZYgpwlP2HJH7P_BoZX8YIVnaC2FGUCdvmxDWhB_VfCef99niMP2WDju2-9XA4duR-bufrwkjwnK8qThI9LIElZAcgB_mcqqibCxjTB6Pr15EfzqD1Md3QADqMcKpTBueEmXJQNIFB_aBrtFX8j7xII87Ewh52KR-KnROAJbmLTKAAGcJphe2Nm5hsBnovQ_mEoiBiYD7X4U5yhr-shXzDgRMvIi8ikkXxYsyifK7xUCND8_DOiNmTDzZv7slS9zZh434cUBOfH-gN2-A_HkmJsRCSexjjlnkpggqQXHA",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hz8EWjIpiqUaAvBYp171iQm0rWUVBxwXQXeBYzzEcBchW7H-t_ZVQvhVdkU6kz_abHfRIfa5iFXf-KvzfXK-bGCwvooYOBmTHQcpbH2B43RJatLtgRDxUp2CrLmL6nZALRdbLV-yJi80PaB4-IfPp0d",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 14:19:46.640 +03:00 [DBG] Success validating end session request from mvc
2018-04-26 14:19:49.632 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-26 14:19:49.638 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-26 14:19:49.640 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-26 14:19:49.646 +03:00 [DBG] Start authorize request
2018-04-26 14:19:49.653 +03:00 [DBG] No user present in authorize request
2018-04-26 14:19:49.659 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 14:19:49.678 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 14:19:49.681 +03:00 [DBG] No PKCE used.
2018-04-26 14:19:49.724 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 14:19:49.738 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzITfB6_CVEX1KT7oB1BgdHwQaY2jmZt-SEdGN70QhIaV5hjPdV_8kIiPWxi-ZcdHz0jC3HF8wyqTkGQqKQ8oF02wstSPHgpEcu6Spwu-pD8Ec7lXnf7Mjl4mtbj8MXuhoiEb2yLOjY_v0HYZiuqyvoGI6ZK3-BpxbNvucKVfsucsuqKEfzappJ4bwikC_YAxPC3_ChdTWizLWF1GAS-KRLsXC6PugdnfHxVFGb2faOxKhQVsGe_Ew49vfCCyFO_DyeO4orlDfQYu1RhVibS5zhuT48EJEWrw6jQ1D90I2DDFXWWct39k6P6FrKRhaCuEA",
  "Nonce": "636603383896126333.MzE4MTZjODMtOGJhZS00ZDg2LWEwODYtZGZmNDRlOGRkNjM0ODIyZjdlMWEtM2MxMC00ZTdlLWIwZWYtYTU3OGU4YzA4NTk5",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603383896126333.MzE4MTZjODMtOGJhZS00ZDg2LWEwODYtZGZmNDRlOGRkNjM0ODIyZjdlMWEtM2MxMC00ZTdlLWIwZWYtYTU3OGU4YzA4NTk5",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hzITfB6_CVEX1KT7oB1BgdHwQaY2jmZt-SEdGN70QhIaV5hjPdV_8kIiPWxi-ZcdHz0jC3HF8wyqTkGQqKQ8oF02wstSPHgpEcu6Spwu-pD8Ec7lXnf7Mjl4mtbj8MXuhoiEb2yLOjY_v0HYZiuqyvoGI6ZK3-BpxbNvucKVfsucsuqKEfzappJ4bwikC_YAxPC3_ChdTWizLWF1GAS-KRLsXC6PugdnfHxVFGb2faOxKhQVsGe_Ew49vfCCyFO_DyeO4orlDfQYu1RhVibS5zhuT48EJEWrw6jQ1D90I2DDFXWWct39k6P6FrKRhaCuEA",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 14:19:49.753 +03:00 [INF] Showing login: User is not authenticated
2018-04-26 14:19:49.793 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 14:19:49.793 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 14:19:49.795 +03:00 [DBG] No PKCE used.
2018-04-26 14:19:49.796 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 14:19:56.531 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-26 14:19:56.834 +03:00 [DBG] Augmenting SignInContext
2018-04-26 14:19:56.837 +03:00 [DBG] Adding idp claim with value: local
2018-04-26 14:19:56.837 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-26 14:19:56.839 +03:00 [DBG] Adding auth_time claim with value: 1524741596
2018-04-26 14:19:56.845 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-26 14:19:56.940 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLDBCTF5L5IR:00000008",
  "TimeStamp": "2018-04-26T11:19:56Z",
  "ProcessId": 22644,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 14:19:56.954 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:19:56.955 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:19:56.957 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-26 14:19:56.958 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-26 14:19:56.959 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-26 14:19:56.965 +03:00 [DBG] Start authorize callback request
2018-04-26 14:19:56.970 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-26 14:19:56.971 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 14:19:56.976 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 14:19:56.977 +03:00 [DBG] No PKCE used.
2018-04-26 14:19:56.979 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 14:19:56.980 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzITfB6_CVEX1KT7oB1BgdHwQaY2jmZt-SEdGN70QhIaV5hjPdV_8kIiPWxi-ZcdHz0jC3HF8wyqTkGQqKQ8oF02wstSPHgpEcu6Spwu-pD8Ec7lXnf7Mjl4mtbj8MXuhoiEb2yLOjY_v0HYZiuqyvoGI6ZK3-BpxbNvucKVfsucsuqKEfzappJ4bwikC_YAxPC3_ChdTWizLWF1GAS-KRLsXC6PugdnfHxVFGb2faOxKhQVsGe_Ew49vfCCyFO_DyeO4orlDfQYu1RhVibS5zhuT48EJEWrw6jQ1D90I2DDFXWWct39k6P6FrKRhaCuEA",
  "Nonce": "636603383896126333.MzE4MTZjODMtOGJhZS00ZDg2LWEwODYtZGZmNDRlOGRkNjM0ODIyZjdlMWEtM2MxMC00ZTdlLWIwZWYtYTU3OGU4YzA4NTk5",
  "SessionId": "c6d0467d8875c712c01484c23c0af8fa",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603383896126333.MzE4MTZjODMtOGJhZS00ZDg2LWEwODYtZGZmNDRlOGRkNjM0ODIyZjdlMWEtM2MxMC00ZTdlLWIwZWYtYTU3OGU4YzA4NTk5",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hzITfB6_CVEX1KT7oB1BgdHwQaY2jmZt-SEdGN70QhIaV5hjPdV_8kIiPWxi-ZcdHz0jC3HF8wyqTkGQqKQ8oF02wstSPHgpEcu6Spwu-pD8Ec7lXnf7Mjl4mtbj8MXuhoiEb2yLOjY_v0HYZiuqyvoGI6ZK3-BpxbNvucKVfsucsuqKEfzappJ4bwikC_YAxPC3_ChdTWizLWF1GAS-KRLsXC6PugdnfHxVFGb2faOxKhQVsGe_Ew49vfCCyFO_DyeO4orlDfQYu1RhVibS5zhuT48EJEWrw6jQ1D90I2DDFXWWct39k6P6FrKRhaCuEA",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 14:19:57.081 +03:00 [DBG] Client is configured to not require consent, no consent is required
2018-04-26 14:19:57.089 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-26 14:19:57.124 +03:00 [DBG] Creating Implicit Flow response.
2018-04-26 14:19:57.138 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-26 14:19:57.142 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-26 14:19:57.184 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****jW3g"
    },
    {
      "TokenType": "code",
      "TokenValue": "****9054"
    }
  ],
  "ActivityId": "0HLDBCTF5L5IR:00000009",
  "TimeStamp": "2018-04-26T11:19:57Z",
  "ProcessId": 22644,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 14:19:57.194 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hzITfB6_CVEX1KT7oB1BgdHwQaY2jmZt-SEdGN70QhIaV5hjPdV_8kIiPWxi-ZcdHz0jC3HF8wyqTkGQqKQ8oF02wstSPHgpEcu6Spwu-pD8Ec7lXnf7Mjl4mtbj8MXuhoiEb2yLOjY_v0HYZiuqyvoGI6ZK3-BpxbNvucKVfsucsuqKEfzappJ4bwikC_YAxPC3_ChdTWizLWF1GAS-KRLsXC6PugdnfHxVFGb2faOxKhQVsGe_Ew49vfCCyFO_DyeO4orlDfQYu1RhVibS5zhuT48EJEWrw6jQ1D90I2DDFXWWct39k6P6FrKRhaCuEA",
  "Scope": "openid profile api1"
}
2018-04-26 14:19:57.212 +03:00 [DBG] Augmenting SignInContext
2018-04-26 14:19:57.213 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-26 14:19:57.554 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-26 14:19:57.559 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-26 14:19:57.560 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-26 14:19:57.573 +03:00 [DBG] Start token request.
2018-04-26 14:19:57.582 +03:00 [DBG] Start client validation
2018-04-26 14:19:57.591 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-26 14:19:57.596 +03:00 [DBG] Start parsing for secret in post body
2018-04-26 14:19:57.597 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-26 14:19:57.598 +03:00 [DBG] Secret id found: mvc
2018-04-26 14:19:57.612 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-26 14:19:57.612 +03:00 [DBG] Client validation success
2018-04-26 14:19:57.619 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLDBCTF5L5IT:00000003",
  "TimeStamp": "2018-04-26T11:19:57Z",
  "ProcessId": 22644,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 14:19:57.626 +03:00 [DBG] Start token request validation
2018-04-26 14:19:57.637 +03:00 [DBG] Start validation of authorization code token request
2018-04-26 14:19:58.349 +03:00 [DBG] Validation of authorization code token request success
2018-04-26 14:19:58.356 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "dcc6d0af06704121c00b946037671637d7b61f603bf8081d091bdf1e2dff9054",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "dcc6d0af06704121c00b946037671637d7b61f603bf8081d091bdf1e2dff9054",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-26 14:19:58.383 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-26 14:19:58.385 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-26 14:19:58.396 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-26 14:19:58.397 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-26 14:19:58.404 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****fk_w"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****IyCw"
    }
  ],
  "ActivityId": "0HLDBCTF5L5IT:00000003",
  "TimeStamp": "2018-04-26T11:19:58Z",
  "ProcessId": 22644,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 14:19:58.410 +03:00 [DBG] Token request success.
2018-04-26 14:19:58.427 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-26 14:19:58.431 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-26 14:19:58.432 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-26 14:19:58.442 +03:00 [DBG] Start userinfo request
2018-04-26 14:19:58.446 +03:00 [DBG] Bearer token found in header
2018-04-26 14:19:58.543 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-26 14:19:58.546 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524741598,
    "exp": 1524745198,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524741596,
    "idp": "local",
    "email": "alice@email.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-04-26 14:19:58.555 +03:00 [DBG] Creating userinfo response
2018-04-26 14:19:58.560 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-26 14:19:58.562 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-26 14:19:58.566 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-26 14:19:58.567 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-26 14:19:58.569 +03:00 [INF] Profile service returned to the following claim types: email
2018-04-26 14:19:58.572 +03:00 [DBG] End userinfo request
2018-04-26 14:20:40.592 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:20:40.594 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:20:40.600 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-26 14:20:40.601 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-26 14:20:40.604 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-26 14:20:40.605 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLDBCTF5L5IR:0000000A",
  "TimeStamp": "2018-04-26T11:20:40Z",
  "ProcessId": 22644,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 14:20:40.882 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-26 14:20:40.884 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-26 14:20:40.885 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-26 14:20:40.886 +03:00 [DBG] Processing signout callback request
2018-04-26 14:20:40.887 +03:00 [DBG] No client front-channel logout URLs
2018-04-26 14:20:40.888 +03:00 [DBG] No client back-channel logout URLs
2018-04-26 14:20:40.889 +03:00 [INF] Successful signout callback.
2018-04-26 14:20:40.889 +03:00 [DBG] No client front-channel iframe urls
2018-04-26 14:20:40.890 +03:00 [DBG] No client back-channel iframe urls
2018-04-26 14:20:46.459 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-26 14:20:51.199 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-26 14:20:51.532 +03:00 [DBG] Augmenting SignInContext
2018-04-26 14:20:51.532 +03:00 [DBG] Adding idp claim with value: local
2018-04-26 14:20:51.533 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-26 14:20:51.534 +03:00 [DBG] Adding auth_time claim with value: 1524741651
2018-04-26 14:20:51.535 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-26 14:20:51.614 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLDBCTF5L5IR:00000010",
  "TimeStamp": "2018-04-26T11:20:51Z",
  "ProcessId": 22644,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 14:20:51.625 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:20:51.627 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:22:34.775 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-26 14:22:34.781 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-26 14:22:34.782 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-26 14:22:34.783 +03:00 [DBG] Start discovery request
2018-04-26 14:22:35.030 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-26 14:22:35.032 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-26 14:22:35.033 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-26 14:22:35.035 +03:00 [DBG] Start key discovery request
2018-04-26 14:22:35.113 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:22:35.116 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:22:35.118 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-26 14:22:35.119 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-26 14:22:35.120 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-26 14:22:35.122 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-26 14:22:35.123 +03:00 [DBG] Start end session request validation
2018-04-26 14:22:35.123 +03:00 [DBG] Start identity token validation
2018-04-26 14:22:35.124 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-26 14:22:35.246 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-26 14:22:35.248 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524741598,
    "exp": 1524741898,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636603383896126333.MzE4MTZjODMtOGJhZS00ZDg2LWEwODYtZGZmNDRlOGRkNjM0ODIyZjdlMWEtM2MxMC00ZTdlLWIwZWYtYTU3OGU4YzA4NTk5",
    "iat": 1524741598,
    "at_hash": "2KQG7IdR4zYNKmtQDZmkPA",
    "sid": "c6d0467d8875c712c01484c23c0af8fa",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524741596,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-26 14:22:35.253 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hxipl4I0FZv-uFvTZgJ5UI4Uj6K299vwHTGYSbPRJdqlTt-dKrgOYANyN5AYoB237DQvxGiyWd6vGSe9zeKpwK0k5r0HOC8nnQBWqZn71gsS7scp6Mp8qA8BsLP27fcJjd7BLw01kxxPwWbz59DysHB",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQ3NDE1OTgsImV4cCI6MTUyNDc0MTg5OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY2MDMzODM4OTYxMjYzMzMuTXpFNE1UWmpPRE10T0dKaFpTMDBaRGcyTFdFd09EWXRaR1ptTkRSbE9HUmtOak0wT0RJeVpqZGxNV0V0TTJNeE1DMDBaVGRsTFdJd1pXWXRZVFUzT0dVNFl6QTROVGs1IiwiaWF0IjoxNTI0NzQxNTk4LCJhdF9oYXNoIjoiMktRRzdJZFI0ellOS210UURabWtQQSIsInNpZCI6ImM2ZDA0NjdkODg3NWM3MTJjMDE0ODRjMjNjMGFmOGZhIiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0NzQxNTk2LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.vww-wrBAtBkYiTQKJFNjXqRK7GZ1gSoEHC1gM8_euev2GgExtcQfw4JCr48o9Epd3xX2m97I3huSNtSvyYpSYl9z3pBuwcI7qbKVIMPnctQE2RcUK9MaNMOD3e9OK46YH_UN8tlUbE2J7sdaO6vl-VyvqRUPxLBD23ZOGUypyEXHqY14iXskSOqnfnukuIsvCECxH0CO_n_34M5IUGGcncPK5tt_I9z5_kc08RTRISvWK1wYiUQ_bmrhXUiR75Bzs1o31ODs9_owOl7zj-UISqaf4P9GF6spGjfxmb3qkRkpVqAxO-Htbg1AJaJ944uYnbNi0Xx1_-SsGxS_6Tfk_w",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hxipl4I0FZv-uFvTZgJ5UI4Uj6K299vwHTGYSbPRJdqlTt-dKrgOYANyN5AYoB237DQvxGiyWd6vGSe9zeKpwK0k5r0HOC8nnQBWqZn71gsS7scp6Mp8qA8BsLP27fcJjd7BLw01kxxPwWbz59DysHB",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 14:22:35.262 +03:00 [DBG] Success validating end session request from mvc
2018-04-26 14:22:35.268 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:22:35.269 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:22:35.275 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-26 14:22:35.276 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-26 14:22:35.278 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-26 14:22:35.278 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLDBCTF5L5IR:00000013",
  "TimeStamp": "2018-04-26T11:22:35Z",
  "ProcessId": 22644,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 14:22:40.043 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-26 14:22:40.046 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-26 14:22:40.050 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-26 14:22:40.051 +03:00 [DBG] Start authorize request
2018-04-26 14:22:40.052 +03:00 [DBG] No user present in authorize request
2018-04-26 14:22:40.052 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 14:22:40.053 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 14:22:40.054 +03:00 [DBG] No PKCE used.
2018-04-26 14:22:40.057 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 14:22:40.059 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hw_TX8vD_6TfEROIYFdk3vw45UKcDLKLbA6lERSnvco_M-5-BX8fesB0LgPOQSti0_GANF0OLDTB37__rGlBy9GHdtC9LCFvGRezlImWOtEZEDPSRG6fWbdU_nnLc92Xe31-F0OjrZ03FRdh_mW99GbhLOnMfU4ADsR4uqFsWciAc5ZGFTsC7DBNxGmcw46kTZex5YR5nIjQ9e7GQxJoNksSoZ-B47P2R2N6nMKW2vkZHp8PfsURmz7WSwRSuZX7sqdXNaZWixXbajLSWoh6Wg9FAwaqspnGnjPH3w6iplKWoRTWbF-vNfVsKMGg8rLE2A",
  "Nonce": "636603385600214161.NGQ2NzQ5ZDgtOWQyNC00MzAwLTk3YzYtODAyMjMxMTZlZGMyZGU0M2Y3ODctNWEzOC00ZDE3LWI4ZjEtOGM4YWU1NmVkYTll",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603385600214161.NGQ2NzQ5ZDgtOWQyNC00MzAwLTk3YzYtODAyMjMxMTZlZGMyZGU0M2Y3ODctNWEzOC00ZDE3LWI4ZjEtOGM4YWU1NmVkYTll",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hw_TX8vD_6TfEROIYFdk3vw45UKcDLKLbA6lERSnvco_M-5-BX8fesB0LgPOQSti0_GANF0OLDTB37__rGlBy9GHdtC9LCFvGRezlImWOtEZEDPSRG6fWbdU_nnLc92Xe31-F0OjrZ03FRdh_mW99GbhLOnMfU4ADsR4uqFsWciAc5ZGFTsC7DBNxGmcw46kTZex5YR5nIjQ9e7GQxJoNksSoZ-B47P2R2N6nMKW2vkZHp8PfsURmz7WSwRSuZX7sqdXNaZWixXbajLSWoh6Wg9FAwaqspnGnjPH3w6iplKWoRTWbF-vNfVsKMGg8rLE2A",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 14:22:40.065 +03:00 [INF] Showing login: User is not authenticated
2018-04-26 14:22:40.074 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 14:22:40.074 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 14:22:40.075 +03:00 [DBG] No PKCE used.
2018-04-26 14:22:40.076 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 14:22:46.018 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-26 14:22:47.842 +03:00 [DBG] Augmenting SignInContext
2018-04-26 14:22:47.844 +03:00 [DBG] Adding idp claim with value: local
2018-04-26 14:22:47.847 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-26 14:22:47.848 +03:00 [DBG] Adding auth_time claim with value: 1524741767
2018-04-26 14:22:47.849 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-26 14:22:47.965 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLDBCTF5L5IR:00000016",
  "TimeStamp": "2018-04-26T11:22:47Z",
  "ProcessId": 22644,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 14:22:47.976 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:22:47.979 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:22:47.981 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-26 14:22:47.982 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-26 14:22:47.983 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-26 14:22:47.984 +03:00 [DBG] Start authorize callback request
2018-04-26 14:22:47.984 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-26 14:22:47.985 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 14:22:47.989 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 14:22:47.989 +03:00 [DBG] No PKCE used.
2018-04-26 14:22:47.990 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 14:22:47.991 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hw_TX8vD_6TfEROIYFdk3vw45UKcDLKLbA6lERSnvco_M-5-BX8fesB0LgPOQSti0_GANF0OLDTB37__rGlBy9GHdtC9LCFvGRezlImWOtEZEDPSRG6fWbdU_nnLc92Xe31-F0OjrZ03FRdh_mW99GbhLOnMfU4ADsR4uqFsWciAc5ZGFTsC7DBNxGmcw46kTZex5YR5nIjQ9e7GQxJoNksSoZ-B47P2R2N6nMKW2vkZHp8PfsURmz7WSwRSuZX7sqdXNaZWixXbajLSWoh6Wg9FAwaqspnGnjPH3w6iplKWoRTWbF-vNfVsKMGg8rLE2A",
  "Nonce": "636603385600214161.NGQ2NzQ5ZDgtOWQyNC00MzAwLTk3YzYtODAyMjMxMTZlZGMyZGU0M2Y3ODctNWEzOC00ZDE3LWI4ZjEtOGM4YWU1NmVkYTll",
  "SessionId": "cf715cae9d329b53147055abbb679120",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603385600214161.NGQ2NzQ5ZDgtOWQyNC00MzAwLTk3YzYtODAyMjMxMTZlZGMyZGU0M2Y3ODctNWEzOC00ZDE3LWI4ZjEtOGM4YWU1NmVkYTll",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hw_TX8vD_6TfEROIYFdk3vw45UKcDLKLbA6lERSnvco_M-5-BX8fesB0LgPOQSti0_GANF0OLDTB37__rGlBy9GHdtC9LCFvGRezlImWOtEZEDPSRG6fWbdU_nnLc92Xe31-F0OjrZ03FRdh_mW99GbhLOnMfU4ADsR4uqFsWciAc5ZGFTsC7DBNxGmcw46kTZex5YR5nIjQ9e7GQxJoNksSoZ-B47P2R2N6nMKW2vkZHp8PfsURmz7WSwRSuZX7sqdXNaZWixXbajLSWoh6Wg9FAwaqspnGnjPH3w6iplKWoRTWbF-vNfVsKMGg8rLE2A",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 14:22:48.630 +03:00 [DBG] Client is configured to not require consent, no consent is required
2018-04-26 14:22:48.630 +03:00 [DBG] Creating Hybrid Flow response.
2018-04-26 14:22:48.644 +03:00 [DBG] Creating Implicit Flow response.
2018-04-26 14:22:48.644 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-26 14:22:48.646 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-26 14:22:48.651 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Zv9A"
    },
    {
      "TokenType": "code",
      "TokenValue": "****47c5"
    }
  ],
  "ActivityId": "0HLDBCTF5L5IR:00000017",
  "TimeStamp": "2018-04-26T11:22:48Z",
  "ProcessId": 22644,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 14:22:48.654 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hw_TX8vD_6TfEROIYFdk3vw45UKcDLKLbA6lERSnvco_M-5-BX8fesB0LgPOQSti0_GANF0OLDTB37__rGlBy9GHdtC9LCFvGRezlImWOtEZEDPSRG6fWbdU_nnLc92Xe31-F0OjrZ03FRdh_mW99GbhLOnMfU4ADsR4uqFsWciAc5ZGFTsC7DBNxGmcw46kTZex5YR5nIjQ9e7GQxJoNksSoZ-B47P2R2N6nMKW2vkZHp8PfsURmz7WSwRSuZX7sqdXNaZWixXbajLSWoh6Wg9FAwaqspnGnjPH3w6iplKWoRTWbF-vNfVsKMGg8rLE2A",
  "Scope": "openid profile api1"
}
2018-04-26 14:22:48.658 +03:00 [DBG] Augmenting SignInContext
2018-04-26 14:22:48.659 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-26 14:22:49.044 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-04-26 14:22:49.046 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-04-26 14:22:49.048 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-04-26 14:22:49.049 +03:00 [DBG] Start token request.
2018-04-26 14:22:49.050 +03:00 [DBG] Start client validation
2018-04-26 14:22:49.050 +03:00 [DBG] Start parsing Basic Authentication secret
2018-04-26 14:22:49.051 +03:00 [DBG] Start parsing for secret in post body
2018-04-26 14:22:49.052 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-04-26 14:22:49.053 +03:00 [DBG] Secret id found: mvc
2018-04-26 14:22:49.054 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-04-26 14:22:49.055 +03:00 [DBG] Client validation success
2018-04-26 14:22:49.060 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLDBCTF5L5J2:00000003",
  "TimeStamp": "2018-04-26T11:22:49Z",
  "ProcessId": 22644,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 14:22:49.061 +03:00 [DBG] Start token request validation
2018-04-26 14:22:49.061 +03:00 [DBG] Start validation of authorization code token request
2018-04-26 14:22:49.239 +03:00 [DBG] Validation of authorization code token request success
2018-04-26 14:22:49.239 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "984a063444c6429fadafb19bf95bcfd98c1926afc67748178aaaac19d40947c5",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "984a063444c6429fadafb19bf95bcfd98c1926afc67748178aaaac19d40947c5",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-04-26 14:22:49.243 +03:00 [DBG] Getting claims for access token for client: mvc
2018-04-26 14:22:49.243 +03:00 [DBG] Getting claims for access token for subject: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-26 14:22:49.247 +03:00 [DBG] Getting claims for identity token for subject: 8dce434c-0b38-4578-9788-7ff306388283 and client: mvc
2018-04-26 14:22:49.247 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-04-26 14:22:49.252 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Rb8g"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****5oHA"
    }
  ],
  "ActivityId": "0HLDBCTF5L5J2:00000003",
  "TimeStamp": "2018-04-26T11:22:49Z",
  "ProcessId": 22644,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 14:22:49.257 +03:00 [DBG] Token request success.
2018-04-26 14:22:49.269 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-04-26 14:22:49.270 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-04-26 14:22:49.272 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-04-26 14:22:49.273 +03:00 [DBG] Start userinfo request
2018-04-26 14:22:49.276 +03:00 [DBG] Bearer token found in header
2018-04-26 14:22:49.563 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-26 14:22:49.566 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1524741769,
    "exp": 1524745369,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524741767,
    "idp": "local",
    "email": "alice@email.com",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2018-04-26 14:22:49.572 +03:00 [DBG] Creating userinfo response
2018-04-26 14:22:49.572 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-26 14:22:49.573 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-26 14:22:49.573 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-04-26 14:22:49.577 +03:00 [DBG] Scopes in access token: openid profile api1
2018-04-26 14:22:49.578 +03:00 [INF] Profile service returned to the following claim types: email
2018-04-26 14:22:49.579 +03:00 [DBG] End userinfo request
2018-04-26 14:23:07.915 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:23:07.917 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:23:12.607 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:23:12.610 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:23:14.094 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:23:14.096 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:23:17.183 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:23:17.188 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:23:18.502 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:23:18.507 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:23:22.743 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-26 14:23:22.744 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-26 14:23:22.746 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-26 14:23:22.748 +03:00 [DBG] Start discovery request
2018-04-26 14:23:22.936 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-26 14:23:22.938 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-26 14:23:22.939 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-26 14:23:22.942 +03:00 [DBG] Start key discovery request
2018-04-26 14:24:53.686 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-26 14:24:53.734 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-26 14:24:53.737 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-26 14:24:53.738 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-26 14:24:53.738 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-26 14:24:53.738 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-26 14:24:54.260 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:24:54.278 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:25:20.811 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-04-26 14:25:20.818 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-04-26 14:25:20.820 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-04-26 14:25:20.825 +03:00 [DBG] Start discovery request
2018-04-26 14:25:21.169 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-04-26 14:25:21.173 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-04-26 14:25:21.175 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-04-26 14:25:21.181 +03:00 [DBG] Start key discovery request
2018-04-26 14:25:21.280 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:25:21.283 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:25:21.284 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-04-26 14:25:21.290 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-04-26 14:25:21.294 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-04-26 14:25:21.312 +03:00 [DBG] Processing signout request for 8dce434c-0b38-4578-9788-7ff306388283
2018-04-26 14:25:21.322 +03:00 [DBG] Start end session request validation
2018-04-26 14:25:21.332 +03:00 [DBG] Start identity token validation
2018-04-26 14:25:21.365 +03:00 [DBG] Client found: mvc / MVC Client
2018-04-26 14:25:22.806 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-04-26 14:25:22.815 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1524741769,
    "exp": 1524742069,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636603385600214161.NGQ2NzQ5ZDgtOWQyNC00MzAwLTk3YzYtODAyMjMxMTZlZGMyZGU0M2Y3ODctNWEzOC00ZDE3LWI4ZjEtOGM4YWU1NmVkYTll",
    "iat": 1524741769,
    "at_hash": "AM1ym_vP3M6VZliV7HVb0g",
    "sid": "cf715cae9d329b53147055abbb679120",
    "sub": "8dce434c-0b38-4578-9788-7ff306388283",
    "auth_time": 1524741767,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-04-26 14:25:22.837 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hysEEO32zG0NXxobhpCVo5ykTVI-gXasi_bcSomF_Rv0wO0Prj1UItq1GxBf5Dy6oKPwHfqZuWOWf7g_0vNwRQ6SK-BuCVGMp_Gk1C795-vzH_UPpxrhsPd9Od728As-U3QA8h7m-OjPxE5z4sQL3zt",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImMzZGJiZjFlYTkyMDk2YmUwN2U3ZjU5MDE1NDBkYmFmIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MjQ3NDE3NjksImV4cCI6MTUyNDc0MjA2OSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY2MDMzODU2MDAyMTQxNjEuTkdRMk56UTVaRGd0T1dReU5DMDBNekF3TFRrM1l6WXRPREF5TWpNeE1UWmxaR015WkdVME0yWTNPRGN0TldFek9DMDBaREUzTFdJNFpqRXRPR000WVdVMU5tVmtZVGxsIiwiaWF0IjoxNTI0NzQxNzY5LCJhdF9oYXNoIjoiQU0xeW1fdlAzTTZWWmxpVjdIVmIwZyIsInNpZCI6ImNmNzE1Y2FlOWQzMjliNTMxNDcwNTVhYmJiNjc5MTIwIiwic3ViIjoiOGRjZTQzNGMtMGIzOC00NTc4LTk3ODgtN2ZmMzA2Mzg4MjgzIiwiYXV0aF90aW1lIjoxNTI0NzQxNzY3LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.quMqTzhA2vjCZC_Dlez0_99jEe8hiGL3FfDgWsk4_VEyBVnPwzl61xuJXHgrEPZmpCm5ltNt6pxlldsKisUb8hOP6YN7-UMG7IP3Hr69RUFlV6siR8sxxzX4sXcEX_45WgoZefl4J5CMXM9wg6wItsQdbQKv4wIXSQCxK8pMF3WQgZKk8YWtB72SBwjdhcuJ89wfgVFh_iTjgbRAly4M8A2sbvMueDWwPbtfig668uJo_6duqFonWh-ZQ83uwyGcIwub1C68_y9giEaXE7wBxdWTMOzlZPAIh3GOrFXi_r0liWU6ZXy-6jURvHIioFAEO10XaG9jyZyCk-4OuvRb8g",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hysEEO32zG0NXxobhpCVo5ykTVI-gXasi_bcSomF_Rv0wO0Prj1UItq1GxBf5Dy6oKPwHfqZuWOWf7g_0vNwRQ6SK-BuCVGMp_Gk1C795-vzH_UPpxrhsPd9Od728As-U3QA8h7m-OjPxE5z4sQL3zt",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 14:25:22.848 +03:00 [DBG] Success validating end session request from mvc
2018-04-26 14:25:22.904 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:25:22.906 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:25:23.007 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-26 14:25:23.010 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-26 14:25:23.014 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-26 14:25:23.048 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLDBD1ALDBTG:00000003",
  "TimeStamp": "2018-04-26T11:25:23Z",
  "ProcessId": 8028,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 14:25:23.345 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-04-26 14:25:23.350 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-04-26 14:25:23.351 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-04-26 14:25:23.358 +03:00 [DBG] Processing signout callback request
2018-04-26 14:25:23.374 +03:00 [DBG] No client front-channel logout URLs
2018-04-26 14:25:23.374 +03:00 [DBG] No client back-channel logout URLs
2018-04-26 14:25:23.376 +03:00 [INF] Successful signout callback.
2018-04-26 14:25:23.376 +03:00 [DBG] No client front-channel iframe urls
2018-04-26 14:25:23.379 +03:00 [DBG] No client back-channel iframe urls
2018-04-26 14:25:26.654 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-04-26 14:25:26.660 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-04-26 14:25:26.661 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-04-26 14:25:26.667 +03:00 [DBG] Start authorize request
2018-04-26 14:25:26.673 +03:00 [DBG] No user present in authorize request
2018-04-26 14:25:26.679 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 14:25:26.691 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 14:25:26.694 +03:00 [DBG] No PKCE used.
2018-04-26 14:25:26.737 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 14:25:26.751 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hz1d-_sqvKnDutnTPKu9v6EKQ-mPmlf8mYYpAEFxHoW79IX__Gcx4PjHKA62Vt22w8mLCGRFcYwG9hsxk92IYjGJHDQ0vSnHSdHuRa168G6dwrEJCd4BZ9pk1a8ktpH5XOioABKkt7xURed05_Sg7jd4ShrLom8XVbuc1XI2-o194qveOM1ZVrNI6j07OU89in_ScAxFdCxCuCl5k4IkG-4GOKSvoPFi8loOnuRbwONSI2JKc3aHbnCq1tkj-RCukyH6tpJhQ5cykmlUAhgeUu5UKEgWqyeBnX-PB1wCX2ASWZb__uQIDqOAngl4fGTY6g",
  "Nonce": "636603387266361731.NzYwZjg1ZDItM2I0NS00ZmZmLTgxMWQtZWE3ZDk5ZDA1MGU5OGUzZTRmY2YtM2U1OS00NGQyLTk1YzgtYzkxZWI2MTllMDBm",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603387266361731.NzYwZjg1ZDItM2I0NS00ZmZmLTgxMWQtZWE3ZDk5ZDA1MGU5OGUzZTRmY2YtM2U1OS00NGQyLTk1YzgtYzkxZWI2MTllMDBm",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hz1d-_sqvKnDutnTPKu9v6EKQ-mPmlf8mYYpAEFxHoW79IX__Gcx4PjHKA62Vt22w8mLCGRFcYwG9hsxk92IYjGJHDQ0vSnHSdHuRa168G6dwrEJCd4BZ9pk1a8ktpH5XOioABKkt7xURed05_Sg7jd4ShrLom8XVbuc1XI2-o194qveOM1ZVrNI6j07OU89in_ScAxFdCxCuCl5k4IkG-4GOKSvoPFi8loOnuRbwONSI2JKc3aHbnCq1tkj-RCukyH6tpJhQ5cykmlUAhgeUu5UKEgWqyeBnX-PB1wCX2ASWZb__uQIDqOAngl4fGTY6g",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 14:25:26.770 +03:00 [INF] Showing login: User is not authenticated
2018-04-26 14:25:26.802 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 14:25:26.803 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 14:25:26.805 +03:00 [DBG] No PKCE used.
2018-04-26 14:25:26.805 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 14:25:37.914 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-26 14:25:38.607 +03:00 [DBG] Augmenting SignInContext
2018-04-26 14:25:38.610 +03:00 [DBG] Adding idp claim with value: local
2018-04-26 14:25:38.612 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-26 14:25:38.614 +03:00 [DBG] Adding auth_time claim with value: 1524741938
2018-04-26 14:25:38.620 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-26 14:25:39.262 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLDBD1ALDBTK:00000001",
  "TimeStamp": "2018-04-26T11:25:39Z",
  "ProcessId": 8028,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 14:25:39.273 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:25:39.275 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:25:39.277 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-04-26 14:25:39.280 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-04-26 14:25:39.281 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-04-26 14:25:39.288 +03:00 [DBG] Start authorize callback request
2018-04-26 14:25:39.292 +03:00 [DBG] User in authorize request: 8dce434c-0b38-4578-9788-7ff306388283
2018-04-26 14:25:39.295 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 14:25:39.296 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 14:25:39.297 +03:00 [DBG] No PKCE used.
2018-04-26 14:25:39.298 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 14:25:39.302 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1",
  "State": "CfDJ8FhtMD-ynWpMsa2i663R4hz1d-_sqvKnDutnTPKu9v6EKQ-mPmlf8mYYpAEFxHoW79IX__Gcx4PjHKA62Vt22w8mLCGRFcYwG9hsxk92IYjGJHDQ0vSnHSdHuRa168G6dwrEJCd4BZ9pk1a8ktpH5XOioABKkt7xURed05_Sg7jd4ShrLom8XVbuc1XI2-o194qveOM1ZVrNI6j07OU89in_ScAxFdCxCuCl5k4IkG-4GOKSvoPFi8loOnuRbwONSI2JKc3aHbnCq1tkj-RCukyH6tpJhQ5cykmlUAhgeUu5UKEgWqyeBnX-PB1wCX2ASWZb__uQIDqOAngl4fGTY6g",
  "Nonce": "636603387266361731.NzYwZjg1ZDItM2I0NS00ZmZmLTgxMWQtZWE3ZDk5ZDA1MGU5OGUzZTRmY2YtM2U1OS00NGQyLTk1YzgtYzkxZWI2MTllMDBm",
  "SessionId": "1f985b889a948cb9bd5221e84c8d6a52",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1",
    "response_mode": "form_post",
    "nonce": "636603387266361731.NzYwZjg1ZDItM2I0NS00ZmZmLTgxMWQtZWE3ZDk5ZDA1MGU5OGUzZTRmY2YtM2U1OS00NGQyLTk1YzgtYzkxZWI2MTllMDBm",
    "state": "CfDJ8FhtMD-ynWpMsa2i663R4hz1d-_sqvKnDutnTPKu9v6EKQ-mPmlf8mYYpAEFxHoW79IX__Gcx4PjHKA62Vt22w8mLCGRFcYwG9hsxk92IYjGJHDQ0vSnHSdHuRa168G6dwrEJCd4BZ9pk1a8ktpH5XOioABKkt7xURed05_Sg7jd4ShrLom8XVbuc1XI2-o194qveOM1ZVrNI6j07OU89in_ScAxFdCxCuCl5k4IkG-4GOKSvoPFi8loOnuRbwONSI2JKc3aHbnCq1tkj-RCukyH6tpJhQ5cykmlUAhgeUu5UKEgWqyeBnX-PB1wCX2ASWZb__uQIDqOAngl4fGTY6g",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-04-26 14:25:40.052 +03:00 [DBG] user_consent grant with value: mvc|8dce434c-0b38-4578-9788-7ff306388283 not found in store.
2018-04-26 14:25:40.056 +03:00 [DBG] Found no prior consent from consent store, consent is required
2018-04-26 14:25:40.056 +03:00 [INF] Showing consent: User has not yet consented
2018-04-26 14:25:40.065 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:25:40.066 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 14:25:40.082 +03:00 [DBG] Start authorize request protocol validation
2018-04-26 14:25:40.083 +03:00 [DBG] Checking for PKCE parameters
2018-04-26 14:25:40.085 +03:00 [DBG] No PKCE used.
2018-04-26 14:25:40.086 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-04-26 16:58:57.181 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-26 16:58:57.239 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-26 16:58:57.243 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-26 16:58:57.244 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-26 16:58:57.244 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-26 16:58:57.244 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-26 16:58:59.870 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 16:58:59.888 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 16:59:05.406 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 16:59:05.409 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 16:59:08.373 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 16:59:08.376 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 16:59:10.711 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 16:59:10.715 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 16:59:15.081 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 16:59:15.084 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 16:59:22.097 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 16:59:22.100 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 16:59:25.505 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 16:59:25.508 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 16:59:45.456 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 16:59:45.459 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 16:59:45.613 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.InvalidOperationException: The partial view '_ValidationScriptsPartial' was not found. The following locations were searched:
/Views/Account/_ValidationScriptsPartial.cshtml
/Views/Shared/_ValidationScriptsPartial.cshtml
   at Microsoft.AspNetCore.Mvc.ViewFeatures.HtmlHelper.<RenderPartialCoreAsync>d__60.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.HtmlHelper.<PartialAsync>d__57.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at AspNetCore._Views_Account_ForgotPassword_cshtml.<<ExecuteAsync>b__16_5>d.MoveNext() in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Views\Account\ForgotPassword.cshtml:line 24
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.<RenderSectionAsyncCore>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at AspNetCore._Views_Shared__Layout_cshtml.<>c__DisplayClass24_0.<<ExecuteAsync>b__5>d.MoveNext() in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Views\Shared\_Layout.cshtml:line 59
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.<SetOutputContentAsync>d__30.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at AspNetCore._Views_Shared__Layout_cshtml.<ExecuteAsync>d__24.MoveNext() in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Views\Shared\_Layout.cshtml:line 7
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.<RenderPageCoreAsync>d__16.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.<RenderPageAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.<RenderLayoutAsync>d__18.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.<RenderAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.<ExecuteAsync>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.<ExecuteAsync>d__21.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.ViewResult.<ExecuteResultAsync>d__26.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeResultAsync>d__19.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResultFilterAsync>d__24.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-26 17:00:02.519 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 17:00:02.524 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 17:00:02.538 +03:00 [ERR] An unhandled exception has occurred while executing the request
System.ApplicationException: A code must be supplied for password reset.
   at PrimeApps.Auth.UI.AccountController.ResetPassword(String code) in C:\Users\Developer\Desktop\IdentityServer4.Samples-dev\IdentityServer4.Samples-dev\Quickstarts\6_AspNetIdentity\src\PrimeApps.Auth\Controllers\AccountController.cs:line 142
   at lambda_method(Closure , Object , Object[] )
   at Microsoft.Extensions.Internal.ObjectMethodExecutor.Execute(Object target, Object[] parameters)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeActionMethodAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeNextActionFilterAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-26 17:02:36.526 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 17:02:36.529 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 17:02:38.261 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 17:02:38.264 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 17:02:39.533 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 17:02:39.538 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 17:02:40.608 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-26 17:02:40.613 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 17:02:40.616 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 17:02:40.655 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-26 17:02:40.658 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-26 17:02:40.659 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-26 17:02:40.745 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLDBFNDHVL8A:00000004",
  "TimeStamp": "2018-04-26T14:02:40Z",
  "ProcessId": 18580,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 17:02:44.399 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-26 17:02:48.723 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-26 17:02:49.110 +03:00 [DBG] Augmenting SignInContext
2018-04-26 17:02:49.113 +03:00 [DBG] Adding idp claim with value: local
2018-04-26 17:02:49.113 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-26 17:02:49.115 +03:00 [DBG] Adding auth_time claim with value: 1524751369
2018-04-26 17:02:49.122 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-26 17:02:49.242 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLDBFNDHVL8A:00000008",
  "TimeStamp": "2018-04-26T14:02:49Z",
  "ProcessId": 18580,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-26 17:02:49.252 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-26 17:02:49.254 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-27 10:54:42.840 +03:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-04-27 10:54:42.899 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-27 10:54:42.906 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-27 10:54:42.910 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-27 10:54:42.913 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-27 10:54:42.915 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-27 10:55:15.153 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-27 10:55:15.178 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-27 10:59:32.624 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-27 10:59:32.629 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-27 11:00:44.526 +03:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-27 11:00:44.533 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-27 11:00:44.538 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-27 11:00:44.615 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-04-27 11:00:44.620 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-27 11:00:44.627 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-04-27 11:00:46.528 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "ActivityId": "0HLDC2GHJ32I3:00000003",
  "TimeStamp": "2018-04-27T08:00:46Z",
  "ProcessId": 14576,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-27 11:00:51.220 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-27 11:00:58.854 +03:00 [INF] AuthenticationScheme: aad was challenged.
2018-04-27 11:01:13.642 +03:00 [DBG] CORS request made for path: /signin-oidc from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-27 11:01:15.729 +03:00 [INF] AuthenticationScheme: Identity.External signed in.
2018-04-27 11:01:15.759 +03:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2018-04-27 11:02:40.346 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Provider": "aad",
  "ProviderUserId": "kf7GBTTP-bR2JBCjNWq_BNVumdJG9GUT8xsTCTpJ3rQ",
  "SubjectId": "10ba2785-d624-4ec6-91d6-28ae03f9b6d3",
  "DisplayName": "Bahadır Civelek",
  "Endpoint": "UI",
  "ActivityId": "0HLDC2GHJ32I3:00000009",
  "TimeStamp": "2018-04-27T08:02:40Z",
  "ProcessId": 14576,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-27 11:02:40.366 +03:00 [DBG] Augmenting SignInContext
2018-04-27 11:02:40.373 +03:00 [DBG] Adding amr claim with value: external
2018-04-27 11:02:40.380 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-27 11:02:40.384 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-04-27 11:02:40.404 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-27 11:02:40.407 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-27 13:45:15.739 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-27 13:45:15.815 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-27 13:45:15.819 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-27 13:45:15.821 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-27 13:45:15.823 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-27 13:45:16.386 +03:00 [DBG] Starting token cleanup
2018-04-27 13:53:17.020 +03:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-04-27 13:53:38.481 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-04-27 13:53:41.683 +03:00 [DBG] Augmenting SignInContext
2018-04-27 13:53:41.698 +03:00 [DBG] Adding idp claim with value: local
2018-04-27 13:53:41.702 +03:00 [DBG] Adding amr claim with value: pwd
2018-04-27 13:53:41.706 +03:00 [DBG] Adding auth_time claim with value: 1524826421
2018-04-27 13:53:41.755 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-04-27 13:53:41.950 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "8dce434c-0b38-4578-9788-7ff306388283",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLDC5FRAJ1KV:00000003",
  "TimeStamp": "2018-04-27T10:53:41Z",
  "ProcessId": 24496,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-04-27 13:53:42.023 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-27 13:53:42.029 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-04-27 13:53:42.217 +03:00 [ERR] Failed executing DbCommand (103ms) [Parameters=[@__subjectId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT "x"."Key", "x"."ClientId", "x"."CreationTime", "x"."Data", "x"."Expiration", "x"."SubjectId", "x"."Type"
FROM "PersistedGrants" AS "x"
WHERE "x"."SubjectId" = @__subjectId_0
Npgsql.PostgresException (0x80004005): 42P01: relation "PersistedGrants" does not exist
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
2018-04-27 13:53:42.335 +03:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'IdentityServer4.EntityFramework.DbContexts.PersistedGrantDbContext'.
Npgsql.PostgresException (0x80004005): 42P01: relation "PersistedGrants" does not exist
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(Boolean buffer)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.<_TrackEntities>d__17`2.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
Npgsql.PostgresException (0x80004005): 42P01: relation "PersistedGrants" does not exist
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(Boolean buffer)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.<_TrackEntities>d__17`2.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
2018-04-27 13:53:43.967 +03:00 [ERR] An unhandled exception has occurred while executing the request
Npgsql.PostgresException (0x80004005): 42P01: relation "PersistedGrants" does not exist
   at Npgsql.NpgsqlConnector.<DoReadMessage>d__155.MoveNext()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
   at Npgsql.NpgsqlConnector.<ReadMessage>d__154.MoveNext()
   at Npgsql.NpgsqlConnector.<ReadExpecting>d__161`1.MoveNext()
   at Npgsql.NpgsqlDataReader.<NextResult>d__32.MoveNext()
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.<Execute>d__71.MoveNext()
   at Npgsql.NpgsqlCommand.<ExecuteDbDataReader>d__92.MoveNext()
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(Boolean buffer)
   at Microsoft.EntityFrameworkCore.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.<_TrackEntities>d__17`2.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
   at System.Collections.Generic.List`1.AddEnumerable(IEnumerable`1 enumerable)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at IdentityServer4.EntityFramework.Stores.PersistedGrantStore.GetAllAsync(String subjectId)
   at IdentityServer4.Services.DefaultPersistedGrantService.<GetAllGrantsAsync>d__4.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Services\DefaultPersistedGrantService.cs:line 47
   at IdentityServer4.Services.DefaultIdentityServerInteractionService.<GetAllUserConsentsAsync>d__16.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Services\DefaultIdentityServerInteractionService.cs:line 159
   at PrimeApps.Auth.UI.GrantsController.<BuildViewModelAsync>d__6.MoveNext() in C:\PrimeApps\PrimeApps.Auth\Controllers\GrantsController.cs:line 57
   at PrimeApps.Auth.UI.GrantsController.<Index>d__4.MoveNext() in C:\PrimeApps\PrimeApps.Auth\Controllers\GrantsController.cs:line 41
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeActionMethodAsync>d__12.MoveNext()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeNextActionFilterAsync>d__10.MoveNext()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext() in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 43
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.<Invoke>d__4.MoveNext()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.<Invoke>d__6.MoveNext()
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2018-04-27 15:00:27.656 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-04-27 15:00:27.733 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-04-27 15:00:27.738 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-04-27 15:00:27.741 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-04-27 15:00:27.745 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-04-27 15:00:28.207 +03:00 [DBG] Starting token cleanup
