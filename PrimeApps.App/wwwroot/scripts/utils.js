"use strict";angular.module("primeapps").factory("$localStorage",["$window",function(e){return{set:function(n,t){e.localStorage[n]=angular.toJson(t)},get:function(e){var n=this.read(e);return n?angular.fromJson(n):null},write:function(n,t){e.localStorage[n]=t},read:function(n){return e.localStorage[n]},remove:function(n){e.localStorage.removeItem(n)}}}]).factory("$sessionStorage",["$window",function(e){return{set:function(n,t){e.sessionStorage[n]=angular.toJson(t)},get:function(e){var n=this.read(e);return n?angular.fromJson(n):null},write:function(n,t){e.sessionStorage[n]=t},read:function(n){return e.sessionStorage[n]},remove:function(n){e.sessionStorage.removeItem(n)},clear:function(){e.sessionStorage.clear()}}}]).factory("$cache",["$cacheFactory",function(e){return e("primeapps")}]).factory("sipHelper",["$rootScope","$timeout","$filter","$localStorage","$sessionStorage","$q","$http","config","$cache","$state","$window","$popover",function(e,n,t,r,s,o,i,a,l,u,c,f){function p(t){t&&(t.off("bye"),t.off("progress"),t.off("accepted"),t.off("rejected"),t.off("cancel"),t.off("terminated"),t.off("muted"),t.off("unmuted"),t.off("hold"),t.off("unhold"),t.off("refer"),t.off("failed"),t=null),e.sipUser.session&&n(function(){e.sipUser.session=null})}function d(e,n){var t=document.getElementById(e);"play"==n?(t.play(),t.loop=!0):(t.pause(),t.currentTime=0)}function m(r,s){r.on("bye",function(){}),r.on("failed",function(){}),r.on("progress",function(){n(function(){"OUTBOUND"==s?(e.sipUser.lineInfo.PhoneStatus=t("translate")("Setup.Phone.Ringing"),e.sipUser.lineInfo.State="Ringing",d("DialSound","play")):(e.sipUser.lineInfo.PhoneStatus=t("translate")("Setup.Phone.IncomingCall"),U.showSipPhone("call"),e.sipUser.lineInfo.State=t("translate")("Setup.Phone.IncomingCall"),e.sipUser.activePhoneScreen="connectingScreen")})}),r.on("cancel",function(){n(function(){d("IncomingSound","pause"),d("DialSound","pause"),e.sipUser.lineInfo.PhoneStatus=t("translate")("Setup.Phone.CanceledByUser"),e.sipUser.lineInfo.State="Cancel"})}),r.on("accepted",function(){n(function(){e.transferShow="IncomingCall"==e.sipUser.lineInfo.State?!0:!1,e.sipUser.lineInfo.PhoneStatus=t("translate")("Setup.Phone.CallActive"),e.sipUser.lineInfo.State="Active",d("DialSound","pause"),d("IncomingSound","pause");var n=document.getElementsByTagName("video")[0],s=r.mediaHandler.getRemoteStreams()[0];"undefined"!=typeof n.srcObject?n.srcObject=s:"undefined"!=typeof n.mozSrcObject?n.mozSrcObject=s:"undefined"!=typeof n.src&&(n.src=URL.createObjectURL(s)),h()})}),r.on("rejected",function(t){e.sipUser.session===r&&n(function(){"OUTBOUND"===s&&(d("DialSound","pause"),d("BusySound","play"),"OUTBOUND"==s&&(e.sipUser.lineInfo.PhoneStatus=t.reason_phrase,e.sipUser.lineInfo.State="Reject"))})}),r.on("muted",function(){n(function(){e.sipUser.lineInfo.PhoneStatus=t("translate")("Setup.Phone.CallMuted"),e.sipUser.lineInfo.State="Active",e.sipUser.lineInfo.IsMuted=!0})}),r.on("unmuted",function(){n(function(){d("DialSound","pause"),d("IncomingSound","pause"),e.sipUser.lineInfo.PhoneStatus=t("translate")("Setup.Phone.CallActive"),e.sipUser.lineInfo.State="Active",e.sipUser.lineInfo.IsMuted=!1})}),r.on("hold",function(){n(function(){e.sipUser.lineInfo.PhoneStatus=t("translate")("Setup.Phone.Hold"),e.sipUser.lineInfo.State="Active",e.sipUser.lineInfo.IsHold=!0})}),r.on("unhold",function(){n(function(){d("DialSound","pause"),d("IncomingSound","pause"),e.sipUser.lineInfo.PhoneStatus=t("translate")("Setup.Phone.CallActive"),e.sipUser.lineInfo.State="Active",e.sipUser.lineInfo.IsHold=!1})}),r.on("refer",r.followRefer(function(){})),r.on("terminated",function(){n(function(){e.sipUser.session=null,e.sipUser.lineInfo.PhoneStatus=t("translate")("Setup.Phone.Hangup"),e.sipUser.lineInfo.State="Hangup",n(function(){d("BusySound","pause"),e.sipUser.userAgent.isRegistered()&&(e.sipUser.lineInfo.PhoneStatus=t("translate")("Setup.Phone.Ready"),e.sipUser.lineInfo.State="Ready",e.sipUser.lineInfo.TalkingTimer=0,e.sipUser.lineInfo.ActiveNumber=null,e.sipUser.activePhoneScreen="readyScreen",e.sipUser.lineInfo.ModuleName=null,e.sipUser.lineInfo.RecordId=null,e.sipUser.lineInfo.TalkingRecordInfo=null,e.transferShow=!1,e.sipUser.lineInfo.IsMuted=!1,e.sipUser.lineInfo.IsHold=!1)},1e3),p(r),g()},2e3)})}function h(){e.sipUser.lineInfo.TalkingTimer++,S=n(h,1e3)}function g(){n.cancel(S),e.sipUser.lineInfo.TalkingTimer=0}function v(r,s,o){var l=t("filter")(e.modules,{name:r},!0)[0],u=t("filter")(l.fields,{primary:!0})[0],c=[];c.push("id"),c.push(u.name);var f={fields:c,filters:[],sort_field:"id",sort_direction:"asc",limit:1,offset:0};f.filters.push({field:s,operator:"contains",value:o.substring(2,12),no:1}),i.post(a.apiUrl+"record/find/"+r,f).then(function(i){var a,l;if(i.data&&i.data.length){var c=i.data[0];a=c[u.name],l=c.id}else a=t("translate")("Common.NewRecord"),l=0;n(function(){e.sipUser.lineInfo.ModuleName=r,e.sipUser.lineInfo.RecordId=l,e.sipUser.lineInfo.TalkingRecordInfo=a,e.sipUser.lineInfo.Field=s,e.sipUser.lineInfo.Value=o})})}var U=this,S=null;return{register:function(){var r=this;e.sipUser.userAgent||(e.sipUser.userAgent=new SIP.UA({uri:e.sipUser.Extension+"@"+e.sipUser.SipUri,wsServers:[e.sipUser.Server],authorizationUser:e.sipUser.Extension,password:e.sipUser.Password,log:{builtinEnabled:!1,level:0},rtcpMuxPolicy:"negotiate"}),e.sipUser.userAgent.on("connecting",function(){e.sipUser.events.IsConnecting=!0,e.sipUser.lineInfo.PhoneStatus=t("translate")("Setup.Phone.Connecting"),e.sipUser.lineInfo.State="Connecting"}),e.sipUser.userAgent.on("unregistered",function(){n(function(){e.sipUser.events.IsRegistered=!1,e.sipUser.events.IsConnecting=!1,e.sipUser.lineInfo.PhoneStatus=t("translate")("Setup.Phone.Unregistered"),e.sipUser.lineInfo.State="Unregistered"})}),e.sipUser.userAgent.on("registered",function(){n(function(){e.sipUser.events.IsRegistered=!0,e.sipUser.events.IsConnecting=!1,e.sipUser.lineInfo.PhoneStatus=t("translate")("Setup.Phone.Ready"),e.sipUser.lineInfo.State="Ready"})}),e.sipUser.userAgent.on("disconnected",function(){n(function(){e.sipUser.events.IsRegistered=!1,e.sipUser.events.IsConnecting=!1,e.sipUser.lineInfo.PhoneStatus=t("translate")("Setup.Phone.Disconnected"),e.sipUser.lineInfo.State="Disconnected"})}),e.sipUser.userAgent.on("registrationFailed",function(){n(function(){e.sipUser.events.IsRegistered=!1,e.sipUser.events.IsConnecting=!1,e.sipUser.events.RegistrationError=!0,e.sipUser.lineInfo.PhoneStatus=t("translate")("Setup.Phone.RegistrationError"),e.sipUser.lineInfo.State="RegistrationError"})}),e.sipUser.userAgent.on("invite",function(s){if(null===e.sipUser.session)n(function(){e.sipUser.lineInfo.PhoneStatus=t("translate")("Setup.Phone.IncomingCall"),r.showSipPhone("call"),e.sipUser.lineInfo.State="IncomingCall",e.sipUser.activePhoneScreen="connectingScreen",e.sipUser.lineInfo.TalkingNumber=s.request.from.friendlyName}),m(s,"INBOUND"),n(function(){d("IncomingSound","play"),e.sipUser.session=s,e.sipUser.lineInfo.ActiveNumber=s.request.from.friendlyName,v(e.sipUser.RecordDetailModuleName,e.sipUser.RecordDetailPhoneFieldName,e.sipUser.lineInfo.TalkingNumber)});else{var o={statusCode:600};s.reject(o)}}),e.sipUser.userAgent.off("invite",function(){n(function(){e.sipUser.session=null,e.sipUser.userAgent.isRegistered()?(e.sipUser.lineInfo.PhoneStatus=t("translate")("Setup.Phone.Ready"),e.sipUser.lineInfo.State="Ready"):(e.sipUser.lineInfo.PhoneStatus=t("translate")("Setup.Phone.Hangup"),e.sipUser.lineInfo.State="Hangup")})}))},unRegister:function(){var n={all:!0};e.sipUser.userAgent.unregister(n),e.sipUser.userAgent=null,p(e.sipUser.session)},isRegistered:function(){e.sipUser.IsRegistered=e.sipUser.userAgent.isRegistered()?!0:!1},getUA:function(){return e.sipUser.userAgent},dial:function(t){var r={media:{constraints:{audio:!0,video:!1}}},s=e.sipUser.userAgent.invite(t,r);m(s,"OUTBOUND"),n(function(){e.sipUser.session=s})},transfer:function(n){e.sipUser.session.refer(n)},mute:function(){e.sipUser.session.mute()},hold:function(){e.sipUser.session.hold()},unmute:function(){e.sipUser.session.unmute()},unhold:function(){e.sipUser.session.unhold()},isOutGoingRequest:function(e){return e.request?e.request.server_transaction?!1:!0:null},goRecordDetail:function(n,t){"true"===e.sipUser.IsAutoRecordDetail&&(c.location.href="#/app/module/"+n+"?id="+t)},findRecordGoDetail:function(e,n,t){v(e,n,t)},showSipPhone:function(n){void 0==n?e.sipPhone||(e.sipPhone={},e.sipPhone[e.app]=e.sipPhone[e.app]||f(angular.element(document.getElementById("sipPhoneBtn")),{templateUrl:cdnUrl+"view/app/phone/sipPhone.html",placement:"bottom",animation:"am-flip-x",scope:e,container:"body",autoClose:!1,show:!0,delay:{show:500,hide:100}})):e.sipPhone?e.sipPhone[e.app].show():this.showSipPhone()}}}]).factory("helper",["$rootScope","$timeout","$filter","$localStorage","$sessionStorage","$q","$http","config","$cache",function(e,n,t,r,s,o,i,a,l){return{hasCustomProfilePermission:function(n){if(!(e.customProfilePermissions&&e.customProfilePermissions.length>0))return!1;for(var t=0;t<e.customProfilePermissions.length;t++){var r=e.customProfilePermissions[t];if(r.profileId==e.user.profile.id){for(var s=!1,o=0;o<r.permissions.length;o++){var i=r.permissions[o];i==n&&(s=!0)}return s?!0:!1}}return!1},SnakeToCamel:function(e,n){function t(e,n,r){if(0===r||!angular.isObject(e))return e;for(var s={},o=Object.keys(e),i=0;i<o.length;i++)s[n(o[i])]=t(e[o[i]],n,r-1);return s}function r(e){var n="_",t=/(?=[A-Z])/;return e.split(t).join(n).toLowerCase()}return angular.isObject(e)?("undefined"==typeof n&&(n=1),t(e,r,n)):r(e)},getTime:function(e){if(!e)return"";var n=new Date(e);return n.getTime()},dateDiff:function(e){var n=new Date;n.setHours(0,0,0,0);var t=Math.floor((e>n?e-n:n-e)/864e5);return t},hideLoader:function(){-1===document.body.className.indexOf("loaded")&&(document.body.className+=" loaded"),n(function(){var e=document.getElementById("loader");e&&e.parentNode.removeChild(e)},300)},getFileExtension:function(e){var n=e.split(".");return n.length<2?"":n=n[n.length-1].toLowerCase()||""},arrayObjectIndexOf:function(e,n){for(var t=0;t<e.length;t++)if(angular.equals(e[t],n))return t;return-1},hasPermission:function(n,r,s){"related_to"===n&&(n="activities"),"stage_history"===n&&(n="opportunities");var o=t("filter")(e.modules,{name:n},!0)[0];if(!o)return!1;var i=t("filter")(e.user.profile.permissions,{module_id:o.id},!0)[0];if(i&&i[r])return("Modify"===r||"Remove"===r)&&s&&(!s.shared_users_edit||-1===s.shared_users_edit.indexOf(e.user.ID))&&s.shared_users&&s.shared_users.indexOf(e.user.ID)>-1?!1:!0;if(s)switch(r){case"Read":if(s.shared_users&&s.shared_users.indexOf(e.user.id)>-1)return!0;if(s.shared_user_groups&&e.user.groups.length)for(var a in s.shared_user_groups)if(e.user.groups.indexOf(s.shared_user_groups[a])>-1)return!0;return!1;case"Remove":case"Modify":if(e.user.profile.has_admin_rights)return!0;if(s.shared_users_edit&&s.shared_users_edit.indexOf(e.user.id)>-1)return!0;if(s.shared_user_groups_edit)for(var a in s.shared_user_groups_edit)if(e.user.groups.indexOf(s.shared_user_groups_edit[a])>-1)return!0;return!1}return!1},hasDocumentsPermission:function(n){var r=t("filter")(e.user.profile.permissions,{type:1})[0];return r?r[n]:!1},hasAdminRights:function(){return e.user.profile.has_admin_rights},getCulture:function(){var e=r.read("NG_TRANSLATE_LANG_KEY")||"tr";switch(e){case"tr":return"tr-TR";case"en":return"en-US"}},getCurrency:function(){var e=r.read("NG_TRANSLATE_LANG_KEY")||"tr";switch(e){case"tr":return"TRY";case"en":return"USD"}},getCurrentDateMin:function(){var e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e},getCurrentDateMax:function(){var e=new Date;return e.setHours(23),e.setMinutes(59),e.setSeconds(59),e.setMilliseconds(0),e},floorMinutes:function(e){var n=3e5;return new Date(Math.floor(e.getTime()/n)*n)},lookupProfile:function(e,n){var t=o.defer();if(!e&&!n)return t.resolve([]),t.promise;var r={fields:["id","name"],filters:[{field:"name",operator:"starts_with",value:e,no:1},{field:"deleted",operator:"equals",value:!1,no:2}],limit:20,sort_field:"name",sort_direction:"asc"};return e||(r.filters.shift(),r.filters[0].no=1),i.post(a.apiUrl+"record/find/profiles",r).then(function(e){if(e=e.data,!e)return t.resolve([]),t.promise;for(var n=[],r=0;r<e.length;r++){var s=e[r],o={};o.id=s.id,o.name=s.name,n.push(o)}t.resolve(n)})["catch"](function(e){t.reject(e.data)}),t.promise},lookupRole:function(n,t){var r=o.defer();if(!n&&!t)return r.resolve([]),r.promise;var s={fields:["id","label_en","label_tr"],filters:[{field:"label_"+e.user.tenant_language,operator:"starts_with",value:n,no:1},{field:"deleted",operator:"equals",value:!1,no:2}],limit:20,sort_field:"label_"+e.user.tenant_language,sort_direction:"asc"};return n||(s.filters.shift(),s.filters[0].no=1),i.post(a.apiUrl+"record/find/roles",s).then(function(n){if(n=n.data,!n)return r.resolve([]),r.promise;for(var t=[],s=0;s<n.length;s++){var o=n[s],i={};i.id=o.id,i.name=o["label_"+e.user.tenant_language],t.push(i)}r.resolve(t)})["catch"](function(e){r.reject(e.data)}),r.promise},lookupUser:function(e,n,r){var s=o.defer();if(!e&&!n)return s.resolve([]),s.promise;var l={fields:["id","full_name","email","is_active"],filters:[{field:"full_name",operator:"starts_with",value:e,no:1},{field:"is_active",operator:"equals",value:!0,no:2}],limit:20,sort_field:"full_name",sort_direction:"asc"};if(r&&1==r)for(var u=0;u<l.filters.length;u++){var c=l.filters[u];if("is_active"==c.field){var f=l.filters.indexOf(c);l.filters.splice(f,1)}}return e||(l.filters.shift(),l.filters[0].no=1),i.post(a.apiUrl+"record/find/users",l).then(function(r){if(r=r.data,!r)return s.resolve([]),s.promise;var o=[];if(n&&!e){var i={};switch(i.id=0,n){case"record_owner":i.email="[owner]",i.full_name=t("translate")("Common.RecordOwner");break;case"logged_in_user":i.email="[me]",i.full_name=t("translate")("Common.LoggedInUser")}o.push(i)}for(var a=0;a<r.length;a++){var l=r[a],u={};u.id=l.id,u.email=l.email,u.full_name=l.full_name,o.push(u)}s.resolve(o)})["catch"](function(e){s.reject(e.data)}),s.promise},lookupUserAndGroup:function(e,n,t){var r=o.defer();if(!t)return r.resolve([]),r.promise;var s={module_id:e,is_readonly:n,search_term:t};return i.post(a.apiUrl+"record/lookup_user",s).then(function(e){return e.data?void r.resolve(e.data):(r.resolve([]),r.promise)})["catch"](function(e){r.reject(e.data)}),r.promise},getPicklists:function(n,r){for(var s=o.defer(),u={},c=[],f=this,p=0;p<n.length;p++){var d=n[p],m=l.get("picklist_"+d);if(0!==d)!m||r?c.push(d):u[d]=m;else{if(m&&!r){u[d]=m;break}for(var h=[],g=0;g<e.modules.length;g++){var v=e.modules[g];if(0!=v.order&&"users"!==v.name){var U={};U.id=parseInt(v.id)+9e5,U.type=9e5,U.order=v.order,U.label={},U.label.en=v.label_en_singular,U.label.tr=v.label_tr_singular,U.labelStr=v["label_"+e.language+"_singular"],U.value=v.name,h.push(U)}}h=t("orderBy")(h,"order"),u[9e5]=h,l.put("picklist_"+9e5,h)}}return c.length<=0?(s.resolve(u),s.promise):(i.post(a.apiUrl+"picklist/find",c).then(function(r){if(!r.data)return s.resolve(u),s.promise;for(var o=0;o<n.length;o++){var i=n[o];if(!(c.indexOf(i)<0)){var a=f.mergePicklists(r.data);a=t("orderBy")(a,"label_"+e.language),u[i]=a,l.put("picklist_"+i,u[i])}}s.resolve(u)})["catch"](function(e){s.reject(e.data)}),s.promise)},mergePicklists:function(n){var t=[];if(n)for(var r=0;r<n.length;r++)for(var s=n[r],o=0;o<s.items.length;o++){var i=s.items[o],a={};a.type=s.id,a.id=i.id,a.label={},a.label.en=i.label_en,a.label.tr=i.label_tr,a.label_en=i.label_en,a.label_tr=i.label_tr,a.value=i.value,a.value2=i.value2,a.value3=i.value3,a.system_code=i.system_code,a.order=i.order,a.inactive=i.inactive,a.labelStr=a.label[e.user.tenant_language],t.push(a)}return t},getSlug:function(e,n){if(!e)return"";n||(n="_");for(var t,r,s={" ":" ","¡":"!","¢":"c","£":"lb","¥":"yen","¦":"|","§":"SS","¨":'"',"©":"(c)","ª":"a","«":"<<","¬":"not","­":"-","®":"(R)","°":"^0","±":"+/-","²":"^2","³":"^3","´":"'","µ":"u","¶":"P","·":".","¸":",","¹":"^1","º":"o","»":">>","¼":" 1/4 ","½":" 1/2 ","¾":" 3/4 ","¿":"?","À":"`A","Á":"'A","Â":"^A","Ã":"~A","Ä":'"A',"Å":"A","Æ":"AE","Ç":"C","È":"`E","É":"'E","Ê":"^E","Ë":'"E',"Ì":"`I","Í":"'I","Î":"^I","Ï":'"I',"Ð":"D","Ñ":"~N","Ò":"`O","Ó":"'O","Ô":"^O","Õ":"~O","Ö":'"O',"×":"x","Ø":"O","Ù":"`U","Ú":"'U","Û":"^U","Ü":'"U',"Ý":"'Y","Þ":"Th","ß":"ss","à":"`a","á":"'a","â":"^a","ã":"~a","ä":'"a',"å":"a","æ":"ae","ç":"c","è":"`e","é":"'e","ê":"^e","ë":'"e',"ì":"`i","í":"'i","î":"^i","ï":'"i',"ð":"d","ñ":"~n","ò":"`o","ó":"'o","ô":"^o","õ":"~o","ö":'"o',"÷":":","ø":"o","ù":"`u","ú":"'u","û":"^u","ü":'"u',"ý":"'y","þ":"th","ÿ":'"y',"Ā":"A","ā":"a","Ă":"A","ă":"a","Ą":"A","ą":"a","Ć":"'C","ć":"'c","Ĉ":"^C","ĉ":"^c","Ċ":"C","ċ":"c","Č":"C","č":"c","Ď":"D","ď":"d","Đ":"D","đ":"d","Ē":"E","ē":"e","Ĕ":"E","ĕ":"e","Ė":"E","ė":"e","Ę":"E","ę":"e","Ě":"E","ě":"e","Ĝ":"^G","ĝ":"^g","Ğ":"G","ğ":"g","Ġ":"G","ġ":"g","Ģ":"G","ģ":"g","Ĥ":"^H","ĥ":"^h","Ħ":"H","ħ":"h","Ĩ":"~I","ĩ":"~i","Ī":"I","ī":"i","Ĭ":"I","ĭ":"i","Į":"I","į":"i","İ":"I","ı":"i","Ĳ":"IJ","ĳ":"ij","Ĵ":"^J","ĵ":"^j","Ķ":"K","ķ":"k","Ĺ":"L","ĺ":"l","Ļ":"L","ļ":"l","Ľ":"L","ľ":"l","Ŀ":"L","ŀ":"l","Ł":"L","ł":"l","Ń":"'N","ń":"'n","Ņ":"N","ņ":"n","Ň":"N","ň":"n","ŉ":"'n","Ō":"O","ō":"o","Ŏ":"O","ŏ":"o","Ő":'"O',"ő":'"o',"Œ":"OE","œ":"oe","Ŕ":"'R","ŕ":"'r","Ŗ":"R","ŗ":"r","Ř":"R","ř":"r","Ś":"'S","ś":"'s","Ŝ":"^S","ŝ":"^s","Ş":"S","ş":"s","Š":"S","š":"s","Ţ":"T","ţ":"t","Ť":"T","ť":"t","Ŧ":"T","ŧ":"t","Ũ":"~U","ũ":"~u","Ū":"U","ū":"u","Ŭ":"U","ŭ":"u","Ů":"U","ů":"u","Ű":'"U',"ű":'"u',"Ų":"U","ų":"u","Ŵ":"^W","ŵ":"^w","Ŷ":"^Y","ŷ":"^y","Ÿ":'"Y',"Ź":"'Z","ź":"'z","Ż":"Z","ż":"z","Ž":"Z","ž":"z","ſ":"s"},o=[],i=0;i<e.length;i++)(r=e.charCodeAt(i))<384&&(t=String.fromCharCode(r),o.push(s[t]||t));return e=o.join(""),e=e.replace(/[^\w\s-]/g,"").trim().toLowerCase(),e.replace(/[-\s]+/g,n)},roundBy:function(e,n,t){var r=n*Math.pow(10,t);return r=e(r),r/Math.pow(10,t)},parseQueryString:function(e){var n,t,r,s,o,i,a,l={};if(null===e)return l;n=e.split("&");for(var u=0;u<n.length;u++)t=n[u],r=t.indexOf("="),-1===r?(s=t,o=null):(s=t.substr(0,r),o=t.substr(r+1)),i=decodeURIComponent(s),a=decodeURIComponent(o),l[i]=a;return l},replaceDynamicValues:function(e){var n=e.split("{appConfigs.");if(n.length>1)for(var t in n)if(n.hasOwnProperty(t)){if(!n[t])continue;var r=n[t].split("}")[0];e=e.replace("{appConfigs."+r+"}",appConfigs[r])}return e}}}]).factory("convert",["helper",function(e){return{fromMsDate:function(n){return n=e.getTime(n),new Date(n)},toMsDate:function(e){return"/Date("+e.getTime()+")/"}}}]).factory("exportFile",function(){return{excel:function(e,n){for(var t=e[0].length-1,r=0,s={columns:"",rows:""},o={excel:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',excelML:'<?xml version="1.0"?><?mso-application progid="Excel.Sheet"?><ss:Workbook xmlns:="urn:schemas-microsoft-com:office:spreadsheet" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" xmlns:html="http://www.w3.org/TR/REC-html40"><ss:Styles><ss:Style ss:ID="1"><ss:Font ss:Bold="1"/></ss:Style></ss:Styles><ss:Worksheet ss:Name="Sheet1"><ss:Table>{columns}{rows}</ss:Table></ss:Worksheet></ss:Workbook>',rowOpen:"<ss:Row>",rowClose:"</ss:Row>",dataOpenString:'<ss:Data ss:Type="String">',dataOpenNumber:'<ss:Data ss:Type="Number">',dataClose:"</ss:Data>",column:'<ss:Column ss:Width="80"/>',cellOpen:"<ss:Cell>",cellClose:"</ss:Cell>"},i=function(e){if(null===e||void 0===e)return"";var n="<![CDATA["+e+"]]>",t=e.toString(),r=t.indexOf(",")>-1||t.indexOf("\r")>-1||t.indexOf("\n")>-1,s=t.indexOf('"')>-1;return s&&(n=n.replace(/"/g,'""')),(r||s)&&(n='"'+n+'"'),n},a=function(e){return window.btoa(unescape(encodeURIComponent(e)))},l=function(e,n){return e.replace(/{(\w+)}/g,function(e,t){return n[t]})},u=0;t>u;u++)s.columns+=o.column;for(var c,f=0;c=e[f];f++){s.rows+=o.rowOpen,r=e[f].length;for(var p=0;r>p;p++){var d=c[p];s.rows+=o.cellOpen,s.rows+="number"==typeof d?o.dataOpenNumber:o.dataOpenString,s.rows+=i(d),s.rows+=o.dataClose,s.rows+=o.cellClose}s.rows+=o.rowClose}for(var m=a(l(o.excelML,s)),h=atob(m),g=new Array(h.length),v=0;v<h.length;v++)g[v]=h.charCodeAt(v);var U=new Uint8Array(g),S=new Blob([U],{type:"application/octet-stream"});saveAs(S,n)}}}).factory("officeHelper",["$http","config",function(e,n){return{officeTenantInfo:function(){return e.get(n.apiUrl+"User/ActiveDirectoryInfo")}}}]).factory("components",["$rootScope","$timeout","$filter","$localStorage","$sessionStorage","$q","$http","config","$cache","ngToast","$injector","$state","$stateParams","helper","$modal",function($rootScope,$timeout,$filter,$localStorage,$sessionStorage,$q,$http,config,$cache,ngToast,$injector,$state,$stateParams,helper,$modal){return{run:function(place,type,scope,record,field){place=place.split(/(?=[A-Z])/).join("_").toLowerCase(),type=type.split(/(?=[A-Z])/).join("_").toLowerCase();var ModuleService=$injector.get("ModuleService"),components=$filter("filter")(scope.module.components,function(e){return e.place===place&&e.type===type&&(e.module_id===scope.module.id||0===e.module_id)&&!e.deleted},!0);if(components=$filter("orderBy")(components,"order"),components&&components.length>0)for(var i=0;i<components.length;i++){var component=components[i];eval(component.content)}}}}]),String.prototype.toUpperCaseTurkish=function(){return this.replace(/i/g,"İ").toLocaleUpperCase()},String.prototype.toLowerCaseTurkish=function(){return this.replace(/I/g,"ı").toLocaleLowerCase()},String.prototype.replaceAll=function(e,n){function t(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}return this.replace(new RegExp(t(e),"g"),n)},Array.prototype.getUnique=function(){for(var e={},n=[],t=0,r=this.length;r>t;++t)e.hasOwnProperty(this[t])||(n.push(this[t]),e[this[t]]=1);return n};