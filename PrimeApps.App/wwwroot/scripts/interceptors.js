"use strict";angular.module("primeapps").factory("genericInterceptor",["$q","$injector","$window","$localStorage","$filter","$cookies","$rootScope",function(e,t,n,r,a,o,i){return{request:function(e){e.headers=e.headers||{};var t=r.read("access_token");(blobUrl&&e.url.indexOf(blobUrl)>-1||containerDomain&&e.url.indexOf(containerDomain)>-1||routeTemplateUrls&&routeTemplateUrls.length>0&&routeTemplateUrls.indexOf(e.url)>-1)&&(e.headers["Access-Control-Allow-Origin"]="*"),t&&e.url.indexOf("/token")<0&&(""===blobUrl||e.url.indexOf(blobUrl)<0)&&(e.headers.Authorization="Bearer "+t);var n=o.get(preview?"preview_app_id":"app_id"),a=o.get(preview?"preview_tenant_id":"tenant_id");if(e.headers["X-App-Id"]=n,e.headers["X-Tenant-Id"]=a,e.headers["X-User-Id"]=account.user.id,trustedUrls.length>0)for(var s=function(e){switch(e){case"X-Auth-Key":case"x-auth-key":return encryptedUserId;case"X-Branch-Id":case"x-branch-id":case"branch_id":return i.branchAvailable?i.user.branchId:"";case"X-Tenant-Language":case"x-tenant-language":return tenantLanguage;case"X-User-Id":case"x-user-id":case"user_id":return account.user.id;case"X-Tenant-Id":case"x-tenant-id":case"tenant_id":return preview?applicationId:a;case"X-App-Id":case"x-app-id":case"app_id":return applicationId}},d=0;d<trustedUrls.length;d++){var l=trustedUrls[d];e.url.indexOf(l.url)>-1&&(l.headers&&angular.forEach(l.headers,function(t,n){e.headers[n]=t.indexOf("::dynamic")>-1?s(n):t}),e.headers["Access-Control-Allow-Origin"]="*")}return e},responseError:function(t){var a="";return 401===t.status?t.config.url.indexOf("/token")>-1?e.reject(t):(r.remove("access_token"),r.remove("refresh_token"),void(n.location.href="/logout")):500===t.status&&t.config.url.indexOf("/User/MyAccount")>-1?(r.remove("access_token"),r.remove("refresh_token"),n.location.href="/logout",e.reject(t)):402===t.status?(n.location.href="#/paymentform",e.reject(t)):403===t.status?(n.location.href=i.start_page,a="Common.Forbidden",i.$broadcast("error",a),e.reject(t)):404===t.status?(t.config.ignoreNotFound||(n.location.href=i.start_page,a=t.config.url.indexOf("/module")>-1?"Common.NotFoundRecord":"Common.NotFound",i.$broadcast("error",a)),e.reject(t)):navigator.onLine&&421!==t.status&&429!==t.status?400===t.status||409===t.status?e.reject(t):(a="Common.Error",i.$broadcast("error",a),e.reject(t)):(a="Common.NetworkError",i.$broadcast("error",a),e.reject(t))}}}]).factory("dimensions",function(){function e(e){var r=e.ownerDocument,a=e.offsetParent||r;if(n(a,"#document"))return r.documentElement;for(;a&&!n(a,"html")&&"static"===t.css(a,"position");)a=a.offsetParent;return a||r.documentElement}var t={},n=t.nodeName=function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()};return t.css=function(e,t,n){var r;return r=e.currentStyle?e.currentStyle[t]:window.getComputedStyle?window.getComputedStyle(e)[t]:e.style[t],n===!0?parseFloat(r)||0:r},t.offset=function(e){var t=e.getBoundingClientRect(),n=e.ownerDocument;return{width:t.width||e.offsetWidth,height:t.height||e.offsetHeight,top:t.top+(window.pageYOffset||n.documentElement.scrollTop)-(n.documentElement.clientTop||0),left:t.left+(window.pageXOffset||n.documentElement.scrollLeft)-(n.documentElement.clientLeft||0)}},t.setOffset=function(e,n,r){var a,o,i,s,d,l,c,u=t.css(e,"position"),f=angular.element(e),p={};"static"===u&&(e.style.position="relative"),d=t.offset(e),i=t.css(e,"top"),l=t.css(e,"left"),c=("absolute"===u||"fixed"===u)&&(i+l).indexOf("auto")>-1,c?(a=t.position(e),s=a.top,o=a.left):(s=parseFloat(i)||0,o=parseFloat(l)||0),angular.isFunction(n)&&(n=n.call(e,r,d)),null!==n.top&&(p.top=n.top-d.top+s),null!==n.left&&(p.left=n.left-d.left+o),"using"in n?n.using.call(f,p):f.css({top:p.top+"px",left:p.left+"px"})},t.position=function(r){var a,o,i={top:0,left:0};return"fixed"===t.css(r,"position")?o=r.getBoundingClientRect():(a=e(r),o=t.offset(r),n(a,"html")||(i=t.offset(a)),i.top+=t.css(a,"borderTopWidth",!0),i.left+=t.css(a,"borderLeftWidth",!0)),{width:r.offsetWidth,height:r.offsetHeight,top:o.top-i.top-t.css(r,"marginTop",!0),left:o.left-i.left-t.css(r,"marginLeft",!0)}},t.height=function(e,n){var r=e.offsetHeight;return n?r+=t.css(e,"marginTop",!0)+t.css(e,"marginBottom",!0):r-=t.css(e,"paddingTop",!0)+t.css(e,"paddingBottom",!0)+t.css(e,"borderTopWidth",!0)+t.css(e,"borderBottomWidth",!0),r},t.width=function(e,n){var r=e.offsetWidth;return n?r+=t.css(e,"marginLeft",!0)+t.css(e,"marginRight",!0):r-=t.css(e,"paddingLeft",!0)+t.css(e,"paddingRight",!0)+t.css(e,"borderLeftWidth",!0)+t.css(e,"borderRightWidth",!0),r},t}).factory("PriorityNavService",["$timeout","$window","$document","$rootScope",function(){var e={};return e.debounce=function(t,n,r){var a,o,i,s,d,l=function(){var c=e.now()-s;n>c&&c>=0?a=setTimeout(l,n-c):(a=null,r||(d=t.apply(i,o),a||(i=o=null)))};return function(){i=this,o=arguments,s=e.now();var c=r&&!a;return a||(a=setTimeout(l,n)),c&&(d=t.apply(i,o),i=o=null),d}},e.now=Date.now||function(){return(new Date).getTime()},e.style=function(e,t){var n=e.currentStyle||window.getComputedStyle(e);return n[t].replace("px","")},e.getMargins=function(t){return parseInt(e.style(t,"marginRight")||0)+parseInt(e.style(t,"paddingLeft")||0)},e.getWidth=function(t,n){var r;if(n){var a=t.style.cssText;t.style.cssText="width:auto !important; display:inline-block !important;",r=t.getBoundingClientRect().width+e.getMargins(t),t.style.cssText=a}else r=t.getBoundingClientRect().width+e.getMargins(t);return r},e.addIds=function(e){angular.forEach(e,function(e,t){angular.element(e).hasClass("vertical-nav")||angular.element(e).attr("data-priority-nav-index",t+1)})},e.getBreakPoint=function(t,n,r){for(var a=0;t.length>a&&(n+=e.getWidth(t[a],!0),!(n>r));a++);return{breakPoint:n,breakPointIndex:a}},e.sortChildrenAndAppend=function(e){var t=e.children();t.sort(function(e,t){return parseInt(angular.element(e).attr("data-priority-nav-index"))>parseInt(angular.element(t).attr("data-priority-nav-index"))?1:-1});for(var n=0;n<t.length;++n)e.append(t[n])},e.calculatebreakPoint=function(t,n,r,a){if(t.children().length>0){var o=e.getWidth(t[0]),i=e.getBreakPoint(t.children(),e.getWidth(n[0]),o),s=e.getBreakPoint(r.children(),i.breakPoint,o),d=i.breakPointIndex+s.breakPointIndex<t.children().length+r.children().length?i.breakPointIndex+s.breakPointIndex-1:i.breakPointIndex+s.breakPointIndex;angular.forEach(t.children(),function(e){angular.element(e).attr("data-priority-nav-index")&&parseInt(angular.element(e).attr("data-priority-nav-index"))>d&&r.append(angular.element(e))}),angular.forEach(r.children(),function(e){angular.element(e).attr("data-priority-nav-index")&&parseInt(angular.element(e).attr("data-priority-nav-index"))<=d&&t.append(angular.element(e))}),e.sortChildrenAndAppend(r),e.sortChildrenAndAppend(t),t.append(n),r.children().length>0?(n.removeClass("go-away"),a.text(r.children().length>9?"9+":r.children().length)):(n.addClass("go-away"),a.text(""))}},e}]);