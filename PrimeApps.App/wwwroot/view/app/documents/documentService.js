"use strict";angular.module("primeapps").factory("DocumentService",["$http","config","guidEmpty","$filter","helper","$rootScope",function(e,t,n,o,i,r){return{getDocuments:function(n,o,i){return e.post(t.apiUrl+"document/get_documents",{record_id:o,tenant_id:n,module_id:i})},getEntityDocuments:function(n,o,i){return e.post(t.apiUrl+"document/get_entity_documents",{tenant_id:n,module_id:i,record_id:o})},getDocument:function(n){return e.post(t.apiUrl+"document/get_document",n)},removeModuleDocument:function(n){return e.post(t.apiUrl+"document/remove_document",n)},advancedSearch:function(n,o,i,r){return e.post(t.apiUrl+"document/document_search",{module:n,filters:o,top:i,skip:r})},create:function(n,o,i,u,a,c,d,m,s){var l={};return l[r.globalization.Label]={name:i,description:c},e.post(t.apiUrl+"document/create",{unique_file_name:o,file_name:i,mime_type:u,file_size:a,chunk_size:s||1,description:c,tenant_id:n,record_id:d,module_id:m,languages:JSON.stringify(l)})},update:function(n,o,i,u,a){return r.languageStringify(i),e.post(t.apiUrl+"document/modify",{id:n,file_name:i.name,description:i.description,instance_id:o,record_id:u,module_id:a,languages:i.languages})},remove:function(n){return e.post(t.apiUrl+"document/remove",n)},upload:function(n){return e.post(t.apiUrl+"document/Upload",n,{headers:{"Content-Type":void 0},transformRequest:angular.identity})},processDocuments:function(e,t,u,a,c){if(u){var d=angular.copy(u);d.created_by===n&&delete d.created_by,e.documents=o("filter")(e.documents,d,!1)}var m={documentList:[],totalDocumentCount:e.total_documents_count,filteredDocumentCount:e.filtered_documents_count};return angular.forEach(e.documents,function(e){var n=angular.isObject(e.created_by)?e.created_by.id:e.created_by,u=o("filter")(t,{id:n},!0)[0],a=e.languages[r.globalization.Label].name;e.name=a,e.description=e.languages[r.globalization.Label].description,e.created_by=u,e.timestamp=i.getTime(e.created_time),e.extension=i.getFileExtension(e.name),e.name_plain=a.slice(0,a.indexOf(e.extension)-1),m.documentList.push(e)},m.documentList),a&&(m.documentList=o("orderBy")(m.documentList,a,c)),m}}}]);