"use strict";angular.module("primeapps").factory("DocumentService",["$http","config","guidEmpty","$filter","helper",function(e,t,n,o,i){return{getDocuments:function(n,o,i){return e.post(t.apiUrl+"Document/GetDocuments",{record_id:o,tenant_id:n,module_id:i})},getEntityDocuments:function(n,o,i){return e.post(t.apiUrl+"Document/GetEntityDocuments",{tenant_id:n,module_id:i,record_id:o})},getDocument:function(n){return e.post(t.apiUrl+"Document/GetDocument",n)},removeModuleDocument:function(n){return e.post(t.apiUrl+"Document/remove_document",n)},advancedSearch:function(n,o,i,r){return e.post(t.apiUrl+"Document/document_search",{module:n,filters:o,top:i,skip:r})},create:function(t,n,o,i,r,u,c,d,m){return e.post("storage/create",{unique_file_name:n,file_name:o,mime_type:i,file_size:r,chunk_size:m||1,description:u,tenant_id:t,record_id:c,module_id:d})},update:function(n,o,i,r,u,c){return e.post(t.apiUrl+"Document/Modify",{id:n,file_name:i,description:r,instance_id:o,record_id:u,module_id:c})},remove:function(n){return e.post(t.apiUrl+"Document/Remove",n)},upload:function(n){return e.post(t.apiUrl+"Document/Upload",n,{headers:{"Content-Type":void 0},transformRequest:angular.identity})},move:function(n,o,i){return e.post(t.apiUrl+"Document/Move",{ID:n,EntityID:o,EntityType:i})},processDocuments:function(e,t,r,u,c){if(r){var d=angular.copy(r);d.created_by===n&&delete d.created_by,e.documents=o("filter")(e.documents,d,!1)}var m={documentList:[],totalDocumentCount:e.total_documents_count,filteredDocumentCount:e.filtered_documents_count};return angular.forEach(e.documents,function(e){var n=e.created_by.id;n||(n=e.created_by);var r=o("filter")(t,{id:n},!0)[0];e.created_by=r,e.timestamp=i.getTime(e.created_time),e.extension=i.getFileExtension(e.name),e.name_plain=e.name.slice(0,e.name.indexOf(e.extension)-1),m.documentList.push(e)},m.documentList),u&&(m.documentList=o("orderBy")(m.documentList,u,c)),m}}}]);