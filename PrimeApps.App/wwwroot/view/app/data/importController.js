"use strict";angular.module("primeapps").controller("ImportController",["$rootScope","$scope","$stateParams","$state","config","$q","$localStorage","$filter","helper","FileUploader","$timeout","$cache","emailRegex","ModuleService","ImportService","$cookies","components","$mdDialog","mdToast",function(e,a,t,r,i,n,l,o,d,u,m,p,s,c,f,g,v,x,h){function M(e){return new Date(86400*(e-25569)*1e3)}function _(e,t,r){var i=a.rowsBase[t],n=i[r];return n}function k(e){return o("filter")(a.cells,{column:e},!0)[0]}function F(e){var a={};for(var t in e)a[t]=e[t].column;return a}a.type=t.type,a.wizardStep=0,a.fieldMap={},a.fixedValue={},a.importMapping={},a.mappingField={},a.selectedMapping={},a.mappingArray=[];var y=!1;if(a.module=o("filter")(e.modules,{name:a.type},!0)[0],!a.module)return h.warning(o("translate")("Common.NotFound")),void r.go("app.dashboard");a.module=angular.copy(a.module),angular.forEach(a.module.fields,function(e){("created_by"===e.name||"updated_by"===e.name||"created_at"===e.name||"updated_at"===e.name)&&(e.validation.required=!1,d.hasAdminRights()||(e.deleted=!0)),"activities"===a.module.name&&("owner"!=e.name&&"activity_type"!=e.name&&"subject"!=e.name&&(e.validation.required=!1),("task_reminder"===e.name||"reminder_recurrence"===e.name||"task_notification"===e.name||"event_reminder"===e.name)&&(e.deleted=!0))}),angular.forEach(a.module.sections,function(e){var t=o("filter")(a.module.fields,{section:e.name,deleted:"!true"});t.length||(e.deleted=!0)}),f.getAllMapping(a.module.id).then(function(e){if(e){var t=e.data;a.mappingArray=t}});var D=function(e,t){var r=new FileReader;r.onload=function(e){if(!e||e.target.error)return void m(function(){h.warning({content:o("translate")("Module.ExportUnsupported"),timeout:1e4})});try{a.workbook=XLS.read(e.target.result,{type:"binary"}),a.sheets=a.workbook.SheetNames,m(function(){a.selectedSheet=a.selectedSheet||a.sheets[0],a.selectSheet(t),a.getSampleDate()})}catch(r){m(function(){h.warning(o("translate")("Data.Import.InvalidExcel"))})}},r.readAsBinaryString(e)},b={column:"fixed",name:o("translate")("Data.Import.FixedValue")+" -->"},w={column:"currentUser",name:e.user.full_name};a.selectSheet=function(t){return a.rowsBase=XLSX.utils.sheet_to_json(a.workbook.Sheets[a.selectedSheet],{header:"A"}),a.rows=XLSX.utils.sheet_to_json(a.workbook.Sheets[a.selectedSheet],{raw:!0,header:"A"}),a.headerRow=angular.copy(a.rows[0]),a.rows.shift(),a.cells=[],a.rows.length>3e3?void h.warning(o("translate")("Data.Import.CountError")):(angular.forEach(a.headerRow,function(e,t){var r=e+o("translate")("Data.Import.ColumnIndex",{index:t});a.cells.push({column:t,name:r,used:!1})}),t?void a.submit(!0):void m(function(){a.selectedMapping.name||(a.fieldMap={},a.fixedValue={},a.fixedValueFormatted={},angular.forEach(a.headerRow,function(t,r){var i=!1;"tr"===e.language?angular.forEach(a.module.fields,function(e){e.deleted||e.label_tr.toLowerCaseTurkish()===t.trim().toLowerCaseTurkish()&&(i=!0,a.fieldMap[e.name]=k(r))}):angular.forEach(a.module.fields,function(n){if(!n.deleted)if("owner"===n.name)i=!0,a.fieldMap[n.name]=w;else if(n["label_"+e.language].toLowerCase()===t.trim().toLowerCase())i=!0,a.fieldMap[n.name]=k(r);else if(n&&n.default_value)if("picklist"===n.data_type){a.fieldMap[n.name]=b;var l=o("filter")(a.picklistsModule[n.picklist_id],{id:n.default_value})[0];a.fixedValue[n.name]=l,a.fixedValueFormatted[n.name]="tr"===e.language?l.label_tr:l.label_en}else a.fieldMap[n.name]=b,a.fixedValue[n.name]=n.default_value,a.fixedValueFormatted[n.name]=n.default_value});var n=o("filter")(a.cells,{column:r},!0)[0];n&&(n.used=i)}))}))};var V=a.uploader=new u;V.onAfterAddingFile=function(e){D(e._file)},V.onWhenAddingFileFailed=function(e,a){switch(a.name){case"excelFilter":h.warning(o("translate")("Data.Import.FormatError"));break;case"sizeFilter":h.warning(o("translate")("Data.Import.SizeError"))}},V.onBeforeUploadItem=function(e){e.url="storage/upload_import_excel?import_id="+a.importResponse.id},V.filters.push({name:"excelFilter",fn:function(e){var a=d.getFileExtension(e.name);return"xls"===a||"xlsx"===a}}),V.filters.push({name:"sizeFilter",fn:function(e){return e.size<2097152}}),c.getPicklists(a.module).then(function(e){a.picklistsModule=e}),a.lookup=function(t){if("users"===a.fixedField.lookup_type&&!a.fixedField.lookupModulePrimaryField){var r={};r.data_type="text_single",r.name="full_name",a.fixedField.lookupModulePrimaryField=r}if("relation"===a.fixedField.lookup_type){if(!a.fixedValue.related_module)return a.$broadcast("angucomplete-alt:clearInput",a.fixedField.name),n.defer().promise;var i=o("filter")(e.modules,{name:a.fixedValue.related_module.value},!0)[0];if(!i)return a.$broadcast("angucomplete-alt:clearInput",a.fixedField.name),n.defer().promise;a.fixedField.lookupModulePrimaryField=o("filter")(i.fields,{primary:!0},!0)[0]}return"number"!==a.fixedField.lookupModulePrimaryField.data_type&&"number_auto"!==a.fixedField.lookupModulePrimaryField.data_type||!isNaN(parseFloat(t))?c.lookup(t,a.fixedField,a.fixedValue):(a.$broadcast("angucomplete-alt:clearInput",a.fixedField.name),n.defer().promise)},a.multiselect=function(e,t){var r=[];return angular.forEach(a.picklistsModule[t.picklist_id],function(a){a.inactive||a.hidden||a.labelStr.toLowerCase().indexOf(e)>-1&&r.push(a)}),r},a.clear=function(){V.clearQueue(),a.rows=null,a.cells=null,a.sheets=null,a.fieldMap=null,a.fixedValue=null,a.fixedValueFormatted=null,a.showAdvancedOptions=!1},a.cellChanged=function(e,t){return"fixed"===a.fieldMap[e.name]?void a.openFixedValueModal(e,t):(angular.forEach(a.cells,function(e){e.used=!1}),angular.forEach(a.fieldMap,function(e){var t=o("filter")(a.cells,{column:e},!0)[0];t&&(t.used=!0)}),!a.fieldMap[e.name]&&a.fixedValue&&a.fixedValue[e.name]&&delete a.fixedValue[e.name],void("related_module"===e.name&&delete a.fixedValue.related_to))},a.fixedValueChanged=function(e){"related_module"===e.name&&delete a.fixedValue.related_to},a.openFixedValueModal=function(e,t){a.fixedValue=a.fixedValue||{},a.fixedValueState=angular.copy(a.fixedValue),a.fixedField=e;var r=angular.element(document.body);x.show({parent:r,templateUrl:"view/app/data/fixedValue.html",clickOutsideToClose:!0,targetEvent:t,scope:a,preserveScope:!0})},a.closeDialog=function(){x.hide()},a.modalSubmit=function(e){e.validate()&&(a.fixedValue[a.fixedField.name]||delete a.fieldMap[a.fixedField.name],a.fixedValueFormatted=angular.copy(a.fixedValue),c.formatRecordFieldValues(a.fixedValueFormatted,a.module,a.picklistsModule),angular.forEach(a.fixedValueFormatted,function(e,t){var r=o("filter")(a.module.fields,{name:t},!0)[0];r&&r.valueFormatted&&(a.fixedValueFormatted[t]=r.valueFormatted),"lookup"===r.data_type&&(a.fixedValueFormatted[t]=a.fixedValueFormatted[t].primary_value)}),a.excelCellOptions(a.fixedField,!0),a.closeDialog())},a.modalCancel=function(){!a.fixedValueState[a.fixedField.name]&&a.fixedValue[a.fixedField.name]&&delete a.fixedValue[a.fixedField.name],a.fixedValue[a.fixedField.name]||delete a.fieldMap[a.fixedField.name]},a.loadMappingList=function(){f.getAllMapping(a.module.id).then(function(e){e.data&&(a.mappingArray=e.data)}),a.mappingDropDown2.dataSource.read()},a.mappingSave=function(e){a.savingTemplate=!0,a.importMapping.module_id=a.module.id,a.fixedValue&&(a.fieldMap.fixed=angular.copy(a.fixedValue)),a.fixedValueFormatted&&(a.fieldMap.fixedFormat=angular.copy(a.fixedValueFormatted));var t=angular.copy(a.fieldMap);return t?a.importMapping.mapping=JSON.stringify(t):(h.warning({content:o("translate")("Data.Import.MappingNotFound"),timeout:6e3}),a.importMappingSaveModal.hide()),a.importMapping.skip=a.importMapping.skip?a.importMapping.skip:!1,e.$valid?a.importMapping.name||a.selectedMapping?void(a.selectedMapping.id?f.updateMapping(a.selectedMapping.id,a.importMapping).then(function(e){var t=e.data;t?(a.loadMappingList(),m(function(){h.success({content:o("translate")("Data.Import.MappingSaveSucces"),timeout:6e3}),a.savingTemplate=!1,a.cancel()},500)):a.savingTemplate=!1})["catch"](function(){h.error({content:o("translate")("Common.Error"),timeout:6e3}),a.savingTemplate=!1,a.cancel()}):f.getMapping(a.importMapping).then(function(e){var t=e.data;t?(h.warning({content:o("translate")("Data.Import.TryMappingName"),timeout:6e3}),a.importMapping={},a.savingTemplate=!1,a.cancel()):f.saveMapping(a.importMapping).then(function(e){var t=e.data;t?m(function(){a.loadMappingList(),h.success({content:o("translate")("Data.Import.MappingSaveSucces"),timeout:6e3}),a.savingTemplate=!1,a.cancel(),f.getAllMapping(a.module.id).then(function(e){e.data&&(a.mappingArray=e.data,a.selectedMapping=t,a.mappingDropDown2.dataSource.read(),a.mappingSelectedChange(t))})},500):a.savingTemplate=!1})["catch"](function(){h.error({content:o("translate")("Common.Error"),timeout:6e3}),a.savingTemplate=!1,a.cancel()})})):(a.importMapping={},void(a.savingTemplate=!1)):void(a.savingTemplate=!1)},a.deleteMapping=function(e){a.selectedMapping=e,v.run("BeforeDelete","Script",a,a.selectedMapping),f.deleteMapping(a.selectedMapping).then(function(){a.loadMappingList(),h.success({content:o("translate")("Data.Import.DeletedMapping"),timeout:6e3})})["catch"](function(){h.error({content:o("translate")("Common.Error"),timeout:6e3})})},a.showConfirm=function(e,t){var r=x.confirm().title(o("translate")("Common.AreYouSure")).targetEvent(t).ok(o("translate")("Common.Yes")).cancel(o("translate")("Common.No"));x.show(r).then(function(){a.deleteMapping(e)},function(){})},a.mappingModalCancel=function(){a.importMapping={}},a.openMappingModal=function(){if(y=!0,!a.importForm.validate())return void h.warning(o("translate")("Module.RequiredError"));var e=angular.element(document.body);x.show({parent:e,templateUrl:"view/app/data/importMappingSave.html",clickOutsideToClose:!1,scope:a,preserveScope:!0})},a.mappingSelectedChange=function(e){if(e&&e.id){a.selectedMapping=e;var t=o("filter")(a.mappingArray,{id:e.id},!0)[0];if(t){a.importMapping.name=t.name,a.importMapping.skip=t.skip;var r=angular.fromJson(t.mapping);r&&(r.fixed&&(a.fixedValue=r.fixed,delete r.fixed),r.fixedFormat&&(a.fixedValueFormatted=r.fixedFormat,delete r.fixedFormat),a.fieldMap=r)}}else a.selectedMapping={},a.importMapping={}},a.checkWizard=function(){var e=a.user.profile.has_admin_rights;a.fieldMapCopy=angular.copy(a.fieldMap),a.selectedMapping.skip&&!e?(a.wizardStep=2,y=!0,a.submit(!0)):(y=!1,a.wizardStep=1)},a.getDateFormat=function(){var e=angular.copy(a.dateOrder);return e=e.replace(/\//g,a.dateDelimiter)},a.getDateTimeFormat=function(){var e=a.getDateFormat();return e+=" "+a.timeFormat},a.getSampleDate=function(){a.dateOrder||(a.dateOrder="en"===e.locale?"M/D/YYYY":"DD/MM/YYYY"),a.dateDelimiter||(a.dateDelimiter="en"===e.locale?"/":"."),a.timeFormat||(a.timeFormat="en"===e.locale?"H:mm a":"HH:mm");var t=new Date("2010-01-31 16:20:00"),r=a.getDateTimeFormat();a.sampleDate=moment(t).format(r)},a.prepareFixedValue=function(){var t=angular.copy(a.fixedValue);return angular.forEach(t,function(r,i){var n=o("filter")(a.module.fields,{name:i},!0)[0];switch(n.data_type){case"number":t[i]=parseInt(t[i]);break;case"number_decimal":case"currency":t[i]=parseFloat(t[i]);break;case"picklist":t[i]=null!=t[i]?t[i].label[e.user.tenant_language]:null;break;case"tag":var l=t[i].split("|");t[i]="{";for(var d=0;d<l.length;d++)t[i]+='"'+l[d]+'",';t[i]&&(t[i]=t[i].slice(0,-1)+"}");break;case"multiselect":var u="{{";angular.forEach(t[i],function(a){u+='"'+a["label_"+e.user.tenant_language]+'",'}),t[i]=u.slice(0,-1)+"}}";break;case"lookup":t[i]=t[i].id}}),t},a.prepareRecords=function(){for(var t=[],r=function(t,r,i,n){var l="";switch(t&&(l=t.toString().trim()),a.error={},a.error.rowNo=i,a.error.cellName=n,a.error.cellValue=t,a.error.fieldLabel=r["label_"+e.language],r.data_type){case"number":l=parseInt(l),isNaN(l)&&(a.error.message=o("translate")("Data.Import.Error.InvalidNumber"),l=0);break;case"number_decimal":l=parseFloat(l),isNaN(l)&&(a.error.message=o("translate")("Data.Import.Error.InvalidNumber"),l=0);break;case"currency":l=l.replace(",","."),l=parseFloat(l),isNaN(l)&&(a.error.message=o("translate")("Data.Import.Error.InvalidDecimal"),l=null);break;case"date":var d=M(l);l="Invalid Date"===d.toString()?l.split(" ")[0]:d;var u=a.getDateFormat(),m="en"===a.locale?"D/M/YYYY":"DD/MM/YYYY",p=moment(l,u,!0);if(p.isValid())l=p.format();else if(p=moment(l,m,!0),!p.isValid()){var c=a.dateDelimiter,f=l.split(dateDelimiter),g=u.split(dateDelimiter);if(f.length>1){var v=f[g.indexOf("YYYY")],x=f[g.indexOf("MM")],h=f[g.indexOf("DD")],k=Date.parse(x+c+h+dateDelimiter+v);p=moment(new Date(k),u,!0),p.isValid()?l=p.format():(a.error.message=o("translate")("Data.Import.Error.InvalidDate"),l=null)}}break;case"date_time":var F=angular.copy(l),d=M(l);l="Invalid Date"===d.toString()?l.split(" ")[0]:d;var y=a.getDateTimeFormat(),D="en"===a.locale?"D/M/YYYY":"DD/MM/YYYY";D+=" "+a.timeFormat;var b=moment(l,y,!0);b.isValid()?l=b.toDate():(b=moment(F,y,!0),b.isValid()?l=b.toDate():(b=moment(l,D,!0),b.isValid()?l=b.toDate():(a.error.message=o("translate")("Data.Import.Error.InvalidDateTime"),l=null)));break;case"time":var w,V=_(r,i-1,n),S=[];V?(S=V.split(":"),S[1]="en"===a.locale?S[1].split(" ")[0]:S[1],w=moment(new Date(null,null,null,S[0],S[1]),a.timeFormat,!0)):(l=M(l),w=moment(l.toUTCString(),a.timeFormat,!0)),w.isValid()?l=w.format():(a.error.message=o("translate")("Data.Import.Error.InvalidTime"),l=null);break;case"email":s.test(l)||(a.error.message=o("translate")("Data.Import.Error.InvalidEmail"),l=null);break;case"picklist":var I=o("filter")(a.picklistsModule[r.picklist_id],{labelStr:l},!0)[0];I||(a.error.message=o("translate")("Data.Import.Error.PicklistItemNotFound"),l=null);break;case"multiselect":var C=l.split("|");l="{{";for(var E=0;E<C.length;E++){var L=C[E],T=o("filter")(a.picklistsModule[r.picklist_id],{labelStr:L})[0];if(!T){a.error.message=o("translate")("Data.Import.Error.MultiselectItemNotFound",{item:L}),l=null;break}l+='"'+L+'",'}l&&(l=l.slice(0,-1)+"}}");break;case"lookup":"relation"===r.lookup_type&&(r.lookup_type=a.fixedValue.related_module.value);for(var Y=[],N=0;N<a.lookupIds[r.lookup_type].length;N++){var O=a.lookupIds[r.lookup_type][N],A=l%1===0;A&&O.id===parseInt(l)?Y.push(O):O.value==l&&Y.push(O)}var P=o("filter")(e.modules,{name:r.lookup_type})[0];if("users"===r.lookup_type&&(P={},P.label_tr_singular="Kullanıcı",P.label_en_singular="User"),Y.length>1)return a.error.message=o("translate")("Data.Import.Error.LookupMoreThanOne",{module:P["label_"+e.language+"_singular"]}),void(l=null);var R=Y[0];if(!R)return a.error.message=o("translate")("Data.Import.Error.LookupNotFound",{module:P["label_"+e.language+"_singular"]}),void(l=null);l=R.id;break;case"checkbox":"yes"===l.toLowerCase()||"evet"===l.toLowerCase()||"true"===l.toLowerCase()?l="true":"no"===l.toLowerCase()||"hayır"===l.toLowerCaseTurkish()||"false"===l.toLowerCase()?l="false":(a.error.message=o("translate")("Data.Import.Error.InvalidCheckbox"),l=null)}if(null!=l&&void 0!=l){if(r.validation||(r.validation={}),!r.validation.max_length)switch(r.data_type){case"text_single":r.validation.max_length=50;break;case"text_multi":r.validation.max_length=500;break;case"number":r.validation.max_length=15;break;case"number_decimal":r.validation.max_length=19;break;case"currency":r.validation.max_length=21;break;case"email":r.validation.max_length=100}if(r.validation.max||"number"!==r.data_type&&"number_decimal"!==r.data_type&&"currency"!==r.data_type||(r.validation.max=Number.MAX_VALUE),r.validation.max_length&&l.toString().length>r.validation.max_length&&(a.error.message=o("translate")("Data.Import.Validation.MaxLength",{maxLength:r.validation.max_length}),l=null),r.validation.min_length&&l.toString().length<r.validation.min_length&&(a.error.message=o("translate")("Data.Import.Validation.MinLength",{minLength:r.validation.min_length}),l=null),r.validation.max&&l>r.validation.max&&(a.error.message=o("translate")("Data.Import.Validation.Max",{max:r.validation.max}),l=null),r.validation.min&&l<r.validation.min&&(a.error.message=o("translate")("Data.Import.Validation.Min",{min:r.validation.min}),l=null),r.validation.pattern){var U=new RegExp(r.validation.pattern);U.test(l)||(a.error.message=o("translate")("Data.Import.Validation.Pattern"),l=null)}}return null!=l&&void 0!=l&&(a.error=null),l},i=a.prepareFixedValue(),n=0;n<a.rows.length;n++){var l={},d=a.rows[n];a.error=null;var u=F(a.fieldMap);for(var m in u)if("fixed"!==m&&"fixedFormat"!==m&&u.hasOwnProperty(m)){var p=u[m];if("fixed"===p)l[m]=i[m];else{var c=angular.copy(o("filter")(a.module.fields,{name:m},!0)[0]),f=d[p];if(c.validation&&c.validation.required&&!f){a.error={},a.error.rowNo=n+2,a.error.cellName=p,a.error.cellValue=f,a.error.fieldLabel=c["label_"+e.language],a.error.message=o("translate")("Data.Import.Error.Required");break}if(!f)continue;var g=r(f,c,n+2,p);if(angular.isUndefined(g))break;l[m]=g}}if(a.error)break;t.push(l)}return a.preparing=!1,t},a.getLookupIds=function(){for(var t=n.defer(),r=[],i=F(a.fieldMap),l=0;l<a.rows.length;l++){var d=a.rows[l];if(d[i.owner]){var u=o("filter")(a.users,function(e){return e.full_name.trim().toLowerCaseTurkish()===d[i.owner].toString().trim().toLowerCaseTurkish()},!0)[0];u||(d[a.fieldMap.owner]=e.user.full_name)}else d[i.owner]=e.user.full_name;for(var m in d)if(d.hasOwnProperty(m)){var p=d[m].toString().trim();for(var s in i)if(i.hasOwnProperty(s)){var c=i[s];if("fixed"!==s&&m===c){var g=angular.copy(o("filter")(a.module.fields,{name:s},!0)[0]);if("lookup"!==g.data_type)break;"relation"===g.lookup_type&&(g.lookup_type=a.fixedValue.related_module.value);var v=o("filter")(r,{type:g.lookup_type},!0)[0];if(!v){if(v={},v.type=g.lookup_type,v.values=[],"users"!==g.lookup_type){var x=o("filter")(e.modules,{name:g.lookup_type},!0)[0];v.field=o("filter")(x.fields,{primary:!0},!0)[0].name}else v.field=p.indexOf("@")>-1?"email":"full_name";r.push(v)}p&&v.values.indexOf(p)<0&&v.values.push(p)}}}}return r.length?f.getLookupIds(r).then(function(e){t.resolve(e.data)})["catch"](function(e){t.reject(e.data)}):t.resolve([]),t.promise},a.submit=function(e){return a.error=null,a.errorUnique=null,a.importForm.validate()?y?void(y=!1):(e||(a.wizardStep=2),a.preparing=!0,a.trying=!1,void m(function(){a.getLookupIds().then(function(e){a.lookupIds=e,a.records=a.prepareRecords(),v.run("BeforeImport","Script",a)})},200)):void h.warning(o("translate")("Module.RequiredError"))},a.tryAgain=function(){a.trying=!0,a.error=null,a.errorUnique=null;var e=V.queue[0]._file;D(e,!0)},a.saveLoaded=function(){a.getLookupIds().then(function(e){a.lookupIds=e,a.records=a.prepareRecords(),a.save()})},a.save=function(){return!a.records&&a.selectedMapping.id?void a.saveLoaded():(a.saving=!0,m(function(){a.saving&&(a.longProcessing=!0)},4e3),void f["import"](a.records,a.module.name).then(function(e){var t=a.module.name+"_"+a.module.name;p.remove(t),a.importResponse=e.data,V.uploadAll(),m(function(){a.saving=!1,a.longProcessing=!1,h.success({content:o("translate")("Data.Import.Success"),timeout:6e3}),r.go("app.moduleList",{type:a.type})},500)})["catch"](function(e){409===e.status&&(a.errorUnique={},a.errorUnique.field=e.data.field,e.data.field2&&(a.errorUnique.field=e.data.field2)),a.saving=!1,a.longProcessing=!1}))},a.combinationFilter=function(e){return e.combination?!1:!0},a.mappingControl=function(){a.importForm.validate()||(a.wizardStep=2)},a.cancel=function(){x.cancel()};var S=[];angular.element(document).ready(function(){a.excelCellOptions=function(e,t){if(S=[],"related_module"!==e.name&&(S=angular.copy(a.cells)),b.name=a.fixedValue[e.name]?a.fixedValueFormatted[e.name]:o("translate")("Data.Import.FixedValue")+" -->",S.push(b),S.push(w),!t)return{dataSource:S,autoBind:!0,dataTextField:"name",dataValueField:"column"};var r=angular.element("#"+e.name).data("kendoDropDownList");r.setDataSource(S)},a.fieldMap=angular.copy(a.fieldMapCopy)}),a.mappingOptions={dataSource:{transport:{read:{url:"/api/data/import_get_all_mappings/"+a.module.id,type:"GET",dataType:"json",beforeSend:e.beforeSend(),cache:!1}}},dataTextField:"name",dataValueField:"id",autoBind:!0},a.dateMinValidationControl=function(e){return e.validation.min?"today"===e.validation.min?a.currentDayMin:e.validation.min:new Date(2e3,0,1,0,0,0)},a.dateMaxValidationControl=function(e){return e.validation.max?"today"===e.validation.max?a.currentDayMax:e.validation.max:new Date(2099,0,1,0,0,0)},a.fixedSelectListOption=function(e){var t=o("filter")(a.picklistsModule[e.picklist_id],{inactive:"!true",hidden:"!true"},!0);return{dataSource:t,dataTextField:"label_"+a.language,dataValueField:"id"}},a.fixedMultiSelect=function(e){var t=o("filter")(a.picklistsModule[e.picklist_id],{inactive:"!true",hidden:"!true"},!0);return{placeholder:o("translate")("Common.MultiselectPlaceholder"),dataTextField:"label_"+a.language,valuePrimitive:!0,autoBind:!1,dataSource:t}},a.fixedLookupOptions=function(){return{}},a.getColumnName=function(e){var t=a.fieldMap[e];return t?t.column:void 0}}]);