"use strict";angular.module("primeapps").controller("ExportDataController",["$rootScope","$scope","$filter","$window","$mdDialog","mdToast",function(e,t,l,a,o,i){t.getDownloadViewUrlExcel=function(){var o=t.module.name,d=t.activeView.id,n=e.user.profile.id,c=t["export"].moduleAllColumn,s=angular.copy(t.findRequest);delete s.aggregations,delete s.group,delete s.groupDate,s.filters&&s.filters.length>0&&s.filters.forEach(function(e){delete e.created_at,delete e.created_by,delete e.created_by_id,delete e.view_id,delete e.id,delete e.deleted}),a.open("/attach/export_excel_view?module="+o+"&viewId="+d+"&profileId="+n+"&listFindRequestJson="+JSON.stringify(s)+"&isViewFields="+!c+"&locale="+e.locale+(e.preview?"&appId="+e.user.app_id:""),"_blank"),i.success(l("translate")("Module.ExcelDesktop"))},t.excelNoData=function(){var o=t.module.name,d=t.quoteTemplate.id,n=t.quoteTemplate.name,c=e.activeView.id;a.open("/attach/export_excel_no_data?module="+o+"&viewId="+c+"&templateId="+d+"&templateName="+n+"&locale="+e.locale+"&listFindRequestJson="+JSON.stringify(t.findRequest),"_blank"),i.success(l("translate")("Module.ExcelDesktop"))},t.excelData=function(){var o=t.module.name,d=t.quoteTemplate.id,n=t.quoteTemplate.name,c=e.activeView.id;a.open("/attach/export_excel_data?module="+o+"&viewId="+c+"&templateId="+d+"&templateName="+n+"&locale="+e.locale+"&listFindRequestJson="+JSON.stringify(t.findRequest),"_blank"),i.success(l("translate")("Module.ExcelDesktop"))},t.cancel=function(){o.cancel()},t.quoteTemplatesOptions={dataSource:l("filter")(t.quoteTemplates,{active:!0,isShown:!0}),dataTextField:"name",dataValueField:"id"}}]);