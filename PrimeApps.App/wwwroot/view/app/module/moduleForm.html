<div class="page">
    <form name="moduleForm" class="form-horizontal form-custom" ng-submit="submit(record)" autocomplete="off" novalidate>
        <div class="panel panel-default">
            <div class="panel-heading clearfix">
                <h4 ng-if="type == 'current_accounts' || type == 'activities'" class="pull-left">
                    {{subtypeNameLang}}<span ng-if="clone && !revise"> ({{'Module.Copy' | translate}})</span><span
                        ng-if="revise"></span></h4>
                <h4 ng-if="type != 'current_accounts' && type != 'activities'" class="pull-left">{{title}}<span
                        ng-if="clone && !revise"> ({{'Module.Copy' | translate}})</span><span ng-if="revise"> ({{'Common.Revise' | translate}})</span>
                </h4>
                <div class="pull-right">
                    <a href="#/app/setup/module?id={{module.name}}&redirect" class="btn btn-sm btn-custom" ng-if="hasAdminRights() && !id && !isAvailableForSmallDevice() && !preview">{{'Module.EditForm' | translate}}</a>
                    <a href="{{!back ? (!parentId ? (!id ? '#/app/modules/' + type : '#/app/module/' + type + '?id=' + id) : ('#/app/module/' + parentModule + '?id=' + parentId + '&rptype=' + returnTab)) : (back != 'calendar' ? '#/app/modules/' + back : '#/app/calendar')}}" class="btn btn-sm btn-custom" ng-disabled="submitting || loading">{{'Common.Cancel' | translate}}</a>
                    <button type="submit" class="btn btn-sm btn-primary" ladda="submitting && saveAndNew"
                            ng-mouseup="saveAndNew = true"
                            ng-show="showSaveAndNew != 'false'"
                            ng-disabled="(submitting && !saveAndNew) || loading || fileLoadingCounter>0">
                        {{'Common.SaveAndNew'
                        | translate}}
                    </button>
                    <button type="submit" class="btn btn-sm btn-primary" ladda="submitting && !saveAndNew"
                            ng-mouseup="saveAndNew = false"
                            ng-disabled="(submitting && saveAndNew) || loading || fileLoadingCounter>0">{{'Common.Save'
                        |
                        translate}}
                    </button>
                </div>
                <a ng-if="isAvailableForSmallDevice()" href="javascript:history.back();" class="btn btn-sm btn-custom"><i class="fa fa-chevron-left"></i> {{'Common.Back' | translate}}</a>
                <div class="pull-right">
                    <button class="{{custombutton.css_class}}" type="button"
                            custom-scripting="{{custombutton.template}}" data-spinner-color="#666" ladda="running"
                            ng-repeat="custombutton in actionButtons"
                            ng-if="custombutton.action_type === 'Scripting' && hasActionButtonDisplayPermission(custombutton)"
                            style="margin-left: 10px"><i ng-class="custombutton.icon"></i>
                        {{custombutton.name}}
                    </button>
                    <button class="{{custombutton.css_class}} ladda-button" type="button" data-spinner-color="#666"
                            ladda="webhookRequesting[custombutton.id]" ng-click="webhookRequest(custombutton)"
                            ng-repeat="custombutton in actionButtons"
                            ng-if="custombutton.action_type === 'Webhook' && hasActionButtonDisplayPermission(custombutton)"
                            style="margin-left: 10px"><i
                            ng-class="custombutton.icon"></i> {{custombutton.name}}
                    </button>
                    <button class="{{custombutton.css_class}}" type="button"
                            ng-click="showModuleFrameModal(custombutton.url)"
                            ng-repeat="custombutton in actionButtons"
                            ng-if="custombutton.action_type === 'ModalFrame' && hasActionButtonDisplayPermission(custombutton)"
                            style="margin-left: 10px"><i ng-class="custombutton.icon"></i>
                        {{custombutton.name}}
                    </button>
                </div>
            </div>
            <div class="panel-body">
                <div class="form-group" ng-show="moduleForm.$submitted && moduleForm.$invalid">
                    <div class="col-sm-offset-2 col-sm-8">
                        <div class="callout callout-danger">
                            <p ng-if="moduleForm.$error.required || moduleForm.$error['autocomplete-required']">
                                {{'Module.RequiredError' | translate}}</p>
                            <p ng-if="moduleForm.$error['autocomplete-required'] || moduleForm.$error.leftoverText">
                                {{'Module.RequiredAutoCompleteError' | translate}}</p>
                            <p ng-if="moduleForm.$error.email">{{'Module.EmailError' | translate}}</p>
                            <p ng-if="moduleForm.$error.min">{{'Module.MinError' | translate}}</p>
                            <p ng-if="moduleForm.$error.max">{{'Module.MaxError' | translate}}</p>
                            <p ng-if="moduleForm.$error.minlength">{{'Module.MinLengthError' | translate}}</p>
                            <p ng-if="moduleForm.$error.pattern">{{'Module.PatternError' | translate}}</p>
                            <p ng-if="moduleForm.$error.date && moduleForm.$error.parse">{{'Module.DateError' |
                                translate}}</p>
                            <p ng-if="moduleForm.$error.unique">{{'Module.UniqueError ' | translate}}</p>
                        </div>
                    </div>
                </div>
                <div ng-show="loading" class="page-loading"><i class="fa fa-sm fa-spinner fa-pulse"></i></div>
                <div ng-show="!loading">
                    <div class="subpanel" ng-repeat="section in module.sections | filter:{display_form:true, deleted: false}:true | orderBy:'order'" ng-if="!section.hidden && hasPermission(type, operations.modify, record) && hasSectionFullPermission(section)">
                        <h5 class="subpanel-heading">
                            {{
 !section.custom_label ? section['label_' + language] :
                            section.custom_label
                            }}
                        </h5>
                        <div class="subpanel-body">
                            <div class="row">
                                <div ng-class="{'col-sm-6': section.column_count === 2, 'col-sm-12': section.column_count === 1}" ng-repeat="column in section.columns track by $index">
                                    <div class="form-group"
                                         ng-class="{'has-error': moduleForm.$submitted && moduleForm[field.name].$invalid}"
                                         ng-repeat="field in module.fields | filter:{section: section.name, section_column: column.no, display_form:true, deleted: false}:true | orderBy:'order'"
                                         ng-if="!field.hidden && field.data_type != 'number_auto' && (field.show_only_edit ? id : true) && hasFieldFullPermission(field)"
                                         ng-show="field.name != 'activity_type' && field.name != 'transaction_type'">
                                        <label for="name={{field.name}}" class="control-label" ng-if="!(module.name == 'izinler' && (field.name == 'from_entry_type' || field.name == 'to_entry_type'))" ng-class="{'col-sm-6':section.column_count === 2, 'col-sm-3':section.column_count === 1, 'required-field':field.validation.required}" style="{{field.style_label}}">
                                            <span ng-if="field.validation.required && field.show_label">*</span>
                                            <span ng-show="!field.custom_label && field.show_label">{{field['label_' + language]}}:</span>
                                            <input type="checkbox" ng-model="record[field.name]" class="cell-handle" ng-show="field.data_type=='checkbox' && field.custom_label">
                                        </label>
                                        <div ng-class="{'col-sm-6': section.column_count === 2, 'col-sm-9': section.column_count === 1 && field.position !='left', 'checkbox': field.data_type === 'checkbox','col-sm-12':field.position==='left'}"
                                             style="{{field.style_input}}">

                                            <div ng-if="field.show_lock" class="clearfix">
                                                <i style="margin-left: 5px; margin-top: 10px;" class="fa fa-lock fa-lg"></i>
                                            </div>

                                            <input type="text"
                                                   name="{{field.name}}"
                                                   class="form-control ng-animate-disabled"
                                                   style="{{field.style.input}}"
                                                   tabindex="{{field.order}}"
                                                   placeholder="{{field.placeholder}}"
                                                   ng-model="record[field.name]"
                                                   ng-change="fieldValueChange(field);"
                                                   ng-required="{{field.validation.required}}"
                                                   ng-readonly="field.validation.readonly || (id && !field.editable)"
                                                   ng-minlength="field.validation.min_length || 0"
                                                   maxlength="{{field.validation.max_length || 50}}"
                                                   pattern="{{field.validation.pattern}}"
                                                   ui-mask="{{field.mask}}"
                                                   ng-if="field.data_type === 'text_single' && field.data_type != 'number_auto' && !field.combination && (!field.editable ? field.show_label : true) && !field.show_lock" />

                                            <pre name="{{field.name}}"
                                                 class="form-control ng-animate-disabled"
                                                 style="{{'padding-top: 5px; padding-left: 1px; border: 0px;height: 100% ' + field.style.input}}"
                                                 tabindex="{{field.order}}"
                                                 ng-bind-html="field.placeholder"
                                                 ng-if="field.data_type === 'text_single' && !field.editable && !field.show_label  && !field.show_lock"></pre>

                                            <textarea name="{{field.name}}"
                                                      class="form-control ng-animate-disabled"
                                                      style="{{'overflow-x: hidden;' + field.style.input}}"
                                                      tabindex="{{field.order}}"
                                                      placeholder="{{field.placeholder}}"
                                                      ng-model="record[field.name]"
                                                      ng-change="fieldValueChange(field);"
                                                      ng-required="{{field.validation.required}}"
                                                      ng-minlength="field.validation.min_length || 0"
                                                      maxlength="{{field.validation.max_length || 500}}"
                                                      ng-readonly="field.validation.readonly || (id && !field.editable)"
                                                      pattern="{{field.validation.pattern}}"
                                                      auto-grow
                                                      ng-if="field.data_type === 'text_multi' && !field.multiline_type_use_html"></textarea>

                                            <textarea ng-model="record[field.name]"
                                                      ui-tinymce-multi="tinymceOptions"
                                                      ng-required="{{field.validation.required}}"
                                                      ng-if="field.data_type === 'text_multi' && field.multiline_type_use_html"></textarea>

                                            <div class="inner-addon right-addon" ng-if="field.data_type === 'location'"
                                                 ng-click="openLocationModal(field.name)">
                                                <i class="glyphicon glyphicon-map-marker" style="height: 27px;"></i>
                                                <input name="{{field.name}}" ng-model="record[field.name]"
                                                       ng-readonly="field.validation.readonly" type="text"
                                                       class="form-control" />

                                            </div>

                                            <input type="text"
                                                   name="{{field.name}}"
                                                   class="form-control ng-animate-disabled"
                                                   style="{{field.style.input}}"
                                                   tabindex="{{field.order}}"
                                                   placeholder="{{field.placeholder}}"
                                                   ng-model="record[field.name]"
                                                   ng-change="fieldValueChange(field); calculate(field);"
                                                   ng-required="field.validation.required"
                                                   ng-readonly="field.validation.readonly || (id && !field.editable)"
                                                   ng-trim="false"
                                                   ng-minlength="field.validation.min_length || 0"
                                                   maxlength="{{field.validation.max_length || 15}}"
                                                   min-value="field.validation.min || Number.MIN_VALUE"
                                                   max-value="field.validation.max || Number.MAX_VALUE"
                                                   numeric
                                                   ng-if="field.data_type === 'number' && !field.show_lock" />

                                            <input type="text"
                                                   name="{{field.name}}"
                                                   class="form-control ng-animate-disabled"
                                                   style="{{field.style.input}}"
                                                   tabindex="{{field.order}}"
                                                   placeholder="{{field.placeholder}}"
                                                   ng-model="record[field.name]"
                                                   ng-change="fieldValueChange(field); calculate(field);"
                                                   ng-required="field.validation.required"
                                                   ng-readonly="field.validation.readonly || (id && !field.editable)"
                                                   maxlength="{{field.validation.max_length || 19}}"
                                                   min-value="field.validation.min || Number.MIN_VALUE"
                                                   max-value="field.validation.max || Number.MAX_VALUE"
                                                   places="field.decimal_places || 2"
                                                   rounding="field.rounding"
                                                   number-decimal
                                                   ng-if="field.data_type === 'number_decimal' && !field.show_lock" />

                                            <input type="text"
                                                   name="{{field.name}}"
                                                   class="form-control ng-animate-disabled"
                                                   style="{{field.style.input}}"
                                                   tabindex="{{field.order}}"
                                                   placeholder="{{field.placeholder}}"
                                                   ng-model="record[field.name]"
                                                   ng-change="fieldValueChange(field); calculate(field);"
                                                   ng-required="field.validation.required"
                                                   ng-readonly="field.validation.readonly || (id && !field.editable)"
                                                   maxlength="{{field.validation.max_length || 21}}"
                                                   min-value="field.validation.min || 0"
                                                   max-value="field.validation.max || Number.MAX_VALUE"
                                                   places="field.decimal_places || 2"
                                                   rounding="field.rounding"
                                                   currency-symbol="field.currency_symbol || currencySymbol"
                                                   number-currency
                                                   ng-if="field.data_type === 'currency' && !field.show_lock" />

                                            <input type="email"
                                                   name="{{field.name}}"
                                                   class="form-control ng-animate-disabled"
                                                   style="{{field.style.input}}"
                                                   tabindex="{{field.order}}"
                                                   placeholder="{{field.placeholder}}"
                                                   ng-model="record[field.name]"
                                                   ng-change="fieldValueChange(field);"
                                                   ng-required="{{field.validation.required}}"
                                                   ng-readonly="field.validation.readonly || (id && !field.editable)"
                                                   ng-minlength="field.validation.min_length || 0"
                                                   maxlength="{{field.validation.max_length || 100}}"
                                                   ng-if="field.data_type === 'email' && !field.show_lock" />

                                            <input type="text"
                                                   name="{{field.name}}"
                                                   class="form-control ng-animate-disabled"
                                                   style="{{field.style.input}}"
                                                   tabindex="{{field.order}}"
                                                   ng-model="record[field.name]"
                                                   ng-change="fieldValueChange(field); moduleForm[field.name].$setValidity('date', true);"
                                                   ng-required="{{field.validation.required}}"
                                                   ng-readonly="field.validation.readonly || (id && !field.editable)"
                                                   data-autoclose="1"
                                                   data-date-type="iso"
                                                   data-min-date="{{(field.validation.min ? (field.validation.min === 'today' ? currentDayMin : field.validation.min) : undefined)}}"
                                                   data-max-date="{{(field.validation.max ? (field.validation.max === 'today' ? currentDayMax : field.validation.max) : undefined)}}"
                                                   data-icon-left="fa fa-chevron-left"
                                                   data-icon-right="fa fa-chevron-right"
                                                   bs-datepicker
                                                   ng-if="field.data_type === 'date'">

                                            <div class="clearfix" ng-if="field.data_type === 'date_time'">
                                                <input type="text"
                                                       name="{{field.name}}"
                                                       class="form-control ng-animate-disabled pull-left datetime-date"
                                                       style="{{(module.name === 'izinler' && izinTuruData && (!izinTuruData['saatlik_kullanim_yapilir'] && izinTuruData['sadece_tam_gun_olarak_kullanilir'])) ? field.style.input + ' width: 100% !important;' : field.style.input}}"
                                                       tabindex="{{field.order}}"
                                                       ng-model="record[field.name]"
                                                       ng-change="fieldValueChange(field); moduleForm[field.name].$setValidity('date', true);"
                                                       ng-required="{{field.validation.required}}"
                                                       ng-readonly="field.validation.readonly || (id && !field.editable)"
                                                       placeholder="{{'Common.Date' | translate}}"
                                                       data-autoclose="1"
                                                       data-date-type="iso"
                                                       data-min-date="{{(field.validation.min ? (field.validation.min === 'today' ? currentDayMin : field.validation.min) : undefined)}}"
                                                       data-max-date="{{(field.validation.max ? (field.validation.max === 'today' ? currentDayMax : field.validation.max) : undefined)}}"
                                                       data-icon-left="fa fa-chevron-left"
                                                       data-icon-right="fa fa-chevron-right"
                                                       bs-datepicker>
                                                <input type="text"
                                                       class="form-control datetime-time ng-animate-disabled"
                                                       style="{{field.style.input}}"
                                                       tabindex="{{field.order}}"
                                                       ng-model="record[field.name]"
                                                       ng-change="fieldValueChange(field); moduleForm[field.name].$setValidity('date', true);"
                                                       ng-disabled="!record[field.name] && !moduleForm[field.name].$dirty"
                                                       placeholder="{{'Common.Time' | translate}}"
                                                       data-autoclose="1"
                                                       data-time-type="iso"
                                                       data-icon-up="fa fa-chevron-up"
                                                       data-icon-down="fa fa-chevron-down"
                                                       data-length="1"
                                                       data-minute-step="10"
                                                       data-arrow-behavior="picker"
                                                       bs-timepicker
                                                       ng-hide="module.name === 'izinler' && izinTuruData && (!izinTuruData['saatlik_kullanim_yapilir'] || izinTuruData['yillik_izin'])">

                                                <select class="form-control ng-animate-disabled custom-readonly"
                                                        name="{{field.name === 'baslangic_tarihi' ? 'from_entry_type' : 'to_entry_type'}}"
                                                        style="width:29% !important;font-size: 10px;"
                                                        tabindex="{{field.order + 1}}"
                                                        ng-model="record[field.name === 'baslangic_tarihi' ? 'from_entry_type' : 'to_entry_type']"
                                                        ng-change="fieldValueChange(customLeaveFields[field.name === 'baslangic_tarihi' ? 'from_entry_type' : 'to_entry_type']);"
                                                        ng-required="{{true}}"
                                                        ng-options="o as o.label[language] for o in picklistsModule[customLeaveFields[field.name === 'baslangic_tarihi' ? 'from_entry_type' : 'to_entry_type'].picklist_id] | filter:{inactive:'!true', hidden:'!true'} track by o.id"
                                                        ng-if="module.name == 'izinler' && izinTuruData && !izinTuruData['saatlik_kullanim_yapilir'] && !izinTuruData['sadece_tam_gun_olarak_kullanilir'] && (field.name === 'baslangic_tarihi' || field.name === 'bitis_tarihi')"></select>
                                            </div>

                                            <input type="text"
                                                   name="{{field.name}}"
                                                   class="form-control"
                                                   style="{{field.style.input}}"
                                                   tabindex="{{field.order}}"
                                                   ng-model="record[field.name]"
                                                   ng-change="fieldValueChange(field); moduleForm[field.name].$setValidity('date', true);"
                                                   ng-required="{{field.validation.required}}"
                                                   ng-readonly="field.validation.readonly || (id && !field.editable)"
                                                   data-autoclose="1"
                                                   data-time-type="iso"
                                                   data-icon-up="fa fa-chevron-up"
                                                   data-icon-down="fa fa-chevron-down"
                                                   data-length="1"
                                                   data-minute-step="10"
                                                   data-arrow-behavior="picker"
                                                   placeholder="{{'Common.Time' | translate}}"
                                                   bs-timepicker
                                                   ng-if="field.data_type === 'time'">
                                            <div style="text-align: justify; text-justify: inter-word; margin-bottom: 6px;"
                                                 class="ng-animate-disabled"
                                                 tabindex="{{cell.field.order}}"
                                                 ng-model="field.custom_label"
                                                 ng-class="{'required-field':field.validation.required, 'col-sm-12':field.position==='left'} "
                                                 ng-if="(field.data_type === 'picklist' ||field.data_type === 'rating') && field.custom_label">
                                                {{field.custom_label}}
                                            </div>

                                            <select class="form-control ng-animate-disabled custom-readonly"
                                                    name="{{field.name}}"
                                                    style="{{field.style.input}}"
                                                    tabindex="{{field.order}}"
                                                    ng-model="record[field.name]"
                                                    ng-change="fieldValueChange(field);"
                                                    ng-required="{{field.validation.required}}"
                                                    ng-disabled="field.validation.readonly || (id && !field.editable)"
                                                    ng-options="o as o.label[language] for o in picklistsModule[field.picklist_id] | filter:picklistFilter() track by o.id"
                                                    ng-if="field.data_type === 'picklist' && ( field.view_type === 'dropdown' || field.view_type === '' || field.view_type === undefined) && !(module.name == 'izinler' && (field.name == 'from_entry_type' || field.name == 'to_entry_type'))">
                                                <option value="">{{'Common.Select' | translate}}</option>
                                            </select>

                                            <span style="position: absolute;right: -268px;;top: 6px;width: 277px;" class="product-info" ng-if="module.name == 'izinler' && field.data_type === 'lookup' && field.name == 'izin_turu' && izinTuruData && izinTuruData['aciklama']">
                                                <i class="fa fa-info-circle" aria-hidden="true"
                                                   data-title="{{izinTuruData['aciklama']}}"
                                                   data-trigger="hover"
                                                   data-placement="bottom"
                                                   bs-tooltip=""></i>
                                            </span>

                                            <div ng-repeat="radio in picklistsModule[field.picklist_id] | filter:{inactive:'!true', hidden:'!true'}"
                                                 ng-if="field.data_type === 'picklist' &&  field.view_type ==='radio'"
                                                 ng-class="{'col-sm-12':field.position==='left'}">
                                                <input id="{{field.name+radio.id}}"
                                                       tabindex="{{field.order}}"
                                                       ng-disabled="field.validation.readonly || (id && !field.editable)"
                                                       ng-required="{{field.validation.required}}"
                                                       name="{{field.name}}"
                                                       type="radio"
                                                       ng-model="record[field.name]"
                                                       ng-change="fieldValueChange(field);"
                                                       ng-value="radio">
                                                <label for="{{field.name+radio.id}}"
                                                       style="font-size: 16px;font-weight: 300 !important;">
                                                    {{radio.label[language]}}
                                                </label>
                                            </div>

                                            <input type="checkbox"
                                                   name="{{field.name}}"
                                                   class="ng-animate-disabled custom-readonly"
                                                   style="{{field.style.input}}"
                                                   tabindex="{{field.order}}"
                                                   ng-checked="record[field.name]"
                                                   ng-disabled="field.validation.readonly || (id && !field.editable)"
                                                   ng-model="record[field.name]"
                                                   ng-change="fieldValueChange(field);"
                                                   ng-if="field.data_type === 'checkbox' && !field.custom_label">

                                            <span class="ng-animate-disabled"
                                                  tabindex="{{cell.field.order}}"
                                                  ng-model="field.custom_label"
                                                  ng-if="field.data_type === 'checkbox' && field.custom_label">{{field.custom_label}}</span>

                                            <input type="text"
                                                   name="{{field.name}}"
                                                   class="form-control ng-animate-disabled"
                                                   style="{{field.style.input}}"
                                                   tabindex="{{field.order}}"
                                                   ng-value="record[field.combination.field_1] && record[field.combination.field_2] ? record[field.combination.field_1] + ' ' + record[field.combination.field_2] : null"
                                                   ng-readonly="true"
                                                   ng-if="field.data_type === 'text_single' && field.combination && !field.show_lock" />

                                            <tags-input name="{{field.name}}"
                                                        tabindex="{{field.order}}"
                                                        ng-model="record[field.name]"
                                                        display-property="labelStr"
                                                        key-property="id"
                                                        placeholder="{{'Common.MultiselectPlaceholder' | translate}}"
                                                        replace-spaces-with-dashes="false"
                                                        add-from-autocomplete-only="true"
                                                        min-length="1"
                                                        ng-required="{{field.validation.required}}"
                                                        ng-if="field.data_type === 'multiselect'">
                                                <auto-complete source="multiselect($query, field)"
                                                               min-length="0"
                                                               load-on-focus="true"
                                                               load-on-empty="true"
                                                               max-results-to-show="9999"></auto-complete>
                                            </tags-input>
                                            <tags-input name="{{field.name}}"
                                                        tabindex="{{field.order}}"
                                                        ng-model="record[field.name]"
                                                        display-property="text"
                                                        placeholder="{{'Common.TagPlaceholder' | translate}}"
                                                        ng-required="{{field.validation.required}}"
                                                        replace-spaces-with-dashes="false"
                                                        ng-if="field.data_type === 'tag'">
                                                <auto-complete source="tags($query, field)"
                                                               load-on-focus="true"
                                                               load-on-empty="true"
                                                               max-results-to-show="9999"></auto-complete>
                                            </tags-input>
                                            <span class="file-input btn btn-primary btn-sm btn-file" ng-if="field.data_type === 'document'">
                                                {{'Documents.ChooseFiles' | translate}}
                                                <input id="fileDocument_{{field.name}}"
                                                       type="file"
                                                       name="{{field.name}}"
                                                       class="fileInput"
                                                       tabindex="{{field.order}}"
                                                       nv-file-select uploader="uploaderBasic(field)"
                                                       ng-model='record[field.name]'
                                                       ng-required="{{field.validation.required}}"
                                                       ng-if="field.data_type === 'document'" />

                                            </span>
                                            <label for="fileDocument_{{field.name}}" ng-if="field.data_type === 'document'" ng-value='record[field.name]' id="lbl_fileDocument_{{field.name}}">{{record[field.name]}}</label>
                                            <span ng-show="record[field.name]" ng-if="field.data_type === 'document'">
                                                <a href ng-if="field.data_type === 'document'" ng-click="removeDocument(field)">
                                                    <i class="fa fa-minus-circle"></i>
                                                </a>
                                            </span>

                                            <div ng-if="field.data_type === 'image'" class="image-type">
                                                <span class="file-input btn btn-primary btn-sm btn-file"
                                                      ng-disabled="fileLoadingCounter>0">
                                                    {{'Documents.ChooseFiles' | translate}}
                                                    <input id="fileImage_{{field.name}}"
                                                           type="file"
                                                           name="{{field.name}}"
                                                           class="fileInput"
                                                           tabindex="{{field.order}}"
                                                           nv-file-select uploader="uploaderImage(field)"
                                                           ng-model='record[field.name]'
                                                           ng-required="{{field.validation.required}}"
                                                           ng-if="field.data_type === 'image'" />

                                                </span>
                                                <label for="fileImage_{{field.name}}"
                                                       ng-if="field.data_type === 'image'"
                                                       ng-value='record[field.name]'
                                                       id="lbl_fileDocument_{{field.name}}">{{record[field.name]}}</label>
                                                <span ng-show="record[field.name]" ng-if="field.data_type === 'image'">
                                                    <a ng-show="fileLoadingCounter<1" href
                                                       ng-if="field.data_type === 'image'"
                                                       ng-click="removeDocument(field)">
                                                        <i class="fa fa-minus-circle"></i>
                                                    </a>
                                                    <i ng-if="fileLoadingCounter>0"
                                                       class="fa  fa-spinner fa-spin ng-animate-disabled"></i>
                                                </span>
                                            </div>

                                            <input-stars style="margin-left: 11px;"
                                                         ng-if="field.data_type === 'rating'"
                                                         max="{{field.validation.min_length}}"
                                                         allow-half
                                                         icon-base="fa fa-fw"
                                                         icon-empty="fa-star-o"
                                                         icon-half="fa-star-half-o"
                                                         icon-full="fa-star"
                                                         icon-hover-full="fa-star"
                                                         ng-model="record[field.name]">
                                            </input-stars>

                                            <input type="text"
                                                   name="{{field.name}}"
                                                   class="form-control ng-animate-disabled"
                                                   style="{{field.style.input}}"
                                                   tabindex="{{field.order}}"
                                                   placeholder="{{field.placeholder}}"
                                                   ng-model="record[field.name]"
                                                   ng-required="{{field.validation.required}}"
                                                   ng-readonly="field.validation.readonly || (id && !field.editable)"
                                                   ng-minlength="field.validation.min_length || 0"
                                                   maxlength="{{field.validation.max_length || 400}}"
                                                   pattern="{{field.validation.pattern}}"
                                                   ng-if="field.data_type === 'url'  && !field.show_lock" />

                                            <ui-select name="{{field.name}}" ng-change="fieldValueChange(field);" ng-required="{{field.validation.required}}" ng-disabled="field.validation.readonly || (id && !field.editable)" ng-click="setDropdownData(field)" ng-model="record[field.name]" ng-if="field.data_type === 'lookup' && field.show_as_dropdown">
                                                <ui-select-match placeholder="{{('Common.Select' | translate)}}">{{$select.selected.primary_value}}</ui-select-match>
                                                <ui-select-choices repeat="user in dropdownFieldDatas[field.name] | filter:{primary_value: $select.search} | orderBy:'primary_value'">
                                                    <div ng-bind-html="user.primary_value | highlight: $select.search"></div>
                                                </ui-select-choices>
                                            </ui-select>

                                            <!--Create new input above. angucomplete-alt must be at the bottom of the form-->
                                            <angucomplete-alt input-name="{{field.name}}"
                                                              id="{{field.name}}"
                                                              input-class="form-control ng-animate-disabled"
                                                              match-class="highlight-angucomplete"
                                                              field-tabindex="{{field.order}}"
                                                              field-required="field.validation.required"
                                                              disable-input="field.validation.readonly || (id && !field.editable)"
                                                              pause="200"
                                                              selected-object="record[field.name]"
                                                              initial-value="record[field.name]"
                                                              remote-api-handler="lookup"
                                                              search-fields="name"
                                                              title-field="primary_value"
                                                              minlength="1"
                                                              template-url="view/common/angucomplete.html"
                                                              focus-in="setCurrentLookupField(field)"
                                                              text-searching="{{'Common.Searching' | translate}}"
                                                              text-no-results="{{'Common.NoResults' | translate}}"
                                                              use-original-object="true"
                                                              value-changed="fieldValueChange(field);"
                                                              create-new="openFormModal"
                                                              hide-create-new="hideCreateNew(field)"
                                                              ng-if="field.data_type === 'lookup' && !field.show_as_dropdown" />
                                            <!--Don't add new input below angucomplete-alt. Add above angucomplete-alt-->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="subpanel expand">
                        <h5 class="subpanel-heading" ng-click="expanded = !expanded">
                            {{
 'AdvancedSharing.Title' |
                            translate
                            }} <i ng-class="{'fa fa-minus-square-o':expanded, 'fa fa-plus-square-o':!expanded}"></i>
                        </h5>
                        <div class="subpanel-body" ng-show="expanded">
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group">
                                        <label for="sharedUsersRead" class="control-label col-sm-4">
                                            {{
                                            'AdvancedSharing.VisibleAndCanNotEdit' | translate
                                            }}:
                                        </label>
                                        <div class="col-sm-8">
                                            <tags-input id="sharedUsersRead"
                                                        name="sharedRead"
                                                        tabindex="998"
                                                        ng-model="record.shared_read"
                                                        display-property="name"
                                                        key-property="id"
                                                        placeholder="{{'Common.Search' | translate}}"
                                                        replace-spaces-with-dashes="false"
                                                        add-from-autocomplete-only="true"
                                                        template="view/common/taginput.html">
                                                <auto-complete source="lookupUserAndGroup(module.id, false, $query)"
                                                               min-length="0"
                                                               load-on-focus="true"
                                                               load-on-empty="true"
                                                               max-results-to-show="9999"
                                                               template="view/common/taginput-autocomplete.html"></auto-complete>
                                            </tags-input>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-12">
                                    <div class="form-group">
                                        <label for="sharedUsersRead" class="control-label col-sm-4">
                                            {{
                                            'AdvancedSharing.VisibleAndEditable' | translate
                                            }}:
                                        </label>
                                        <div class="col-sm-8">
                                            <tags-input id="sharedEdit"
                                                        name="sharedUsersRead"
                                                        tabindex="999"
                                                        ng-model="record.shared_edit"
                                                        display-property="name"
                                                        key-property="id"
                                                        placeholder="{{'Common.Search' | translate}}"
                                                        replace-spaces-with-dashes="false"
                                                        add-from-autocomplete-only="true"
                                                        template="view/common/taginput.html">
                                                <auto-complete source="lookupUserAndGroup(module.id, !user.profile.has_admin_rights, $query)"
                                                               min-length="0"
                                                               load-on-focus="true"
                                                               load-on-empty="true"
                                                               max-results-to-show="9999"
                                                               template="view/common/taginput-autocomplete.html"></auto-complete>
                                            </tags-input>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="subpanel expand" ng-if="branchAvailable && module.name == 'branchs' && showBranchSettings">
                        <h5 class="subpanel-heading" ng-click="expanded = !expanded">
                            {{ 'Branch.Title' | translate }} <i ng-class="{'fa fa-minus-square-o':expanded, 'fa fa-plus-square-o':!expanded}"></i>
                        </h5>
                        <div class="subpanel-body" ng-show="expanded">
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group">
                                        <label for="sharedUsersRead" class="control-label col-sm-4">
                                            {{
                                            'Branch.Authorities' | translate
                                            }}:
                                        </label>
                                        <div class="col-sm-8">
                                            <tags-input id="branchAuthorities"
                                                        name="authorities"
                                                        tabindex="998"
                                                        ng-model="record.Authorities"
                                                        display-property="full_name"
                                                        key-property="id"
                                                        placeholder="{{'Common.Search' | translate}}"
                                                        replace-spaces-with-dashes="false"
                                                        add-from-autocomplete-only="true">
                                                <auto-complete source="lookupUser($query)"
                                                               min-length="0"
                                                               load-on-focus="true"
                                                               load-on-empty="true"
                                                               max-results-to-show="9999"></auto-complete>
                                            </tags-input>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="subpanel" ng-if="showExchangeRates">
                        <h5 class="subpanel-heading">{{ 'Product.ExchangeRates' | translate }}</h5>
                        <div class="subpanel-body">
                            <div class="row">
                                <div class="col-sm-6" ng-class="{'has-error': moduleForm.$submitted && moduleForm[field.name].$invalid}" ng-if="record.currency.value === '₺'">
                                    <label for="exchange_rate_try_usd" class="col-sm-6 control-label required-field">
                                        <span>*</span>
                                        <span>{{'1 ' + ('Common.Dollar' | translate)}} =</span>
                                    </label>
                                    <div class="col-sm-6">
                                        <input type="text"
                                               id="exchange_rate_try_usd"
                                               name="exchange_rate_try_usd"
                                               class="form-control ng-animate-disabled"
                                               tabindex="998"
                                               ng-model="record.exchange_rate_try_usd"
                                               required
                                               maxlength="{{21}}"
                                               min-value="0"
                                               max-value="Number.MAX_VALUE"
                                               places="4"
                                               currency-symbol="record.currency.value || currencySymbol"
                                               number-currency />
                                    </div>
                                </div>
                                <div class="col-sm-6" ng-class="{'has-error': moduleForm.$submitted && moduleForm[field.name].$invalid}" ng-if="record.currency.value === '₺'">
                                    <label for="exchange_rate_try_eur" class="col-sm-6 control-label required-field">
                                        <span>*</span>
                                        <span>{{'1 ' + ('Common.Euro' | translate)}} =</span>
                                    </label>
                                    <div class="col-sm-6">
                                        <input type="text"
                                               id="exchange_rate_try_eur"
                                               name="exchange_rate_try_eur"
                                               class="form-control ng-animate-disabled"
                                               tabindex="998"
                                               ng-model="record.exchange_rate_try_eur"
                                               required
                                               maxlength="{{21}}"
                                               min-value="0"
                                               max-value="Number.MAX_VALUE"
                                               places="4"
                                               currency-symbol="record.currency.value || currencySymbol"
                                               number-currency />
                                    </div>
                                </div>
                                <div class="col-sm-6" ng-class="{'has-error': moduleForm.$submitted && moduleForm[field.name].$invalid}" ng-if="record.currency.value === '$'">
                                    <label for="exchange_rate_usd_try" class="col-sm-6 control-label required-field">
                                        <span>*</span>
                                        <span>{{'1 ' + ('Common.TurkishLira' | translate)}} =</span>
                                    </label>
                                    <div class="col-sm-6">
                                        <input type="text"
                                               id="exchange_rate_usd_try"
                                               name="exchange_rate_usd_try"
                                               class="form-control ng-animate-disabled"
                                               tabindex="998"
                                               ng-model="record.exchange_rate_usd_try"
                                               required
                                               maxlength="{{21}}"
                                               min-value="0"
                                               max-value="Number.MAX_VALUE"
                                               places="4"
                                               currency-symbol="record.currency.value || currencySymbol"
                                               number-currency />
                                    </div>
                                </div>
                                <div class="col-sm-6" ng-class="{'has-error': moduleForm.$submitted && moduleForm[field.name].$invalid}" ng-if="record.currency.value === '$'">
                                    <label for="exchange_rate_usd_eur" class="col-sm-6 control-label required-field">
                                        <span>*</span>
                                        <span>{{'1 ' + ('Common.Euro' | translate)}} =</span>
                                    </label>
                                    <div class="col-sm-6">
                                        <input type="text"
                                               id="exchange_rate_usd_eur"
                                               name="exchange_rate_usd_eur"
                                               class="form-control ng-animate-disabled"
                                               tabindex="998"
                                               ng-model="record.exchange_rate_usd_eur"
                                               required
                                               maxlength="{{21}}"
                                               min-value="0"
                                               max-value="Number.MAX_VALUE"
                                               places="4"
                                               currency-symbol="record.currency.value || currencySymbol"
                                               number-currency />
                                    </div>
                                </div>
                                <div class="col-sm-6" ng-class="{'has-error': moduleForm.$submitted && moduleForm[field.name].$invalid}" ng-if="record.currency.value === '€'">
                                    <label for="exchange_rate_eur_try" class="col-sm-6 control-label required-field">
                                        <span>*</span>
                                        <span>{{'1 ' + ('Common.TurkishLira' | translate)}} =</span>
                                    </label>
                                    <div class="col-sm-6">
                                        <input type="text"
                                               id="exchange_rate_eur_try"
                                               name="exchange_rate_eur_try"
                                               class="form-control ng-animate-disabled"
                                               tabindex="998"
                                               ng-model="record.exchange_rate_eur_try"
                                               required
                                               maxlength="{{21}}"
                                               min-value="0"
                                               max-value="Number.MAX_VALUE"
                                               places="4"
                                               currency-symbol="record.currency.value || currencySymbol"
                                               number-currency />
                                    </div>
                                </div>
                                <div class="col-sm-6" ng-class="{'has-error': moduleForm.$submitted && moduleForm[field.name].$invalid}" ng-if="record.currency.value === '€'">
                                    <label for="exchange_rate_eur_usd" class="col-sm-6 control-label required-field">
                                        <span>*</span>
                                        <span>{{'1 ' + ('Common.Dollar' | translate)}} =</span>
                                    </label>
                                    <div class="col-sm-6">
                                        <input type="text"
                                               id="exchange_rate_eur_usd"
                                               name="exchange_rate_eur_usd"
                                               class="form-control ng-animate-disabled"
                                               tabindex="998"
                                               ng-model="record.exchange_rate_eur_usd"
                                               required
                                               maxlength="{{21}}"
                                               min-value="0"
                                               max-value="Number.MAX_VALUE"
                                               places="4"
                                               currency-symbol="record.currency.value || currencySymbol"
                                               number-currency />
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <span class="exchange-rates-message">* {{'Module.ExchangeRatesMessage' | translate:{date: exchangeRatesDate} }}</span>
                            </div>
                        </div>
                    </div>
                    <ng-include ng-show="module.name === 'quotes'" src="'view/app/product/quoteProducts.html'"></ng-include>
                    <ng-include ng-show="module.name === 'sales_orders'" src="'view/app/product/orderProducts.html'"></ng-include>
                    <ng-include ng-show="module.name === 'purchase_orders'" src="'view/app/product/purchaseProducts.html'"></ng-include>
                    <ng-include ng-show="module.name === 'sales_invoices'" src="'view/app/product/salesInvoiceProducts.html'"></ng-include>
                    <ng-include ng-show="module.name === 'purchase_invoices'" src="'view/app/product/purchaseInvoiceProducts.html'"></ng-include>

                    <div class="subpanel" ng-if="hasDocumentsPermission(operations.read)">
                        <h5 class="subpanel-heading">{{'Common.Attachments' | translate}}</h5>
                        <div class="subpanel-body">
                            <div class="row row-custom">
                                <div class="col-sm-12">
                                    <div document-form entity-id="id" entity-type="entityTypes.module" show="true" hide-close-button="true" hide-upload-button="true" hide-all-panel="true" custom-uploader="uploader" entity-id-func="entityIdFunc()"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" ng-show="moduleForm.$submitted && moduleForm.$invalid">
                        <div class="col-sm-offset-2 col-sm-8">
                            <div class="callout callout-danger">
                                <p ng-if="moduleForm.$error.required || moduleForm.$error['autocomplete-required']">{{'Module.RequiredError' | translate}}</p>
                                <p ng-if="moduleForm.$error['autocomplete-required'] || moduleForm.$error.leftoverText">{{'Module.RequiredAutoCompleteError' | translate}}</p>
                                <p ng-if="moduleForm.$error.email">{{'Module.EmailError' | translate}}</p>
                                <p ng-if="moduleForm.$error.min">{{'Module.MinError' | translate}}</p>
                                <p ng-if="moduleForm.$error.max">{{'Module.MaxError' | translate}}</p>
                                <p ng-if="moduleForm.$error.minlength">{{'Module.MinLengthError' | translate}}</p>
                                <p ng-if="moduleForm.$error.pattern">{{'Module.PatternError' | translate}}</p>
                                <p ng-if="moduleForm.$error.date && moduleForm.$error.parse">{{'Module.DateError' | translate}}</p>
                                <p ng-if="moduleForm.$error.unique">{{'Module.UniqueError ' | translate}}</p>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-sm-12 text-center buttons">
                            <a href="{{!back ? (!parentId ? (!id ? '#/app/modules/' + type : '#/app/module/' + type + '?id=' + id) : ('#/app/module/' + parentModule + '?id=' + parentId + '&rptype=' + returnTab)) : (back != 'calendar' ? '#/app/modules/' + back : '#/app/calendar')}}" class="btn btn-custom" ng-disabled="submitting" tabindex="9999">{{'Common.Cancel' | translate}}</a>
                            <button type="submit" class="btn btn-primary" ladda="submitting && saveAndNew" ng-mouseup="saveAndNew = true" ng-disabled="submitting && !saveAndNew" ng-show="showSaveAndNew != 'false'" tabindex="9998">{{'Common.SaveAndNew' | translate}}</button>
                            <button type="submit" class="btn btn-primary" ladda="submitting && !saveAndNew"
                                    ng-mouseup="saveAndNew = false" id="RecordSaveButton"
                                    ng-disabled="(submitting && saveAndNew) || fileLoadingCounter>0  " tabindex="9997">
                                {{'Common.Save' | translate}}
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>