"use strict";angular.module("primeapps").controller("SignalNotificationController",["$rootScope","$scope","SignalNotificationService","helper","mdToast","$filter","$state",function(t,a,e,i,n,d,l){i.hasAdminRights||(n.error(d("translate")("Common.Forbidden")),l.go("app.dashboard")),a.loading=!0,t.breadcrumblist=[{title:d("translate")("Layout.Menu.Dashboard"),link:"#/app/dashboard"},{title:d("translate")("Setup.Nav.Notifications"),link:"#/app/setup/signalnotification"},{title:d("translate")("Setup.Nav.Notifications")}],a.goUrl2=function(t){var e=window.getSelection();0===e.toString().length&&a.showSideModal(t.id,null)},a.getTime=function(t){return kendo.toString(kendo.parseDate(t),"g")};var o=function(t){var e='<td class="hide-on-m2"><span>{{dataItem.message}}</span></td>';e+='<td class="hide-on-m2"><span>{{dataItem.user.full_name}}</span></td>',e+=t.module_id?'<td class="hide-on-m2"><span>{{dataItem.module.label_'+a.language+"_plural}}</span></td>":'<td class="hide-on-m2"><span>-</span></td>',e+=t.record_id?'<td class="hide-on-m2"><div class="grid-list-button"> <span>'+d("translate")("Setup.SignalNotification.RecordDetail")+'</span><a href="#/app/record/{{dataItem.module.name}}?id={{dataItem.record_id}}"><i class= "fas fa-external-link-alt"></i></a> </div></td>':'<td class="hide-on-m2"><span>-</span></td>',e+='<td class="hide-on-m2"><span>'+d("translate")("Setup.SignalNotification.TypeEnum."+t.type)+"</span></td>",e+='<td class="hide-on-m2"><span>'+a.getTime(t.created_at)+"</span></td>",e+="Unread"!==t.status?'<td class="hide-on-m2"><span>'+d("translate")("Setup.SignalNotification.StatusEnum.Read")+"</span></td>":'<td class="hide-on-m2"><span>'+d("translate")("Setup.SignalNotification.StatusEnum.Unread")+"</span></td>",e+=t.updated_at||"Unread"!==t.status?'<td class="hide-on-m2"><span>'+a.getTime(t.updated_at)+"</span></td>":'<td class="hide-on-m2"><span>-</span></td>',e+='<td class="show-on-m2">';var i="<div>"+d("translate")("Setup.SignalNotification.Message")+": <strong>{{dataItem.message}}</strong></div>";return i+="<div>"+d("translate")("Setup.SignalNotification.User")+": <strong>{{dataItem.user.full_name}}</strong></div>",i+=t.module_id?"<div>"+d("translate")("Setup.SignalNotification.Module")+": {{dataItem.module.label_"+a.language+"_plural}}</div>":"<div>"+d("translate")("Setup.SignalNotification.Module")+": -</div>",i+=t.record_id?"<div>"+d("translate")("Setup.SignalNotification.Record")+': <div class="grid-list-button"> <span>{{dataItem.record_id}}</span><a href="#/app/record/{{dataItem.module.name}}?id={{dataItem.record_id}}"><i class= "fas fa-external-link-alt"></i></a> </div></div>':"<div>"+d("translate")("Setup.SignalNotification.Record")+": -</div>",i+="<div>"+d("translate")("Setup.SignalNotification.Status")+": "+d("translate")("Setup.SignalNotification.TypeEnum."+t.type)+"</div>",i+="<div>"+d("translate")("Setup.SignalNotification.CreatedAt")+": "+a.getTime(t.created_at)+"</div>",i+="Unread"!==t.status?"<div>"+d("translate")("Setup.SignalNotification.StatusEnum.Read")+"</div>":"<div>"+d("translate")("Setup.SignalNotification.StatusEnum.Unread")+"</div>",i+=t.updated_at||"Unread"!==t.status?"<div>"+d("translate")("Setup.SignalNotification.UpdatedAt")+": "+a.getTime(t.updated_at)+"</div>":"<div>"+d("translate")("Setup.SignalNotification.UpdatedAt")+": -</div>",e+=i+"</td>"},s=function(){a.signalNotificationGridOptions={dataSource:{type:"odata-v4",page:1,pageSize:10,serverPaging:!0,serverFiltering:!0,serverSorting:!0,transport:{read:{url:"/api/signal_notification/find",type:"GET",dataType:"json",beforeSend:t.beforeSend()}},schema:{data:"items",total:"count",model:{id:"id",fields:{Status:{type:"enums"},Type:{type:"enums"}}}}},scrollable:!1,persistSelection:!0,sortable:!0,noRecords:!0,pageable:{refresh:!0,pageSize:10,pageSizes:[10,25,50,100],buttonCount:5,info:!0},filterable:!0,filter:function(t){if(t.filter&&"Status"!==t.field&&"Type"!==t.field)for(var a=0;a<t.filter.filters.length;a++)t.filter.filters[a].ignoreCase=!0},rowTemplate:function(t){var a="<tr>";return a+=o(t),a+="</tr>"},altRowTemplate:function(t){var a='<tr  class="k-alt">';return a+=o(t),a+="</tr>"},columns:[{media:"(min-width: 575px)",field:"Message",title:d("translate")("Setup.SignalNotification.Message")},{media:"(min-width: 575px)",field:"User.FullName",title:d("translate")("Setup.SignalNotification.User")},{media:"(min-width: 575px)",field:"Module.LabelEnPlural",title:d("translate")("Setup.SignalNotification.Module")},{media:"(min-width: 575px)",field:"RecordId",title:d("translate")("Setup.SignalNotification.Record")},{media:"(min-width: 575px)",field:"Type",title:d("translate")("Setup.SignalNotification.Type"),values:[{value:"Information",text:d("translate")("Setup.SignalNotification.TypeEnum.Information")},{value:"Error",text:d("translate")("Setup.SignalNotification.TypeEnum.Error")},{value:"Success",text:d("translate")("Setup.SignalNotification.TypeEnum.Success")},{value:"Warning",text:d("translate")("Setup.SignalNotification.TypeEnum.Warning")}]},{media:"(min-width: 575px)",field:"CreatedAt",title:d("translate")("Setup.SignalNotification.CreatedAt"),filterable:{ui:function(t){t.kendoDateTimePicker({format:"{0: dd-MM-yyyy  hh:mm}"})}}},{media:"(min-width: 575px)",field:"Status",title:d("translate")("Setup.SignalNotification.Status"),values:[{text:d("translate")("Setup.SignalNotification.StatusEnum.Read"),value:"Read"},{text:d("translate")("Setup.SignalNotification.StatusEnum.Unread"),value:"Unread"}]},{media:"(min-width: 575px)",field:"UpdatedAt",title:d("translate")("Setup.SignalNotification.UpdatedAt"),filterable:{ui:function(t){t.kendoDateTimePicker({format:"{0: dd-MM-yyyy  hh:mm}"})}}},{title:"Items",media:"(max-width: 575px)"}]}};angular.element(document).ready(function(){s(),a.loading=!1})}]);