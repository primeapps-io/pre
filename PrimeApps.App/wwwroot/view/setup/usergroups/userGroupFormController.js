"use strict";angular.module("primeapps").controller("UserGroupFormController",["$rootScope","$scope","$location","$state","$filter","helper","UserGroupService","mdToast",function(e,r,u,o,a,s,t,l){function n(){t.getAll().then(function(e){if(r.userGroups=e.data,i){r.userGroup=angular.copy(a("filter")(r.userGroups,{id:i},!0)[0]);var u=angular.copy(r.userGroup.users);r.userGroup.users=[];for(var o=0;o<u.length;o++){var s=u[o].user;r.userGroup.users.push(s)}}else r.userGroup=p?angular.copy(a("filter")(r.userGroups,{id:p},!0)[0]):{}})["finally"](function(){r.loadingModal=!1})}if(r.loadingModal=!0,r.userGroup={},r.$parent.$parent.selectedGroup){var i=r.$parent.$parent.selectedGroup.id,p=r.$parent.$parent.selectedGroup.clone;r.lookupUser=s.lookupUser,n(),r.setFormValid=function(){r.userGroupForm.users.$setValidity("minTags",!0)},r.submit=function(){if(r.validator.validate()){r.loadingModal=!0;var u=null,o=angular.copy(r.userGroup);o=t.prepare(o),u=!r.userGroup.id||p?t.create(o):t.update(o),u.then(function(){l.success(a("translate")("Setup.UserGroups.SubmitSuccess")),e.closeSide("sideModal"),r.$parent.$parent.grid.dataSource.read()})["finally"](function(){r.loadingModal=!1})}else l.error(a("translate")("Module.RequiredError"))},r.users=e.users,r.usersOptions={dataSource:r.users,filter:"contains",dataTextField:"full_name",dataValueField:"id"}}}]);