"use strict";angular.module("primeapps").controller("UserGroupFormController",["$rootScope","$scope","$location","$state","$filter","helper","UserGroupService","mdToast",function(e,r,a,o,u,s,t,l){function n(){t.getAll().then(function(a){if(r.userGroups=a.data,e.processLanguages(r.userGroups),i&&!p){r.userGroup=angular.copy(u("filter")(r.userGroups,{id:i},!0)[0]);var o=angular.copy(r.userGroup.users);r.userGroup.users=[];for(var s=0;s<o.length;s++){var t=o[s].user;r.userGroup.users.push(t)}}else p&&(r.userGroup=angular.copy(u("filter")(r.userGroups,{id:i},!0)[0]))})["finally"](function(){r.loadingModal=!1})}if(r.loadingModal=!0,r.userGroup={languages:{}},r.userGroup.languages[e.globalization.Label]={name:"",description:""},r.$parent.$parent.selectedGroup){var i=r.$parent.$parent.selectedGroup.id,p=r.$parent.$parent.selectedGroup.clone;r.lookupUser=s.lookupUser,n(),r.setFormValid=function(){r.userGroupForm.users.$setValidity("minTags",!0)},r.submit=function(){if(r.validator.validate()){r.loadingModal=!0;var a=null,o=angular.copy(r.userGroup);o=t.prepare(o),a=!r.userGroup.id||p?t.create(o):t.update(o),a.then(function(){l.success(u("translate")("Setup.UserGroups.SubmitSuccess")),e.closeSide("sideModal"),r.$parent.$parent.grid.dataSource.read()})["finally"](function(){r.loadingModal=!1})["catch"](function(){r.loadingModal=!1,e.closeSide("sideModal"),r.$parent.$parent.grid.dataSource.read()})}else l.error(u("translate")("Module.RequiredError"))},r.users=e.users,r.usersOptions={dataSource:r.users,filter:"contains",dataTextField:"full_name",dataValueField:"id"}}}]);