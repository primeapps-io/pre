"use strict";angular.module("primeapps").factory("TemplateService",["$rootScope","$http","config","$filter","ModuleService",function(e,a,t,l,r){return{get:function(e){return a.get(t.apiUrl+"template/get/"+e)},getAll:function(e,l,r){return a.get(t.apiUrl+"template/get_all?type="+e+"&moduleName="+(l||"")+"&subject="+(r||""))},getAllList:function(e,l){return a.get(t.apiUrl+"template/get_all_list?type="+e+"&excelType="+l)},create:function(e){return a.post(t.apiUrl+"template/create",e)},update:function(e){return a.put(t.apiUrl+"template/update/"+e.id,e)},"delete":function(e){return a["delete"](t.apiUrl+"template/delete/"+e)},getFields:function(a){var t=angular.copy(a.fields),n=[];t=l("filter")(t,{lookup_type:"!relation"},!0);var p={};p.name="seperator-main",p.label=e.getLanguageValue(a.languages,"label","singular"),p.order=0,p.seperator=!0,t.push(p);var u=0;return angular.forEach(t,function(a){if("lookup"===a.data_type&&"relation"!==a.lookup_type){var r=angular.copy(l("filter")(e.modules,{name:a.lookup_type},!0)[0]);if(u+=200,null===r||void 0===r)return;var n={};n.name="seperator-"+r.name,n.order=u,n.seperator=!0,n.label=e.getLanguageValue(r.languages,"label","singular")+" ("+e.getLanguageValue(a.languages,"label")+")",t.push(n);var p=angular.copy(r.fields);p=l("filter")(p,{display_list:!0},!0),angular.forEach(p,function(l){"lookup"!==l.data_type&&(l.label=e.getLanguageValue(l.languages,"label"),l.labelExt="("+a.label+")",l.name=a.name+"."+l.name,l.order=parseInt(l.order)+u,l.parent_type=a.lookup_type,t.push(l))})}}),angular.forEach(t,function(e){if(!e.deleted&&r.hasFieldDisplayPermission(e)&&e.name&&"lookup"!==e.data_type){var a={};a.name=e.name,a.label=e.label,a.labelExt=e.labelExt,a.order=e.order,a.lookup_type=e.lookup_type,a.seperator=e.seperator,a.multiline_type=e.multiline_type,a.data_type=e.data_type,a.parent_type=e.parent_type,n.push(a)}}),n=l("orderBy")(n,"order")}}}]);