"use strict";angular.module("primeapps").controller("TemplateGuideController",["$rootScope","$scope","$filter","ModuleService","$window","mdToast",function(e,l,a,t,o,u){l.templateModules=[],l.$parent.collapsed=!0,angular.forEach(e.modules,function(e){0!=e.order&&l.templateModules.push(angular.copy(e))});var n=function(l){if(l){for(var a=[],t=0;t<l.fields.length;t++)if("lookup"==l.fields[t].data_type)for(var o=0;o<e.modules.length;o++)if(l.fields[t].lookup_type==e.modules[o].name){var u=angular.copy(e.modules[o]);u.parent_field=l.fields[t],a.push(u);break}a.length&&(l.lookupModules=a)}},d=function(e){var l={};l.type="custom",l.name="notes",l.label_tr_singular="Not",l.label_tr_plural="Notlar",l.label_en_singular="Note",l.label_en_plural="Notes",l.order=9999,l.fields=[],l.fields.push({id:1,name:"text",label_tr:"Not",label_en:"Note"}),l.fields.push({id:2,name:"first_name",label_tr:"Oluşturan - Adı",label_en:"First Name"}),l.fields.push({id:3,name:"last_name",label_tr:"Oluşturan - Soyadı",label_en:"Last Name"}),l.fields.push({id:4,name:"full_name",label_tr:"Oluşturan - Adı Soyadı",label_en:"Full Name"}),l.fields.push({id:5,name:"email",label_tr:"Oluşturan - Eposta",label_en:"Email"}),l.fields.push({id:6,name:"created_at",label_tr:"Oluşturulma Tarihi",label_en:"Created at"}),e.relatedModules.push(l)};l.getDownloadUrlExcel=function(){var t=l.selectedModuleExcel.name;o.open("/attach/export_excel?module="+t+"&locale="+e.locale,"_blank"),u.success(a("translate")("Module.ExcelDesktop"))},l.moduleChanged=function(){l.lookupModules=n(l.selectedModule),l.getModuleRelations(l.selectedModule),l.selectedSubModule=null},l.getModuleRelations=function(t){t&&(t.relatedModules=[],angular.forEach(l.selectedModule.relations,function(l){var o=a("filter")(e.modules,{name:l.related_module},!0)[0];!l.deleted&&o&&0!==o.order&&(o=angular.copy(o),"many_to_many"===l.relation_type?angular.forEach(o.fields,function(e){e.name=l.related_module+"_id."+e.name}):n(o),t.relatedModules.push(o))}),d(t))},l.filterUsers=function(e){return"users"!=e.data_type},l.getRelatedFieldName=function(e,l){return l.parent_field.name+"."+(e.multiline_type_use_html?"html__":"image"==e.data_type?"img__":"")+e.name}}]);