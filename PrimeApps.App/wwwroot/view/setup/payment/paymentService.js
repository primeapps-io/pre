"use strict";angular.module("primeapps").factory("PaymentService",["$http","$filter","config",function(t,e,n){return{getPayment:function(){return t.post(n.apiUrl+"Payment/Get",{})},getPaymentHistory:function(e){return t.post(n.apiUrl+"License/GetLicenseStatus",angular.toJson(e))},checkCampaignCode:function(e){return t.get(n.apiUrl+"Payment/CheckCampaign?code="+e)},update:function(e){return t.post(n.apiUrl+"Payment/SaveOrUpdate",e)},updateCampaign:function(e,a){return t.post(n.apiUrl+"Payment/UpdateCampaignCode",{PaymentId:e,CampaignCode:a})},changeCurrency:function(e){return t.post(n.apiUrl+"User/ChangeCurrency",angular.toJson(e))},processPaymentHistory:function(t){var n={};angular.copy(t,n);var a=[];return n.LicenseHistory=null,angular.forEach(t.LicenseHistory,function(t){var n=[],a={};angular.copy(t,a),a.InvoiceDetails=null,angular.forEach(t.InvoiceDetails,function(t){var r=e("filter")(n,{Title:t.Title},!0)[0];if(r)r.Amount+=t.Amount,r.Count++;else{if(t.Title&&t.Title.split(" (").length>0){var i=t.Title.split(" (");t.Code="User"==i[0]||"Storage"==i[0]?i[0]:"Usage",t.Period="Monthly",a.MountCount=1;var o=i[1]&&i[1].replace(/[{()} ]/g,"");o&&parseInt(o)>1&&(a.MountCount=parseInt(o),t.Period="Annual")}t.Count=1,this.push(t)}},n),a.InvoiceDetails=n,this.push(a)},a),n.LicenseHistory=a,n}}}]);